<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Spring的多租户/站点方案</title>
      <link href="/2025/03/17/Spring%E7%9A%84%E5%A4%9A%E7%A7%9F%E6%88%B7%E7%AB%99%E7%82%B9%E6%96%B9%E6%A1%88/"/>
      <url>/2025/03/17/Spring%E7%9A%84%E5%A4%9A%E7%A7%9F%E6%88%B7%E7%AB%99%E7%82%B9%E6%96%B9%E6%A1%88/</url>
      
        <content type="html"><![CDATA[<h2 id="Mybatis-PLUS默认多租户插件"><a href="#Mybatis-PLUS默认多租户插件" class="headerlink" title="Mybatis PLUS默认多租户插件"></a>Mybatis PLUS默认多租户插件</h2><h3 id="1-增加多站点处理器"><a href="#1-增加多站点处理器" class="headerlink" title="1. 增加多站点处理器"></a>1. 增加多站点处理器</h3><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SqlConstants</span> &#123;</span><br><span class="line">    List&lt;String&gt; TENANT_LINE_INNER_IGNORE_TABLES = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;()&#123;&#123;</span><br><span class="line">        add(<span class="string">&quot;xx_config&quot;</span>);</span><br><span class="line">    &#125;&#125;;</span><br><span class="line">    <span class="type">String</span> <span class="variable">TENANT_ID</span> <span class="operator">=</span> <span class="string">&quot;site_id&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> net.sf.jsqlparser.expression.Expression;</span><br><span class="line"><span class="keyword">import</span> net.sf.jsqlparser.expression.StringValue;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.handler.TenantLineHandler;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SiteFilterHandler</span> <span class="keyword">implements</span> <span class="title class_">TenantLineHandler</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Expression <span class="title function_">getTenantId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 获取站点值的处理逻辑，一般来说可以通过 通用配置变量获取，这里通过请求后鉴权拦截器赋予的上下文获取-适用于数据不隔离场景</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">StringValue</span>(RequestHolder.getRequireSite());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getTenantIdColumn</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> SqlConstants.TENANT_ID;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">ignoreTable</span><span class="params">(String tableName)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">siteId</span> <span class="operator">=</span> RequestHolder.getSite();</span><br><span class="line">        <span class="keyword">if</span> (siteId == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> SqlConstants.TENANT_LINE_INNER_IGNORE_TABLES.contains(tableName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="2-Mybatis拦截器"><a href="#2-Mybatis拦截器" class="headerlink" title="2. Mybatis拦截器"></a>2. Mybatis拦截器</h3><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableTransactionManagement</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisPlusConfig</span> &#123;</span><br><span class="line">     <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MybatisPlusInterceptor <span class="title function_">mybatisPlusInterceptor</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">MybatisPlusInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusInterceptor</span>();</span><br><span class="line">        <span class="comment">// 多站点</span></span><br><span class="line">        interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">TenantLineInnerInterceptor</span>(<span class="keyword">new</span> <span class="title class_">SiteFilterHandler</span>()));</span><br><span class="line">        <span class="keyword">return</span> interceptor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="3-TTL包装器，线程池的本地线程变量-请求上下文-继承"><a href="#3-TTL包装器，线程池的本地线程变量-请求上下文-继承" class="headerlink" title="3. TTL包装器，线程池的本地线程变量(请求上下文)继承"></a>3. TTL包装器，线程池的本地线程变量(请求上下文)继承</h3><div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>transmittable-thread-local<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.12.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></div><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RequestHolder</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> TransmittableThreadLocal&lt;RequestContext&gt; THREAD_LOCAL = <span class="keyword">new</span> <span class="title class_">TransmittableThreadLocal</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">RequestHolder</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(Object 你的内容)</span> &#123;</span><br><span class="line">        THREAD_LOCAL.set(<span class="keyword">new</span> <span class="title class_">RequestContext</span>(object));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">()</span> &#123;</span><br><span class="line">        THREAD_LOCAL.remove();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p><strong>线程池配置</strong></p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@EnableAsync</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BaseAsyncConfig</span> <span class="keyword">implements</span> <span class="title class_">AsyncConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Executor <span class="title function_">getAsyncExecutor</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ThreadPoolTaskExecutor</span> <span class="variable">executor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolTaskExecutor</span>();</span><br><span class="line">        <span class="comment">// 核心线程池数量，方法: 返回可用处理器的Java虚拟机的数量。</span></span><br><span class="line">        executor.setCorePoolSize(Runtime.getRuntime().availableProcessors());</span><br><span class="line">        <span class="comment">// 最大线程数量</span></span><br><span class="line">        executor.setMaxPoolSize(Runtime.getRuntime().availableProcessors()*<span class="number">6</span>);</span><br><span class="line">        <span class="comment">// 线程池的队列容量</span></span><br><span class="line">        <span class="comment">// 消息队列应该更大 by steven</span></span><br><span class="line">        executor.setQueueCapacity(Runtime.getRuntime().availableProcessors()*<span class="number">200</span>);</span><br><span class="line">        <span class="comment">// 线程名称的前缀</span></span><br><span class="line">        executor.setThreadNamePrefix(<span class="string">&quot;customization-center-executor-&quot;</span>);</span><br><span class="line">        <span class="comment">// setRejectedExecutionHandler：当pool已经达到max size的时候，如何处理新任务</span></span><br><span class="line">        <span class="comment">// CallerRunsPolicy：不在新线程中执行任务，而是由调用者所在的线程来执行</span></span><br><span class="line">        executor.setRejectedExecutionHandler(<span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>.CallerRunsPolicy());</span><br><span class="line">        executor.initialize();</span><br><span class="line">        <span class="comment">// ttl装饰一下 保证线程上下文的传递</span></span><br><span class="line">        <span class="keyword">return</span> TtlExecutors.getTtlExecutor(executor);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> TaskScheduler <span class="title function_">taskScheduler</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ThreadPoolTaskScheduler</span> <span class="variable">taskScheduler</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolTaskScheduler</span>();</span><br><span class="line">        taskScheduler.setPoolSize(Runtime.getRuntime().availableProcessors() *<span class="number">4</span>);</span><br><span class="line">        taskScheduler.initialize();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> taskScheduler;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 异步任务中异常处理</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 异常处理策略</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> AsyncUncaughtExceptionHandler <span class="title function_">getAsyncUncaughtExceptionHandler</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (Throwable ex, Method method, Object... params)-&gt;&#123;</span><br><span class="line">            log.error(<span class="string">&quot;线程池执行方法出现异常:&#123;&#125;,异常类型type:&#123;&#125;,定位class#method:&#123;&#125;&quot;</span>,</span><br><span class="line">                    ex.getMessage(),</span><br><span class="line">                    ex.getClass().getName(),</span><br><span class="line">                    method.getDeclaringClass().getName() + <span class="string">&quot;#&quot;</span> + method.getName());</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="4-鉴权拦截器与非鉴权白名单的站点取值方案"><a href="#4-鉴权拦截器与非鉴权白名单的站点取值方案" class="headerlink" title="4. 鉴权拦截器与非鉴权白名单的站点取值方案"></a>4. 鉴权拦截器与非鉴权白名单的站点取值方案</h3><h4 id="4-1-拦截器"><a href="#4-1-拦截器" class="headerlink" title="4.1 拦截器"></a>4.1 拦截器</h4><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IWebRequestInterceptor</span> <span class="keyword">implements</span> <span class="title class_">AsyncHandlerInterceptor</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, <span class="meta">@NotNull</span> HttpServletResponse response, <span class="meta">@NotNull</span> Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// 获取请求的目标站点 设定请求头Site标识站点，Feign三方通信时可能不存在header时通过提取参数获取</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">site</span> <span class="operator">=</span> request.getHeader(<span class="string">&quot;Site&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(site == <span class="literal">null</span>) &#123;</span><br><span class="line">         <span class="keyword">if</span> (request <span class="keyword">instanceof</span> CachedBodyHttpServletRequest wrapper) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.getStorehouseIdFromRequest(wrapper);</span><br><span class="line">        &#125;   </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> CustomizationStorageEnum <span class="title function_">getStorehouseIdFromRequest</span><span class="params">(CachedBodyHttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="comment">// 从查询参数或表单参数中获取</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">storehouseId</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;Site&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (storehouseId != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> CustomizationStorageEnum.getSiteIdByStorehouseId(customizationCenterConfigApplication, storehouseId);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">isBody</span> <span class="operator">=</span> <span class="string">&quot;POST&quot;</span>.equalsIgnoreCase(request.getMethod()) || <span class="string">&quot;PUT&quot;</span>.equalsIgnoreCase(request.getMethod()) ||</span><br><span class="line">                <span class="string">&quot;PATCH&quot;</span>.equalsIgnoreCase(request.getMethod());</span><br><span class="line">        <span class="keyword">if</span> (isBody &amp;&amp; request.getContentType() != <span class="literal">null</span> &amp;&amp; request.getContentType().contains(<span class="string">&quot;application/json&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">ServletInputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> request.getInputStream();</span><br><span class="line">                <span class="type">byte</span>[] bytes = inputStream.readAllBytes();</span><br><span class="line">                <span class="type">String</span> <span class="variable">body</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(bytes, StandardCharsets.UTF_8);</span><br><span class="line">                <span class="comment">// 存在请求内容从body参数中获取</span></span><br><span class="line">                <span class="keyword">if</span> (StringUtils.isNotBlank(body) &amp;&amp; body.startsWith(<span class="string">&quot;&#123;&quot;</span>)) &#123;</span><br><span class="line">                    Map&lt;String, Object&gt; jsonBody = JSONObject.parseObject(body, Map.class);</span><br><span class="line">                    <span class="keyword">if</span> (jsonBody != <span class="literal">null</span>) &#123;</span><br><span class="line">                        storehouseId = (String) Optional.ofNullable(jsonBody.get(<span class="string">&quot;storehouseId&quot;</span>)).orElse(jsonBody.get(<span class="string">&quot;Site&quot;</span>));</span><br><span class="line">                        <span class="keyword">if</span> (storehouseId != <span class="literal">null</span>) &#123;</span><br><span class="line">                            <span class="keyword">return</span> CustomizationStorageEnum.getSiteIdByStorehouseId(customizationCenterConfigApplication, storehouseId);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">这是一个自定义包装器，用来缓存Request的字节参数，因为Request请求的内容再被read后被清除，在controller的处理器上会丢失参数，必须在前置过滤器缓存参数，来保证持久化</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">import javax.servlet.ReadListener;</span><br><span class="line">import javax.servlet.ServletInputStream;</span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletRequestWrapper;</span><br><span class="line">import java.io.*;</span><br><span class="line">import java.util.*;</span><br><span class="line"></span><br><span class="line">public class CachedBodyHttpServletRequest extends HttpServletRequestWrapper &#123;</span><br><span class="line">    private final byte[] cachedBody;</span><br><span class="line">    private final Map&lt;String, String[]&gt; parameterMap;</span><br><span class="line"></span><br><span class="line">    public CachedBodyHttpServletRequest(HttpServletRequest request) throws IOException &#123;</span><br><span class="line">        super(request);</span><br><span class="line"></span><br><span class="line">        this.parameterMap = new HashMap&lt;&gt;(request.getParameterMap());</span><br><span class="line"></span><br><span class="line">        // 1. 读取并缓存请求体</span><br><span class="line">        InputStream requestInputStream = request.getInputStream();</span><br><span class="line">        this.cachedBody = toByteArray(requestInputStream);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private byte[] toByteArray(InputStream input) throws IOException &#123;</span><br><span class="line">        ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class="line">        byte[] buffer = new byte[1024];</span><br><span class="line">        int len;</span><br><span class="line">        while ((len = input.read(buffer)) != -1) &#123;</span><br><span class="line">            baos.write(buffer, 0, len);</span><br><span class="line">        &#125;</span><br><span class="line">        return baos.toByteArray();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public ServletInputStream getInputStream() &#123;</span><br><span class="line">        final ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(this.cachedBody);</span><br><span class="line">        return new ServletInputStream() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public boolean isFinished() &#123;</span><br><span class="line">                return byteArrayInputStream.available() == 0;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            @Override</span><br><span class="line">            public boolean isReady() &#123;</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            @Override</span><br><span class="line">            public void setReadListener(ReadListener listener) &#123;</span><br><span class="line">                // 不支持异步读取</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            @Override</span><br><span class="line">            public int read() throws IOException &#123;</span><br><span class="line">                return byteArrayInputStream.read();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public BufferedReader getReader() throws IOException &#123;</span><br><span class="line">        return new BufferedReader(new InputStreamReader(getInputStream()));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String getQueryString() &#123;</span><br><span class="line">        return super.getQueryString(); // 让 GET 请求的 QueryString 正常工作</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Map&lt;String, String[]&gt; getParameterMap() &#123;</span><br><span class="line">        return parameterMap; // 返回缓存的参数，防止 GET 参数丢失</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String[] getParameterValues(String name) &#123;</span><br><span class="line">        return parameterMap.get(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String getParameter(String name) &#123;</span><br><span class="line">        String[] values = parameterMap.get(name);</span><br><span class="line">        return (values != null &amp;&amp; values.length &gt; 0) ? values[0] : null;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p><strong>过滤器替换request缓存</strong></p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.filter.OncePerRequestFilter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RequestCachingFilter</span> <span class="keyword">extends</span> <span class="title class_">OncePerRequestFilter</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doFilterInternal</span><span class="params">(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="type">CachedBodyHttpServletRequest</span> <span class="variable">wrappedRequest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CachedBodyHttpServletRequest</span>(request);</span><br><span class="line">        filterChain.doFilter(wrappedRequest, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.cj.customization.config.interceptor.RequestCachingFilter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.web.servlet.FilterRegistrationBean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FilterConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> FilterRegistrationBean&lt;RequestCachingFilter&gt; <span class="title function_">requestCachingFilter</span><span class="params">()</span> &#123;</span><br><span class="line">        FilterRegistrationBean&lt;RequestCachingFilter&gt; registrationBean = <span class="keyword">new</span> <span class="title class_">FilterRegistrationBean</span>&lt;&gt;();</span><br><span class="line">        registrationBean.setFilter(<span class="keyword">new</span> <span class="title class_">RequestCachingFilter</span>());</span><br><span class="line">        registrationBean.addUrlPatterns(<span class="string">&quot;/*&quot;</span>);</span><br><span class="line">        registrationBean.setOrder(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> registrationBean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> spring </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android-REVIEW架构</title>
      <link href="/2025/03/12/ANDROID%E6%9E%B6%E6%9E%84%E9%87%8D%E6%9E%84%E5%8F%82%E8%80%83-REVIEW/"/>
      <url>/2025/03/12/ANDROID%E6%9E%B6%E6%9E%84%E9%87%8D%E6%9E%84%E5%8F%82%E8%80%83-REVIEW/</url>
      
        <content type="html"><![CDATA[<h2 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h2><p>改用官方提供的示意参考 <a class="link"   href="https://developer.android.com/topic/libraries/view-binding" >View Binding<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p><ol><li><p><code>build.gradle</code>文件增加引用</p><div class="code-container" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">buildFeatures <span class="punctuation">&#123;</span></span><br><span class="line">viewBinding <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div></li><li><p>现存所有视图文件根视图先添加默认忽略</p><div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xmlns:tools=&quot;http://schemas.android.com/tools&quot;</span><br><span class="line">tools:viewBindingIgnore=&quot;true&quot;</span><br></pre></td></tr></table></figure></div></li><li><p>需要采用viewBinding绑定的视图增加声明：<code>tools:context=&quot;&#123;.activity&#125;&quot;</code></p></li><li><p>Activity使用示意</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 假设视图文件名称为 activity_test,其会进行驼峰转换并增加Binding后缀</span></span><br><span class="line"><span class="keyword">private</span> ActivityTestBinding inflate;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    <span class="comment">// 一定要在setContentView前绑定</span></span><br><span class="line">    inflate = ActivityTestBinding.inflate(getLayoutInflater());</span><br><span class="line">    <span class="comment">// 绑定为绑定器根</span></span><br><span class="line">    setContentView(inflate.getRoot());</span><br><span class="line">    <span class="comment">// 直接调用元素ID即可操作对应元素</span></span><br><span class="line">    inflate.id.setText(<span class="string">&quot;xxx&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li></ol><h2 id="存储"><a href="#存储" class="headerlink" title="存储"></a>存储</h2><p>采用腾讯MMKV键值对存储框架与SharedPreferences原生存储方式进行短信息存储<br>业务功能本地数据存储采用ROOM数据库存储<br>全局用户信息存储改用<code>InheritableThreadLocal</code><br>Token存储示意：</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(Context context)</span> &#123;</span><br><span class="line">    MMKV.initialize(context);</span><br><span class="line">    AuthContext.setUser(JsonUtils.fromJson(MMKV.defaultMMKV().getString(USER, <span class="string">&quot;&#123;&#125;&quot;</span>), User.class));</span><br><span class="line">    sToken = MMKV.defaultMMKV().decodeString(KEY_TOKEN, <span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setToken</span><span class="params">(String token)</span> &#123;</span><br><span class="line">    sToken = token;</span><br><span class="line">    MMKV.defaultMMKV().putString(KEY_TOKEN, token);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">clearToken</span><span class="params">()</span> &#123;</span><br><span class="line">    sToken = <span class="literal">null</span>;</span><br><span class="line">    MMKV.defaultMMKV().remove(KEY_TOKEN);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getToken</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> sToken;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">hasToken</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> MMKV.defaultMMKV().containsKey(KEY_TOKEN) &amp;&amp;</span><br><span class="line">    MMKV.defaultMMKV().getLong(EXPIRE, <span class="number">0L</span>) &gt; System.currentTimeMillis();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><p>上衔：<a class="link"   href="http://www.oursdreams.top/article/14" >基于Okhttp3,Retrofit2,Rxjava2的Android网络请求封装<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p><ol><li><p>去除对Api接口类的订阅器调用，使用JDK动态代理再度封装</p><blockquote><p>接口订阅器好像并没有执行什么有效的工作，它只是使用Rxjava将网络响应以发布-订阅模式封装<br>它应该使用代理类替代工作，以避免每次增加&#x2F;变动 API接口时对其订阅器的重复劳动，这是“傻瓜的”</p></blockquote><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SuppressWarnings(&quot;all&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Request</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Api <span class="title function_">handler</span><span class="params">(HandlerCallback&lt;T&gt; callback)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (Api) Proxy.newProxyInstance(Api.class.getClassLoader(), <span class="keyword">new</span> <span class="title class_">Class</span>&lt;?&gt;[] &#123; Api.class &#125;,</span><br><span class="line">                (proxy1, method, args) -&gt; &#123;</span><br><span class="line">                    Observable&lt;ResponseBody&gt; observable = (Observable&lt;ResponseBody&gt;)method.invoke(BaseSubscribe.getOkHttpApi(), args);</span><br><span class="line">                    BaseSubscribe.toSubscribe(observable, callback);</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">                &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li><li><p><code>@Body</code>必须RequestBody？我需要POJO声明来”见名知意”</p><blockquote><p>对于POST请求的参数传递，Retrofit要求RequestBody，我需要对它进行一个小封装来使得不必每次都对body参数做<code>RequestBody.Companion.create</code>的重复劳动</p></blockquote><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> androidx.annotation.NonNull;</span><br><span class="line"><span class="keyword">import</span> androidx.annotation.Nullable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.xxx.xxx.util.JsonUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> okhttp3.MediaType;</span><br><span class="line"><span class="keyword">import</span> okhttp3.RequestBody;</span><br><span class="line"><span class="keyword">import</span> okio.BufferedSink;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/3/1</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RequestParamBody</span>&lt;T&gt; <span class="keyword">extends</span> <span class="title class_">RequestBody</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> RequestBody requestBody;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">RequestParamBody</span><span class="params">(T data)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.requestBody = RequestBody.Companion.create(JsonUtils.toJson(data), contentType());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; RequestParamBody&lt;T&gt; <span class="title function_">body</span><span class="params">(T body)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RequestParamBody</span>&lt;&gt;(body);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> MediaType <span class="title function_">contentType</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> MediaType.Companion.parse(<span class="string">&quot;application/json;charset=utf-8&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">writeTo</span><span class="params">(<span class="meta">@NonNull</span> BufferedSink bufferedSink)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        requestBody.writeTo(bufferedSink);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li></ol><p><strong>试验：</strong> 你的网络请求代码变得更为简洁(虽然它损失了一些性能)</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Pojo</span> <span class="variable">data</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Pojo</span>();</span><br><span class="line">Request.handler(<span class="keyword">new</span> <span class="title class_">HandlerCallback</span>&lt;Boolean&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onSuccess</span><span class="params">(Boolean result)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;).method(RequestParamBody.body(data));</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> 泛前端-Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Review </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git基础</title>
      <link href="/2025/03/12/Git/"/>
      <url>/2025/03/12/Git/</url>
      
        <content type="html"><![CDATA[<h2 id="按功能"><a href="#按功能" class="headerlink" title="按功能"></a>按功能</h2><ul><li><p>已提交的文件加入忽略目录</p><blockquote><ol><li>进入项目根目录</li><li>复制想忽略文件的项目相对路径</li><li>在项目跟目录执行<code>git rm -r &#123;path&#125;</code></li><li>.gitignore加入此相对路径</li></ol></blockquote></li><li><p>代码提交统计</p></li></ul><p>统计变动行数</p><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> --format=<span class="string">&#x27;%aN&#x27;</span> | <span class="built_in">sort</span> -u | <span class="keyword">while</span> <span class="built_in">read</span> name; <span class="keyword">do</span> <span class="built_in">echo</span> -en <span class="string">&quot;<span class="variable">$name</span>\t&quot;</span>; git <span class="built_in">log</span> --author=<span class="string">&quot;<span class="variable">$name</span>&quot;</span> --pretty=tformat:</span><br><span class="line">--numstat | awk <span class="string">&#x27;&#123; add += $1; subs += $2; loc += $1 - $2 &#125; END &#123; printf &quot;added lines: %s, removed lines: %s, total lines</span></span><br><span class="line"><span class="string">: %s\n&quot;, add, subs, loc &#125;&#x27;</span> -; <span class="keyword">done</span></span><br></pre></td></tr></table></figure></div><p>统计提交次数-前五</p><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> --pretty=<span class="string">&#x27;%aN&#x27;</span> | <span class="built_in">sort</span> | <span class="built_in">uniq</span> -c | <span class="built_in">sort</span> -k1 -n -r | <span class="built_in">head</span> -n 5</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> 工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android基础</title>
      <link href="/2025/03/12/Andorid/"/>
      <url>/2025/03/12/Andorid/</url>
      
        <content type="html"><![CDATA[<h1 id="Base"><a href="#Base" class="headerlink" title="Base"></a><strong>Base</strong></h1><blockquote><p>设计时层级，区块越少，性能越好</p></blockquote><h2 id="FLOW"><a href="#FLOW" class="headerlink" title="FLOW"></a>FLOW</h2><blockquote><p>安卓启动基于Activity运行</p><p>第一个Activity为AndroidManifest，所有Activity必须在此注册</p></blockquote><h2 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h2><h3 id="TextView"><a href="#TextView" class="headerlink" title="TextView"></a><strong>TextView</strong></h3><table><thead><tr><th>prefix</th><th>key</th><th>value</th><th>describe</th></tr></thead><tbody><tr><td>android</td><td>signleLine</td><td>true,false</td><td>是否单行显示</td></tr><tr><td></td><td>focusable</td><td>true,false</td><td>是否可以获取焦点</td></tr><tr><td></td><td>focusableInTouchMode</td><td>true,false</td><td>触摸模式下是否可以聚焦</td></tr><tr><td></td><td>ellipsize</td><td>marquee <a href="%E6%A8%AA%E5%90%91%E6%BB%9A%E5%8A%A8"></a><br />middle <a href="%E7%9C%81%E7%95%A5%E5%8F%B7%E5%9C%A8%E4%B8%AD%E9%97%B4"></a><br />end <a href="%E5%9C%A8%E6%9C%80%E5%90%8E"></a><br />start<a href="%E5%9C%A8%E5%BC%80%E5%A7%8B"></a><br />none <a href="%E6%B2%A1%E6%9C%89"></a></td><td>在哪里省略文本</td></tr><tr><td></td><td>marqueeRepeatLimit</td><td>marquee_forever<a href="%E6%97%A0%E9%99%90"></a><br/><font color=blue>{number}</font></td><td>字幕动画重复次数</td></tr><tr><td></td><td>id</td><td>@+id&#x2F; <font color=blue>{name}</font></td><td>设置ID</td></tr><tr><td></td><td>layout_width,layout_height</td><td>match_parent<a href="%E5%8C%B9%E9%85%8D%E7%88%B6%E7%BA%A7"></a><br />warp_parent<a href="%E8%87%AA%E9%80%82%E5%BA%94"></a></td><td>设置宽度，高度</td></tr><tr><td></td><td>gravity</td><td>top<a href="%E5%9C%A8%E9%A1%B6%E9%83%A8"></a><br />bottom<a href="%E5%BA%95%E9%83%A8"></a><br />left<a href="%E5%B7%A6"></a><br />right<a href="%E5%8F%B3"></a><br />center_vertical<a href="%E5%9E%82%E7%9B%B4%E5%B1%85%E4%B8%AD"></a><br />fill_vertical<a href="%E5%A2%9E%E5%A4%A7%E5%AF%B9%E8%B1%A1%E5%9E%82%E7%9B%B4%E5%A4%A7%E5%B0%8F,%E5%A1%AB%E6%BB%A1%E5%AE%B9%E5%99%A8"></a><br />center_horizontal<a href="%E6%B0%B4%E5%B9%B3%E5%B1%85%E4%B8%AD"></a><br />fill_horizontal<a href="%E5%A2%9E%E5%A4%A7%E6%B0%B4%E5%B9%B3%E5%A4%A7%E5%B0%8F,%E5%A1%AB%E6%BB%A1%E5%AE%B9%E5%99%A8"></a><br />center<a href="%E6%B0%B4%E5%B9%B3%E5%9E%82%E7%9B%B4%E5%B1%85%E4%B8%AD"></a><br />fill<a href="%E6%B0%B4%E5%B9%B3%E5%9E%82%E7%9B%B4%E5%A1%AB%E6%BB%A1%E5%AE%B9%E5%99%A8"></a><br />clip_vertical<a href="%E5%9F%BA%E4%BA%8E%E5%9E%82%E7%9B%B4%E8%A3%81%E5%89%AA%E4%BE%9D%E6%8D%AE%E5%85%B6%E5%AE%B9%E5%99%A8%E7%9A%84%E8%BE%B9%E7%95%8C,%E9%A1%B6%E9%83%A8%E5%BA%95%E9%83%A8"></a><br />clip_horizontal<a href="%E5%9F%BA%E4%BA%8E%E6%B0%B4%E5%B9%B3%E8%A3%81%E5%89%AA%E4%BE%9D%E6%8D%AE%E5%85%B6%E5%AE%B9%E5%99%A8%E7%9A%84%E8%BE%B9%E7%95%8C,%E5%B7%A6%E5%8F%B3"></a><br />start<a href="%E5%BC%80%E5%A7%8B%E5%A4%84"></a><br />end<a href="%E7%BB%93%E6%9D%9F%E5%A4%84"></a></td><td>文本对齐方式</td></tr><tr><td></td><td>shadowDx,shadowDy</td><td><font color=blue>{number}</font></td><td>阴影坐标大小</td></tr><tr><td></td><td>shadowRadius</td><td><font color=blue>{number}</font></td><td>阴影大小</td></tr><tr><td></td><td>clickable</td><td>true,false</td><td>是否允许点击</td></tr></tbody></table><h3 id="requestFocus"><a href="#requestFocus" class="headerlink" title="requestFocus"></a>requestFocus</h3><blockquote><p> 请求聚焦,一般嵌套在某个元素(例如：TextView)内部，请求到达时聚焦至此  <code> &lt;</code>requestFocus&#x2F;&gt;</p></blockquote><h3 id="Button"><a href="#Button" class="headerlink" title="Button"></a>Button</h3><table><thead><tr><th>prefix</th><th>key</th><th>value</th><th>describe</th></tr></thead><tbody><tr><td>android</td><td>background,backgroundTint,foreground</td><td>@color&#x2F;<font color=blue>{color}</font><a href="%E7%9B%B4%E6%8E%A5%E8%83%8C%E6%99%AF"></a><br />@drawable<font color=blue>{path}</font><a href="%E5%BC%95%E7%94%A8%E8%83%8C%E6%99%AF%E5%9B%BE"></a><br />@color&#x2F;<font color=blue>{path}</font><a href="%E5%BC%95%E7%94%A8%E8%83%8C%E6%99%AF"></a></td><td>背景色，浅色，前景色</td></tr></tbody></table><h3 id="EditText"><a href="#EditText" class="headerlink" title="EditText"></a>EditText</h3><table><thead><tr><th>prefix</th><th>key</th><th>value</th><th>describe</th></tr></thead><tbody><tr><td>android</td><td>hint</td><td><font color=blue>{text}</font></td><td>输入提示</td></tr><tr><td></td><td>textColorHint</td><td><font color=blue>{RGB}</font></td><td>提示文本颜色</td></tr><tr><td></td><td>inputType</td><td>none<a href="%E6%99%AE%E9%80%9A%E5%AD%97%E7%AC%A6"></a><br />text<a href="%E6%99%AE%E9%80%9A%E5%AD%97%E7%AC%A6"></a><br />textCapCharacters<a href="%E6%99%AE%E9%80%9A%E5%AD%97%E7%AC%A6"></a><br />textCapWords<a href="%E5%8D%95%E8%AF%8D%E9%A6%96%E5%AD%97%E6%AF%8D%E5%A4%A7%E5%B0%8F"></a><br />textAutoCorrect<a href="%E5%89%8D%E4%B8%A4%E4%B8%AA%E8%87%AA%E5%8A%A8%E5%AE%8C%E6%88%90"></a><br />textAutoComplete<a href="%E5%89%8D%E4%B8%A4%E4%B8%AA%E8%87%AA%E5%8A%A8%E5%AE%8C%E6%88%90"></a><br />textMultiLine<a href="%E5%A4%9A%E8%A1%8C%E8%BE%93%E5%85%A5"></a><br />textImeMultiLine<a href="%E8%BE%93%E5%85%A5%E6%B3%95%E5%A4%9A%E8%A1%8C"></a><br />textNoSuggestions<a href="%E4%B8%8D%E6%8F%90%E7%A4%BA"></a><br />textUri<a href="URI%E6%A0%BC%E5%BC%8F"></a><br />textEmailAddress<a href="%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E5%9C%B0%E5%9D%80%E6%A0%BC%E5%BC%8F"></a><br />textEmailSubject<a href="%E9%82%AE%E4%BB%B6%E4%B8%BB%E9%A2%98%E6%A0%BC%E5%BC%8F"></a><br />textShortMessage<a href="%E7%9F%AD%E6%B6%88%E6%81%AF%E6%A0%BC%E5%BC%8F"></a><br />textLongMessage<a href="%E9%95%BF%E6%B6%88%E6%81%AF%E6%A0%BC%E5%BC%8F"></a><br />textPersonName<a href="%E4%BA%BA%E5%90%8D%E6%A0%BC%E5%BC%8F"></a><br />textPostalAddress<a href="%E9%82%AE%E6%94%BF%E6%A0%BC%E5%BC%8F"></a><br />textPassword<a href="%E5%AF%86%E7%A0%81%E6%A0%BC%E5%BC%8F"></a><br />textVisiblePassword<a href="%E5%AF%86%E7%A0%81%E5%8F%AF%E8%A7%81%E6%A0%BC%E5%BC%8F"></a><br />textWebEditText<a href="%E4%BD%9C%E4%B8%BA%E7%BD%91%E9%A1%B5%E8%A1%A8%E5%8D%95%E7%9A%84%E6%96%87%E6%9C%AC%E6%A0%BC%E5%BC%8F"></a><br />textFilter<a href="%E6%96%87%E6%9C%AC%E7%AD%9B%E9%80%89%E6%A0%BC%E5%BC%8F"></a><br />textPhonetic<a href="%E6%8B%BC%E9%9F%B3%E8%BE%93%E5%85%A5%E6%A0%BC%E5%BC%8F"></a><br /><br />number<a href="%E6%95%B0%E5%AD%97%E6%A0%BC%E5%BC%8F"></a><br />numberSigned<a href="%E6%9C%89%E7%AC%A6%E5%8F%B7%E6%95%B0%E5%AD%97%E6%A0%BC%E5%BC%8F"></a><br />numberDecimal<a href="%E5%8F%AF%E4%BB%A5%E5%B8%A6%E5%B0%8F%E6%95%B0%E7%82%B9%E7%9A%84%E6%B5%AE%E7%82%B9%E6%A0%BC%E5%BC%8F"></a><br />phone<a href="%E6%8B%A8%E5%8F%B7%E9%94%AE%E7%9B%98"></a><br />datetime<a href="%E6%97%A5%E6%9C%9F+%E6%97%B6%E9%97%B4%E6%A0%BC%E5%BC%8F"></a><br />date<a href="%E6%97%A5%E6%9C%9F%E9%94%AE%E7%9B%98"></a><br />time<a href="%E6%97%B6%E9%97%B4%E6%A0%BC%E5%BC%8F"></a><br /></td><td>输入类型</td></tr><tr><td></td><td>drawable<font color=blue>{UDLR}</font></td><td>Left,Right,Top,Bottom,End,Padding,Start,Tint,TintMode<br />@drawable<font color=blue>{path}</font><a href="%E5%BC%95%E7%94%A8%E5%9B%BE"></a></td><td>在输入框的指定方位添加图片</td></tr><tr><td></td><td>drawblePadding</td><td><font color=blue>{number}</font></td><td>设置图片与输入内容的间距</td></tr><tr><td></td><td>padding<font color=blue>{UDLR}</font></td><td>Horizontal,Vertical,Left,Right,Top,Bottom,End,Padding,Start<br /><font color=blue>{number}</font></td><td>设置内容与边框的间距</td></tr></tbody></table><h3 id="ImageView"><a href="#ImageView" class="headerlink" title="ImageView"></a>ImageView</h3><table><thead><tr><th>prefix</th><th>key</th><th>value</th><th>describe</th></tr></thead><tbody><tr><td>android</td><td>src</td><td>@drawable<font color=blue>{path}</font><a href="%E5%BC%95%E7%94%A8%E5%9B%BE"></a></td><td>图片资源</td></tr><tr><td></td><td>scaleType</td><td>fitStart<a href="%E5%AE%BD%E9%AB%98%E6%AF%94%E7%BC%A9%E6%94%BE%E5%9C%A8%E5%B7%A6%E4%B8%8A%E8%A7%92"></a><br />fitCenter<a href="%E5%AE%BD%E9%AB%98%E6%AF%94%E7%BC%A9%E6%94%BE%E5%9C%A8%E4%B8%AD%E9%97%B4"></a><br />fitEnd<a href="%E5%AE%BD%E9%AB%98%E6%AF%94%E7%BC%A9%E6%94%BE%E5%9C%A8%E5%8F%B3%E4%B8%8B%E8%A7%92"></a><br />fitXY<a href="%E6%A8%AA%E7%BA%B5%E6%96%B9%E5%90%91%E7%8B%AC%E7%AB%8B%E7%BC%A9%E6%94%BE"></a><br />center<a href="%E5%8E%9F%E5%9B%BE%E5%A4%A7%E5%B0%8F%EF%BC%8C%E5%B1%85%E4%B8%AD"></a><br />centerCop<a href="%E5%AE%BD%E9%AB%98%E6%AF%94%E7%BC%A9%E6%94%BE%EF%BC%8C%E5%AE%8C%E5%85%A8%E8%A6%86%E7%9B%96ImageView"></a><br />centerInside<a href="%E5%AE%BD%E9%AB%98%E6%AF%94%E7%BC%A9%E6%94%BE%EF%BC%8C%E7%9B%B4%E8%87%B3imageView%E8%83%BD%E5%A4%9F%E5%AE%8C%E5%85%A8%E6%98%BE%E7%A4%BA%E5%9B%BE%E7%89%87"></a><br />matrix<a href="%E5%8E%9F%E5%9B%BE%E5%A4%A7%E5%B0%8F%EF%BC%8C%E8%B6%85%E5%87%BA%E8%A3%81%E5%89%AA"></a></td><td>图片缩放类型</td></tr><tr><td></td><td>maxHeight</td><td><font color=blue>{number}</font></td><td>最大高度</td></tr><tr><td></td><td>maxWidth</td><td><font color=blue>{number}</font></td><td>最大宽度</td></tr><tr><td></td><td>adjustViewBounds</td><td>true,false</td><td>调整View界限</td></tr></tbody></table><h3 id="ProgressBar"><a href="#ProgressBar" class="headerlink" title="ProgressBar"></a>ProgressBar</h3><table><thead><tr><th>prefix</th><th>key</th><th>value</th><th>describe</th></tr></thead><tbody><tr><td>android</td><td>max</td><td><font color=blue>{number}</font></td><td>进度条最大值</td></tr><tr><td></td><td>progress</td><td><font color=blue>{number}</font></td><td>进度条已完成进度值</td></tr><tr><td></td><td>indeterminate</td><td>true,false</td><td>是否精确显示进度</td></tr><tr><td>无</td><td>style</td><td>?android:attr&#x2F;progressBarStyleHorizontal<a href="%E6%B0%B4%E5%B9%B3%E8%BF%9B%E5%BA%A6%E6%9D%A1"></a></td><td>样式</td></tr></tbody></table><h3 id="Notification"><a href="#Notification" class="headerlink" title="Notification"></a>Notification</h3><p>JAVA类对象</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.oursdreams.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"><span class="keyword">import</span> androidx.core.app.NotificationCompat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.Notification;</span><br><span class="line"><span class="keyword">import</span> android.app.NotificationChannel;</span><br><span class="line"><span class="keyword">import</span> android.app.NotificationManager;</span><br><span class="line"><span class="keyword">import</span> android.app.PendingIntent;</span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.graphics.BitmapFactory;</span><br><span class="line"><span class="keyword">import</span> android.graphics.Color;</span><br><span class="line"><span class="keyword">import</span> android.os.Build;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TAG</span> <span class="operator">=</span> <span class="string">&quot;oursdreams&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> NotificationManager manager;</span><br><span class="line">    <span class="keyword">private</span> Notification notification;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        manager = (NotificationManager)getSystemService(NOTIFICATION_SERVICE); <span class="comment">//创建通知对象</span></span><br><span class="line">        <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O)&#123;<span class="comment">//判断构造器允许的版本是否大于Android版本</span></span><br><span class="line">            <span class="type">NotificationChannel</span> <span class="variable">channel</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NotificationChannel</span>(TAG,<span class="string">&quot;测试&quot;</span>, NotificationManager.IMPORTANCE_HIGH);<span class="comment">//id name 优先级</span></span><br><span class="line">            manager.createNotificationChannel(channel);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(<span class="built_in">this</span>,NotificationActivity.class);</span><br><span class="line">        <span class="type">PendingIntent</span> <span class="variable">pendingIntent</span> <span class="operator">=</span> PendingIntent.getActivity(<span class="built_in">this</span>,<span class="number">0</span>,intent,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        notification = <span class="keyword">new</span> <span class="title class_">NotificationCompat</span>.Builder(<span class="built_in">this</span>,TAG) <span class="comment">//创建构造器</span></span><br><span class="line">            .setContentTitle(<span class="string">&quot;官方通知&quot;</span>)<span class="comment">//设置标题</span></span><br><span class="line">            .setContentText(<span class="string">&quot;测试一下系统通知&quot;</span>)<span class="comment">//通知内容</span></span><br><span class="line">            .setSmallIcon(R.drawable.ic_baseline_account_balance_24)<span class="comment">//小图标</span></span><br><span class="line">            .setLargeIcon(BitmapFactory.decodeResource(getResources(),R.drawable.ic_baseline_accessibility_24))<span class="comment">//设置大图标</span></span><br><span class="line">            .setColor(Color.parseColor(<span class="string">&quot;red&quot;</span>))<span class="comment">//设置小图标颜色</span></span><br><span class="line">                .setContentIntent(pendingIntent)<span class="comment">//设置点击后的跳转意图</span></span><br><span class="line">                .setAutoCancel(<span class="literal">true</span>)<span class="comment">//点击通知后取消</span></span><br><span class="line">                .build();<span class="comment">//构建</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendNotification</span><span class="params">(View view)</span></span><br><span class="line">    &#123;</span><br><span class="line">        manager.notify(<span class="number">1</span>,notification);<span class="comment">//发起通知</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">cancelNotification</span><span class="params">(View view)</span></span><br><span class="line">    &#123;</span><br><span class="line">        manager.cancel(<span class="number">1</span>); <span class="comment">//取消通知</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="Toolbar"><a href="#Toolbar" class="headerlink" title="Toolbar"></a>Toolbar</h3><ul><li><p>取消初始Toolbar</p><blockquote><p>res&#x2F;values&#x2F;themes.xml</p><p>修改parent为”Theme.MaterialComponents.DayNight.NoActionBar”</p></blockquote></li><li><p>自定义Toolbar</p><p>androidx.appcompat.widget.Toolbar</p><table><thead><tr><th>prefix</th><th>key</th><th>value</th><th>describe</th></tr></thead><tbody><tr><td>app</td><td>navigationIcon</td><td>@drawable<font color=blue>{path}</font><a href="%E5%BC%95%E7%94%A8%E5%9B%BE"></a></td><td>导航部图标</td></tr><tr><td></td><td>title</td><td><font color=blue>{string}</font></td><td>标题</td></tr><tr><td></td><td>titleTextColor</td><td><font color=blue>{RGB}</font></td><td>标题颜色</td></tr><tr><td></td><td>titleMarginStart</td><td><font color=blue>{number}</font></td><td>标题文本边距</td></tr><tr><td></td><td>subtitle</td><td><font color=blue>{string}</font></td><td>子标题</td></tr><tr><td></td><td>subtitleTextColor</td><td><font color=blue>{RGB}</font></td><td>子标题颜色</td></tr><tr><td></td><td>logo</td><td>@mipmap<font color=blue>{path}</font><a href="%E5%BC%95%E7%94%A8%E5%9B%BE"></a></td><td>logo图</td></tr></tbody></table></li></ul><h3 id="AlertDialog"><a href="#AlertDialog" class="headerlink" title="AlertDialog"></a>AlertDialog</h3><p>Java类对象</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.oursdreams.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AlertDialog;</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.DialogInterface;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TAG</span> <span class="operator">=</span> <span class="string">&quot;oursdreams&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">View</span> <span class="variable">dialog</span> <span class="operator">=</span> getLayoutInflater().inflate(R.layout.dialog_view,<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        AlertDialog.<span class="type">Builder</span> <span class="variable">builder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AlertDialog</span>.Builder(<span class="built_in">this</span>);</span><br><span class="line">        builder.setIcon(R.mipmap.ic_launcher_round)</span><br><span class="line">                .setTitle(<span class="string">&quot;我是标题&quot;</span>)</span><br><span class="line">                .setMessage(<span class="string">&quot;内容&quot;</span>)</span><br><span class="line">                .setPositiveButton(<span class="string">&quot;确定&quot;</span>, <span class="keyword">new</span> <span class="title class_">DialogInterface</span>.OnClickListener() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(DialogInterface dialogInterface, <span class="type">int</span> i)</span> &#123;</span><br><span class="line">                        Log.e(TAG,<span class="string">&quot;点击了确定&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">                .setNegativeButton(<span class="string">&quot;取消&quot;</span>, <span class="keyword">new</span> <span class="title class_">DialogInterface</span>.OnClickListener() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(DialogInterface dialogInterface, <span class="type">int</span> i)</span> &#123;</span><br><span class="line">                        Log.e(TAG,<span class="string">&quot;取消&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">                .setNeutralButton(<span class="string">&quot;中间&quot;</span>, <span class="keyword">new</span> <span class="title class_">DialogInterface</span>.OnClickListener() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(DialogInterface dialogInterface, <span class="type">int</span> i)</span> &#123;</span><br><span class="line">                        Log.e(TAG,<span class="string">&quot;中间&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">                .setView(dialog)<span class="comment">//自定义布局</span></span><br><span class="line">                .create()</span><br><span class="line">                .show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="PopupWindow"><a href="#PopupWindow" class="headerlink" title="PopupWindow"></a>PopupWindow</h3><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.oursdreams.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.view.ViewGroup;</span><br><span class="line"><span class="keyword">import</span> android.widget.PopupWindow;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">View</span> <span class="variable">popupView</span> <span class="operator">=</span> getLayoutInflater().inflate(R.layout.popup_view,<span class="literal">null</span>);<span class="comment">//创建弹出的View对象</span></span><br><span class="line"></span><br><span class="line">        <span class="type">PopupWindow</span> <span class="variable">popupWindow</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PopupWindow</span>(popupView, ViewGroup.LayoutParams.WRAP_CONTENT,</span><br><span class="line">                ViewGroup.LayoutParams.WRAP_CONTENT,<span class="literal">true</span>);<span class="comment">//创建弹出执行对象</span></span><br><span class="line"></span><br><span class="line">        popupWindow.setBackgroundDrawable(getResources().getDrawable(R.drawable.abc_vector_test));<span class="comment">//设置弹出层背景图</span></span><br><span class="line">        popupWindow.setAnimationStyle(<span class="number">1</span>);<span class="comment">//设置加载动画</span></span><br><span class="line">        popupWindow.setTouchable(<span class="literal">true</span>);<span class="comment">//设置触摸使能</span></span><br><span class="line"></span><br><span class="line">        popupWindow.showAsDropDown(view,view.getWidth(),-view.getHeight());<span class="comment">//显示，显示的坐标</span></span><br><span class="line"></span><br><span class="line">        popupWindow.dismiss();<span class="comment">//退出弹出层</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="ViewPager"><a href="#ViewPager" class="headerlink" title="ViewPager"></a>ViewPager</h3><p>左右布局切换</p><ul><li><p>主视图XML</p><div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;com.oursdreams.viewPagerandfragment.ViewPagerActivity&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">androidx.viewpager2.widget.ViewPager2</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/viewpager&quot;</span>&gt;</span>//定义viewpager2</span><br><span class="line">    <span class="tag">&lt;/<span class="name">androidx.viewpager2.widget.ViewPager2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></div></li><li><p>activity</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ViewPager2</span> <span class="variable">viewpager</span> <span class="operator">=</span> findViewById(R.id.viewpager);</span><br><span class="line"><span class="type">ViewPagerAdapter</span> <span class="variable">viewPagerAdapter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ViewPagerAdapter</span>();</span><br><span class="line">viewpager.setAdapter(viewPagerAdapter);</span><br></pre></td></tr></table></figure></div></li><li><p>ViewPager适配器</p><blockquote><p>更改RecyclerView.ViewHolder为自定义Holder，继承实现RecyclerView.ViewHolder</p><p>getItemCount 设定pager数量,初始为0 不会加载viewpager视图</p></blockquote><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> List&lt;String&gt; titles = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"><span class="keyword">private</span> List&lt;Integer&gt; colors = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"><span class="keyword">public</span> <span class="title function_">ViewPagerAdapter</span><span class="params">()</span>&#123;</span><br><span class="line">    titles.add(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">    titles.add(<span class="string">&quot;hello1&quot;</span>);</span><br><span class="line">    titles.add(<span class="string">&quot;hello2&quot;</span>);</span><br><span class="line">    colors.add(R.color.red);</span><br><span class="line">    colors.add(R.color.white);</span><br><span class="line">    colors.add(R.color.black);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@NonNull</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> ViewPagerViewHolder <span class="title function_">onCreateViewHolder</span><span class="params">(<span class="meta">@NonNull</span> ViewGroup parent, <span class="type">int</span> viewType)</span> &#123;</span><br><span class="line">    <span class="comment">//定义viewpager视图</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ViewPagerViewHolder</span>(LayoutInflater.from(parent.getContext()).inflate(R.layout.item_pager,parent,<span class="literal">false</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onBindViewHolder</span><span class="params">(<span class="meta">@NonNull</span> ViewPagerViewHolder holder, <span class="type">int</span> position)</span> &#123;</span><br><span class="line">    <span class="comment">//翻页时的视图绑定，对现有视图进行更改(此处更改颜色与文本)</span></span><br><span class="line">    holder.mtv.setText(titles.get(position));</span><br><span class="line">    holder.container.setBackgroundResource(colors.get(position));</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getItemCount</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ViewPagerViewHolder</span> <span class="keyword">extends</span> <span class="title class_">RecyclerView</span>.ViewHolder&#123;</span><br><span class="line">    TextView mtv;</span><br><span class="line">    RelativeLayout container;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ViewPagerViewHolder</span><span class="params">(<span class="meta">@NonNull</span> View itemView)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(itemView);</span><br><span class="line">        container = itemView.findViewById(R.id.container);</span><br><span class="line">        mtv = itemView.findViewById(R.id.tvTtile);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li><li><p>ViewPager XML</p><div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/tvTtile&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_centerInParent</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">&quot;#000000&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">&quot;32dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;hello&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></div></li></ul><h2 id="Layout"><a href="#Layout" class="headerlink" title="Layout"></a>Layout</h2><h3 id="LinearLayout"><a href="#LinearLayout" class="headerlink" title="LinearLayout"></a>LinearLayout</h3><p>线性布局</p><table><thead><tr><th>prefix</th><th>key</th><th>value</th><th>describe</th></tr></thead><tbody><tr><td>android</td><td>orientation</td><td>vertical<a href="%E7%BA%B5%E5%90%91%E6%8E%92%E5%88%97"></a><br />horizontal<a href="%E6%A8%AA%E5%90%91%E6%8E%92%E5%88%97"></a></td><td>排列方式</td></tr><tr><td></td><td>divider</td><td>@drawable<font color=blue>{path}</font><a href="%E5%BC%95%E7%94%A8%E5%9B%BE"></a></td><td>分割线</td></tr><tr><td></td><td>showDividers</td><td>middle<a href="%E4%B8%AD%E9%97%B4%E7%9A%84"></a><br />none<a href="%E4%B8%8D%E6%98%BE%E7%A4%BA"></a><br />beginning<a href="%E5%BC%80%E5%A7%8B%E5%A4%84%E6%98%BE%E7%A4%BA"></a><br />end<a href="%E7%BB%93%E6%9D%9F%E5%A4%84"></a></td><td>分割线放置位置</td></tr><tr><td></td><td>dividerPadding</td><td><font color=blue>{number}</font></td><td>填充距离</td></tr><tr><td></td><td>layout_weight</td><td><font color=blue>{number}</font></td><td>权重，为剩余空间进行分配<br />受限于orientation的值<br />vertical分配高度，horizontal分配宽度</td></tr></tbody></table><h3 id="RelativeLayout"><a href="#RelativeLayout" class="headerlink" title="RelativeLayout"></a>RelativeLayout</h3><p>相对布局</p><blockquote><p>通过layout_centerInParent等设置容器的居中等…..</p><p>通过layout_toRightOf等来设置相对于兄弟容器的定位，value为目标兄弟的ID</p><p>layout_margin设置外边距等.</p></blockquote><h3 id="FrameLayout"><a href="#FrameLayout" class="headerlink" title="FrameLayout"></a>FrameLayout</h3><p>帧布局(层叠布局)</p><h3 id="TableLayout"><a href="#TableLayout" class="headerlink" title="TableLayout"></a>TableLayout</h3><p>表格布局(每个控件独占一行)</p><table><thead><tr><th>prefix</th><th>key</th><th>value</th><th>describe</th></tr></thead><tbody><tr><td>android</td><td>collapseColumns</td><td><font color=blue>{number}</font><br />多列时：0，1，2，3等</td><td>设置需要被隐藏的列的序号</td></tr><tr><td></td><td>stretchColumns</td><td></td><td>允许被拉伸的列的序号</td></tr><tr><td></td><td>shrinkColumns</td><td></td><td>允许被收缩的列的序号</td></tr></tbody></table><p>子控件属性：</p><p>layout_column:显示在第几列 layout_span:横向跨几列</p><h4 id="TableRow"><a href="#TableRow" class="headerlink" title="TableRow"></a>TableRow</h4><p>行,内部嵌套控件强制一行，超出不显示</p><h3 id="GridLayout"><a href="#GridLayout" class="headerlink" title="GridLayout"></a>GridLayout</h3><p>网格布局</p><p>也可以使用orientation来决定横纵显示</p><table><thead><tr><th>prefix</th><th>key</th><th>value</th><th>describe</th></tr></thead><tbody><tr><td>android</td><td>rowcount</td><td><font color=blue>{number}</font></td><td>每行显示几列</td></tr><tr><td></td><td>laryout_columnWeight</td><td><font color=blue>{number}</font></td><td>列权重</td></tr><tr><td></td><td>layout_gravity</td><td><font color=blue>{number}</font></td><td>在网格中的显示位置</td></tr></tbody></table><h3 id="ConstranintLayout"><a href="#ConstranintLayout" class="headerlink" title="ConstranintLayout"></a>ConstranintLayout</h3><p>约束布局</p><h3 id="ListView"><a href="#ListView" class="headerlink" title="ListView"></a>ListView</h3><p>列表布局，适用懒加载数据</p><h3 id="RecyclerView"><a href="#RecyclerView" class="headerlink" title="RecyclerView"></a>RecyclerView</h3><p>循环器视图</p><p>瀑布流显示与网格显示的区别：瀑布流会铺满屏幕，元素大小不一致会错位，网格不会</p><h2 id="Animation"><a href="#Animation" class="headerlink" title="Animation"></a>Animation</h2><h3 id="frame-by-frame"><a href="#frame-by-frame" class="headerlink" title="frame-by-frame"></a>frame-by-frame</h3><p>逐帧动画(N张图轮询播放形成每帧图片)</p><div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">animation-list</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:drawable</span>=<span class="string">&quot;@drawable/calendar_nature_01s&quot;</span> <span class="attr">android:duration</span>=<span class="string">&quot;120&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:drawable</span>=<span class="string">&quot;@drawable/calendar_nature_02s&quot;</span> <span class="attr">android:duration</span>=<span class="string">&quot;120&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:drawable</span>=<span class="string">&quot;@drawable/calendar_nature_05s&quot;</span> <span class="attr">android:duration</span>=<span class="string">&quot;120&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:drawable</span>=<span class="string">&quot;@drawable/calendar_nature_06s&quot;</span> <span class="attr">android:duration</span>=<span class="string">&quot;120&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:drawable</span>=<span class="string">&quot;@drawable/calendar_nature_08s&quot;</span> <span class="attr">android:duration</span>=<span class="string">&quot;120&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">animation-list</span>&gt;</span></span><br></pre></td></tr></table></figure></div><blockquote><p>duration 展示时间</p></blockquote><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">       <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">       setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">       <span class="type">RelativeLayout</span> <span class="variable">frame</span> <span class="operator">=</span> findViewById(R.id.frame); <span class="comment">//获取容器</span></span><br><span class="line">       <span class="type">AnimationDrawable</span> <span class="variable">anim</span> <span class="operator">=</span> (AnimationDrawable) frame.getBackground(); <span class="comment">//获取容器背景图 强转为动画对象</span></span><br><span class="line">       frame.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;<span class="comment">//容器点击事件</span></span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">               <span class="keyword">if</span> (flag)&#123;</span><br><span class="line">                   anim.start();<span class="comment">//启动动画</span></span><br><span class="line">                   flag = <span class="literal">false</span>;</span><br><span class="line">               &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                   anim.stop();<span class="comment">//关闭动画</span></span><br><span class="line">                   flag = <span class="literal">true</span>;</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></div><h3 id="tweened"><a href="#tweened" class="headerlink" title="tweened"></a>tweened</h3><p>补间动画（定义起点与终点来自动补间）</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        <span class="type">ImageView</span> <span class="variable">imageView</span> <span class="operator">=</span> findViewById(R.id.iv); <span class="comment">//动画容器</span></span><br><span class="line"></span><br><span class="line">        imageView.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;<span class="comment">//监听</span></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">                <span class="type">Animation</span> <span class="variable">anim</span> <span class="operator">=</span> AnimationUtils.loadAnimation(MainActivity.<span class="built_in">this</span>,R.anim.translate);<span class="comment">//加载动画 这里的R.anim.translate代表动画路径 R为全局加载对象 anim为自定义目录 translate为动画xml文件名</span></span><br><span class="line">                imageView.startAnimation(anim);<span class="comment">//运行动画</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div><h4 id="alpha"><a href="#alpha" class="headerlink" title="alpha"></a>alpha</h4><blockquote><p>透明度</p></blockquote><div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">alpha</span> <span class="attr">android:fromAlpha</span>=<span class="string">&quot;0&quot;</span> <span class="attr">android:toAlpha</span>=<span class="string">&quot;1&quot;</span> <span class="attr">android:duration</span>=<span class="string">&quot;2000&quot;</span>/&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure></div><h4 id="rotale"><a href="#rotale" class="headerlink" title="rotale"></a>rotale</h4><blockquote><p>旋转</p></blockquote><div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">rotate</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromDegrees</span>=<span class="string">&quot;0&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toDegrees</span>=<span class="string">&quot;360&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:pivotX</span>=<span class="string">&quot;50%&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:pivotY</span>=<span class="string">&quot;50%&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span>=<span class="string">&quot;2000&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure></div><h4 id="scale"><a href="#scale" class="headerlink" title="scale"></a>scale</h4><blockquote><p>缩放</p></blockquote><div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scale</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span>=<span class="string">&quot;2000&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromXScale</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromYScale</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toXScale</span>=<span class="string">&quot;0.5&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toYScale</span>=<span class="string">&quot;0.5&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:pivotY</span>=<span class="string">&quot;50%&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:pivotX</span>=<span class="string">&quot;50%&quot;</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure></div><h4 id="translate"><a href="#translate" class="headerlink" title="translate"></a>translate</h4><blockquote><p>移动</p></blockquote><div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">translate</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span>=<span class="string">&quot;2000&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromXDelta</span>=<span class="string">&quot;0&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromYDelta</span>=<span class="string">&quot;0&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toXDelta</span>=<span class="string">&quot;400&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toYDelta</span>=<span class="string">&quot;400&quot;</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure></div><h3 id="property"><a href="#property" class="headerlink" title="property"></a>property</h3><p>属性动画</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ValueAnimator</span> <span class="variable">valueAnimator</span> <span class="operator">=</span> ValueAnimator.ofFloat(<span class="number">0f</span>, <span class="number">1f</span>);</span><br><span class="line">       valueAnimator.setDuration(<span class="number">2000</span>);</span><br><span class="line">       valueAnimator.addUpdateListener(<span class="keyword">new</span> <span class="title class_">ValueAnimator</span>.AnimatorUpdateListener() &#123;</span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onAnimationUpdate</span><span class="params">(ValueAnimator anim)</span> &#123;</span><br><span class="line">               <span class="type">float</span> <span class="variable">animatedValue</span> <span class="operator">=</span> (<span class="type">float</span>) anim.getAnimatedValue();</span><br><span class="line">               Log.e(<span class="string">&quot;o&quot;</span>,<span class="string">&quot;val:&quot;</span>+animatedValue);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;);</span><br><span class="line">       valueAnimator.start();</span><br><span class="line"></span><br><span class="line">       <span class="type">TextView</span> <span class="variable">text</span> <span class="operator">=</span> findViewById(R.id.tv);</span><br><span class="line">       <span class="type">ObjectAnimator</span> <span class="variable">alpha</span> <span class="operator">=</span> ObjectAnimator.ofFloat(text, <span class="string">&quot;alpha&quot;</span>, <span class="number">0f</span>, <span class="number">1f</span>);<span class="comment">//此处的alpha代表执行的动作 其值为text容器所支持的所有类型的值</span></span><br><span class="line">       alpha.setDuration(<span class="number">4000</span>);</span><br><span class="line">       alpha.start();</span><br><span class="line">       alpha.addListener(<span class="keyword">new</span> <span class="title class_">Animator</span>.AnimatorListener() &#123;</span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onAnimationStart</span><span class="params">(Animator animator)</span> &#123;<span class="comment">//启动</span></span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onAnimationEnd</span><span class="params">(Animator animator)</span> &#123;<span class="comment">//结束</span></span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onAnimationCancel</span><span class="params">(Animator animator)</span> &#123;<span class="comment">//关闭</span></span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onAnimationRepeat</span><span class="params">(Animator animator)</span> &#123;<span class="comment">//重复</span></span><br><span class="line">           &#125;</span><br><span class="line">       &#125;);</span><br></pre></td></tr></table></figure></div><h2 id="Fragment"><a href="#Fragment" class="headerlink" title="Fragment"></a>Fragment</h2><p>碎片布局</p><p>Activity加载的主视图XML使用fragment通过name引入FragmentActivity</p><p>FragmentActivity继承Fragment重写onCreate，onCreateView</p><div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;.MainActivity&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">fragment</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">&quot;com.oursdreams.test.BlankFragment&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;40dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/fragment1&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">fragment</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">&quot;com.oursdreams.test.BlankFragment&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;40dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/fragment2&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></div><blockquote><p>xml中的fragment标签必须定义id，否则无法加载</p></blockquote><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> View root;</span><br><span class="line">   <span class="keyword">private</span> TextView textView;</span><br><span class="line">   <span class="keyword">private</span> Button button;</span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">       <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> View <span class="title function_">onCreateView</span><span class="params">(<span class="meta">@NonNull</span> LayoutInflater inflater, ViewGroup container,</span></span><br><span class="line"><span class="params">                            Bundle savedInstanceState)</span> &#123;</span><br><span class="line">       root = inflater.inflate(R.layout.fragment_blank,container,<span class="literal">false</span>); <span class="comment">//引入fragment视图</span></span><br><span class="line">       textView = root.findViewById(R.id.textview); <span class="comment">//对视图内组件做操作</span></span><br><span class="line">       button = root.findViewById(R.id.btn);Log.e(<span class="string">&quot;a&quot;</span>, (String) button.getText());</span><br><span class="line">       button.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">               textView.setText(<span class="string">&quot;yes,i am fine you&quot;</span>);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;);</span><br><span class="line">       <span class="keyword">return</span> root;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></div><blockquote><p>多Fragment可以复用多个fragment标签</p><p>同一Fragment可以被多个Activity引用，一个Activity也可以引用多个相同的(不同的)Fragment</p></blockquote><p><strong>动态</strong></p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">FragmentManager</span> <span class="variable">manager</span> <span class="operator">=</span> getSupportFragmentManager(); <span class="comment">//获取代理器</span></span><br><span class="line"><span class="type">FragmentTransaction</span> <span class="variable">transaction</span> <span class="operator">=</span> manager.beginTransaction();<span class="comment">//开启事务</span></span><br><span class="line">transaction.replace(R.id.fragmentLayout,fragment);<span class="comment">//替换fragment  R.id.fragmentLayout是主视图的容器  fragment是替换容器</span></span><br><span class="line">transaction.addToBackStack(<span class="literal">null</span>);<span class="comment">//回退栈设置空  如果不设置空 将会使上一视图(被替换)推入栈空间 在返回时回到上一视图</span></span><br><span class="line">transaction.commit();<span class="comment">//提交事务</span></span><br></pre></td></tr></table></figure></div><p><strong>信息传递</strong></p><p>通过Bundle对象</p><p>示例</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Activity</span></span><br><span class="line"><span class="type">Bundle</span> <span class="variable">bundle</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bundle</span>();</span><br><span class="line">bundle.putString(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;test&quot;</span>);</span><br><span class="line"><span class="type">BlankFragment2</span> <span class="variable">bf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BlankFragment2</span>();</span><br><span class="line">bf.setArguments(bundle);</span><br><span class="line">replaceFragment(bf);</span><br><span class="line"><span class="comment">//fragment</span></span><br><span class="line"><span class="type">Bundle</span> <span class="variable">bundle</span> <span class="operator">=</span> <span class="built_in">this</span>.getArguments();</span><br><span class="line"><span class="keyword">assert</span> bundle != <span class="literal">null</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> bundle.getString(<span class="string">&quot;msg&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//接口方式</span></span><br><span class="line"><span class="number">1.</span>定义接口</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IFragmentCallback</span> &#123;</span><br><span class="line">    <span class="keyword">void</span>  <span class="title function_">sendMsgToActivity</span><span class="params">(String msg)</span>;</span><br><span class="line">    String  <span class="title function_">getMsgToActivity</span><span class="params">(String msg)</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.</span>fragment创建该接口类型对象与对象赋值方法</span><br><span class="line">    <span class="keyword">private</span> IFragmentCallback fragmentCallback;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setFragmentCallback</span><span class="params">(IFragmentCallback callback)</span>&#123;</span><br><span class="line">        fragmentCallback = callback;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="number">3.</span>fragment生产消息</span><br><span class="line"><span class="keyword">private</span> View rootview;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> View <span class="title function_">onCreateView</span><span class="params">(LayoutInflater inflater, ViewGroup container,</span></span><br><span class="line"><span class="params">                             Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="comment">// Inflate the layout for this fragment</span></span><br><span class="line">        <span class="keyword">if</span> (rootview==<span class="literal">null</span>) rootview = inflater.inflate(R.layout.fragment_blank2,container,<span class="literal">false</span>);</span><br><span class="line">        <span class="type">Button</span> <span class="variable">btn</span> <span class="operator">=</span> rootview.findViewById(R.id.btn_3);</span><br><span class="line">        btn.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">                fragmentCallback.sendMsgToActivity(<span class="string">&quot;hello world&quot;</span>);<span class="comment">//向赋值对象生产消息</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> rootview;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="number">4.</span>activity消费消息</span><br><span class="line">bf.setFragmentCallback(<span class="keyword">new</span> <span class="title class_">IFragmentCallback</span>()&#123;<span class="comment">//此处的bf是fragment对象的示例</span></span><br><span class="line">     <span class="meta">@Override</span></span><br><span class="line">     <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendMsgToActivity</span><span class="params">(String msg)</span> &#123;</span><br><span class="line">                        Toast.makeText(MainActivity.<span class="built_in">this</span>,msg,Toast.LENGTH_SHORT).show();</span><br><span class="line">                        <span class="comment">//发送消息去上下文对象的视图中</span></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="keyword">public</span> String <span class="title function_">getMsgToActivity</span><span class="params">(String msg)</span> &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br></pre></td></tr></table></figure></div><p><strong>生命周期</strong></p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">onAttach();</span><br><span class="line">onCreate();</span><br><span class="line">onCreateView();</span><br><span class="line">onActivityCreated();</span><br><span class="line">onStart();</span><br><span class="line">onResume();</span><br><span class="line">onPause();</span><br><span class="line">onStop();</span><br><span class="line">onDestroyView();</span><br><span class="line">onDestroy();</span><br><span class="line">onDetach();</span><br></pre></td></tr></table></figure></div><p><strong>配合ViewPager使用</strong></p><blockquote><p>将适配器切换为继承FragmentStateAdapter的适配器即可</p></blockquote><ul><li><p>主视图xml</p><div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.viewpager2.widget.ViewPager2</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/id_viewpager&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.viewpager2.widget.ViewPager2</span>&gt;</span></span><br></pre></td></tr></table></figure></div></li><li><p>activity</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ViewPager2</span> <span class="variable">viewPager</span> <span class="operator">=</span> findViewById(R.id.id_viewpager);</span><br><span class="line">ArrayList&lt;Fragment&gt; fragments = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">fragments.add(BlankFragment.newInstance(<span class="string">&quot;微信聊天&quot;</span>));</span><br><span class="line">fragments.add(BlankFragment.newInstance(<span class="string">&quot;通讯录&quot;</span>));</span><br><span class="line"><span class="comment">//getSupportFragmentManager() 获取Fragment管理器的支持(android3.0不支持,所以要获取下支持管理器)</span></span><br><span class="line"><span class="comment">//getLifecycle() 获取提供者的声明周期 此处也就是activity的声明周期</span></span><br><span class="line"><span class="type">FragementPagerAdapter</span> <span class="variable">fa</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FragementPagerAdapter</span>(getSupportFragmentManager(), getLifecycle(), fragments);<span class="comment">//与传统viewpager设置方式一样 区别是此处的适配器切换为fragment适配器</span></span><br><span class="line">viewPager.setAdapter(fa);</span><br></pre></td></tr></table></figure></div></li><li><p>adapter</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FragementPagerAdapter</span> <span class="keyword">extends</span> <span class="title class_">FragmentStateAdapter</span> &#123;</span><br><span class="line">    List&lt;Fragment&gt; fragmentList;<span class="comment">//建立一个list来存放 fragment列表 泛型声明好</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//构造方法选择涵盖两个参数的 再自定义第三个参数来从activity传递fragment</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">FragementPagerAdapter</span><span class="params">(<span class="meta">@NonNull</span> FragmentManager fragmentManager, <span class="meta">@NonNull</span> Lifecycle lifecycle,</span></span><br><span class="line"><span class="params">                                 List&lt;Fragment&gt; fragments)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(fragmentManager, lifecycle);</span><br><span class="line">        fragmentList = fragments;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@NonNull</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Fragment <span class="title function_">createFragment</span><span class="params">(<span class="type">int</span> position)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> fragmentList.get(position);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getItemCount</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> fragmentList.size();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li><li><p>fragment</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">ARG_PARAM1</span> <span class="operator">=</span> <span class="string">&quot;param1&quot;</span>;</span><br><span class="line">  </span><br><span class="line">   <span class="keyword">private</span> String mTextString;</span><br><span class="line">  </span><br><span class="line">   <span class="keyword">public</span> <span class="title function_">BlankFragment</span><span class="params">()</span> &#123;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> BlankFragment <span class="title function_">newInstance</span><span class="params">(String param1)</span> &#123;<span class="comment">//通过此静态方法来创建示例 定义参数 也可以通过传统构造方法来创建示例</span></span><br><span class="line">       <span class="type">BlankFragment</span> <span class="variable">fragment</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BlankFragment</span>();</span><br><span class="line">       <span class="type">Bundle</span> <span class="variable">args</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bundle</span>();</span><br><span class="line">       args.putString(ARG_PARAM1, param1);</span><br><span class="line">       fragment.setArguments(args);</span><br><span class="line">       <span class="keyword">return</span> fragment;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">       <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">       <span class="keyword">if</span> (getArguments() != <span class="literal">null</span>) &#123;</span><br><span class="line">           mTextString = getArguments().getString(ARG_PARAM1);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   View rootView;</span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> View <span class="title function_">onCreateView</span><span class="params">(LayoutInflater inflater, ViewGroup container,</span></span><br><span class="line"><span class="params">                            Bundle savedInstanceState)</span> &#123;</span><br><span class="line">       <span class="keyword">if</span> (rootView==<span class="literal">null</span>)rootView = inflater.inflate(R.layout.fragment_blank3, container, <span class="literal">false</span>);</span><br><span class="line">       <span class="type">TextView</span> <span class="variable">textView</span> <span class="operator">=</span> rootView.findViewById(R.id.textaa);</span><br><span class="line">       textView.setText(mTextString);</span><br><span class="line">       <span class="keyword">return</span> rootView;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></div></li><li><p>fragment XML</p><div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">FrameLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;com.oursdreams.viewPagerandfragment.BlankFragment&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:gravity</span>=<span class="string">&quot;center&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">&quot;36sp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/textaa&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;@string/hello_blank_fragment&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></div></li></ul><h2 id="Activity"><a href="#Activity" class="headerlink" title="Activity"></a>Activity</h2><ul><li><p>跳转</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">startActivity(<span class="keyword">new</span> <span class="title class_">Intent</span>(<span class="built_in">this</span>,TwoActivity.class));<span class="comment">//转向其他Activity</span></span><br></pre></td></tr></table></figure></div></li><li><p>生命周期</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">onCreate();</span><br><span class="line">onRestart();</span><br><span class="line">onStart();</span><br><span class="line">onResume();</span><br><span class="line">onPause();</span><br><span class="line">onStop();</span><br><span class="line">onDestroy();  </span><br></pre></td></tr></table></figure></div></li></ul><h2 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h2><ul><li><p>父类</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android.app.Service</span><br></pre></td></tr></table></figure></div></li><li><p>生命周期</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//StartService</span></span><br><span class="line">onCreate();</span><br><span class="line">onStart();</span><br><span class="line">onStartCommant();</span><br><span class="line">onBind();</span><br><span class="line"></span><br><span class="line"><span class="comment">//BindService</span></span><br><span class="line">onUnbind();</span><br><span class="line">onDestroy();</span><br></pre></td></tr></table></figure></div></li><li><p>调用</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//commonService  适合云服务 长期后台挂载</span></span><br><span class="line">startService(<span class="keyword">new</span> <span class="title class_">Intent</span>(<span class="built_in">this</span>,MyService.class));<span class="comment">//启动</span></span><br><span class="line">stopService(<span class="keyword">new</span> <span class="title class_">Intent</span>(<span class="built_in">this</span>,MyService.class));<span class="comment">//停止</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//binService  适合运行时服务 activity死亡跟随死亡</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">ServiceConnection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServiceConnection</span>() &#123;</span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onServiceConnected</span><span class="params">(ComponentName componentName, IBinder iBinder)</span> &#123;<span class="comment">//开启服务</span></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onServiceDisconnected</span><span class="params">(ComponentName componentName)</span> &#123;<span class="comment">//关闭服务</span></span><br><span class="line">   &#125;</span><br><span class="line">&#125;;</span><br><span class="line">bindService(<span class="keyword">new</span> <span class="title class_">Intent</span>(<span class="built_in">this</span>,MyService.class),connection,Context.BIND_AUTO_CREATE)</span><br><span class="line">unbindService(connection);</span><br></pre></td></tr></table></figure></div></li></ul><h2 id="Receiver"><a href="#Receiver" class="headerlink" title="Receiver"></a>Receiver</h2><ul><li><p>静态广播</p><div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">//AndroidManifest注册静态广播       </span><br><span class="line"><span class="tag">&lt;<span class="name">receiver</span> <span class="attr">android:name</span>=<span class="string">&quot;.CustomerReceiver&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:exported</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;com.oursdreams.flag__&quot;</span>/&gt;</span> //接收者名 需要在发送时设定一致</span><br><span class="line">            <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">receiver</span>&gt;</span></span><br><span class="line"></span><br><span class="line">//java发送代码</span><br><span class="line">Intent intent = new Intent();</span><br><span class="line">intent.setAction(ActionUtils.ACTION_FLAG);//此处的ACTION_FLAG就是上方的接收者名 用接口常量来复用</span><br><span class="line">intent.setPackage(&quot;com.oursdreams.test&quot;);//不设置包名无法感知此广播接收者在哪个频道(BroadcastReceiver)下,包名与注册器里一致</span><br><span class="line">sendBroadcast(intent);</span><br><span class="line"></span><br><span class="line">//执行逻辑</span><br><span class="line">public class CustomerReceiver extends BroadcastReceiver &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void onReceive(Context context, Intent intent) &#123;</span><br><span class="line">        Log.e(&quot;a&quot;,&quot;OK&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">映射关系通过在静态注册的广播频道与接收者来对应</span><br></pre></td></tr></table></figure></div></li><li><p>动态发送</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//与静态基本一致，唯一区别是不在xml中注册，在JAVA里注册广播接收者</span></span><br><span class="line"><span class="type">UpdatelpSelectCity</span> <span class="variable">updateIp</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UpdatelpSelectCity</span>();<span class="comment">//创建接收者对象 继承BroadcastReceiver</span></span><br><span class="line"><span class="type">IntentFilter</span> <span class="variable">filter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IntentFilter</span>();<span class="comment">//创建过滤器 </span></span><br><span class="line">filter.addAction(ActionUtils.ACTION_EQUES_UPDATE_IP);<span class="comment">//添加核心TAG 同静态相同 此处TAG必须与发送者一致</span></span><br><span class="line">registerReceiver(updateIp,filter);  <span class="comment">//注册广播</span></span><br></pre></td></tr></table></figure></div></li></ul><h2 id="Event"><a href="#Event" class="headerlink" title="Event"></a>Event</h2><ul><li><p>事件定义在JAVA代码里</p></li><li><p>事件需要new对应的对象</p></li><li><p>事件如存在boolean返回值的说明可以链式联动事件，返回true相当于阻止事件向下冒泡</p><blockquote><p>创建对象  {返回类型}  {对象名} &#x3D; findViewById(R.id.{name})</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Button</span> <span class="variable">btn</span> <span class="operator">=</span> findViewById(R.id.btn)</span><br></pre></td></tr></table></figure></div></blockquote></li></ul><table><thead><tr><th>event</th><th>describe</th></tr></thead><tbody><tr><td>setOnClickListener</td><td>点击事件</td></tr><tr><td>setOnLongClickListener</td><td>长按事件</td></tr><tr><td>setOnTouchListener</td><td>触摸事件</td></tr></tbody></table><p><strong>增加底部固定栏</strong></p><ul><li><p>XML（Floor）</p><div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;horizontal&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;@color/gray&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;55dp&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_weight</span>=<span class="string">&quot;1&quot;</span> //<span class="attr">用权重来划分大小</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center&quot;</span> //<span class="attr">外部居中</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:gravity</span>=<span class="string">&quot;center&quot;</span> //<span class="attr">内部居中</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>//<span class="attr">垂直布局</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/id_tab_wb&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;32dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;32dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:background</span>=<span class="string">&quot;@drawable/tab_weixin&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">&quot;@+id/tab_iv_weixin&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ImageView</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;32dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">&quot;@+id/text_weixin&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:gravity</span>=<span class="string">&quot;center&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:text</span>=<span class="string">&quot;微信&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></div></li><li><p>主XML</p><div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.viewpager2.widget.ViewPager2</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_weight</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/viewpager&quot;</span>/&gt;</span>//主视图用权重来占据剩余的空间</span><br><span class="line"><span class="tag">&lt;<span class="name">include</span> <span class="attr">layout</span>=<span class="string">&quot;@layout/bottom_layout&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">include</span>&gt;</span>//引入的底部栏固定大小</span><br></pre></td></tr></table></figure></div></li><li><p>activity</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//注册ViewPage改变时的事件</span></span><br><span class="line">viewPager.registerOnPageChangeCallback(<span class="keyword">new</span> <span class="title class_">ViewPager2</span>.OnPageChangeCallback() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onPageScrolled</span><span class="params">(<span class="type">int</span> position, <span class="type">float</span> positionOffset, <span class="type">int</span> positionOffsetPixels)</span> &#123;</span><br><span class="line">                <span class="built_in">super</span>.onPageScrolled(position, positionOffset, positionOffsetPixels);</span><br><span class="line">                <span class="comment">//滚动发生时</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onPageSelected</span><span class="params">(<span class="type">int</span> position)</span> &#123;</span><br><span class="line">                <span class="built_in">super</span>.onPageSelected(position);</span><br><span class="line">                <span class="comment">//选择发生时</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onPageScrollStateChanged</span><span class="params">(<span class="type">int</span> state)</span> &#123;</span><br><span class="line">                <span class="built_in">super</span>.onPageScrollStateChanged(state);</span><br><span class="line">                <span class="comment">//选择结束时</span></span><br><span class="line">            &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//页面初始化时的默认选中</span></span><br><span class="line">chat.setSelected(<span class="literal">true</span>);<span class="comment">//chat是目标Layout</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//底栏选择时选中ViewPager子项</span></span><br><span class="line">viewPager.setCurrentItem(<span class="number">1</span>);<span class="comment">//1 是目标下标位置</span></span><br></pre></td></tr></table></figure></div></li></ul><h2 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h2><ol><li><p>跑马灯</p><div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 跑马灯 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/tv_one&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;200dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:shadowDx</span>=<span class="string">&quot;10.0&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:shadowDy</span>=<span class="string">&quot;10.0&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:shadowRadius</span>=<span class="string">&quot;3.0&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:singleLine</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:ellipsize</span>=<span class="string">&quot;marquee&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:marqueeRepeatLimit</span>=<span class="string">&quot;marquee_forever&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;@string/tv_one&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">&quot;30sp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">&quot;@color/black&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textStyle</span>=<span class="string">&quot;italic&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:focusable</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:focusableInTouchMode</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:clickable</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">requestFocus</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">TextView</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p>2.事件监听</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.oursdreams.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"><span class="keyword">import</span> android.view.MotionEvent;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TAG</span> <span class="operator">=</span> <span class="string">&quot;oursdreams&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        <span class="type">Button</span> <span class="variable">btn</span> <span class="operator">=</span> findViewById(R.id.btn);</span><br><span class="line">        btn.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">                Log.e(TAG,<span class="string">&quot;click&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        btn.setOnLongClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnLongClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onLongClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">                Log.e(TAG,<span class="string">&quot;longClick&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">//false会向下冒泡事件</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        btn.setOnTouchListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnTouchListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onTouch</span><span class="params">(View view, MotionEvent motionEvent)</span> &#123;</span><br><span class="line">                Log.e(TAG,<span class="string">&quot;touch:&quot;</span>+motionEvent.getAction());</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">//true会阻止事件冒泡</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li></ol><h2 id="Bugly"><a href="#Bugly" class="headerlink" title="Bugly"></a>Bugly</h2><blockquote><p>热更新</p></blockquote><h2 id="Glide"><a href="#Glide" class="headerlink" title="Glide"></a>Glide</h2><blockquote><p>图片处理库  GeneratedAPI 简量配置</p></blockquote><h2 id="OkHttp"><a href="#OkHttp" class="headerlink" title="OkHttp"></a>OkHttp</h2><blockquote><p>请求库</p></blockquote><blockquote><p>建立拦截器&#x2F;中间件&#x2F;过滤器等来复用某些处理<br>例如：token认证信息可以使用拦截器做前置处理<br>缓存处理 Cookie处理 </p></blockquote><h3 id="Retrofit"><a href="#Retrofit" class="headerlink" title="Retrofit"></a>Retrofit</h3><blockquote><p>对OkHttp的封装</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 泛前端-Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSS基础</title>
      <link href="/2025/03/12/CSS/"/>
      <url>/2025/03/12/CSS/</url>
      
        <content type="html"><![CDATA[<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><h3 id="文本"><a href="#文本" class="headerlink" title="文本"></a>文本</h3><blockquote><p>文本溢出替换</p></blockquote><div class="code-container" data-rel="Css"><figure class="iseeu highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">overflow</span>: hidden;</span><br><span class="line"><span class="attribute">white-space</span>: nowrap;</span><br><span class="line"><span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line"><span class="attribute">pointer-events</span>: none;</span><br></pre></td></tr></table></figure></div><h3 id="滚动"><a href="#滚动" class="headerlink" title="滚动"></a>滚动</h3><blockquote><p>元素y轴滚动但不显示滚动条</p></blockquote><div class="code-container" data-rel="Css"><figure class="iseeu highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">height</span>: <span class="number">100vh</span>;</span><br><span class="line"><span class="attribute">scrollbar-width</span>: none; <span class="comment">/* firefox */</span></span><br><span class="line">-ms-<span class="attribute">overflow</span>-style: none; <span class="comment">/* IE 10+ */</span></span><br><span class="line"><span class="attribute">overflow-x</span>: hidden;</span><br><span class="line"><span class="attribute">overflow-y</span>: auto;</span><br><span class="line">::-webkit-scrollbar &#123;</span><br><span class="line">  <span class="attribute">display</span>: none; <span class="comment">/* Chrome Safari */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="概念与API"><a href="#概念与API" class="headerlink" title="概念与API"></a>概念与API</h2><h3 id="度量单位"><a href="#度量单位" class="headerlink" title="度量单位"></a>度量单位</h3><blockquote><p>px：表示像素,相对于屏幕分辨率</p><p>in：英寸,物理度量文件,在CSS领域被直接映射成像素<code>（1in == 2.54cm == 96px）</code></p><p>cm：厘米,物理度量单位,映射成像素<code>（1cm == 37.8px）</code></p><p>mm：毫米,小数量级的物理度量单位<code>（1mm == 0.1cm == 3.78px ）</code></p><p>pt：点,物理长度单位<code>（1pt == 1/72in == 96/72px）</code></p><p>pc：派卡,物理长度单位<code>（1pc == 12pt）</code></p><p>em：相对单位,相对于当前对象内文本的字体尺寸,字体尺寸未被人设置则相对于浏览器 的默认字体尺寸</p><p>rem：和 em一样，不同的是 <code>rem</code> 总是相对于<code>根元素</code></p><p>ex：相对长度单位,此高度通常为字体尺寸的一半,字体尺寸未被人设置则相对于浏览器 的默认字体尺寸<code>当改变 </code>font-family<code> 时 em 不会改变，而 ex 单位会变化</code> </p><p>ch：ch的内涵和ex相对于x的高度相似，只是 <code>ch</code> 是基于字符 <code>0</code> 的宽度的而不是基于字符 x 高度的当 <code>font-family</code> 改变的时候 ch 也会随着改变</p><p>vw： <code>可视宽度</code> 单位（视窗宽度），<code>1vw</code> 等于可视区宽度的 <code>百分之一</code>,与百分比类似但它总相对于根元素</p><p>vh：<code>可视高度</code> 单位（视窗宽度）,同vw</p><p>vmin：vmin的值是当前vw和vh中 <code>较小</code> 的值</p><p>vmax：vmax的值是vw和vh中 <code>较大</code> 的那个值</p><p>%：百分比,基于父元素</p><p>fr：gird布局中利用的一个长度单位，例：声明三行的gird，第一行30px，第二行30px，第三行60px <code>grid-template-rows: 30px 1fr 2fr</code></p></blockquote><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><ul><li>度量单位计算</li></ul><blockquote><p>css3借助calc函数 例：<code>height: calc(100vh - 100px)</code></p></blockquote><ul><li>废弃已有属性</li></ul><div class="code-container" data-rel="Css"><figure class="iseeu highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">属性名: unset;</span><br><span class="line"># 以<span class="attribute">overflow</span>举例：<span class="attribute">overflow</span>: unset;</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> 泛前端-Css </category>
          
      </categories>
      
      
        <tags>
            
            <tag> css </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>小记线上事故-Cerbot签发故障</title>
      <link href="/2025/03/12/Cerbot%E7%AD%BE%E5%8F%91%E6%95%85%E9%9A%9C/"/>
      <url>/2025/03/12/Cerbot%E7%AD%BE%E5%8F%91%E6%95%85%E9%9A%9C/</url>
      
        <content type="html"><![CDATA[<p>起因：自动签发失效，网站提示无效协议，APP，工业设备等同步宕机无法通信</p><p>手动签发：</p><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">certbot certonly --preferred-challenges dns --manual -d *.xxx --server https://acme-v02.api.letsencrypt.org/directory</span><br></pre></td></tr></table></figure></div><p>抛出错误：</p><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">During secondary validation: Remote PerformValidation RPC failed” <span class="keyword">for</span> both production and staging at the moment</span><br></pre></td></tr></table></figure></div><p>WTF？通信失败？</p><p>以为自己DNS解析文本设置有误，修改了N次解析均Rpc failed</p><p>前往 Let’s Encrypt求助，在Help内发现已经许多反馈都是此问题，有位老哥说服务阻断了。<br>查看letencrypt服务状态：<a class="link"   href="https://letsencrypt.status.io/" >状态验证<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p><p>发现acme-v02.api.letsencrypt.org与acme-staging-v02.api.letsencrypt.org都已经中断且官方发布了修复公告。<br>凌晨1:44中断两点开始修复预机30-60m完成<br>得，倒霉，只能等待它修复，修改nginx配置发布项目补丁，临时使用普通HTTP恢复工作<br>不得不吐槽，letencrypt预期60分钟耗时600分钟才恢复<code>Operational</code></p><h3 id="注"><a href="#注" class="headerlink" title="注"></a>注</h3><p>不断尝试重新签发时一直使用正式签发地址以使IP遭受速率限制（每小时五次）</p><p>请在签发前务必使用暂存环境<code>acme-staging-v02.api.letsencrypt.org</code>来验证签发</p>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 运维 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ElementUI组件侵入式增强扩展</title>
      <link href="/2025/03/12/ElementUI%E7%BB%84%E4%BB%B6%E6%89%A9%E5%B1%95-%E5%85%A8%E9%80%89%E5%8F%8D%E9%80%89/"/>
      <url>/2025/03/12/ElementUI%E7%BB%84%E4%BB%B6%E6%89%A9%E5%B1%95-%E5%85%A8%E9%80%89%E5%8F%8D%E9%80%89/</url>
      
        <content type="html"><![CDATA[<blockquote><p>基于Vue2的$parent属性，仅ElementUI VUE2可用</p></blockquote><p><strong>注</strong>：这是一个非标做法，从设计思想上不推荐这么做，但它确实可以很好的完成工作</p><h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><p>为el-select组件增加全选&#x2F;反选 功能</p><h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><blockquote><p>自定义组件 el-option-all</p></blockquote><div class="code-container" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">el-checkbox</span> <span class="attr">v-model</span>=<span class="string">&quot;selected&quot;</span> <span class="attr">:style</span>=<span class="string">&quot;&#123; paddingLeft: &#x27;20px&#x27; &#125;&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">               <span class="attr">:indeterminate</span>=<span class="string">&quot;indeterminate&quot;</span> <span class="attr">label</span>=<span class="string">&quot;全/反选&quot;</span> @<span class="attr">change.native.stop</span>=<span class="string">&quot;select&quot;</span> /&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">name</span>: <span class="string">&#x27;ElOptionAll&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">return</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">indeterminate</span>: <span class="literal">false</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">selected</span>: <span class="literal">false</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">const</span> oldChange = <span class="variable language_">this</span>.<span class="property">$parent</span>.<span class="property">$parent</span>.<span class="property">$parent</span>.<span class="property">emitChange</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">this</span>.<span class="property">$parent</span>.<span class="property">$parent</span>.<span class="property">$parent</span>.<span class="property">emitChange</span> = <span class="function">(<span class="params">currentVal</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="title function_">oldChange</span>(currentVal)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="title function_">change</span>(currentVal)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">select</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> elSelect = <span class="variable language_">this</span>.<span class="property">$parent</span>.<span class="property">$parent</span>.<span class="property">$parent</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> selected = []</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; elSelect.<span class="property">optionsCount</span>; i++) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">if</span> (elSelect.<span class="property">selected</span>.<span class="title function_">indexOf</span>(elSelect.<span class="property">options</span>[i]) === -<span class="number">1</span>) selected.<span class="title function_">push</span>(elSelect.<span class="property">options</span>[i].<span class="property">value</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      elSelect.<span class="property">value</span>.<span class="title function_">splice</span>(<span class="number">0</span>, elSelect.<span class="property">optionsCount</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      elSelect.<span class="property">value</span>.<span class="title function_">push</span>(...selected)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">change</span>(<span class="params">currentVal</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> elSelect = <span class="variable language_">this</span>.<span class="property">$parent</span>.<span class="property">$parent</span>.<span class="property">$parent</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> selectedCount = currentVal.<span class="property">length</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">selected</span> = elSelect.<span class="property">optionsCount</span> === selectedCount</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">indeterminate</span> = !<span class="variable language_">this</span>.<span class="property">selected</span> &amp;&amp; selectedCount &gt; <span class="number">0</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure></div><blockquote><p>插槽使用-不影响任何现有组件内容</p></blockquote><div class="code-container" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> &lt;el-select multiple&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">el-option-all</span> /&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">el-option</span> /&gt;</span></span></span><br><span class="line">&lt;/el-select&gt;</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> 泛前端-Vue2 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> Element-UI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Golang基础</title>
      <link href="/2025/03/12/Go/"/>
      <url>/2025/03/12/Go/</url>
      
        <content type="html"><![CDATA[<h1 id="编译与运行"><a href="#编译与运行" class="headerlink" title="编译与运行"></a>编译与运行</h1><ul><li>Q：WINDOWS下隐藏exe可执行文件弹出的输出黑窗口</li></ul><blockquote><p>编译时增加编译参数：go build -ldflags “-H windowsgui”</p></blockquote><h1 id="基础语法"><a href="#基础语法" class="headerlink" title="基础语法"></a>基础语法</h1><p>GO中不需要有; 编译器会自动处理，如果想要一行内写多个语句可以使用;分隔</p><p>‘{‘不能单独一行，否则报错</p><p>return可以return多个值，在调用接收时必须同样使用多个变量接收 </p><p>接收变量可以使用’_’作为变量名来接收不需要使用的值</p><h2 id="变量声明"><a href="#变量声明" class="headerlink" title="变量声明"></a>变量声明</h2><p>​批量声明时如果为赋值，其会默认与上一行值一致</p><h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><p>​var 变量名 变量类型</p><p>​Go推荐使用驼峰命名，非驼峰会标记不规范命名</p><p>​被声明的变量必须被引用，否则报错</p><p>​批量声明：var (</p><p>​变量a 变量类型</p><p>​变量b 变量类型</p><p>​)</p><p>​简短声明：变量a,变量b  :&#x3D;  值a,值b</p><p>​简短声明使用:&#x3D;    批量时key的数量必须与value数量对应否则报错,value如果比key少则视为key的value都为此值，只能在函数中使用简短声明</p><p>​%s 占位符，在后面声明需要填充的值</p><p>​(“name:%s”,小蓝)   输入：name:小蓝</p><p>​匿名变量：’_’一个单独的下划线，表示忽略某个值</p><h3 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h3><p>​const 声明常量，通常定义为全局</p><p>​常量定义之后不能被修改</p><p>​iota 类似于枚举，常数每声明一个iota计数+1，iota在const中出现时其会被重置为0</p><h3 id="切片"><a href="#切片" class="headerlink" title="切片"></a>切片</h3><p>​切片初始化</p><div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s :=[] <span class="type">int</span> &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> &#125;</span><br></pre></td></tr></table></figure></div><p>初始化切片s,是数组arr的引用</p><div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s := arr[:] </span><br></pre></td></tr></table></figure></div><h4 id="len-和-cap-函数"><a href="#len-和-cap-函数" class="headerlink" title="len() 和 cap() 函数"></a>len() 和 cap() 函数</h4><p>切片是可索引的，并且可以由 len() 方法获取长度。</p><p>切片提供了计算容量的方法 cap() 可以测量切片最长可以达到多少。</p><h4 id="截取切片与截取数组赋给切片"><a href="#截取切片与截取数组赋给切片" class="headerlink" title="截取切片与截取数组赋给切片"></a>截取切片与截取数组赋给切片</h4><p>切片名[起始索引:结束索引]</p><h3 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h3><p>​两种创建方式：var|make</p><div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> 名称 <span class="keyword">map</span>[key类型]value类型 </span><br><span class="line">名称 = <span class="built_in">make</span>(<span class="keyword">map</span>[key类型]value类型)</span><br></pre></td></tr></table></figure></div><p>​删除集合中的值：</p><p>​delete(集合名,key)</p><h3 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h3><p>​转换后类型(转换值)</p><p>​var a  int &#x3D; 3 </p><p>​例：float32(a)</p><h2 id="循环-判断"><a href="#循环-判断" class="headerlink" title="循环&amp;&amp;判断"></a>循环&amp;&amp;判断</h2><p>​跳出多层for循环：</p><p>​①. 外部定义变量，内部if修改变量，外层循环if判断变量</p><p>​②.  底部定义一个标签 例如 XX:  循环中使用 goto 标签名(XX) 来跳出循环去往标签位置</p><h1 id="并发特性"><a href="#并发特性" class="headerlink" title="并发特性"></a>并发特性</h1><p>​Go出现时已有双核处理器出现，所以它天生支持并发，不需要去额外的引入类库</p><p>使用保留字 go</p><p>​go   函数名(参数)</p><h1 id="函数特性"><a href="#函数特性" class="headerlink" title="函数特性"></a>函数特性</h1><p>​匿名函数：</p><p>​未命名函数，分两种定义方式：</p><p>​①.将匿名函数赋给变量   a&#x3D;func(){return 1}</p><p>​②.结尾加一个括号表示立即执行：func(){return 1}()</p><p>​闭包：</p><p>​闭包必须是匿名函数，判断其是否为闭包依据其内部是否引用了函数外的变量</p><p>​func 函数a (){</p><p>​var 变量a 变量类型</p><p>​func (){</p><p>​return 变量a</p><p>​}</p><p>​}</p><h1 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h1><p>​go中没有try catch它使用recover，panic来处理异常</p><p>​panic定义异常，recover捕获异常</p><p>​defer声明在函数即将结束时执行</p><p>​     例：defer func(){</p><p>​错误a :&#x3D; recover()</p><p>​if 错误a !&#x3D; nil{</p><p>​&#x2F;&#x2F;抛出信息</p><p>​}</p><p>​panic(“panic用来定义产生异常”)</p><p>​} </p><h5 id="注：recover-必须搭配defer使用"><a href="#注：recover-必须搭配defer使用" class="headerlink" title="注：recover()必须搭配defer使用"></a>注：recover()必须搭配defer使用</h5><h5 id="defer一定要在可能引发pinic的语句前定义"><a href="#defer一定要在可能引发pinic的语句前定义" class="headerlink" title="defer一定要在可能引发pinic的语句前定义"></a>defer一定要在可能引发pinic的语句前定义</h5><h1 id="结构体与实例化"><a href="#结构体与实例化" class="headerlink" title="结构体与实例化"></a>结构体与实例化</h1><p>类似于java，php中的模型实体类概念</p><p>​type 类型名 struct{</p><p>​变量名  变量类型</p><p>​}</p><p>变量类型相同的变量尽量放在一起批量定义，有助于内存优化例：变量a,变量b    string</p><p>实例化：结构体定义后并不会被分配内存，需要实例化分配内存</p><p>​var 变量名 结构体类型名</p><p>​结构体内部变量赋值：变量名.结构体内变量名&#x3D;值</p><p>结构体实例化后再内存中占用的是一块连续的内存地址</p><h5 id="仅使用一次的结构体定义"><a href="#仅使用一次的结构体定义" class="headerlink" title="仅使用一次的结构体定义"></a>仅使用一次的结构体定义</h5><p>​不使用type关键字使用var：var 类型名 struct{…}</p><h5 id="指针结构体定义"><a href="#指针结构体定义" class="headerlink" title="指针结构体定义"></a>指针结构体定义</h5><p>​创建不变，实例化时new出来：var 变量名&#x3D;new(结构体类型名)</p><p>​指针结构体在赋值时要加*,例：*结构体名.内部变量名&#x3D;值;但go编译时会自动对指针结构体加上*所以直接  “结构体名.变量名” 即可</p><h5 id="键值对形式的初始化"><a href="#键值对形式的初始化" class="headerlink" title="键值对形式的初始化"></a>键值对形式的初始化</h5><p>​变量名 :&#x3D; 结构体名{</p><p>​变量a  :  值,</p><p>​变量b  :  值,</p><p>​}</p><h5 id="列表形式初始化"><a href="#列表形式初始化" class="headerlink" title="列表形式初始化"></a>列表形式初始化</h5><p>​按照结构体内顺序挨个赋值</p><p>​变量名 :&#x3D; 结构体名{</p><p>​值a,</p><p>​值b,</p><p>​}</p><h4 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h4><p>​go中没有构造函数，可以使用结构体去自定义实现构造函数</p><p>​例：func newTest结构体(参数列表也是结构体的内部列表) 返回值类型结构体名 {</p><p>​return 返回值类型结构体名 {</p><p>​参数列表也是结构体的内部列表</p><p>​}</p><p>​}</p><p>​这样的构造函数会直接实例化所占内存开销较大，使用指针结构体,*,&amp;定义</p><p>​例：func newTest结构体(参数列表也是结构体的内部列表)  *返回值类型结构体名 {</p><p>​return  &amp;返回值类型结构体名 {</p><p>​参数列表也是结构体的内部列表</p><p>​}</p><p>​}</p><h4 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h4><p>需要接收者与接收者类型，一般接收者命名为接收者类型首字母小写</p><p>例：func (p Person) 方法名(){</p><p>​&#x2F;&#x2F;业务</p><p>}</p><p>其中Person为已定义好的结构体</p><p>在需要修改结构体时必须使用指针接收者，值接收者只能copy不能修改</p><p>接收者类型可以为指针接收者(加*号)，值接收者</p><h5 id="为任意类型定义接收者"><a href="#为任意类型定义接收者" class="headerlink" title="为任意类型定义接收者"></a>为任意类型定义接收者</h5><p>​如果接收者类型为基础类型的话，需要基于内置基本类型定义一个自定义类型,接收者类型使用此类型</p><h1 id="Go中的public"><a href="#Go中的public" class="headerlink" title="Go中的public"></a>Go中的public</h1><p>​变量名与结构体中变量名在命名时如果 首字母小写表示仅本包可见，首字母大写为公开的，外部可见，函数方法也相同</p><h1 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h1><p>​序列化：data, err :&#x3D; json.Marshal(需要序列化值)</p><p>​反序列化：err &#x3D; json.Unmarshal([]byte(需要反序列化值), 成功后赋值的变量)</p><p>​在序列化与反序列化时调用结构体的内部属性时仅可调用首字母大写变量，因为首字母小写为私有变量</p><p>​解决：使用Tag定义别名</p><p>​<code>Tag</code>是结构体的元信息，可以在运行的时候通过反射的机制读取出来。 <code>Tag</code>在结构体字段的后方定义，由一对反引号包裹起来，具体的格式如下：</p><div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ID <span class="type">int</span>  <span class="string">`json:&quot;id&quot; db:&quot;id&quot; xml:&quot;id&quot;`</span></span><br></pre></td></tr></table></figure></div><p>结构体标签由一个或多个键值对组成。键与值使用冒号分隔，值用双引号括起来。键值对之间使用一个空格分隔。 <strong>注意事项：</strong> 为结构体编写<code>Tag</code>时，必须严格遵守键值对的规则。结构体标签的解析代码的容错能力很差，一旦格式写错，编译和运行时都不会提示任何错误，通过反射也无法正确取值。例如不要在key和value之间添加空格。</p><p>上述定义了tag为json，db(数据库)，xml格式的别名 定义多个使用空格间隔</p>]]></content>
      
      
      <categories>
          
          <category> 泛后端-Golang </category>
          
      </categories>
      
      
        <tags>
            
            <tag> golang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>安卓GridLayout视图均分</title>
      <link href="/2025/03/12/GridLayout%E7%9A%84%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F(%E5%AD%90%E8%A7%86%E5%9B%BE%E5%9D%87%E5%88%86)/"/>
      <url>/2025/03/12/GridLayout%E7%9A%84%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F(%E5%AD%90%E8%A7%86%E5%9B%BE%E5%9D%87%E5%88%86)/</url>
      
        <content type="html"><![CDATA[<p><strong>子视图均分</strong></p><blockquote><p>xml中的layout_rowWeight与layout_columnWeight以java代码实现</p></blockquote><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GridLayout.<span class="type">LayoutParams</span> <span class="variable">params</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GridLayout</span>.LayoutParams();</span><br><span class="line">params.columnSpec=GridLayout.spec(GridLayout.UNDEFINED, <span class="number">1f</span>);</span><br><span class="line">params.rowSpec=GridLayout.spec(GridLayout.UNDEFINED, <span class="number">1f</span>);</span><br><span class="line">view.setLayoutParams(params);</span><br></pre></td></tr></table></figure></div><p>利用Spec类，属性说明：</p><div class="code-container" data-rel="Yaml"><figure class="iseeu highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">GridLayout.UNDEFINED:</span> <span class="string">无需指定视图所处位置(第几行第几列)</span></span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      
        <tags>
            
            <tag> android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java穷举排列组合-非算法实现</title>
      <link href="/2025/03/12/JAVA%20%E7%A9%B7%E4%B8%BE%E6%95%B0%E7%BB%84%E6%89%80%E6%9C%89%E6%8E%92%E5%88%97%E5%8F%AF%E8%83%BD/"/>
      <url>/2025/03/12/JAVA%20%E7%A9%B7%E4%B8%BE%E6%95%B0%E7%BB%84%E6%89%80%E6%9C%89%E6%8E%92%E5%88%97%E5%8F%AF%E8%83%BD/</url>
      
        <content type="html"><![CDATA[<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 穷举一个字符串数组内的所有排列可能性</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> OursDreams</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExhaustiveArray</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 最大承载元素</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * 穷举过程会随着元素的增加而指数性上升,依据服务器配置来设定资源消耗的承载能力</span></span><br><span class="line"><span class="comment">     * 10 ≈ 250MB 200MS</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">MAX_BEARING</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 计算</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> arr 源数组</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> java.util.List</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;String[]&gt; toCalculate(String[] arr)&#123;</span><br><span class="line">        <span class="keyword">if</span> (arr.length &gt; MAX_BEARING)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;元素节点过多,禁止资源开销&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;String[]&gt; result = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        process(arr, <span class="number">0</span>, result);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 过程</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> arr 源数组</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index 开始节点</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> res 存储结果集</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">process</span><span class="params">(String[] arr, <span class="type">int</span> index, List&lt;String[]&gt; res)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (index == arr.length) &#123;</span><br><span class="line">            res.add(arr.clone());</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> index; j &lt; arr.length; j++) &#123;</span><br><span class="line">            swap(arr, index, j);</span><br><span class="line">            process(arr, index + <span class="number">1</span>, res);</span><br><span class="line">            swap(arr, index, j);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 交换数组元素</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> arr 源数组</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index 需要交换的目标下标I</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> j 需要交换的目标下标J</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(String[] arr, <span class="type">int</span> index, <span class="type">int</span> j)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (index == j)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">tmp</span> <span class="operator">=</span> arr[index];</span><br><span class="line">        arr[index] = arr[j];</span><br><span class="line">        arr[j] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><p><strong>注</strong></p><ul><li>前提条件为数组内元素非重,这里使用List来优化性能,如果切换元素类型为字符串且存在重复可采用 HashSet来存储结果集</li><li>hash最好提前声明预分配空间大小,而list最好不要去声明,这有助于资源开销上的优化</li><li>请限制内元素节点数量,采集计算量是以阶乘方式递增的,不加以限制资源开销会拖垮服务器</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JS基础</title>
      <link href="/2025/03/12/JS/"/>
      <url>/2025/03/12/JS/</url>
      
        <content type="html"><![CDATA[<h2 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h2><ul><li><strong>Q：VUE引入JQUERY及其插件</strong></li></ul><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> $ <span class="keyword">from</span> <span class="string">&quot;jquery&quot;</span>;<span class="comment">// 引入JQ</span></span><br><span class="line"><span class="keyword">import</span> jcanvas <span class="keyword">from</span> <span class="string">&#x27;jcanvas&#x27;</span>;<span class="comment">// 引入插件</span></span><br><span class="line"><span class="title function_">jcanvas</span>($, <span class="variable language_">window</span>);<span class="comment">// 工厂代理插件</span></span><br></pre></td></tr></table></figure></div><h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><p><strong>循环</strong></p><ul><li><p>for</p><blockquote><p>常规循环：语法:let i &#x3D; 0; i&lt;n; i++ </p></blockquote></li><li><p>forEach</p><blockquote><p>迭代器：语法: (val,index)&#x3D;&gt;{},无法使用break与return来跳出</p></blockquote></li><li><p>some</p><blockquote><p>迭代器：语法同上，return true结束,返回当前元素</p></blockquote></li><li><p>every</p><blockquote><p>迭代器：语法同上，return false结束,return true向下迭代\</p></blockquote></li></ul><p>**注：**some与eveny用法区别：</p><p>some：多用于检测数组是否存在符合条件的元素</p><ul><li>如果有一个元素满足条件，则表达式返回<em>true</em> , 剩余的元素不会再执行检测。</li><li>如果没有满足条件的元素，则返回false。</li></ul><p>veery：多用于验证数组内每一个元素节点</p><ul><li>如果数组中检测到有一个元素不满足，则整个表达式返回 <em>false</em> ，且剩余的元素不会再进行检测。</li><li>如果所有元素都满足条件，则返回 true。</li></ul><p><strong>请求</strong></p><p>ajax（Asynchronous  JavaScript  XML）：基于XMLHTTPRequest对象</p><p>axios，fetch都是对其实现的另外封装</p><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//axios</span></span><br><span class="line">axios.<span class="title function_">post</span>(<span class="string">&#x27;url&#x27;</span>,&#123;<span class="attr">key</span>:value&#125;)</span><br><span class="line">.<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">response</span>)&#123;&#125;)</span><br><span class="line">.<span class="title function_">catch</span>(<span class="keyword">function</span>(<span class="params">error</span>)&#123;&#125;);</span><br></pre></td></tr></table></figure></div><p><strong>作用域</strong></p><blockquote><p>箭头函数</p></blockquote><p>对于一些闭包采取箭头函数,来获取上下文提升作用域</p><p>自ES6起,更简短的函数并且不绑定<code>this</code></p><h2 id="技巧"><a href="#技巧" class="headerlink" title="技巧"></a>技巧</h2><blockquote><p>获取A-Z的数组</p></blockquote><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ES6</span></span><br><span class="line"><span class="keyword">let</span> arr = [...<span class="title class_">Array</span>(<span class="number">26</span>).<span class="title function_">keys</span>()].<span class="title function_">map</span>(<span class="function"><span class="params">i</span> =&gt;</span> <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(i + <span class="number">65</span>));</span><br></pre></td></tr></table></figure></div><blockquote><p>为数字补0凑字节数</p></blockquote><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ES6</span></span><br><span class="line"><span class="keyword">let</span> size = <span class="number">5</span>;<span class="comment">//size：总字节数</span></span><br><span class="line"><span class="keyword">let</span> val = <span class="number">22</span>;<span class="comment">//val：原值</span></span><br><span class="line">val = (<span class="title class_">Array</span>(size).<span class="title function_">join</span>(<span class="string">&#x27;0&#x27;</span>) + val).<span class="title function_">slice</span>(-size);<span class="comment">//00022</span></span><br></pre></td></tr></table></figure></div><blockquote><p>判断字符串最后一个字符是 [A-Z] 还是 [0-9]</p></blockquote><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;TEST01&quot;</span>;<span class="comment">//字符串</span></span><br><span class="line"><span class="keyword">let</span> lastChar = str.<span class="title function_">substr</span>(-<span class="number">1</span>,<span class="number">1</span>);<span class="comment">//取最后字符</span></span><br><span class="line"><span class="keyword">if</span> (lastChar.<span class="title function_">search</span>(<span class="regexp">/[A-Z]/g</span>)===<span class="number">0</span>)&#123;</span><br><span class="line"><span class="comment">//字符串</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (lastChar.<span class="title function_">search</span>(<span class="regexp">/[\d]/g</span>)===<span class="number">0</span>)&#123;</span><br><span class="line">    <span class="comment">//数字</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><blockquote><p>取字符串最后一组连续数字</p></blockquote><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> strTem = str.<span class="title function_">replace</span>(<span class="regexp">/[^\d]/g</span>,<span class="string">&#x27;*&#x27;</span>);<span class="comment">//替换非数字为*</span></span><br><span class="line"><span class="keyword">let</span> strArr = strTem.<span class="title function_">split</span>(<span class="string">&#x27;*&#x27;</span>);<span class="comment">//已*分割，剔除非数字</span></span><br><span class="line"><span class="keyword">let</span> val = strArr[strArr.<span class="property">length</span>-<span class="number">1</span>];<span class="comment">//取最后一组</span></span><br></pre></td></tr></table></figure></div><h2 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h2><blockquote><p>对div内元素截图</p></blockquote><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> <span class="title function_">html2canvas</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;目标元素ID&quot;</span>)).<span class="title function_">then</span>(<span class="function"><span class="params">canvas</span>=&gt;</span> &#123;</span><br><span class="line">     <span class="keyword">return</span> canvas.<span class="title function_">toDataURL</span>(<span class="string">&#x27;images/png&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div><blockquote><p>对video截图</p></blockquote><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取base64截图</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getBase64Img</span>(<span class="params"></span>)&#123;</span><br><span class="line">   <span class="keyword">let</span> canvas = $(<span class="string">&#x27;&lt;canvas&gt;&lt;/canvas&gt;&#x27;</span>);</span><br><span class="line">   <span class="keyword">let</span> video = $(<span class="string">&quot;#目标元素ID&quot;</span>).<span class="title function_">children</span>()[<span class="number">0</span>];</span><br><span class="line">   <span class="keyword">let</span> ctx = canvas[<span class="number">0</span>].<span class="title function_">getContext</span>(<span class="string">&#x27;2d&#x27;</span>);</span><br><span class="line">   <span class="keyword">let</span> w = video.<span class="property">videoWidth</span>;</span><br><span class="line">   <span class="keyword">let</span> h = video.<span class="property">videoHeight</span>;</span><br><span class="line">   canvas.<span class="title function_">attr</span>(&#123;</span><br><span class="line">      <span class="attr">width</span>: w,</span><br><span class="line">      <span class="attr">height</span>: h,</span><br><span class="line">   &#125;);</span><br><span class="line">   ctx.<span class="title function_">drawImage</span>(video, <span class="number">0</span>, <span class="number">0</span>, w, h);</span><br><span class="line">   <span class="keyword">return</span> canvas[<span class="number">0</span>].<span class="title function_">toDataURL</span>(<span class="string">&#x27;images/png&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//此处取默认帧，截取特定帧需要在video上指定帧通过setTimeout延时几十毫秒后截帧</span></span><br></pre></td></tr></table></figure></div><blockquote><p>简单字符排序</p></blockquote><p><strong>难点</strong></p><ol><li>数字 》 字母 》 中文拼音字母</li><li>大小写 》 数量 》同名优先级</li><li>不固定长度 》 效率</li></ol><p><strong>方式</strong></p><ul><li><p>比较类排序</p><blockquote><p>交换排序</p><blockquote><p>冒泡排序   快速排序</p></blockquote><p>插入排序</p><blockquote><p>简单插入排序   希尔排序</p></blockquote><p>选择排序</p><blockquote><p>简单选择排序   堆排序</p></blockquote><p>归并排序</p><blockquote><p>二路归并排序    多路归并排序</p></blockquote></blockquote></li><li><p>非比较类排序</p><blockquote><p>计数排序    桶排序     基数排序</p></blockquote></li></ul><p><strong>小论</strong></p><blockquote><p>基数排序最为简单快捷，以时间换空间方式</p></blockquote><blockquote><p>N维数组 》 基数放置 每维长度高1 》 单维抽离递归 》 直至长度为1 》同名不变动保持顺序</p><p>中文以首字母拼音当作英文字母处理 》 层级处于字母后方 》 特殊字符不考虑直接放置最后方</p><p>列出基数顺序池： 0 1 2 3 4 5 6 7 8 9 a b c d e f g h i j k l m n o p q r s t u v w x y z A B C D E F G H I J K L M N  O P Q R S T U V W X Y Z<br>              chinese: a b c d e f g h i j k l m n o p q r s t u v w x y z</p><p>special: 顺序置放</p><p>减少时间复杂度 加大空间复杂度 因每次数据一般为50-500ms 不考虑空间优化</p><p>数组一维 无限循环来增加其元素 以下标当作其维度</p><p>保证追加数组的顺序(键值对数组每次新增必定在最后一个) 获取一个中文的首字母</p><p>对中文的操作需要引入“数据字典”</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JS工具包/条码二维码/PDF</title>
      <link href="/2025/03/12/JS%E6%9D%A1%E7%A0%81,%E4%BA%8C%E7%BB%B4%E7%A0%81,%E6%88%AA%E5%9B%BE,PDF/"/>
      <url>/2025/03/12/JS%E6%9D%A1%E7%A0%81,%E4%BA%8C%E7%BB%B4%E7%A0%81,%E6%88%AA%E5%9B%BE,PDF/</url>
      
        <content type="html"><![CDATA[<h2 id="JS条码与二维码"><a href="#JS条码与二维码" class="headerlink" title="JS条码与二维码"></a>JS条码与二维码</h2><ul><li><p>引包</p><ul><li><a class="link"   href="https://github.com/lindell/JsBarcode" >JSBARCODE包<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></li><li>[QRCODE包][<a class="link"   href="https://github.com/davidshimjs/qrcodejs]" >https://github.com/davidshimjs/qrcodejs]<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></li></ul></li><li><p>JS函数</p><blockquote><p>比较傻瓜式 基础用法即可</p></blockquote><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//条码</span></span><br><span class="line"><span class="title class_">JsBarcode</span>(dom, val, &#123;</span><br><span class="line">        <span class="attr">format</span>: <span class="string">&#x27;CODE39&#x27;</span>,<span class="comment">//编码格式</span></span><br><span class="line">        <span class="attr">lineColor</span>: <span class="string">&#x27;#000&#x27;</span>,<span class="comment">//条码颜色</span></span><br><span class="line">        <span class="attr">background</span>: <span class="string">&#x27;#ffffff&#x27;</span>,<span class="comment">//背景色</span></span><br><span class="line">        <span class="attr">width</span>: width,<span class="comment">//宽</span></span><br><span class="line">        <span class="attr">height</span>: height,<span class="comment">//高</span></span><br><span class="line">        <span class="attr">displayValue</span>: isShowValue<span class="comment">//布尔值 是否在条码下显示值</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//二维码</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">QRCode</span>(dom,&#123;</span><br><span class="line">        <span class="attr">text</span>: text,<span class="comment">//值</span></span><br><span class="line">        <span class="attr">width</span>: hei*<span class="number">1.4</span>,<span class="comment">//宽</span></span><br><span class="line">        <span class="attr">height</span>: hei,<span class="comment">//高</span></span><br><span class="line">        colorDark : <span class="string">&quot;#000000&quot;</span>,<span class="comment">//颜色</span></span><br><span class="line">        colorLight : <span class="string">&quot;#ffffff&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure></div><p>一般构建有两种方式：直接在canvas上绘制 用一个canvas元素以对象方式调用方法</p><p>向指定元素节点插入绘制对象：<strong>就是上图方式，指定一个dom目标元素</strong></p><p>属性很多不一一列举</p></li></ul><h2 id="JS截图转换PDF下载"><a href="#JS截图转换PDF下载" class="headerlink" title="JS截图转换PDF下载"></a>JS截图转换PDF下载</h2><ul><li><p>引包</p><ul><li><a class="link"   href="https://jquery.com/download/" >JQUERY包<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></li><li><a class="link"   href="http://html2canvas.hertzen.com/" >CANVAS包<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></li><li><a class="link"   href="http://mrrio.github.io/" >JSPDF包<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></li></ul></li><li><p>HTML元素</p><div class="code-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--设定一块绘制区域--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span><br><span class="line">    你要放的各种东西</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></div></li><li><p>JS函数</p><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">pdfD</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 要导出pdf的节点</span></span><br><span class="line">        <span class="keyword">let</span> elements = <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;content&quot;</span>); <span class="comment">// 需要转换的页面节点</span></span><br><span class="line">        <span class="keyword">let</span> imgMap = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> index = <span class="number">0</span>; index &lt; elements.<span class="property">length</span>; index++) &#123;</span><br><span class="line">            <span class="keyword">let</span> mapIndex = index;</span><br><span class="line">            <span class="comment">//将元素绘制为canvas转换图片</span></span><br><span class="line">            <span class="title function_">html2canvas</span>(elements[index], &#123;</span><br><span class="line">                <span class="attr">useCORS</span>: <span class="literal">true</span>, <span class="comment">// 是否允许网页中img元素跨域，这个设置需要img元素支持及服务器支持</span></span><br><span class="line">                <span class="attr">scale</span>: <span class="number">2</span>, <span class="comment">// 这个影响生成图片的清晰度</span></span><br><span class="line">                <span class="attr">background</span>: <span class="string">&quot;#F5F5F5&quot;</span> <span class="comment">//背景</span></span><br><span class="line">            &#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">canvas</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">let</span> img = <span class="keyword">new</span> <span class="title class_">Image</span>();</span><br><span class="line">                img.<span class="property">width</span> = canvas.<span class="property">width</span>;</span><br><span class="line">                img.<span class="property">height</span> = canvas.<span class="property">height</span>;</span><br><span class="line">                img.<span class="property">src</span> = canvas.<span class="title function_">toDataURL</span>(<span class="string">&#x27;image/jpeg&#x27;</span>, <span class="number">1.0</span>);</span><br><span class="line">                imgMap.<span class="title function_">set</span>(mapIndex, img); <span class="comment">// 按照顺序保存图片</span></span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(imgMap.<span class="property">size</span> == elements.<span class="property">length</span>) &#123; <span class="comment">// 当所有图片都转化完毕，则进行保存操作</span></span><br><span class="line">                    <span class="keyword">let</span> pdf = <span class="keyword">new</span> <span class="title function_">jsPDF</span>(<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;pt&#x27;</span>, <span class="string">&#x27;a4&#x27;</span>);</span><br><span class="line">                    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; imgMap.<span class="property">size</span>; i++) &#123;</span><br><span class="line">                    <span class="comment">// canvas尺寸</span></span><br><span class="line">                    <span class="keyword">let</span> canvasWidth = imgMap.<span class="title function_">get</span>(i).<span class="property">width</span>;</span><br><span class="line">                    <span class="keyword">let</span> canvasHeight = imgMap.<span class="title function_">get</span>(i).<span class="property">height</span>;</span><br><span class="line">                    <span class="keyword">let</span> pageData = imgMap.<span class="title function_">get</span>(i).<span class="property">src</span>;</span><br><span class="line">                    <span class="title function_">addOneImg</span>(pdf, pageData, canvasWidth, canvasHeight);</span><br><span class="line">                    <span class="keyword">if</span>(i &lt; imgMap.<span class="property">size</span>-<span class="number">1</span>) &#123;</span><br><span class="line">                        pdf.<span class="title function_">addPage</span>(); <span class="comment">// 如果还有图片未添加到pdf,则增加一个页面</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 所有图片添加完毕，保存</span></span><br><span class="line">                pdf.<span class="title function_">save</span>(<span class="string">&quot;pdf文件.pdf&quot;</span>);</span><br><span class="line">            &#125;&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// img转化为pdf并保存</span></span><br><span class="line">    <span class="keyword">let</span> addOneImg = <span class="keyword">function</span> (<span class="params">pdf, pageData, canvasWidth, canvasHeight</span>) &#123;</span><br><span class="line">        <span class="comment">// a4纸的尺寸[595.28,841.89]</span></span><br><span class="line">        <span class="keyword">let</span> a4Width = <span class="number">595.28</span>;</span><br><span class="line">        <span class="keyword">let</span> a4Height = <span class="number">841.89</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//html页面生成的canvas在pdf中图片的宽高</span></span><br><span class="line">        <span class="keyword">let</span> imgWidth = a4Width;</span><br><span class="line">        <span class="keyword">let</span> imgHeight = a4Width / canvasWidth * canvasHeight;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//一页pdf显示html页面生成的canvas高度;</span></span><br><span class="line">        <span class="keyword">let</span> pageHeight = canvasWidth / a4Width * a4Height;</span><br><span class="line"></span><br><span class="line">        <span class="title function_">addPages</span>(pdf, pageData, <span class="number">0</span>, imgWidth, imgHeight, canvasHeight, pageHeight, a4Height);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 递归的方式对页面进行截取并添加到pdf中</span></span><br><span class="line">    <span class="keyword">let</span> addPages = <span class="keyword">function</span> (<span class="params">pdf, pageData, position, imgWidth, imgHeight, canvasHeight, pageHeight, a4Height</span>) &#123;</span><br><span class="line">        pdf.<span class="title function_">addImage</span>(pageData, <span class="string">&#x27;JPEG&#x27;</span>, <span class="number">0</span>, position, imgWidth, imgHeight)</span><br><span class="line">        <span class="comment">// 减去已经绘制的区域</span></span><br><span class="line">        canvasHeight -= pageHeight;</span><br><span class="line">        position -= a4Height;</span><br><span class="line">        <span class="comment">// 当还有内容未生成pdf，则新加页面，并添加图片</span></span><br><span class="line">        <span class="keyword">if</span> (canvasHeight &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            pdf.<span class="title function_">addPage</span>();</span><br><span class="line">            <span class="title function_">addPages</span>(pdf, pageData, position, imgWidth, imgHeight, canvasHeight, pageHeight, a4Height);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div></li><li><p>将事件绑定<code>pdfD</code>函数即可</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java地址断言与补全工具包-自实现</title>
      <link href="/2025/03/12/JAVA%20%E5%9C%B0%E5%9D%80%E6%96%AD%E8%A8%80%E6%8F%90%E5%8F%96%20%E7%9C%81%E5%B8%82%E5%8C%BA%E5%8F%8A%E5%BC%B1%E8%A1%A5%E5%85%A8/"/>
      <url>/2025/03/12/JAVA%20%E5%9C%B0%E5%9D%80%E6%96%AD%E8%A8%80%E6%8F%90%E5%8F%96%20%E7%9C%81%E5%B8%82%E5%8C%BA%E5%8F%8A%E5%BC%B1%E8%A1%A5%E5%85%A8/</url>
      
        <content type="html"><![CDATA[<p>概述</p><blockquote><p>相关地址服务都需云服务付费，仅需弱功能前提下自己建立字典来做一个简单匹配</p></blockquote><h3 id="1-实现"><a href="#1-实现" class="headerlink" title="1. 实现"></a>1. 实现</h3><h4 id="1-1-获取字典映射"><a href="#1-1-获取字典映射" class="headerlink" title="1.1 获取字典映射"></a>1.1 获取字典映射</h4><blockquote><p>以确定此处必然为三层映射关系，省→市→区，所以简单的JSON结构 三层MAP取值</p></blockquote><p>字典文件我存储在 <code>project root(项目根目录)/resources/dictionary/</code>下</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 字典文件名称</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FILE</span> <span class="operator">=</span> <span class="string">&quot;dictionary/region.json&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, Map&lt;String, Map&lt;String, String&gt;&gt;&gt; <span class="title function_">readDictionary</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">Resource</span> <span class="variable">resource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathResource</span>(FILE);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">Reader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(resource.getInputStream(), StandardCharsets.UTF_8);</span><br><span class="line">        <span class="type">int</span> ch;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">while</span> ((ch = reader.read()) != -<span class="number">1</span>) &#123;</span><br><span class="line">            sb.append((<span class="type">char</span>) ch);</span><br><span class="line">        &#125;</span><br><span class="line">        reader.close();</span><br><span class="line">        <span class="keyword">return</span> JSONObject.parseObject(sb.toString(), <span class="keyword">new</span> <span class="title class_">TypeReference</span>&lt;Map&lt;String, Map&lt;String, Map&lt;String, String&gt;&gt;&gt;&gt;()&#123;&#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RunException</span>(CodeEnum.FAIL.getCode(), e.getMessage());</span><br><span class="line">    &#125; <span class="keyword">catch</span> (JSONException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RunException</span>(CodeEnum.FAIL.getCode(), <span class="string">&quot;字典文件语法错误&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h4 id="1-2-建立实体内部类映射"><a href="#1-2-建立实体内部类映射" class="headerlink" title="1.2 建立实体内部类映射"></a>1.2 建立实体内部类映射</h4><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Region</span>&#123;</span><br><span class="line">     <span class="keyword">private</span> String province;</span><br><span class="line">     <span class="keyword">private</span> String city;</span><br><span class="line">     <span class="keyword">private</span> String district;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h4 id="1-3-建立后缀简称关键字-必须由字长-高至低"><a href="#1-3-建立后缀简称关键字-必须由字长-高至低" class="headerlink" title="1.3 建立后缀简称关键字&#x2F;必须由字长 高至低"></a>1.3 建立后缀简称关键字&#x2F;必须由字长 高至低</h4><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 区域后缀称 用其对比字典KEY获取简称</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] PROVINCE_SUFFIX = <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;</span><br><span class="line">    <span class="string">&quot;维吾尔自治区&quot;</span>,<span class="string">&quot;回族自治区&quot;</span>,<span class="string">&quot;壮族自治区&quot;</span>,<span class="string">&quot;特别行政区&quot;</span>,<span class="string">&quot;行政区&quot;</span>,<span class="string">&quot;自治区&quot;</span>,<span class="string">&quot;省&quot;</span>,<span class="string">&quot;市&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] CITY_SUFFIX = <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;</span><br><span class="line">    <span class="string">&quot;蒙古族藏族自治州&quot;</span>,<span class="string">&quot;傣族景颇族自治州&quot;</span>,<span class="string">&quot;哈尼族彝族自治州&quot;</span>,<span class="string">&quot;布依族苗族自治州&quot;</span>,<span class="string">&quot;土家族苗族自治州&quot;</span>,<span class="string">&quot;藏族羌族自治州&quot;</span>,</span><br><span class="line">    <span class="string">&quot;壮族苗族自治州&quot;</span>,<span class="string">&quot;苗族侗族自治州&quot;</span>,<span class="string">&quot;傈僳族自治州&quot;</span>,<span class="string">&quot;朝鲜族自治州&quot;</span>,<span class="string">&quot;苗族自治州&quot;</span>,<span class="string">&quot;白族自治州&quot;</span>,<span class="string">&quot;蒙古自治州&quot;</span>,</span><br><span class="line">    <span class="string">&quot;藏族自治州&quot;</span>,<span class="string">&quot;傣族自治州&quot;</span>,<span class="string">&quot;彝族自治州&quot;</span>,<span class="string">&quot;自治州&quot;</span>,<span class="string">&quot;地区&quot;</span>,<span class="string">&quot;市&quot;</span>,<span class="string">&quot;盟&quot;</span>,<span class="string">&quot;州&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 区县级地址获取不重要，所以此处并不进行严格的简称匹配，随机</span></span><br><span class="line"><span class="comment"> * 想简称完整补全此列表</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] DISTRICT_SUFFIX = <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;</span><br><span class="line">    <span class="string">&quot;市&quot;</span>,<span class="string">&quot;旗&quot;</span>,<span class="string">&quot;区&quot;</span>,<span class="string">&quot;县&quot;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div><h4 id="1-4-断言区域简称方法"><a href="#1-4-断言区域简称方法" class="headerlink" title="1.4 断言区域简称方法"></a>1.4 断言区域简称方法</h4><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取指定地域名称简称</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> name 地域名称</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> diffColl 对比集</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 简称或者原值</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">getShortName</span><span class="params">(String name, String[] diffColl)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (String suffix : diffColl) &#123;</span><br><span class="line">        <span class="keyword">if</span> (name.endsWith(suffix)) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> name.substring(<span class="number">0</span>, name.length() - suffix.length());</span><br><span class="line">            <span class="keyword">if</span> (result.isEmpty()) &#123;</span><br><span class="line">                <span class="comment">// 防止全称与简称一致返回空字符的全部正确匹配，在一致前提下返回前两位char</span></span><br><span class="line">                <span class="keyword">return</span> name.substring(<span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h4 id="1-5-匹配"><a href="#1-5-匹配" class="headerlink" title="1.5 匹配"></a>1.5 匹配</h4><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> RegionUtils.Region <span class="title function_">matching</span><span class="params">(String address)</span> &#123;</span><br><span class="line">        Map&lt;String, Map&lt;String, Map&lt;String, String&gt;&gt;&gt; dictionary = readDictionary();</span><br><span class="line">        RegionUtils.<span class="type">Region</span> <span class="variable">region</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RegionUtils</span>.Region();</span><br><span class="line">        <span class="comment">// 省份匹配</span></span><br><span class="line">        address = matchingProvince(address, dictionary, region, <span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">if</span> (region.getProvince() == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// 匹配不到 直接逆序尝试自动补充匹配</span></span><br><span class="line">            matchingDesc(address, dictionary, region, <span class="literal">false</span>);</span><br><span class="line">            <span class="keyword">return</span> region.getProvince() == <span class="literal">null</span> ? <span class="literal">null</span> : region;</span><br><span class="line">        &#125;</span><br><span class="line">        address = matchingCity(address, dictionary.get(region.getProvince()), region, <span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">if</span> (region.getCity() == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> region;</span><br><span class="line">        &#125;</span><br><span class="line">        matchingDistrict(address, dictionary.get(region.getProvince()).get(region.getCity()), region, <span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">return</span> region;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 逆序匹配/ 县区/市 任意一个在地址条目中符合即认为其归属地</span></span><br><span class="line"><span class="comment">     * 伪自动补全</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> address 地址条目</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dictionary 字典集</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> region 结果对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">matchingDesc</span><span class="params">(String address, Map&lt;String, Map&lt;String, Map&lt;String, String&gt;&gt;&gt; dictionary,</span></span><br><span class="line"><span class="params">                                 Region region, <span class="type">boolean</span> ignoreSuffix)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (Map.Entry&lt;String, Map&lt;String, Map&lt;String, String&gt;&gt;&gt; province : dictionary.entrySet()) &#123;</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, Map&lt;String, String&gt;&gt; city : province.getValue().entrySet()) &#123;</span><br><span class="line">            <span class="comment">// 如果城市匹配到了 找一下区县 跳出</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">cityKey</span> <span class="operator">=</span> city.getKey();</span><br><span class="line">            <span class="keyword">if</span> (ignoreSuffix) &#123;</span><br><span class="line">                cityKey = getShortName(cityKey, CITY_SUFFIX);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> <span class="variable">idx</span> <span class="operator">=</span> address.indexOf(cityKey);</span><br><span class="line">            <span class="keyword">if</span> (idx != -<span class="number">1</span>) &#123;</span><br><span class="line">                region.setProvince(province.getKey());</span><br><span class="line">                region.setCity(city.getKey());</span><br><span class="line">                address = address.substring(idx + cityKey.length());</span><br><span class="line">                matchingDistrict(address, city.getValue(), region, <span class="literal">false</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; district : city.getValue().entrySet()) &#123;</span><br><span class="line">                <span class="comment">// 区县匹配到了 直接结束</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">disKey</span> <span class="operator">=</span> district.getKey();</span><br><span class="line">                <span class="keyword">if</span> (ignoreSuffix) &#123;</span><br><span class="line">                    disKey = getShortName(disKey, DISTRICT_SUFFIX);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (address.contains(disKey)) &#123;</span><br><span class="line">                    region.setProvince(province.getKey());</span><br><span class="line">                    region.setCity(city.getKey());</span><br><span class="line">                    region.setDistrict(district.getKey());</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!ignoreSuffix) &#123;</span><br><span class="line">        matchingDesc(address, dictionary, region, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 匹配省份</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> address 地域</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> collection 对比集</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> region 结果对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ignoreSuffix 是否忽略后缀</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 匹配后的分割地址</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">matchingProvince</span><span class="params">(String address, Map&lt;String, Map&lt;String, Map&lt;String, String&gt;&gt;&gt; collection,</span></span><br><span class="line"><span class="params">                                       Region region, <span class="type">boolean</span> ignoreSuffix)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (Map.Entry&lt;String, Map&lt;String, Map&lt;String, String&gt;&gt;&gt; province : collection.entrySet()) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> province.getKey();</span><br><span class="line">        <span class="keyword">if</span> (ignoreSuffix) &#123;</span><br><span class="line">            key = getShortName(key, PROVINCE_SUFFIX);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">idx</span> <span class="operator">=</span> address.indexOf(key);</span><br><span class="line">        <span class="keyword">if</span> (idx != -<span class="number">1</span>) &#123;</span><br><span class="line">            region.setProvince(province.getKey());</span><br><span class="line">            <span class="comment">// 如果匹配到的是直辖市，那么不进行截断，用于兼容简写风格</span></span><br><span class="line">            <span class="keyword">if</span> (province.getKey().endsWith(<span class="string">&quot;市&quot;</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> address;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> address.substring(idx + key.length());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 全称匹配不到 递归一下简称匹配</span></span><br><span class="line">    <span class="keyword">if</span> (!ignoreSuffix) &#123;</span><br><span class="line">        matchingProvince(address, collection, region, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> address;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 匹配城市</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> address 地域</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> collection 对比集</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> region 结果对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ignoreSuffix 是否忽略后缀</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 匹配后的分割地址</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">matchingCity</span><span class="params">(String address, Map&lt;String, Map&lt;String, String&gt;&gt; collection,</span></span><br><span class="line"><span class="params">                                   Region region, <span class="type">boolean</span> ignoreSuffix)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (Map.Entry&lt;String, Map&lt;String, String&gt;&gt; city : collection.entrySet()) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> city.getKey();</span><br><span class="line">        <span class="keyword">if</span> (ignoreSuffix) &#123;</span><br><span class="line">            key = getShortName(key, CITY_SUFFIX);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">idx</span> <span class="operator">=</span> address.indexOf(key);</span><br><span class="line">        <span class="keyword">if</span> (idx != -<span class="number">1</span>) &#123;</span><br><span class="line">            region.setCity(city.getKey());</span><br><span class="line">            <span class="keyword">return</span> address.substring(idx + key.length());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 全称匹配不到 递归一下简称匹配</span></span><br><span class="line">    <span class="keyword">if</span> (!ignoreSuffix) &#123;</span><br><span class="line">        matchingCity(address, collection, region, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> address;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 匹配区/县</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> address 地域</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> collection 对比集</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> region 结果对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ignoreSuffix 是否忽略后缀</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">matchingDistrict</span><span class="params">(String address, Map&lt;String, String&gt; collection,</span></span><br><span class="line"><span class="params">                                     Region region, <span class="type">boolean</span> ignoreSuffix)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; district : collection.entrySet()) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> district.getKey();</span><br><span class="line">        <span class="keyword">if</span> (ignoreSuffix) &#123;</span><br><span class="line">            key = getShortName(key, DISTRICT_SUFFIX);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (address.contains(key)) &#123;</span><br><span class="line">            region.setDistrict(district.getKey());</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 全称匹配不到 递归一下简称匹配</span></span><br><span class="line">    <span class="keyword">if</span> (!ignoreSuffix) &#123;</span><br><span class="line">        matchingDistrict(address, collection, region, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="2-工具包全代码"><a href="#2-工具包全代码" class="headerlink" title="2. 工具包全代码"></a>2. 工具包全代码</h3><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.baoshi.common.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONException;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.TypeReference;</span><br><span class="line"><span class="keyword">import</span> com.xxx.common.eum.CodeEnum;</span><br><span class="line"><span class="keyword">import</span> com.xxx.common.exception.RunException;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.nio.charset.StandardCharsets;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 地域/区域 工具包 仅限制中国（CN）三级行政区划</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 一个简单的匹配逻辑 省份匹配(全称/简称)-&gt;城市匹配(全称/简称)-&gt;区县匹配(全称/简称)</span></span><br><span class="line"><span class="comment"> *                 ↓不存在</span></span><br><span class="line"><span class="comment"> *                 逆序尝试补全匹配(直接查全部城市/区县)，查到地址存在即认为该属地</span></span><br><span class="line"><span class="comment"> *  允许区县为空，城市不存在时直接跳出了 只记省份</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Oursdreams</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RegionUtils</span> &#123;</span><br><span class="line">    <span class="comment">// 字典文件名称</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FILE</span> <span class="operator">=</span> <span class="string">&quot;region.json&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, Map&lt;String, Map&lt;String, String&gt;&gt;&gt; <span class="title function_">readDictionary</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 拼接字符串获取字典文件 DIR</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">separator</span> <span class="operator">=</span> System.getProperty(<span class="string">&quot;file.separator&quot;</span>);</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">path</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        path.append(System.getProperty(<span class="string">&quot;user.dir&quot;</span>));</span><br><span class="line">        path.append(separator).append(<span class="string">&quot;src&quot;</span>).append(separator)</span><br><span class="line">                .append(<span class="string">&quot;main&quot;</span>).append(separator).append(<span class="string">&quot;resources&quot;</span>)</span><br><span class="line">                .append(separator).append(<span class="string">&quot;dictionary&quot;</span>).append(separator);</span><br><span class="line">        path.append(FILE);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">FileReader</span> <span class="variable">fileReader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileReader</span>(path.toString());</span><br><span class="line">            <span class="type">Reader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(path.toString()), StandardCharsets.UTF_8);</span><br><span class="line">            <span class="type">int</span> ch;</span><br><span class="line">            <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">            <span class="keyword">while</span> ((ch = reader.read()) != -<span class="number">1</span>) &#123;</span><br><span class="line">                sb.append((<span class="type">char</span>) ch);</span><br><span class="line">            &#125;</span><br><span class="line">            fileReader.close();</span><br><span class="line">            reader.close();</span><br><span class="line">            <span class="keyword">return</span> JSONObject.parseObject(sb.toString(), <span class="keyword">new</span> <span class="title class_">TypeReference</span>&lt;Map&lt;String, Map&lt;String, Map&lt;String, String&gt;&gt;&gt;&gt;()&#123;&#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RunException</span>(CodeEnum.FAIL.getCode(), e.getMessage());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (JSONException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RunException</span>(CodeEnum.FAIL.getCode(), <span class="string">&quot;字典文件语法错误&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> RegionUtils.Region <span class="title function_">matching</span><span class="params">(String address)</span> &#123;</span><br><span class="line">        Map&lt;String, Map&lt;String, Map&lt;String, String&gt;&gt;&gt; dictionary = readDictionary();</span><br><span class="line">        RegionUtils.<span class="type">Region</span> <span class="variable">region</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RegionUtils</span>.Region();</span><br><span class="line">        <span class="comment">// 省份匹配</span></span><br><span class="line">        address = matchingProvince(address, dictionary, region, <span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">if</span> (region.getProvince() == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// 匹配不到 直接逆序尝试自动补充匹配</span></span><br><span class="line">            matchingDesc(address, dictionary, region, <span class="literal">false</span>);</span><br><span class="line">            <span class="keyword">return</span> region.getProvince() == <span class="literal">null</span> ? <span class="literal">null</span> : region;</span><br><span class="line">        &#125;</span><br><span class="line">        address = matchingCity(address, dictionary.get(region.getProvince()), region, <span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">if</span> (region.getCity() == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> region;</span><br><span class="line">        &#125;</span><br><span class="line">        matchingDistrict(address, dictionary.get(region.getProvince()).get(region.getCity()), region, <span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">return</span> region;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 逆序匹配/ 县区/市 任意一个在地址条目中符合即认为其归属地</span></span><br><span class="line"><span class="comment">     * 伪自动补全</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> address 地址条目</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dictionary 字典集</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> region 结果对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">matchingDesc</span><span class="params">(String address, Map&lt;String, Map&lt;String, Map&lt;String, String&gt;&gt;&gt; dictionary,</span></span><br><span class="line"><span class="params">                                    Region region, <span class="type">boolean</span> ignoreSuffix)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, Map&lt;String, Map&lt;String, String&gt;&gt;&gt; province : dictionary.entrySet()) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Map.Entry&lt;String, Map&lt;String, String&gt;&gt; city : province.getValue().entrySet()) &#123;</span><br><span class="line">                <span class="comment">// 如果城市匹配到了 找一下区县 跳出</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">cityKey</span> <span class="operator">=</span> city.getKey();</span><br><span class="line">                <span class="keyword">if</span> (ignoreSuffix) &#123;</span><br><span class="line">                    cityKey = getShortName(cityKey, CITY_SUFFIX);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="type">int</span> <span class="variable">idx</span> <span class="operator">=</span> address.indexOf(cityKey);</span><br><span class="line">                <span class="keyword">if</span> (idx != -<span class="number">1</span>) &#123;</span><br><span class="line">                    region.setProvince(province.getKey());</span><br><span class="line">                    region.setCity(city.getKey());</span><br><span class="line">                    address = address.substring(idx + cityKey.length());</span><br><span class="line">                    matchingDistrict(address, city.getValue(), region, <span class="literal">false</span>);</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; district : city.getValue().entrySet()) &#123;</span><br><span class="line">                    <span class="comment">// 区县匹配到了 直接结束</span></span><br><span class="line">                    <span class="type">String</span> <span class="variable">disKey</span> <span class="operator">=</span> district.getKey();</span><br><span class="line">                    <span class="keyword">if</span> (ignoreSuffix) &#123;</span><br><span class="line">                        disKey = getShortName(disKey, DISTRICT_SUFFIX);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (address.contains(disKey)) &#123;</span><br><span class="line">                        region.setProvince(province.getKey());</span><br><span class="line">                        region.setCity(city.getKey());</span><br><span class="line">                        region.setDistrict(district.getKey());</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!ignoreSuffix) &#123;</span><br><span class="line">            matchingDesc(address, dictionary, region, <span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 匹配省份</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> address 地域</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> collection 对比集</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> region 结果对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ignoreSuffix 是否忽略后缀</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 匹配后的分割地址</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">matchingProvince</span><span class="params">(String address, Map&lt;String, Map&lt;String, Map&lt;String, String&gt;&gt;&gt; collection,</span></span><br><span class="line"><span class="params">                                          Region region, <span class="type">boolean</span> ignoreSuffix)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, Map&lt;String, Map&lt;String, String&gt;&gt;&gt; province : collection.entrySet()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> province.getKey();</span><br><span class="line">            <span class="keyword">if</span> (ignoreSuffix) &#123;</span><br><span class="line">                key = getShortName(key, PROVINCE_SUFFIX);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> <span class="variable">idx</span> <span class="operator">=</span> address.indexOf(key);</span><br><span class="line">            <span class="keyword">if</span> (idx != -<span class="number">1</span>) &#123;</span><br><span class="line">                region.setProvince(province.getKey());</span><br><span class="line">                <span class="comment">// 如果匹配到的是直辖市，那么不进行截断，用于兼容简写风格</span></span><br><span class="line">                <span class="keyword">if</span> (province.getKey().endsWith(<span class="string">&quot;市&quot;</span>)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> address;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> address.substring(idx + key.length());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 全称匹配不到 递归一下简称匹配</span></span><br><span class="line">        <span class="keyword">if</span> (!ignoreSuffix) &#123;</span><br><span class="line">            matchingProvince(address, collection, region, <span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 匹配城市</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> address 地域</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> collection 对比集</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> region 结果对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ignoreSuffix 是否忽略后缀</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 匹配后的分割地址</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">matchingCity</span><span class="params">(String address, Map&lt;String, Map&lt;String, String&gt;&gt; collection,</span></span><br><span class="line"><span class="params">                                      Region region, <span class="type">boolean</span> ignoreSuffix)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, Map&lt;String, String&gt;&gt; city : collection.entrySet()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> city.getKey();</span><br><span class="line">            <span class="keyword">if</span> (ignoreSuffix) &#123;</span><br><span class="line">                key = getShortName(key, CITY_SUFFIX);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> <span class="variable">idx</span> <span class="operator">=</span> address.indexOf(key);</span><br><span class="line">            <span class="keyword">if</span> (idx != -<span class="number">1</span>) &#123;</span><br><span class="line">                region.setCity(city.getKey());</span><br><span class="line">                <span class="keyword">return</span> address.substring(idx + key.length());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 全称匹配不到 递归一下简称匹配</span></span><br><span class="line">        <span class="keyword">if</span> (!ignoreSuffix) &#123;</span><br><span class="line">            matchingCity(address, collection, region, <span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 匹配区/县</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> address 地域</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> collection 对比集</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> region 结果对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ignoreSuffix 是否忽略后缀</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">matchingDistrict</span><span class="params">(String address, Map&lt;String, String&gt; collection,</span></span><br><span class="line"><span class="params">                                          Region region, <span class="type">boolean</span> ignoreSuffix)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; district : collection.entrySet()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> district.getKey();</span><br><span class="line">            <span class="keyword">if</span> (ignoreSuffix) &#123;</span><br><span class="line">                key = getShortName(key, DISTRICT_SUFFIX);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (address.contains(key)) &#123;</span><br><span class="line">                region.setDistrict(district.getKey());</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 全称匹配不到 递归一下简称匹配</span></span><br><span class="line">        <span class="keyword">if</span> (!ignoreSuffix) &#123;</span><br><span class="line">            matchingDistrict(address, collection, region, <span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取指定地域名称简称</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name 地域名称</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> diffColl 对比集</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 简称或者原值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">getShortName</span><span class="params">(String name, String[] diffColl)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (String provinceSuffix : diffColl) &#123;</span><br><span class="line">            <span class="keyword">if</span> (name.endsWith(provinceSuffix)) &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> name.substring(<span class="number">0</span>, name.length() - provinceSuffix.length());</span><br><span class="line">                <span class="keyword">if</span> (result.isEmpty()) &#123;</span><br><span class="line">                    <span class="keyword">return</span> name.substring(<span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> result;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 区域后缀称 用其对比字典KEY获取简称</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] PROVINCE_SUFFIX = <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;</span><br><span class="line">            <span class="string">&quot;维吾尔自治区&quot;</span>,<span class="string">&quot;回族自治区&quot;</span>,<span class="string">&quot;壮族自治区&quot;</span>,<span class="string">&quot;特别行政区&quot;</span>,<span class="string">&quot;行政区&quot;</span>,<span class="string">&quot;自治区&quot;</span>,<span class="string">&quot;省&quot;</span>,<span class="string">&quot;市&quot;</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] CITY_SUFFIX = <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;</span><br><span class="line">            <span class="string">&quot;蒙古族藏族自治州&quot;</span>,<span class="string">&quot;傣族景颇族自治州&quot;</span>,<span class="string">&quot;哈尼族彝族自治州&quot;</span>,<span class="string">&quot;布依族苗族自治州&quot;</span>,<span class="string">&quot;土家族苗族自治州&quot;</span>,<span class="string">&quot;藏族羌族自治州&quot;</span>,</span><br><span class="line">            <span class="string">&quot;壮族苗族自治州&quot;</span>,<span class="string">&quot;苗族侗族自治州&quot;</span>,<span class="string">&quot;傈僳族自治州&quot;</span>,<span class="string">&quot;朝鲜族自治州&quot;</span>,<span class="string">&quot;苗族自治州&quot;</span>,<span class="string">&quot;白族自治州&quot;</span>,<span class="string">&quot;蒙古自治州&quot;</span>,</span><br><span class="line">            <span class="string">&quot;藏族自治州&quot;</span>,<span class="string">&quot;傣族自治州&quot;</span>,<span class="string">&quot;彝族自治州&quot;</span>,<span class="string">&quot;自治州&quot;</span>,<span class="string">&quot;地区&quot;</span>,<span class="string">&quot;市&quot;</span>,<span class="string">&quot;盟&quot;</span>,<span class="string">&quot;州&quot;</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 区县级地址获取不重要，所以此处并不进行严格的简称匹配，随机</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] DISTRICT_SUFFIX = <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;</span><br><span class="line">            <span class="string">&quot;市&quot;</span>,<span class="string">&quot;旗&quot;</span>,<span class="string">&quot;区&quot;</span>,<span class="string">&quot;县&quot;</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="meta">@Data</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Region</span>&#123;</span><br><span class="line">        <span class="keyword">private</span> String province;</span><br><span class="line">        <span class="keyword">private</span> String city;</span><br><span class="line">        <span class="keyword">private</span> String district;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h4 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h4><ul><li>Q: 简称匹配</li></ul><blockquote><p>用户书写习惯的简写方式会忽略区域行政后缀甚至于省市前缀</p><p>EXAMPLE：</p><blockquote><p>北京市北京市辖区朝阳区→北京朝阳</p><p>上海市上海市辖区浦东新区张江镇→浦东张江</p><p>河南省郑州市中牟县→河南郑州中牟县</p></blockquote></blockquote><ul><li>Q:伪补全？</li></ul><blockquote><p>地址逆序匹配 从市区匹配第一个符合规则的即断言其属级赋正确</p><p>终止条件为：第一个符合规则的，再优化一点的做法应该是所有符合规则中全称匹配相似度最接近的</p></blockquote><h3 id="3-字典数据"><a href="#3-字典数据" class="headerlink" title="3. 字典数据"></a>3. 字典数据</h3><blockquote><p>取自某博文中的一个身份地址前缀匹配，非邮编，但因为K-V结构中的VAL对我们意义不大所以不做变更</p></blockquote><details> <summary>JSON池</summary> <pre><code>&#123;  "北京市": &#123;    "北京市": &#123;      "东城区": "110101",      "西城区": "110102",      "朝阳区": "110105",      "丰台区": "110106",      "石景山区": "110107",      "海淀区": "110108",      "门头沟区": "110109",      "房山区": "110111",      "通州区": "110112",      "顺义区": "110113",      "昌平区": "110114",      "大兴区": "110115",      "怀柔区": "110116",      "平谷区": "110117",      "密云区": "110118",      "延庆区": "110119"    &#125;  &#125;,  "天津市": &#123;    "天津市": &#123;      "和平区": "120101",      "河东区": "120102",      "河西区": "120103",      "南开区": "120104",      "河北区": "120105",      "红桥区": "120106",      "东丽区": "120110",      "西青区": "120111",      "津南区": "120112",      "北辰区": "120113",      "武清区": "120114",      "宝坻区": "120115",      "滨海新区": "120116",      "宁河区": "120117",      "静海区": "120118",      "蓟州区": "120119"    &#125;  &#125;,  "河北省": &#123;    "石家庄市": &#123;      "长安区": "130102",      "桥西区": "130104",      "新华区": "130105",      "井陉矿区": "130107",      "裕华区": "130108",      "藁城区": "130109",      "鹿泉区": "130110",      "栾城区": "130111",      "井陉县": "130121",      "正定县": "130123",      "行唐县": "130125",      "灵寿县": "130126",      "高邑县": "130127",      "深泽县": "130128",      "赞皇县": "130129",      "无极县": "130130",      "平山县": "130131",      "元氏县": "130132",      "赵县": "130133",      "辛集市": "130181",      "晋州市": "130183",      "新乐市": "130184"    &#125;,    "唐山市": &#123;      "路南区": "130202",      "路北区": "130203",      "古冶区": "130204",      "开平区": "130205",      "丰南区": "130207",      "丰润区": "130208",      "曹妃甸区": "130209",      "滦南县": "130224",      "乐亭县": "130225",      "迁西县": "130227",      "玉田县": "130229",      "遵化市": "130281",      "迁安市": "130283",      "滦州市": "130284"    &#125;,    "秦皇岛市": &#123;      "海港区": "130302",      "山海关区": "130303",      "北戴河区": "130304",      "抚宁区": "130306",      "青龙满族自治县": "130321",      "昌黎县": "130322",      "卢龙县": "130324"    &#125;,    "邯郸市": &#123;      "邯山区": "130402",      "丛台区": "130403",      "复兴区": "130404",      "峰峰矿区": "130406",      "肥乡区": "130407",      "永年区": "130408",      "临漳县": "130423",      "成安县": "130424",      "大名县": "130425",      "涉县": "130426",      "磁县": "130427",      "邱县": "130430",      "鸡泽县": "130431",      "广平县": "130432",      "馆陶县": "130433",      "魏县": "130434",      "曲周县": "130435",      "武安市": "130481"    &#125;,    "邢台市": &#123;      "襄都区": "130502",      "信都区": "130503",      "任泽区": "130505",      "南和区": "130506",      "临城县": "130522",      "内丘县": "130523",      "柏乡县": "130524",      "隆尧县": "130525",      "宁晋县": "130528",      "巨鹿县": "130529",      "新河县": "130530",      "广宗县": "130531",      "平乡县": "130532",      "威县": "130533",      "清河县": "130534",      "临西县": "130535",      "南宫市": "130581",      "沙河市": "130582"    &#125;,    "保定市": &#123;      "竞秀区": "130602",      "莲池区": "130606",      "满城区": "130607",      "清苑区": "130608",      "徐水区": "130609",      "涞水县": "130623",      "阜平县": "130624",      "定兴县": "130626",      "唐县": "130627",      "高阳县": "130628",      "容城县": "130629",      "涞源县": "130630",      "望都县": "130631",      "安新县": "130632",      "易县": "130633",      "曲阳县": "130634",      "蠡县": "130635",      "顺平县": "130636",      "博野县": "130637",      "雄县": "130638",      "涿州市": "130681",      "定州市": "130682",      "安国市": "130683",      "高碑店市": "130684"    &#125;,    "张家口市": &#123;      "桥东区": "130702",      "桥西区": "130703",      "宣化区": "130705",      "下花园区": "130706",      "万全区": "130708",      "崇礼区": "130709",      "张北县": "130722",      "康保县": "130723",      "沽源县": "130724",      "尚义县": "130725",      "蔚县": "130726",      "阳原县": "130727",      "怀安县": "130728",      "怀来县": "130730",      "涿鹿县": "130731",      "赤城县": "130732"    &#125;,    "承德市": &#123;      "双桥区": "130802",      "双滦区": "130803",      "鹰手营子矿区": "130804",      "承德县": "130821",      "兴隆县": "130822",      "滦平县": "130824",      "隆化县": "130825",      "丰宁满族自治县": "130826",      "宽城满族自治县": "130827",      "围场满族蒙古族自治县": "130828",      "平泉市": "130881"    &#125;,    "沧州市": &#123;      "新华区": "130902",      "运河区": "130903",      "沧县": "130921",      "青县": "130922",      "东光县": "130923",      "海兴县": "130924",      "盐山县": "130925",      "肃宁县": "130926",      "南皮县": "130927",      "吴桥县": "130928",      "献县": "130929",      "孟村回族自治县": "130930",      "泊头市": "130981",      "任丘市": "130982",      "黄骅市": "130983",      "河间市": "130984"    &#125;,    "廊坊市": &#123;      "安次区": "131002",      "广阳区": "131003",      "固安县": "131022",      "永清县": "131023",      "香河县": "131024",      "大城县": "131025",      "文安县": "131026",      "大厂回族自治县": "131028",      "霸州市": "131081",      "三河市": "131082"    &#125;,    "衡水市": &#123;      "桃城区": "131102",      "冀州区": "131103",      "枣强县": "131121",      "武邑县": "131122",      "武强县": "131123",      "饶阳县": "131124",      "安平县": "131125",      "故城县": "131126",      "景县": "131127",      "阜城县": "131128",      "深州市": "131182"    &#125;  &#125;,  "山西省": &#123;    "太原市": &#123;      "小店区": "140105",      "迎泽区": "140106",      "杏花岭区": "140107",      "尖草坪区": "140108",      "万柏林区": "140109",      "晋源区": "140110",      "清徐县": "140121",      "阳曲县": "140122",      "娄烦县": "140123",      "古交市": "140181"    &#125;,    "大同市": &#123;      "新荣区": "140212",      "平城区": "140213",      "云冈区": "140214",      "云州区": "140215",      "阳高县": "140221",      "天镇县": "140222",      "广灵县": "140223",      "灵丘县": "140224",      "浑源县": "140225",      "左云县": "140226"    &#125;,    "阳泉市": &#123;      "城区": "140302",      "矿区": "140303",      "郊区": "140311",      "平定县": "140321",      "盂县": "140322"    &#125;,    "长治市": &#123;      "潞州区": "140403",      "上党区": "140404",      "屯留区": "140405",      "潞城区": "140406",      "襄垣县": "140423",      "平顺县": "140425",      "黎城县": "140426",      "壶关县": "140427",      "长子县": "140428",      "武乡县": "140429",      "沁县": "140430",      "沁源县": "140431"    &#125;,    "晋城市": &#123;      "城区": "140502",      "沁水县": "140521",      "阳城县": "140522",      "陵川县": "140524",      "泽州县": "140525",      "高平市": "140581"    &#125;,    "朔州市": &#123;      "朔城区": "140602",      "平鲁区": "140603",      "山阴县": "140621",      "应县": "140622",      "右玉县": "140623",      "怀仁市": "140681"    &#125;,    "晋中市": &#123;      "榆次区": "140702",      "太谷区": "140703",      "榆社县": "140721",      "左权县": "140722",      "和顺县": "140723",      "昔阳县": "140724",      "寿阳县": "140725",      "祁县": "140727",      "平遥县": "140728",      "灵石县": "140729",      "介休市": "140781"    &#125;,    "运城市": &#123;      "盐湖区": "140802",      "临猗县": "140821",      "万荣县": "140822",      "闻喜县": "140823",      "稷山县": "140824",      "新绛县": "140825",      "绛县": "140826",      "垣曲县": "140827",      "夏县": "140828",      "平陆县": "140829",      "芮城县": "140830",      "永济市": "140881",      "河津市": "140882"    &#125;,    "忻州市": &#123;      "忻府区": "140902",      "定襄县": "140921",      "五台县": "140922",      "代县": "140923",      "繁峙县": "140924",      "宁武县": "140925",      "静乐县": "140926",      "神池县": "140927",      "五寨县": "140928",      "岢岚县": "140929",      "河曲县": "140930",      "保德县": "140931",      "偏关县": "140932",      "原平市": "140981"    &#125;,    "临汾市": &#123;      "尧都区": "141002",      "曲沃县": "141021",      "翼城县": "141022",      "襄汾县": "141023",      "洪洞县": "141024",      "古县": "141025",      "安泽县": "141026",      "浮山县": "141027",      "吉县": "141028",      "乡宁县": "141029",      "大宁县": "141030",      "隰县": "141031",      "永和县": "141032",      "蒲县": "141033",      "汾西县": "141034",      "侯马市": "141081",      "霍州市": "141082"    &#125;,    "吕梁市": &#123;      "离石区": "141102",      "文水县": "141121",      "交城县": "141122",      "兴县": "141123",      "临县": "141124",      "柳林县": "141125",      "石楼县": "141126",      "岚县": "141127",      "方山县": "141128",      "中阳县": "141129",      "交口县": "141130",      "孝义市": "141181",      "汾阳市": "141182"    &#125;  &#125;,  "内蒙古自治区": &#123;    "呼和浩特市": &#123;      "新城区": "150102",      "回民区": "150103",      "玉泉区": "150104",      "赛罕区": "150105",      "土默特左旗": "150121",      "托克托县": "150122",      "和林格尔县": "150123",      "清水河县": "150124",      "武川县": "150125"    &#125;,    "包头市": &#123;      "东河区": "150202",      "昆都仑区": "150203",      "青山区": "150204",      "石拐区": "150205",      "白云鄂博矿区": "150206",      "九原区": "150207",      "土默特右旗": "150221",      "固阳县": "150222",      "达尔罕茂明安联合旗": "150223"    &#125;,    "乌海市": &#123;      "海勃湾区": "150302",      "海南区": "150303",      "乌达区": "150304"    &#125;,    "赤峰市": &#123;      "红山区": "150402",      "元宝山区": "150403",      "松山区": "150404",      "阿鲁科尔沁旗": "150421",      "巴林左旗": "150422",      "巴林右旗": "150423",      "林西县": "150424",      "克什克腾旗": "150425",      "翁牛特旗": "150426",      "喀喇沁旗": "150428",      "宁城县": "150429",      "敖汉旗": "150430"    &#125;,    "通辽市": &#123;      "科尔沁区": "150502",      "科尔沁左翼中旗": "150521",      "科尔沁左翼后旗": "150522",      "开鲁县": "150523",      "库伦旗": "150524",      "奈曼旗": "150525",      "扎鲁特旗": "150526",      "霍林郭勒市": "150581"    &#125;,    "鄂尔多斯市": &#123;      "东胜区": "150602",      "康巴什区": "150603",      "达拉特旗": "150621",      "准格尔旗": "150622",      "鄂托克前旗": "150623",      "鄂托克旗": "150624",      "杭锦旗": "150625",      "乌审旗": "150626",      "伊金霍洛旗": "150627"    &#125;,    "呼伦贝尔市": &#123;      "海拉尔区": "150702",      "扎赉诺尔区": "150703",      "阿荣旗": "150721",      "莫力达瓦达斡尔族自治旗": "150722",      "鄂伦春自治旗": "150723",      "鄂温克族自治旗": "150724",      "陈巴尔虎旗": "150725",      "新巴尔虎左旗": "150726",      "新巴尔虎右旗": "150727",      "满洲里市": "150781",      "牙克石市": "150782",      "扎兰屯市": "150783",      "额尔古纳市": "150784",      "根河市": "150785"    &#125;,    "巴彦淖尔市": &#123;      "临河区": "150802",      "五原县": "150821",      "磴口县": "150822",      "乌拉特前旗": "150823",      "乌拉特中旗": "150824",      "乌拉特后旗": "150825",      "杭锦后旗": "150826"    &#125;,    "乌兰察布市": &#123;      "集宁区": "150902",      "卓资县": "150921",      "化德县": "150922",      "商都县": "150923",      "兴和县": "150924",      "凉城县": "150925",      "察哈尔右翼前旗": "150926",      "察哈尔右翼中旗": "150927",      "察哈尔右翼后旗": "150928",      "四子王旗": "150929",      "丰镇市": "150981"    &#125;,    "兴安盟": &#123;      "乌兰浩特市": "152201",      "阿尔山市": "152202",      "科尔沁右翼前旗": "152221",      "科尔沁右翼中旗": "152222",      "扎赉特旗": "152223",      "突泉县": "152224"    &#125;,    "锡林郭勒盟": &#123;      "二连浩特市": "152501",      "锡林浩特市": "152502",      "阿巴嘎旗": "152522",      "苏尼特左旗": "152523",      "苏尼特右旗": "152524",      "东乌珠穆沁旗": "152525",      "西乌珠穆沁旗": "152526",      "太仆寺旗": "152527",      "镶黄旗": "152528",      "正镶白旗": "152529",      "正蓝旗": "152530",      "多伦县": "152531"    &#125;,    "阿拉善盟": &#123;      "阿拉善左旗": "152921",      "阿拉善右旗": "152922",      "额济纳旗": "152923"    &#125;  &#125;,  "辽宁省": &#123;    "沈阳市": &#123;      "和平区": "210102",      "沈河区": "210103",      "大东区": "210104",      "皇姑区": "210105",      "铁西区": "210106",      "苏家屯区": "210111",      "浑南区": "210112",      "沈北新区": "210113",      "于洪区": "210114",      "辽中区": "210115",      "康平县": "210123",      "法库县": "210124",      "新民市": "210181"    &#125;,    "大连市": &#123;      "中山区": "210202",      "西岗区": "210203",      "沙河口区": "210204",      "甘井子区": "210211",      "旅顺口区": "210212",      "金州区": "210213",      "普兰店区": "210214",      "长海县": "210224",      "瓦房店市": "210281",      "庄河市": "210283"    &#125;,    "鞍山市": &#123;      "铁东区": "210302",      "铁西区": "210303",      "立山区": "210304",      "千山区": "210311",      "台安县": "210321",      "岫岩满族自治县": "210323",      "海城市": "210381"    &#125;,    "抚顺市": &#123;      "新抚区": "210402",      "东洲区": "210403",      "望花区": "210404",      "顺城区": "210411",      "抚顺县": "210421",      "新宾满族自治县": "210422",      "清原满族自治县": "210423"    &#125;,    "本溪市": &#123;      "平山区": "210502",      "溪湖区": "210503",      "明山区": "210504",      "南芬区": "210505",      "本溪满族自治县": "210521",      "桓仁满族自治县": "210522"    &#125;,    "丹东市": &#123;      "元宝区": "210602",      "振兴区": "210603",      "振安区": "210604",      "宽甸满族自治县": "210624",      "东港市": "210681",      "凤城市": "210682"    &#125;,    "锦州市": &#123;      "古塔区": "210702",      "凌河区": "210703",      "太和区": "210711",      "黑山县": "210726",      "义县": "210727",      "凌海市": "210781",      "北镇市": "210782"    &#125;,    "营口市": &#123;      "站前区": "210802",      "西市区": "210803",      "鲅鱼圈区": "210804",      "老边区": "210811",      "盖州市": "210881",      "大石桥市": "210882"    &#125;,    "阜新市": &#123;      "海州区": "210902",      "新邱区": "210903",      "太平区": "210904",      "清河门区": "210905",      "细河区": "210911",      "阜新蒙古族自治县": "210921",      "彰武县": "210922"    &#125;,    "辽阳市": &#123;      "白塔区": "211002",      "文圣区": "211003",      "宏伟区": "211004",      "弓长岭区": "211005",      "太子河区": "211011",      "辽阳县": "211021",      "灯塔市": "211081"    &#125;,    "盘锦市": &#123;      "双台子区": "211102",      "兴隆台区": "211103",      "大洼区": "211104",      "盘山县": "211122"    &#125;,    "铁岭市": &#123;      "银州区": "211202",      "清河区": "211204",      "铁岭县": "211221",      "西丰县": "211223",      "昌图县": "211224",      "调兵山市": "211281",      "开原市": "211282"    &#125;,    "朝阳市": &#123;      "双塔区": "211302",      "龙城区": "211303",      "朝阳县": "211321",      "建平县": "211322",      "喀喇沁左翼蒙古族自治县": "211324",      "北票市": "211381",      "凌源市": "211382"    &#125;,    "葫芦岛市": &#123;      "连山区": "211402",      "龙港区": "211403",      "南票区": "211404",      "绥中县": "211421",      "建昌县": "211422",      "兴城市": "211481"    &#125;  &#125;,  "吉林省": &#123;    "长春市": &#123;      "南关区": "220102",      "宽城区": "220103",      "朝阳区": "220104",      "二道区": "220105",      "绿园区": "220106",      "双阳区": "220112",      "九台区": "220113",      "农安县": "220122",      "榆树市": "220182",      "德惠市": "220183",      "公主岭市": "220184"    &#125;,    "吉林市": &#123;      "昌邑区": "220202",      "龙潭区": "220203",      "船营区": "220204",      "丰满区": "220211",      "永吉县": "220221",      "蛟河市": "220281",      "桦甸市": "220282",      "舒兰市": "220283",      "磐石市": "220284"    &#125;,    "四平市": &#123;      "铁西区": "220302",      "铁东区": "220303",      "梨树县": "220322",      "伊通满族自治县": "220323",      "双辽市": "220382"    &#125;,    "辽源市": &#123;      "龙山区": "220402",      "西安区": "220403",      "东丰县": "220421",      "东辽县": "220422"    &#125;,    "通化市": &#123;      "东昌区": "220502",      "二道江区": "220503",      "通化县": "220521",      "辉南县": "220523",      "柳河县": "220524",      "梅河口市": "220581",      "集安市": "220582"    &#125;,    "白山市": &#123;      "浑江区": "220602",      "江源区": "220605",      "抚松县": "220621",      "靖宇县": "220622",      "长白朝鲜族自治县": "220623",      "临江市": "220681"    &#125;,    "松原市": &#123;      "宁江区": "220702",      "前郭尔罗斯蒙古族自治县": "220721",      "长岭县": "220722",      "乾安县": "220723",      "扶余市": "220781"    &#125;,    "白城市": &#123;      "洮北区": "220802",      "镇赉县": "220821",      "通榆县": "220822",      "洮南市": "220881",      "大安市": "220882"    &#125;,    "延边朝鲜族自治州": &#123;      "延吉市": "222401",      "图们市": "222402",      "敦化市": "222403",      "珲春市": "222404",      "龙井市": "222405",      "和龙市": "222406",      "汪清县": "222424",      "安图县": "222426"    &#125;  &#125;,  "黑龙江省": &#123;    "哈尔滨市": &#123;      "道里区": "230102",      "南岗区": "230103",      "道外区": "230104",      "平房区": "230108",      "松北区": "230109",      "香坊区": "230110",      "呼兰区": "230111",      "阿城区": "230112",      "双城区": "230113",      "依兰县": "230123",      "方正县": "230124",      "宾县": "230125",      "巴彦县": "230126",      "木兰县": "230127",      "通河县": "230128",      "延寿县": "230129",      "尚志市": "230183",      "五常市": "230184"    &#125;,    "齐齐哈尔市": &#123;      "龙沙区": "230202",      "建华区": "230203",      "铁锋区": "230204",      "昂昂溪区": "230205",      "富拉尔基区": "230206",      "碾子山区": "230207",      "梅里斯达斡尔族区": "230208",      "龙江县": "230221",      "依安县": "230223",      "泰来县": "230224",      "甘南县": "230225",      "富裕县": "230227",      "克山县": "230229",      "克东县": "230230",      "拜泉县": "230231",      "讷河市": "230281"    &#125;,    "鸡西市": &#123;      "鸡冠区": "230302",      "恒山区": "230303",      "滴道区": "230304",      "梨树区": "230305",      "城子河区": "230306",      "麻山区": "230307",      "鸡东县": "230321",      "虎林市": "230381",      "密山市": "230382"    &#125;,    "鹤岗市": &#123;      "向阳区": "230402",      "工农区": "230403",      "南山区": "230404",      "兴安区": "230405",      "东山区": "230406",      "兴山区": "230407",      "萝北县": "230421",      "绥滨县": "230422"    &#125;,    "双鸭山市": &#123;      "尖山区": "230502",      "岭东区": "230503",      "四方台区": "230505",      "宝山区": "230506",      "集贤县": "230521",      "友谊县": "230522",      "宝清县": "230523",      "饶河县": "230524"    &#125;,    "大庆市": &#123;      "萨尔图区": "230602",      "龙凤区": "230603",      "让胡路区": "230604",      "红岗区": "230605",      "大同区": "230606",      "肇州县": "230621",      "肇源县": "230622",      "林甸县": "230623",      "杜尔伯特蒙古族自治县": "230624"    &#125;,    "伊春市": &#123;      "伊美区": "230717",      "乌翠区": "230718",      "友好区": "230719",      "嘉荫县": "230722",      "汤旺县": "230723",      "丰林县": "230724",      "大箐山县": "230725",      "南岔县": "230726",      "金林区": "230751",      "铁力市": "230781"    &#125;,    "佳木斯市": &#123;      "向阳区": "230803",      "前进区": "230804",      "东风区": "230805",      "郊区": "230811",      "桦南县": "230822",      "桦川县": "230826",      "汤原县": "230828",      "同江市": "230881",      "富锦市": "230882",      "抚远市": "230883"    &#125;,    "七台河市": &#123;      "新兴区": "230902",      "桃山区": "230903",      "茄子河区": "230904",      "勃利县": "230921"    &#125;,    "牡丹江市": &#123;      "东安区": "231002",      "阳明区": "231003",      "爱民区": "231004",      "西安区": "231005",      "林口县": "231025",      "绥芬河市": "231081",      "海林市": "231083",      "宁安市": "231084",      "穆棱市": "231085",      "东宁市": "231086"    &#125;,    "黑河市": &#123;      "爱辉区": "231102",      "逊克县": "231123",      "孙吴县": "231124",      "北安市": "231181",      "五大连池市": "231182",      "嫩江市": "231183"    &#125;,    "绥化市": &#123;      "北林区": "231202",      "望奎县": "231221",      "兰西县": "231222",      "青冈县": "231223",      "庆安县": "231224",      "明水县": "231225",      "绥棱县": "231226",      "安达市": "231281",      "肇东市": "231282",      "海伦市": "231283"    &#125;,    "大兴安岭地区": &#123;      "漠河市": "232701",      "呼玛县": "232721",      "塔河县": "232722"    &#125;  &#125;,  "上海市": &#123;    "上海市": &#123;      "黄浦区": "310101",      "徐汇区": "310104",      "长宁区": "310105",      "静安区": "310106",      "普陀区": "310107",      "虹口区": "310109",      "杨浦区": "310110",      "闵行区": "310112",      "宝山区": "310113",      "嘉定区": "310114",      "浦东新区": "310115",      "金山区": "310116",      "松江区": "310117",      "青浦区": "310118",      "奉贤区": "310120",      "崇明区": "310151"    &#125;  &#125;,  "江苏省": &#123;    "南京市": &#123;      "玄武区": "320102",      "秦淮区": "320104",      "建邺区": "320105",      "鼓楼区": "320106",      "浦口区": "320111",      "栖霞区": "320113",      "雨花台区": "320114",      "江宁区": "320115",      "六合区": "320116",      "溧水区": "320117",      "高淳区": "320118"    &#125;,    "无锡市": &#123;      "锡山区": "320205",      "惠山区": "320206",      "滨湖区": "320211",      "梁溪区": "320213",      "新吴区": "320214",      "江阴市": "320281",      "宜兴市": "320282"    &#125;,    "徐州市": &#123;      "鼓楼区": "320302",      "云龙区": "320303",      "贾汪区": "320305",      "泉山区": "320311",      "铜山区": "320312",      "丰县": "320321",      "沛县": "320322",      "睢宁县": "320324",      "新沂市": "320381",      "邳州市": "320382"    &#125;,    "常州市": &#123;      "天宁区": "320402",      "钟楼区": "320404",      "新北区": "320411",      "武进区": "320412",      "金坛区": "320413",      "溧阳市": "320481"    &#125;,    "苏州市": &#123;      "虎丘区": "320505",      "吴中区": "320506",      "相城区": "320507",      "姑苏区": "320508",      "吴江区": "320509",      "常熟市": "320581",      "张家港市": "320582",      "昆山市": "320583",      "太仓市": "320585"    &#125;,    "南通市": &#123;      "通州区": "320612",      "崇川区": "320613",      "海门区": "320614",      "如东县": "320623",      "启东市": "320681",      "如皋市": "320682",      "海安市": "320685"    &#125;,    "连云港市": &#123;      "连云区": "320703",      "海州区": "320706",      "赣榆区": "320707",      "东海县": "320722",      "灌云县": "320723",      "灌南县": "320724"    &#125;,    "淮安市": &#123;      "淮安区": "320803",      "淮阴区": "320804",      "清江浦区": "320812",      "洪泽区": "320813",      "涟水县": "320826",      "盱眙县": "320830",      "金湖县": "320831"    &#125;,    "盐城市": &#123;      "亭湖区": "320902",      "盐都区": "320903",      "大丰区": "320904",      "响水县": "320921",      "滨海县": "320922",      "阜宁县": "320923",      "射阳县": "320924",      "建湖县": "320925",      "东台市": "320981"    &#125;,    "扬州市": &#123;      "广陵区": "321002",      "邗江区": "321003",      "江都区": "321012",      "宝应县": "321023",      "仪征市": "321081",      "高邮市": "321084"    &#125;,    "镇江市": &#123;      "京口区": "321102",      "润州区": "321111",      "丹徒区": "321112",      "丹阳市": "321181",      "扬中市": "321182",      "句容市": "321183"    &#125;,    "泰州市": &#123;      "海陵区": "321202",      "高港区": "321203",      "姜堰区": "321204",      "兴化市": "321281",      "靖江市": "321282",      "泰兴市": "321283"    &#125;,    "宿迁市": &#123;      "宿城区": "321302",      "宿豫区": "321311",      "沭阳县": "321322",      "泗阳县": "321323",      "泗洪县": "321324"    &#125;  &#125;,  "浙江省": &#123;    "杭州市": &#123;      "上城区": "330102",      "下城区": "330103",      "江干区": "330104",      "拱墅区": "330105",      "西湖区": "330106",      "滨江区": "330108",      "萧山区": "330109",      "余杭区": "330110",      "富阳区": "330111",      "临安区": "330112",      "桐庐县": "330122",      "淳安县": "330127",      "建德市": "330182"    &#125;,    "宁波市": &#123;      "海曙区": "330203",      "江北区": "330205",      "北仑区": "330206",      "镇海区": "330211",      "鄞州区": "330212",      "奉化区": "330213",      "象山县": "330225",      "宁海县": "330226",      "余姚市": "330281",      "慈溪市": "330282"    &#125;,    "温州市": &#123;      "鹿城区": "330302",      "龙湾区": "330303",      "瓯海区": "330304",      "洞头区": "330305",      "永嘉县": "330324",      "平阳县": "330326",      "苍南县": "330327",      "文成县": "330328",      "泰顺县": "330329",      "瑞安市": "330381",      "乐清市": "330382",      "龙港市": "330383"    &#125;,    "嘉兴市": &#123;      "南湖区": "330402",      "秀洲区": "330411",      "嘉善县": "330421",      "海盐县": "330424",      "海宁市": "330481",      "平湖市": "330482",      "桐乡市": "330483"    &#125;,    "湖州市": &#123;      "吴兴区": "330502",      "南浔区": "330503",      "德清县": "330521",      "长兴县": "330522",      "安吉县": "330523"    &#125;,    "绍兴市": &#123;      "越城区": "330602",      "柯桥区": "330603",      "上虞区": "330604",      "新昌县": "330624",      "诸暨市": "330681",      "嵊州市": "330683"    &#125;,    "金华市": &#123;      "婺城区": "330702",      "金东区": "330703",      "武义县": "330723",      "浦江县": "330726",      "磐安县": "330727",      "兰溪市": "330781",      "义乌市": "330782",      "东阳市": "330783",      "永康市": "330784"    &#125;,    "衢州市": &#123;      "柯城区": "330802",      "衢江区": "330803",      "常山县": "330822",      "开化县": "330824",      "龙游县": "330825",      "江山市": "330881"    &#125;,    "舟山市": &#123;      "定海区": "330902",      "普陀区": "330903",      "岱山县": "330921",      "嵊泗县": "330922"    &#125;,    "台州市": &#123;      "椒江区": "331002",      "黄岩区": "331003",      "路桥区": "331004",      "三门县": "331022",      "天台县": "331023",      "仙居县": "331024",      "温岭市": "331081",      "临海市": "331082",      "玉环市": "331083"    &#125;,    "丽水市": &#123;      "莲都区": "331102",      "青田县": "331121",      "缙云县": "331122",      "遂昌县": "331123",      "松阳县": "331124",      "云和县": "331125",      "庆元县": "331126",      "景宁畲族自治县": "331127",      "龙泉市": "331181"    &#125;  &#125;,  "安徽省": &#123;    "合肥市": &#123;      "瑶海区": "340102",      "庐阳区": "340103",      "蜀山区": "340104",      "包河区": "340111",      "长丰县": "340121",      "肥东县": "340122",      "肥西县": "340123",      "庐江县": "340124",      "巢湖市": "340181"    &#125;,    "芜湖市": &#123;      "镜湖区": "340202",      "鸠江区": "340207",      "弋江区": "340209",      "湾沚区": "340210",      "繁昌区": "340212",      "南陵县": "340223",      "无为市": "340281"    &#125;,    "蚌埠市": &#123;      "龙子湖区": "340302",      "蚌山区": "340303",      "禹会区": "340304",      "淮上区": "340311",      "怀远县": "340321",      "五河县": "340322",      "固镇县": "340323"    &#125;,    "淮南市": &#123;      "大通区": "340402",      "田家庵区": "340403",      "谢家集区": "340404",      "八公山区": "340405",      "潘集区": "340406",      "凤台县": "340421",      "寿县": "340422"    &#125;,    "马鞍山市": &#123;      "花山区": "340503",      "雨山区": "340504",      "博望区": "340506",      "当涂县": "340521",      "含山县": "340522",      "和县": "340523"    &#125;,    "淮北市": &#123;      "杜集区": "340602",      "相山区": "340603",      "烈山区": "340604",      "濉溪县": "340621"    &#125;,    "铜陵市": &#123;      "铜官区": "340705",      "义安区": "340706",      "郊区": "340711",      "枞阳县": "340722"    &#125;,    "安庆市": &#123;      "迎江区": "340802",      "大观区": "340803",      "宜秀区": "340811",      "怀宁县": "340822",      "太湖县": "340825",      "宿松县": "340826",      "望江县": "340827",      "岳西县": "340828",      "桐城市": "340881",      "潜山市": "340882"    &#125;,    "黄山市": &#123;      "屯溪区": "341002",      "黄山区": "341003",      "徽州区": "341004",      "歙县": "341021",      "休宁县": "341022",      "黟县": "341023",      "祁门县": "341024"    &#125;,    "滁州市": &#123;      "琅琊区": "341102",      "南谯区": "341103",      "来安县": "341122",      "全椒县": "341124",      "定远县": "341125",      "凤阳县": "341126",      "天长市": "341181",      "明光市": "341182"    &#125;,    "阜阳市": &#123;      "颍州区": "341202",      "颍东区": "341203",      "颍泉区": "341204",      "临泉县": "341221",      "太和县": "341222",      "阜南县": "341225",      "颍上县": "341226",      "界首市": "341282"    &#125;,    "宿州市": &#123;      "埇桥区": "341302",      "砀山县": "341321",      "萧县": "341322",      "灵璧县": "341323",      "泗县": "341324"    &#125;,    "六安市": &#123;      "金安区": "341502",      "裕安区": "341503",      "叶集区": "341504",      "霍邱县": "341522",      "舒城县": "341523",      "金寨县": "341524",      "霍山县": "341525"    &#125;,    "亳州市": &#123;      "谯城区": "341602",      "涡阳县": "341621",      "蒙城县": "341622",      "利辛县": "341623"    &#125;,    "池州市": &#123;      "贵池区": "341702",      "东至县": "341721",      "石台县": "341722",      "青阳县": "341723"    &#125;,    "宣城市": &#123;      "宣州区": "341802",      "郎溪县": "341821",      "泾县": "341823",      "绩溪县": "341824",      "旌德县": "341825",      "宁国市": "341881",      "广德市": "341882"    &#125;  &#125;,  "福建省": &#123;    "福州市": &#123;      "鼓楼区": "350102",      "台江区": "350103",      "仓山区": "350104",      "马尾区": "350105",      "晋安区": "350111",      "长乐区": "350112",      "闽侯县": "350121",      "连江县": "350122",      "罗源县": "350123",      "闽清县": "350124",      "永泰县": "350125",      "平潭县": "350128",      "福清市": "350181"    &#125;,    "厦门市": &#123;      "思明区": "350203",      "海沧区": "350205",      "湖里区": "350206",      "集美区": "350211",      "同安区": "350212",      "翔安区": "350213"    &#125;,    "莆田市": &#123;      "城厢区": "350302",      "涵江区": "350303",      "荔城区": "350304",      "秀屿区": "350305",      "仙游县": "350322"    &#125;,    "三明市": &#123;      "梅列区": "350402",      "三元区": "350403",      "明溪县": "350421",      "清流县": "350423",      "宁化县": "350424",      "大田县": "350425",      "尤溪县": "350426",      "沙县": "350427",      "将乐县": "350428",      "泰宁县": "350429",      "建宁县": "350430",      "永安市": "350481"    &#125;,    "泉州市": &#123;      "鲤城区": "350502",      "丰泽区": "350503",      "洛江区": "350504",      "泉港区": "350505",      "惠安县": "350521",      "安溪县": "350524",      "永春县": "350525",      "德化县": "350526",      "金门县": "350527",      "石狮市": "350581",      "晋江市": "350582",      "南安市": "350583"    &#125;,    "漳州市": &#123;      "芗城区": "350602",      "龙文区": "350603",      "云霄县": "350622",      "漳浦县": "350623",      "诏安县": "350624",      "长泰县": "350625",      "东山县": "350626",      "南靖县": "350627",      "平和县": "350628",      "华安县": "350629",      "龙海市": "350681"    &#125;,    "南平市": &#123;      "延平区": "350702",      "建阳区": "350703",      "顺昌县": "350721",      "浦城县": "350722",      "光泽县": "350723",      "松溪县": "350724",      "政和县": "350725",      "邵武市": "350781",      "武夷山市": "350782",      "建瓯市": "350783"    &#125;,    "龙岩市": &#123;      "新罗区": "350802",      "永定区": "350803",      "长汀县": "350821",      "上杭县": "350823",      "武平县": "350824",      "连城县": "350825",      "漳平市": "350881"    &#125;,    "宁德市": &#123;      "蕉城区": "350902",      "霞浦县": "350921",      "古田县": "350922",      "屏南县": "350923",      "寿宁县": "350924",      "周宁县": "350925",      "柘荣县": "350926",      "福安市": "350981",      "福鼎市": "350982"    &#125;  &#125;,  "江西省": &#123;    "南昌市": &#123;      "东湖区": "360102",      "西湖区": "360103",      "青云谱区": "360104",      "青山湖区": "360111",      "新建区": "360112",      "红谷滩区": "360113",      "南昌县": "360121",      "安义县": "360123",      "进贤县": "360124"    &#125;,    "景德镇市": &#123;      "昌江区": "360202",      "珠山区": "360203",      "浮梁县": "360222",      "乐平市": "360281"    &#125;,    "萍乡市": &#123;      "安源区": "360302",      "湘东区": "360313",      "莲花县": "360321",      "上栗县": "360322",      "芦溪县": "360323"    &#125;,    "九江市": &#123;      "濂溪区": "360402",      "浔阳区": "360403",      "柴桑区": "360404",      "武宁县": "360423",      "修水县": "360424",      "永修县": "360425",      "德安县": "360426",      "都昌县": "360428",      "湖口县": "360429",      "彭泽县": "360430",      "瑞昌市": "360481",      "共青城市": "360482",      "庐山市": "360483"    &#125;,    "新余市": &#123;      "渝水区": "360502",      "分宜县": "360521"    &#125;,    "鹰潭市": &#123;      "月湖区": "360602",      "余江区": "360603",      "贵溪市": "360681"    &#125;,    "赣州市": &#123;      "章贡区": "360702",      "南康区": "360703",      "赣县区": "360704",      "信丰县": "360722",      "大余县": "360723",      "上犹县": "360724",      "崇义县": "360725",      "安远县": "360726",      "定南县": "360728",      "全南县": "360729",      "宁都县": "360730",      "于都县": "360731",      "兴国县": "360732",      "会昌县": "360733",      "寻乌县": "360734",      "石城县": "360735",      "瑞金市": "360781",      "龙南市": "360783"    &#125;,    "吉安市": &#123;      "吉州区": "360802",      "青原区": "360803",      "吉安县": "360821",      "吉水县": "360822",      "峡江县": "360823",      "新干县": "360824",      "永丰县": "360825",      "泰和县": "360826",      "遂川县": "360827",      "万安县": "360828",      "安福县": "360829",      "永新县": "360830",      "井冈山市": "360881"    &#125;,    "宜春市": &#123;      "袁州区": "360902",      "奉新县": "360921",      "万载县": "360922",      "上高县": "360923",      "宜丰县": "360924",      "靖安县": "360925",      "铜鼓县": "360926",      "丰城市": "360981",      "樟树市": "360982",      "高安市": "360983"    &#125;,    "抚州市": &#123;      "临川区": "361002",      "东乡区": "361003",      "南城县": "361021",      "黎川县": "361022",      "南丰县": "361023",      "崇仁县": "361024",      "乐安县": "361025",      "宜黄县": "361026",      "金溪县": "361027",      "资溪县": "361028",      "广昌县": "361030"    &#125;,    "上饶市": &#123;      "信州区": "361102",      "广丰区": "361103",      "广信区": "361104",      "玉山县": "361123",      "铅山县": "361124",      "横峰县": "361125",      "弋阳县": "361126",      "余干县": "361127",      "鄱阳县": "361128",      "万年县": "361129",      "婺源县": "361130",      "德兴市": "361181"    &#125;  &#125;,  "山东省": &#123;    "济南市": &#123;      "历下区": "370102",      "市中区": "370103",      "槐荫区": "370104",      "天桥区": "370105",      "历城区": "370112",      "长清区": "370113",      "章丘区": "370114",      "济阳区": "370115",      "莱芜区": "370116",      "钢城区": "370117",      "平阴县": "370124",      "商河县": "370126"    &#125;,    "青岛市": &#123;      "市南区": "370202",      "市北区": "370203",      "黄岛区": "370211",      "崂山区": "370212",      "李沧区": "370213",      "城阳区": "370214",      "即墨区": "370215",      "胶州市": "370281",      "平度市": "370283",      "莱西市": "370285"    &#125;,    "淄博市": &#123;      "淄川区": "370302",      "张店区": "370303",      "博山区": "370304",      "临淄区": "370305",      "周村区": "370306",      "桓台县": "370321",      "高青县": "370322",      "沂源县": "370323"    &#125;,    "枣庄市": &#123;      "市中区": "370402",      "薛城区": "370403",      "峄城区": "370404",      "台儿庄区": "370405",      "山亭区": "370406",      "滕州市": "370481"    &#125;,    "东营市": &#123;      "东营区": "370502",      "河口区": "370503",      "垦利区": "370505",      "利津县": "370522",      "广饶县": "370523"    &#125;,    "烟台市": &#123;      "芝罘区": "370602",      "福山区": "370611",      "牟平区": "370612",      "莱山区": "370613",      "蓬莱区": "370614",      "龙口市": "370681",      "莱阳市": "370682",      "莱州市": "370683",      "招远市": "370685",      "栖霞市": "370686",      "海阳市": "370687"    &#125;,    "潍坊市": &#123;      "潍城区": "370702",      "寒亭区": "370703",      "坊子区": "370704",      "奎文区": "370705",      "临朐县": "370724",      "昌乐县": "370725",      "青州市": "370781",      "诸城市": "370782",      "寿光市": "370783",      "安丘市": "370784",      "高密市": "370785",      "昌邑市": "370786"    &#125;,    "济宁市": &#123;      "任城区": "370811",      "兖州区": "370812",      "微山县": "370826",      "鱼台县": "370827",      "金乡县": "370828",      "嘉祥县": "370829",      "汶上县": "370830",      "泗水县": "370831",      "梁山县": "370832",      "曲阜市": "370881",      "邹城市": "370883"    &#125;,    "泰安市": &#123;      "泰山区": "370902",      "岱岳区": "370911",      "宁阳县": "370921",      "东平县": "370923",      "新泰市": "370982",      "肥城市": "370983"    &#125;,    "威海市": &#123;      "环翠区": "371002",      "文登区": "371003",      "荣成市": "371082",      "乳山市": "371083"    &#125;,    "日照市": &#123;      "东港区": "371102",      "岚山区": "371103",      "五莲县": "371121",      "莒县": "371122"    &#125;,    "临沂市": &#123;      "兰山区": "371302",      "罗庄区": "371311",      "河东区": "371312",      "沂南县": "371321",      "郯城县": "371322",      "沂水县": "371323",      "兰陵县": "371324",      "费县": "371325",      "平邑县": "371326",      "莒南县": "371327",      "蒙阴县": "371328",      "临沭县": "371329"    &#125;,    "德州市": &#123;      "德城区": "371402",      "陵城区": "371403",      "宁津县": "371422",      "庆云县": "371423",      "临邑县": "371424",      "齐河县": "371425",      "平原县": "371426",      "夏津县": "371427",      "武城县": "371428",      "乐陵市": "371481",      "禹城市": "371482"    &#125;,    "聊城市": &#123;      "东昌府区": "371502",      "茌平区": "371503",      "阳谷县": "371521",      "莘县": "371522",      "东阿县": "371524",      "冠县": "371525",      "高唐县": "371526",      "临清市": "371581"    &#125;,    "滨州市": &#123;      "滨城区": "371602",      "沾化区": "371603",      "惠民县": "371621",      "阳信县": "371622",      "无棣县": "371623",      "博兴县": "371625",      "邹平市": "371681"    &#125;,    "菏泽市": &#123;      "牡丹区": "371702",      "定陶区": "371703",      "曹县": "371721",      "单县": "371722",      "成武县": "371723",      "巨野县": "371724",      "郓城县": "371725",      "鄄城县": "371726",      "东明县": "371728"    &#125;  &#125;,  "河南省": &#123;    "郑州市": &#123;      "中原区": "410102",      "二七区": "410103",      "管城回族区": "410104",      "金水区": "410105",      "上街区": "410106",      "惠济区": "410108",      "中牟县": "410122",      "巩义市": "410181",      "荥阳市": "410182",      "新密市": "410183",      "新郑市": "410184",      "登封市": "410185"    &#125;,    "开封市": &#123;      "龙亭区": "410202",      "顺河回族区": "410203",      "鼓楼区": "410204",      "禹王台区": "410205",      "祥符区": "410212",      "杞县": "410221",      "通许县": "410222",      "尉氏县": "410223",      "兰考县": "410225"    &#125;,    "洛阳市": &#123;      "老城区": "410302",      "西工区": "410303",      "瀍河回族区": "410304",      "涧西区": "410305",      "吉利区": "410306",      "洛龙区": "410311",      "孟津县": "410322",      "新安县": "410323",      "栾川县": "410324",      "嵩县": "410325",      "汝阳县": "410326",      "宜阳县": "410327",      "洛宁县": "410328",      "伊川县": "410329",      "偃师市": "410381"    &#125;,    "平顶山市": &#123;      "新华区": "410402",      "卫东区": "410403",      "石龙区": "410404",      "湛河区": "410411",      "宝丰县": "410421",      "叶县": "410422",      "鲁山县": "410423",      "郏县": "410425",      "舞钢市": "410481",      "汝州市": "410482"    &#125;,    "安阳市": &#123;      "文峰区": "410502",      "北关区": "410503",      "殷都区": "410505",      "龙安区": "410506",      "安阳县": "410522",      "汤阴县": "410523",      "滑县": "410526",      "内黄县": "410527",      "林州市": "410581"    &#125;,    "鹤壁市": &#123;      "鹤山区": "410602",      "山城区": "410603",      "淇滨区": "410611",      "浚县": "410621",      "淇县": "410622"    &#125;,    "新乡市": &#123;      "红旗区": "410702",      "卫滨区": "410703",      "凤泉区": "410704",      "牧野区": "410711",      "新乡县": "410721",      "获嘉县": "410724",      "原阳县": "410725",      "延津县": "410726",      "封丘县": "410727",      "卫辉市": "410781",      "辉县市": "410782",      "长垣市": "410783"    &#125;,    "焦作市": &#123;      "解放区": "410802",      "中站区": "410803",      "马村区": "410804",      "山阳区": "410811",      "修武县": "410821",      "博爱县": "410822",      "武陟县": "410823",      "温县": "410825",      "沁阳市": "410882",      "孟州市": "410883"    &#125;,    "濮阳市": &#123;      "华龙区": "410902",      "清丰县": "410922",      "南乐县": "410923",      "范县": "410926",      "台前县": "410927",      "濮阳县": "410928"    &#125;,    "许昌市": &#123;      "魏都区": "411002",      "建安区": "411003",      "鄢陵县": "411024",      "襄城县": "411025",      "禹州市": "411081",      "长葛市": "411082"    &#125;,    "漯河市": &#123;      "源汇区": "411102",      "郾城区": "411103",      "召陵区": "411104",      "舞阳县": "411121",      "临颍县": "411122"    &#125;,    "三门峡市": &#123;      "湖滨区": "411202",      "陕州区": "411203",      "渑池县": "411221",      "卢氏县": "411224",      "义马市": "411281",      "灵宝市": "411282"    &#125;,    "南阳市": &#123;      "宛城区": "411302",      "卧龙区": "411303",      "南召县": "411321",      "方城县": "411322",      "西峡县": "411323",      "镇平县": "411324",      "内乡县": "411325",      "淅川县": "411326",      "社旗县": "411327",      "唐河县": "411328",      "新野县": "411329",      "桐柏县": "411330",      "邓州市": "411381"    &#125;,    "商丘市": &#123;      "梁园区": "411402",      "睢阳区": "411403",      "民权县": "411421",      "睢县": "411422",      "宁陵县": "411423",      "柘城县": "411424",      "虞城县": "411425",      "夏邑县": "411426",      "永城市": "411481"    &#125;,    "信阳市": &#123;      "浉河区": "411502",      "平桥区": "411503",      "罗山县": "411521",      "光山县": "411522",      "新县": "411523",      "商城县": "411524",      "固始县": "411525",      "潢川县": "411526",      "淮滨县": "411527",      "息县": "411528"    &#125;,    "周口市": &#123;      "川汇区": "411602",      "淮阳区": "411603",      "扶沟县": "411621",      "西华县": "411622",      "商水县": "411623",      "沈丘县": "411624",      "郸城县": "411625",      "太康县": "411627",      "鹿邑县": "411628",      "项城市": "411681"    &#125;,    "驻马店市": &#123;      "驿城区": "411702",      "西平县": "411721",      "上蔡县": "411722",      "平舆县": "411723",      "正阳县": "411724",      "确山县": "411725",      "泌阳县": "411726",      "汝南县": "411727",      "遂平县": "411728",      "新蔡县": "411729",      "济源市": "419001"    &#125;  &#125;,  "湖北省": &#123;    "武汉市": &#123;      "江岸区": "420102",      "江汉区": "420103",      "硚口区": "420104",      "汉阳区": "420105",      "武昌区": "420106",      "青山区": "420107",      "洪山区": "420111",      "东西湖区": "420112",      "汉南区": "420113",      "蔡甸区": "420114",      "江夏区": "420115",      "黄陂区": "420116",      "新洲区": "420117"    &#125;,    "黄石市": &#123;      "黄石港区": "420202",      "西塞山区": "420203",      "下陆区": "420204",      "铁山区": "420205",      "阳新县": "420222",      "大冶市": "420281"    &#125;,    "十堰市": &#123;      "茅箭区": "420302",      "张湾区": "420303",      "郧阳区": "420304",      "郧西县": "420322",      "竹山县": "420323",      "竹溪县": "420324",      "房县": "420325",      "丹江口市": "420381"    &#125;,    "宜昌市": &#123;      "西陵区": "420502",      "伍家岗区": "420503",      "点军区": "420504",      "猇亭区": "420505",      "夷陵区": "420506",      "远安县": "420525",      "兴山县": "420526",      "秭归县": "420527",      "长阳土家族自治县": "420528",      "五峰土家族自治县": "420529",      "宜都市": "420581",      "当阳市": "420582",      "枝江市": "420583"    &#125;,    "襄阳市": &#123;      "襄城区": "420602",      "樊城区": "420606",      "襄州区": "420607",      "南漳县": "420624",      "谷城县": "420625",      "保康县": "420626",      "老河口市": "420682",      "枣阳市": "420683",      "宜城市": "420684"    &#125;,    "鄂州市": &#123;      "梁子湖区": "420702",      "华容区": "420703",      "鄂城区": "420704"    &#125;,    "荆门市": &#123;      "东宝区": "420802",      "掇刀区": "420804",      "沙洋县": "420822",      "钟祥市": "420881",      "京山市": "420882"    &#125;,    "孝感市": &#123;      "孝南区": "420902",      "孝昌县": "420921",      "大悟县": "420922",      "云梦县": "420923",      "应城市": "420981",      "安陆市": "420982",      "汉川市": "420984"    &#125;,    "荆州市": &#123;      "沙市区": "421002",      "荆州区": "421003",      "公安县": "421022",      "江陵县": "421024",      "石首市": "421081",      "洪湖市": "421083",      "松滋市": "421087",      "监利市": "421088"    &#125;,    "黄冈市": &#123;      "黄州区": "421102",      "团风县": "421121",      "红安县": "421122",      "罗田县": "421123",      "英山县": "421124",      "浠水县": "421125",      "蕲春县": "421126",      "黄梅县": "421127",      "麻城市": "421181",      "武穴市": "421182"    &#125;,    "咸宁市": &#123;      "咸安区": "421202",      "嘉鱼县": "421221",      "通城县": "421222",      "崇阳县": "421223",      "通山县": "421224",      "赤壁市": "421281"    &#125;,    "随州市": &#123;      "曾都区": "421303",      "随县": "421321",      "广水市": "421381"    &#125;,    "恩施土家族苗族自治州": &#123;      "恩施市": "422801",      "利川市": "422802",      "建始县": "422822",      "巴东县": "422823",      "宣恩县": "422825",      "咸丰县": "422826",      "来凤县": "422827",      "鹤峰县": "422828",      "仙桃市": "429004",      "潜江市": "429005",      "天门市": "429006",      "神农架林区": "429021"    &#125;  &#125;,  "湖南省": &#123;    "长沙市": &#123;      "芙蓉区": "430102",      "天心区": "430103",      "岳麓区": "430104",      "开福区": "430105",      "雨花区": "430111",      "望城区": "430112",      "长沙县": "430121",      "浏阳市": "430181",      "宁乡市": "430182"    &#125;,    "株洲市": &#123;      "荷塘区": "430202",      "芦淞区": "430203",      "石峰区": "430204",      "天元区": "430211",      "渌口区": "430212",      "攸县": "430223",      "茶陵县": "430224",      "炎陵县": "430225",      "醴陵市": "430281"    &#125;,    "湘潭市": &#123;      "雨湖区": "430302",      "岳塘区": "430304",      "湘潭县": "430321",      "湘乡市": "430381",      "韶山市": "430382"    &#125;,    "衡阳市": &#123;      "珠晖区": "430405",      "雁峰区": "430406",      "石鼓区": "430407",      "蒸湘区": "430408",      "南岳区": "430412",      "衡阳县": "430421",      "衡南县": "430422",      "衡山县": "430423",      "衡东县": "430424",      "祁东县": "430426",      "耒阳市": "430481",      "常宁市": "430482"    &#125;,    "邵阳市": &#123;      "双清区": "430502",      "大祥区": "430503",      "北塔区": "430511",      "新邵县": "430522",      "邵阳县": "430523",      "隆回县": "430524",      "洞口县": "430525",      "绥宁县": "430527",      "新宁县": "430528",      "城步苗族自治县": "430529",      "武冈市": "430581",      "邵东市": "430582"    &#125;,    "岳阳市": &#123;      "岳阳楼区": "430602",      "云溪区": "430603",      "君山区": "430611",      "岳阳县": "430621",      "华容县": "430623",      "湘阴县": "430624",      "平江县": "430626",      "汨罗市": "430681",      "临湘市": "430682"    &#125;,    "常德市": &#123;      "武陵区": "430702",      "鼎城区": "430703",      "安乡县": "430721",      "汉寿县": "430722",      "澧县": "430723",      "临澧县": "430724",      "桃源县": "430725",      "石门县": "430726",      "津市市": "430781"    &#125;,    "张家界市": &#123;      "永定区": "430802",      "武陵源区": "430811",      "慈利县": "430821",      "桑植县": "430822"    &#125;,    "益阳市": &#123;      "资阳区": "430902",      "赫山区": "430903",      "南县": "430921",      "桃江县": "430922",      "安化县": "430923",      "沅江市": "430981"    &#125;,    "郴州市": &#123;      "北湖区": "431002",      "苏仙区": "431003",      "桂阳县": "431021",      "宜章县": "431022",      "永兴县": "431023",      "嘉禾县": "431024",      "临武县": "431025",      "汝城县": "431026",      "桂东县": "431027",      "安仁县": "431028",      "资兴市": "431081"    &#125;,    "永州市": &#123;      "零陵区": "431102",      "冷水滩区": "431103",      "祁阳县": "431121",      "东安县": "431122",      "双牌县": "431123",      "道县": "431124",      "江永县": "431125",      "宁远县": "431126",      "蓝山县": "431127",      "新田县": "431128",      "江华瑶族自治县": "431129"    &#125;,    "怀化市": &#123;      "鹤城区": "431202",      "中方县": "431221",      "沅陵县": "431222",      "辰溪县": "431223",      "溆浦县": "431224",      "会同县": "431225",      "麻阳苗族自治县": "431226",      "新晃侗族自治县": "431227",      "芷江侗族自治县": "431228",      "靖州苗族侗族自治县": "431229",      "通道侗族自治县": "431230",      "洪江市": "431281"    &#125;,    "娄底市": &#123;      "娄星区": "431302",      "双峰县": "431321",      "新化县": "431322",      "冷水江市": "431381",      "涟源市": "431382"    &#125;,    "湘西土家族苗族自治州": &#123;      "吉首市": "433101",      "泸溪县": "433122",      "凤凰县": "433123",      "花垣县": "433124",      "保靖县": "433125",      "古丈县": "433126",      "永顺县": "433127",      "龙山县": "433130"    &#125;  &#125;,  "广东省": &#123;    "广州市": &#123;      "荔湾区": "440103",      "越秀区": "440104",      "海珠区": "440105",      "天河区": "440106",      "白云区": "440111",      "黄埔区": "440112",      "番禺区": "440113",      "花都区": "440114",      "南沙区": "440115",      "从化区": "440117",      "增城区": "440118"    &#125;,    "韶关市": &#123;      "武江区": "440203",      "浈江区": "440204",      "曲江区": "440205",      "始兴县": "440222",      "仁化县": "440224",      "翁源县": "440229",      "乳源瑶族自治县": "440232",      "新丰县": "440233",      "乐昌市": "440281",      "南雄市": "440282"    &#125;,    "深圳市": &#123;      "罗湖区": "440303",      "福田区": "440304",      "南山区": "440305",      "宝安区": "440306",      "龙岗区": "440307",      "盐田区": "440308",      "龙华区": "440309",      "坪山区": "440310",      "光明区": "440311"    &#125;,    "珠海市": &#123;      "香洲区": "440402",      "斗门区": "440403",      "金湾区": "440404"    &#125;,    "汕头市": &#123;      "龙湖区": "440507",      "金平区": "440511",      "濠江区": "440512",      "潮阳区": "440513",      "潮南区": "440514",      "澄海区": "440515",      "南澳县": "440523"    &#125;,    "佛山市": &#123;      "禅城区": "440604",      "南海区": "440605",      "顺德区": "440606",      "三水区": "440607",      "高明区": "440608"    &#125;,    "江门市": &#123;      "蓬江区": "440703",      "江海区": "440704",      "新会区": "440705",      "台山市": "440781",      "开平市": "440783",      "鹤山市": "440784",      "恩平市": "440785"    &#125;,    "湛江市": &#123;      "赤坎区": "440802",      "霞山区": "440803",      "坡头区": "440804",      "麻章区": "440811",      "遂溪县": "440823",      "徐闻县": "440825",      "廉江市": "440881",      "雷州市": "440882",      "吴川市": "440883"    &#125;,    "茂名市": &#123;      "茂南区": "440902",      "电白区": "440904",      "高州市": "440981",      "化州市": "440982",      "信宜市": "440983"    &#125;,    "肇庆市": &#123;      "端州区": "441202",      "鼎湖区": "441203",      "高要区": "441204",      "广宁县": "441223",      "怀集县": "441224",      "封开县": "441225",      "德庆县": "441226",      "四会市": "441284"    &#125;,    "惠州市": &#123;      "惠城区": "441302",      "惠阳区": "441303",      "博罗县": "441322",      "惠东县": "441323",      "龙门县": "441324"    &#125;,    "梅州市": &#123;      "梅江区": "441402",      "梅县区": "441403",      "大埔县": "441422",      "丰顺县": "441423",      "五华县": "441424",      "平远县": "441426",      "蕉岭县": "441427",      "兴宁市": "441481"    &#125;,    "汕尾市": &#123;      "城区": "441502",      "海丰县": "441521",      "陆河县": "441523",      "陆丰市": "441581"    &#125;,    "河源市": &#123;      "源城区": "441602",      "紫金县": "441621",      "龙川县": "441622",      "连平县": "441623",      "和平县": "441624",      "东源县": "441625"    &#125;,    "阳江市": &#123;      "江城区": "441702",      "阳东区": "441704",      "阳西县": "441721",      "阳春市": "441781"    &#125;,    "清远市": &#123;      "清城区": "441802",      "清新区": "441803",      "佛冈县": "441821",      "阳山县": "441823",      "连山壮族瑶族自治县": "441825",      "连南瑶族自治县": "441826",      "英德市": "441881",      "连州市": "441882"    &#125;,    "东莞市": &#123;    &#125;,    "中山市": &#123;    &#125;,    "潮州市": &#123;      "湘桥区": "445102",      "潮安区": "445103",      "饶平县": "445122"    &#125;,    "揭阳市": &#123;      "榕城区": "445202",      "揭东区": "445203",      "揭西县": "445222",      "惠来县": "445224",      "普宁市": "445281"    &#125;,    "云浮市": &#123;      "云城区": "445302",      "云安区": "445303",      "新兴县": "445321",      "郁南县": "445322",      "罗定市": "445381"    &#125;  &#125;,  "广西壮族自治区": &#123;    "南宁市": &#123;      "兴宁区": "450102",      "青秀区": "450103",      "江南区": "450105",      "西乡塘区": "450107",      "良庆区": "450108",      "邕宁区": "450109",      "武鸣区": "450110",      "隆安县": "450123",      "马山县": "450124",      "上林县": "450125",      "宾阳县": "450126",      "横县": "450127"    &#125;,    "柳州市": &#123;      "城中区": "450202",      "鱼峰区": "450203",      "柳南区": "450204",      "柳北区": "450205",      "柳江区": "450206",      "柳城县": "450222",      "鹿寨县": "450223",      "融安县": "450224",      "融水苗族自治县": "450225",      "三江侗族自治县": "450226"    &#125;,    "桂林市": &#123;      "秀峰区": "450302",      "叠彩区": "450303",      "象山区": "450304",      "七星区": "450305",      "雁山区": "450311",      "临桂区": "450312",      "阳朔县": "450321",      "灵川县": "450323",      "全州县": "450324",      "兴安县": "450325",      "永福县": "450326",      "灌阳县": "450327",      "龙胜各族自治县": "450328",      "资源县": "450329",      "平乐县": "450330",      "恭城瑶族自治县": "450332",      "荔浦市": "450381"    &#125;,    "梧州市": &#123;      "万秀区": "450403",      "长洲区": "450405",      "龙圩区": "450406",      "苍梧县": "450421",      "藤县": "450422",      "蒙山县": "450423",      "岑溪市": "450481"    &#125;,    "北海市": &#123;      "海城区": "450502",      "银海区": "450503",      "铁山港区": "450512",      "合浦县": "450521"    &#125;,    "防城港市": &#123;      "港口区": "450602",      "防城区": "450603",      "上思县": "450621",      "东兴市": "450681"    &#125;,    "钦州市": &#123;      "钦南区": "450702",      "钦北区": "450703",      "灵山县": "450721",      "浦北县": "450722"    &#125;,    "贵港市": &#123;      "港北区": "450802",      "港南区": "450803",      "覃塘区": "450804",      "平南县": "450821",      "桂平市": "450881"    &#125;,    "玉林市": &#123;      "玉州区": "450902",      "福绵区": "450903",      "容县": "450921",      "陆川县": "450922",      "博白县": "450923",      "兴业县": "450924",      "北流市": "450981"    &#125;,    "百色市": &#123;      "右江区": "451002",      "田阳区": "451003",      "田东县": "451022",      "德保县": "451024",      "那坡县": "451026",      "凌云县": "451027",      "乐业县": "451028",      "田林县": "451029",      "西林县": "451030",      "隆林各族自治县": "451031",      "靖西市": "451081",      "平果市": "451082"    &#125;,    "贺州市": &#123;      "八步区": "451102",      "平桂区": "451103",      "昭平县": "451121",      "钟山县": "451122",      "富川瑶族自治县": "451123"    &#125;,    "河池市": &#123;      "金城江区": "451202",      "宜州区": "451203",      "南丹县": "451221",      "天峨县": "451222",      "凤山县": "451223",      "东兰县": "451224",      "罗城仫佬族自治县": "451225",      "环江毛南族自治县": "451226",      "巴马瑶族自治县": "451227",      "都安瑶族自治县": "451228",      "大化瑶族自治县": "451229"    &#125;,    "来宾市": &#123;      "兴宾区": "451302",      "忻城县": "451321",      "象州县": "451322",      "武宣县": "451323",      "金秀瑶族自治县": "451324",      "合山市": "451381"    &#125;,    "崇左市": &#123;      "江州区": "451402",      "扶绥县": "451421",      "宁明县": "451422",      "龙州县": "451423",      "大新县": "451424",      "天等县": "451425",      "凭祥市": "451481"    &#125;  &#125;,  "海南省": &#123;    "海口市": &#123;      "秀英区": "460105",      "龙华区": "460106",      "琼山区": "460107",      "美兰区": "460108"    &#125;,    "三亚市": &#123;      "海棠区": "460202",      "吉阳区": "460203",      "天涯区": "460204",      "崖州区": "460205"    &#125;,    "三沙市": &#123;    &#125;,    "儋州市": &#123;      "五指山市": "469001",      "琼海市": "469002",      "文昌市": "469005",      "万宁市": "469006",      "东方市": "469007",      "定安县": "469021",      "屯昌县": "469022",      "澄迈县": "469023",      "临高县": "469024",      "白沙黎族自治县": "469025",      "昌江黎族自治县": "469026",      "乐东黎族自治县": "469027",      "陵水黎族自治县": "469028",      "保亭黎族苗族自治县": "469029",      "琼中黎族苗族自治县": "469030"    &#125;  &#125;,  "重庆市": &#123;    "重庆市": &#123;      "万州区": "500101",      "涪陵区": "500102",      "渝中区": "500103",      "大渡口区": "500104",      "江北区": "500105",      "沙坪坝区": "500106",      "九龙坡区": "500107",      "南岸区": "500108",      "北碚区": "500109",      "綦江区": "500110",      "大足区": "500111",      "渝北区": "500112",      "巴南区": "500113",      "黔江区": "500114",      "长寿区": "500115",      "江津区": "500116",      "合川区": "500117",      "永川区": "500118",      "南川区": "500119",      "璧山区": "500120",      "铜梁区": "500151",      "潼南区": "500152",      "荣昌区": "500153",      "开州区": "500154",      "梁平区": "500155",      "武隆区": "500156",      "城口县": "500229",      "丰都县": "500230",      "垫江县": "500231",      "忠县": "500233",      "云阳县": "500235",      "奉节县": "500236",      "巫山县": "500237",      "巫溪县": "500238",      "石柱土家族自治县": "500240",      "秀山土家族苗族自治县": "500241",      "酉阳土家族苗族自治县": "500242",      "彭水苗族土家族自治县": "500243"    &#125;  &#125;,  "四川省": &#123;    "成都市": &#123;      "锦江区": "510104",      "青羊区": "510105",      "金牛区": "510106",      "武侯区": "510107",      "成华区": "510108",      "龙泉驿区": "510112",      "青白江区": "510113",      "新都区": "510114",      "温江区": "510115",      "双流区": "510116",      "郫都区": "510117",      "新津区": "510118",      "金堂县": "510121",      "大邑县": "510129",      "蒲江县": "510131",      "都江堰市": "510181",      "彭州市": "510182",      "邛崃市": "510183",      "崇州市": "510184",      "简阳市": "510185"    &#125;,    "自贡市": &#123;      "自流井区": "510302",      "贡井区": "510303",      "大安区": "510304",      "沿滩区": "510311",      "荣县": "510321",      "富顺县": "510322"    &#125;,    "攀枝花市": &#123;      "东区": "510402",      "西区": "510403",      "仁和区": "510411",      "米易县": "510421",      "盐边县": "510422"    &#125;,    "泸州市": &#123;      "江阳区": "510502",      "纳溪区": "510503",      "龙马潭区": "510504",      "泸县": "510521",      "合江县": "510522",      "叙永县": "510524",      "古蔺县": "510525"    &#125;,    "德阳市": &#123;      "旌阳区": "510603",      "罗江区": "510604",      "中江县": "510623",      "广汉市": "510681",      "什邡市": "510682",      "绵竹市": "510683"    &#125;,    "绵阳市": &#123;      "涪城区": "510703",      "游仙区": "510704",      "安州区": "510705",      "三台县": "510722",      "盐亭县": "510723",      "梓潼县": "510725",      "北川羌族自治县": "510726",      "平武县": "510727",      "江油市": "510781"    &#125;,    "广元市": &#123;      "利州区": "510802",      "昭化区": "510811",      "朝天区": "510812",      "旺苍县": "510821",      "青川县": "510822",      "剑阁县": "510823",      "苍溪县": "510824"    &#125;,    "遂宁市": &#123;      "船山区": "510903",      "安居区": "510904",      "蓬溪县": "510921",      "大英县": "510923",      "射洪市": "510981"    &#125;,    "内江市": &#123;      "市中区": "511002",      "东兴区": "511011",      "威远县": "511024",      "资中县": "511025",      "隆昌市": "511083"    &#125;,    "乐山市": &#123;      "市中区": "511102",      "沙湾区": "511111",      "五通桥区": "511112",      "金口河区": "511113",      "犍为县": "511123",      "井研县": "511124",      "夹江县": "511126",      "沐川县": "511129",      "峨边彝族自治县": "511132",      "马边彝族自治县": "511133",      "峨眉山市": "511181"    &#125;,    "南充市": &#123;      "顺庆区": "511302",      "高坪区": "511303",      "嘉陵区": "511304",      "南部县": "511321",      "营山县": "511322",      "蓬安县": "511323",      "仪陇县": "511324",      "西充县": "511325",      "阆中市": "511381"    &#125;,    "眉山市": &#123;      "东坡区": "511402",      "彭山区": "511403",      "仁寿县": "511421",      "洪雅县": "511423",      "丹棱县": "511424",      "青神县": "511425"    &#125;,    "宜宾市": &#123;      "翠屏区": "511502",      "南溪区": "511503",      "叙州区": "511504",      "江安县": "511523",      "长宁县": "511524",      "高县": "511525",      "珙县": "511526",      "筠连县": "511527",      "兴文县": "511528",      "屏山县": "511529"    &#125;,    "广安市": &#123;      "广安区": "511602",      "前锋区": "511603",      "岳池县": "511621",      "武胜县": "511622",      "邻水县": "511623",      "华蓥市": "511681"    &#125;,    "达州市": &#123;      "通川区": "511702",      "达川区": "511703",      "宣汉县": "511722",      "开江县": "511723",      "大竹县": "511724",      "渠县": "511725",      "万源市": "511781"    &#125;,    "雅安市": &#123;      "雨城区": "511802",      "名山区": "511803",      "荥经县": "511822",      "汉源县": "511823",      "石棉县": "511824",      "天全县": "511825",      "芦山县": "511826",      "宝兴县": "511827"    &#125;,    "巴中市": &#123;      "巴州区": "511902",      "恩阳区": "511903",      "通江县": "511921",      "南江县": "511922",      "平昌县": "511923"    &#125;,    "资阳市": &#123;      "雁江区": "512002",      "安岳县": "512021",      "乐至县": "512022"    &#125;,    "阿坝藏族羌族自治州": &#123;      "马尔康市": "513201",      "汶川县": "513221",      "理县": "513222",      "茂县": "513223",      "松潘县": "513224",      "九寨沟县": "513225",      "金川县": "513226",      "小金县": "513227",      "黑水县": "513228",      "壤塘县": "513230",      "阿坝县": "513231",      "若尔盖县": "513232",      "红原县": "513233"    &#125;,    "甘孜藏族自治州": &#123;      "康定市": "513301",      "泸定县": "513322",      "丹巴县": "513323",      "九龙县": "513324",      "雅江县": "513325",      "道孚县": "513326",      "炉霍县": "513327",      "甘孜县": "513328",      "新龙县": "513329",      "德格县": "513330",      "白玉县": "513331",      "石渠县": "513332",      "色达县": "513333",      "理塘县": "513334",      "巴塘县": "513335",      "乡城县": "513336",      "稻城县": "513337",      "得荣县": "513338"    &#125;,    "凉山彝族自治州": &#123;      "西昌市": "513401",      "木里藏族自治县": "513422",      "盐源县": "513423",      "德昌县": "513424",      "会理县": "513425",      "会东县": "513426",      "宁南县": "513427",      "普格县": "513428",      "布拖县": "513429",      "金阳县": "513430",      "昭觉县": "513431",      "喜德县": "513432",      "冕宁县": "513433",      "越西县": "513434",      "甘洛县": "513435",      "美姑县": "513436",      "雷波县": "513437"    &#125;  &#125;,  "贵州省": &#123;    "贵阳市": &#123;      "南明区": "520102",      "云岩区": "520103",      "花溪区": "520111",      "乌当区": "520112",      "白云区": "520113",      "观山湖区": "520115",      "开阳县": "520121",      "息烽县": "520122",      "修文县": "520123",      "清镇市": "520181"    &#125;,    "六盘水市": &#123;      "钟山区": "520201",      "六枝特区": "520203",      "水城区": "520204",      "盘州市": "520281"    &#125;,    "遵义市": &#123;      "红花岗区": "520302",      "汇川区": "520303",      "播州区": "520304",      "桐梓县": "520322",      "绥阳县": "520323",      "正安县": "520324",      "道真仡佬族苗族自治县": "520325",      "务川仡佬族苗族自治县": "520326",      "凤冈县": "520327",      "湄潭县": "520328",      "余庆县": "520329",      "习水县": "520330",      "赤水市": "520381",      "仁怀市": "520382"    &#125;,    "安顺市": &#123;      "西秀区": "520402",      "平坝区": "520403",      "普定县": "520422",      "镇宁布依族苗族自治县": "520423",      "关岭布依族苗族自治县": "520424",      "紫云苗族布依族自治县": "520425"    &#125;,    "毕节市": &#123;      "七星关区": "520502",      "大方县": "520521",      "黔西县": "520522",      "金沙县": "520523",      "织金县": "520524",      "纳雍县": "520525",      "威宁彝族回族苗族自治县": "520526",      "赫章县": "520527"    &#125;,    "铜仁市": &#123;      "碧江区": "520602",      "万山区": "520603",      "江口县": "520621",      "玉屏侗族自治县": "520622",      "石阡县": "520623",      "思南县": "520624",      "印江土家族苗族自治县": "520625",      "德江县": "520626",      "沿河土家族自治县": "520627",      "松桃苗族自治县": "520628"    &#125;,    "黔西南布依族苗族自治州": &#123;      "兴义市": "522301",      "兴仁市": "522302",      "普安县": "522323",      "晴隆县": "522324",      "贞丰县": "522325",      "望谟县": "522326",      "册亨县": "522327",      "安龙县": "522328"    &#125;,    "黔东南苗族侗族自治州": &#123;      "凯里市": "522601",      "黄平县": "522622",      "施秉县": "522623",      "三穗县": "522624",      "镇远县": "522625",      "岑巩县": "522626",      "天柱县": "522627",      "锦屏县": "522628",      "剑河县": "522629",      "台江县": "522630",      "黎平县": "522631",      "榕江县": "522632",      "从江县": "522633",      "雷山县": "522634",      "麻江县": "522635",      "丹寨县": "522636"    &#125;,    "黔南布依族苗族自治州": &#123;      "都匀市": "522701",      "福泉市": "522702",      "荔波县": "522722",      "贵定县": "522723",      "瓮安县": "522725",      "独山县": "522726",      "平塘县": "522727",      "罗甸县": "522728",      "长顺县": "522729",      "龙里县": "522730",      "惠水县": "522731",      "三都水族自治县": "522732"    &#125;  &#125;,  "云南省": &#123;    "昆明市": &#123;      "五华区": "530102",      "盘龙区": "530103",      "官渡区": "530111",      "西山区": "530112",      "东川区": "530113",      "呈贡区": "530114",      "晋宁区": "530115",      "富民县": "530124",      "宜良县": "530125",      "石林彝族自治县": "530126",      "嵩明县": "530127",      "禄劝彝族苗族自治县": "530128",      "寻甸回族彝族自治县": "530129",      "安宁市": "530181"    &#125;,    "曲靖市": &#123;      "麒麟区": "530302",      "沾益区": "530303",      "马龙区": "530304",      "陆良县": "530322",      "师宗县": "530323",      "罗平县": "530324",      "富源县": "530325",      "会泽县": "530326",      "宣威市": "530381"    &#125;,    "玉溪市": &#123;      "红塔区": "530402",      "江川区": "530403",      "通海县": "530423",      "华宁县": "530424",      "易门县": "530425",      "峨山彝族自治县": "530426",      "新平彝族傣族自治县": "530427",      "元江哈尼族彝族傣族自治县": "530428",      "澄江市": "530481"    &#125;,    "保山市": &#123;      "隆阳区": "530502",      "施甸县": "530521",      "龙陵县": "530523",      "昌宁县": "530524",      "腾冲市": "530581"    &#125;,    "昭通市": &#123;      "昭阳区": "530602",      "鲁甸县": "530621",      "巧家县": "530622",      "盐津县": "530623",      "大关县": "530624",      "永善县": "530625",      "绥江县": "530626",      "镇雄县": "530627",      "彝良县": "530628",      "威信县": "530629",      "水富市": "530681"    &#125;,    "丽江市": &#123;      "古城区": "530702",      "玉龙纳西族自治县": "530721",      "永胜县": "530722",      "华坪县": "530723",      "宁蒗彝族自治县": "530724"    &#125;,    "普洱市": &#123;      "思茅区": "530802",      "宁洱哈尼族彝族自治县": "530821",      "墨江哈尼族自治县": "530822",      "景东彝族自治县": "530823",      "景谷傣族彝族自治县": "530824",      "镇沅彝族哈尼族拉祜族自治县": "530825",      "江城哈尼族彝族自治县": "530826",      "孟连傣族拉祜族佤族自治县": "530827",      "澜沧拉祜族自治县": "530828",      "西盟佤族自治县": "530829"    &#125;,    "临沧市": &#123;      "临翔区": "530902",      "凤庆县": "530921",      "云县": "530922",      "永德县": "530923",      "镇康县": "530924",      "双江拉祜族佤族布朗族傣族自治县": "530925",      "耿马傣族佤族自治县": "530926",      "沧源佤族自治县": "530927"    &#125;,    "楚雄彝族自治州": &#123;      "楚雄市": "532301",      "双柏县": "532322",      "牟定县": "532323",      "南华县": "532324",      "姚安县": "532325",      "大姚县": "532326",      "永仁县": "532327",      "元谋县": "532328",      "武定县": "532329",      "禄丰县": "532331"    &#125;,    "红河哈尼族彝族自治州": &#123;      "个旧市": "532501",      "开远市": "532502",      "蒙自市": "532503",      "弥勒市": "532504",      "屏边苗族自治县": "532523",      "建水县": "532524",      "石屏县": "532525",      "泸西县": "532527",      "元阳县": "532528",      "红河县": "532529",      "金平苗族瑶族傣族自治县": "532530",      "绿春县": "532531",      "河口瑶族自治县": "532532"    &#125;,    "文山壮族苗族自治州": &#123;      "文山市": "532601",      "砚山县": "532622",      "西畴县": "532623",      "麻栗坡县": "532624",      "马关县": "532625",      "丘北县": "532626",      "广南县": "532627",      "富宁县": "532628"    &#125;,    "西双版纳傣族自治州": &#123;      "景洪市": "532801",      "勐海县": "532822",      "勐腊县": "532823"    &#125;,    "大理白族自治州": &#123;      "大理市": "532901",      "漾濞彝族自治县": "532922",      "祥云县": "532923",      "宾川县": "532924",      "弥渡县": "532925",      "南涧彝族自治县": "532926",      "巍山彝族回族自治县": "532927",      "永平县": "532928",      "云龙县": "532929",      "洱源县": "532930",      "剑川县": "532931",      "鹤庆县": "532932"    &#125;,    "德宏傣族景颇族自治州": &#123;      "瑞丽市": "533102",      "芒市": "533103",      "梁河县": "533122",      "盈江县": "533123",      "陇川县": "533124"    &#125;,    "怒江傈僳族自治州": &#123;      "泸水市": "533301",      "福贡县": "533323",      "贡山独龙族怒族自治县": "533324",      "兰坪白族普米族自治县": "533325"    &#125;,    "迪庆藏族自治州": &#123;      "香格里拉市": "533401",      "德钦县": "533422",      "维西傈僳族自治县": "533423"    &#125;  &#125;,  "西藏自治区": &#123;    "拉萨市": &#123;      "城关区": "540102",      "堆龙德庆区": "540103",      "达孜区": "540104",      "林周县": "540121",      "当雄县": "540122",      "尼木县": "540123",      "曲水县": "540124",      "墨竹工卡县": "540127"    &#125;,    "日喀则市": &#123;      "桑珠孜区": "540202",      "南木林县": "540221",      "江孜县": "540222",      "定日县": "540223",      "萨迦县": "540224",      "拉孜县": "540225",      "昂仁县": "540226",      "谢通门县": "540227",      "白朗县": "540228",      "仁布县": "540229",      "康马县": "540230",      "定结县": "540231",      "仲巴县": "540232",      "亚东县": "540233",      "吉隆县": "540234",      "聂拉木县": "540235",      "萨嘎县": "540236",      "岗巴县": "540237"    &#125;,    "昌都市": &#123;      "卡若区": "540302",      "江达县": "540321",      "贡觉县": "540322",      "类乌齐县": "540323",      "丁青县": "540324",      "察雅县": "540325",      "八宿县": "540326",      "左贡县": "540327",      "芒康县": "540328",      "洛隆县": "540329",      "边坝县": "540330"    &#125;,    "林芝市": &#123;      "巴宜区": "540402",      "工布江达县": "540421",      "米林县": "540422",      "墨脱县": "540423",      "波密县": "540424",      "察隅县": "540425",      "朗县": "540426"    &#125;,    "山南市": &#123;      "乃东区": "540502",      "扎囊县": "540521",      "贡嘎县": "540522",      "桑日县": "540523",      "琼结县": "540524",      "曲松县": "540525",      "措美县": "540526",      "洛扎县": "540527",      "加查县": "540528",      "隆子县": "540529",      "错那县": "540530",      "浪卡子县": "540531"    &#125;,    "那曲市": &#123;      "色尼区": "540602",      "嘉黎县": "540621",      "比如县": "540622",      "聂荣县": "540623",      "安多县": "540624",      "申扎县": "540625",      "索县": "540626",      "班戈县": "540627",      "巴青县": "540628",      "尼玛县": "540629",      "双湖县": "540630"    &#125;,    "阿里地区": &#123;      "普兰县": "542521",      "札达县": "542522",      "噶尔县": "542523",      "日土县": "542524",      "革吉县": "542525",      "改则县": "542526",      "措勤县": "542527"    &#125;  &#125;,  "陕西省": &#123;    "西安市": &#123;      "新城区": "610102",      "碑林区": "610103",      "莲湖区": "610104",      "灞桥区": "610111",      "未央区": "610112",      "雁塔区": "610113",      "阎良区": "610114",      "临潼区": "610115",      "长安区": "610116",      "高陵区": "610117",      "鄠邑区": "610118",      "蓝田县": "610122",      "周至县": "610124"    &#125;,    "铜川市": &#123;      "王益区": "610202",      "印台区": "610203",      "耀州区": "610204",      "宜君县": "610222"    &#125;,    "宝鸡市": &#123;      "渭滨区": "610302",      "金台区": "610303",      "陈仓区": "610304",      "凤翔县": "610322",      "岐山县": "610323",      "扶风县": "610324",      "眉县": "610326",      "陇县": "610327",      "千阳县": "610328",      "麟游县": "610329",      "凤县": "610330",      "太白县": "610331"    &#125;,    "咸阳市": &#123;      "秦都区": "610402",      "杨陵区": "610403",      "渭城区": "610404",      "三原县": "610422",      "泾阳县": "610423",      "乾县": "610424",      "礼泉县": "610425",      "永寿县": "610426",      "长武县": "610428",      "旬邑县": "610429",      "淳化县": "610430",      "武功县": "610431",      "兴平市": "610481",      "彬州市": "610482"    &#125;,    "渭南市": &#123;      "临渭区": "610502",      "华州区": "610503",      "潼关县": "610522",      "大荔县": "610523",      "合阳县": "610524",      "澄城县": "610525",      "蒲城县": "610526",      "白水县": "610527",      "富平县": "610528",      "韩城市": "610581",      "华阴市": "610582"    &#125;,    "延安市": &#123;      "宝塔区": "610602",      "安塞区": "610603",      "延长县": "610621",      "延川县": "610622",      "志丹县": "610625",      "吴起县": "610626",      "甘泉县": "610627",      "富县": "610628",      "洛川县": "610629",      "宜川县": "610630",      "黄龙县": "610631",      "黄陵县": "610632",      "子长市": "610681"    &#125;,    "汉中市": &#123;      "汉台区": "610702",      "南郑区": "610703",      "城固县": "610722",      "洋县": "610723",      "西乡县": "610724",      "勉县": "610725",      "宁强县": "610726",      "略阳县": "610727",      "镇巴县": "610728",      "留坝县": "610729",      "佛坪县": "610730"    &#125;,    "榆林市": &#123;      "榆阳区": "610802",      "横山区": "610803",      "府谷县": "610822",      "靖边县": "610824",      "定边县": "610825",      "绥德县": "610826",      "米脂县": "610827",      "佳县": "610828",      "吴堡县": "610829",      "清涧县": "610830",      "子洲县": "610831",      "神木市": "610881"    &#125;,    "安康市": &#123;      "汉滨区": "610902",      "汉阴县": "610921",      "石泉县": "610922",      "宁陕县": "610923",      "紫阳县": "610924",      "岚皋县": "610925",      "平利县": "610926",      "镇坪县": "610927",      "旬阳县": "610928",      "白河县": "610929"    &#125;,    "商洛市": &#123;      "商州区": "611002",      "洛南县": "611021",      "丹凤县": "611022",      "商南县": "611023",      "山阳县": "611024",      "镇安县": "611025",      "柞水县": "611026"    &#125;  &#125;,  "甘肃省": &#123;    "兰州市": &#123;      "城关区": "620102",      "七里河区": "620103",      "西固区": "620104",      "安宁区": "620105",      "红古区": "620111",      "永登县": "620121",      "皋兰县": "620122",      "榆中县": "620123"    &#125;,    "嘉峪关市": &#123;    &#125;,    "金昌市": &#123;      "金川区": "620302",      "永昌县": "620321"    &#125;,    "白银市": &#123;      "白银区": "620402",      "平川区": "620403",      "靖远县": "620421",      "会宁县": "620422",      "景泰县": "620423"    &#125;,    "天水市": &#123;      "秦州区": "620502",      "麦积区": "620503",      "清水县": "620521",      "秦安县": "620522",      "甘谷县": "620523",      "武山县": "620524",      "张家川回族自治县": "620525"    &#125;,    "武威市": &#123;      "凉州区": "620602",      "民勤县": "620621",      "古浪县": "620622",      "天祝藏族自治县": "620623"    &#125;,    "张掖市": &#123;      "甘州区": "620702",      "肃南裕固族自治县": "620721",      "民乐县": "620722",      "临泽县": "620723",      "高台县": "620724",      "山丹县": "620725"    &#125;,    "平凉市": &#123;      "崆峒区": "620802",      "泾川县": "620821",      "灵台县": "620822",      "崇信县": "620823",      "庄浪县": "620825",      "静宁县": "620826",      "华亭市": "620881"    &#125;,    "酒泉市": &#123;      "肃州区": "620902",      "金塔县": "620921",      "瓜州县": "620922",      "肃北蒙古族自治县": "620923",      "阿克塞哈萨克族自治县": "620924",      "玉门市": "620981",      "敦煌市": "620982"    &#125;,    "庆阳市": &#123;      "西峰区": "621002",      "庆城县": "621021",      "环县": "621022",      "华池县": "621023",      "合水县": "621024",      "正宁县": "621025",      "宁县": "621026",      "镇原县": "621027"    &#125;,    "定西市": &#123;      "安定区": "621102",      "通渭县": "621121",      "陇西县": "621122",      "渭源县": "621123",      "临洮县": "621124",      "漳县": "621125",      "岷县": "621126"    &#125;,    "陇南市": &#123;      "武都区": "621202",      "成县": "621221",      "文县": "621222",      "宕昌县": "621223",      "康县": "621224",      "西和县": "621225",      "礼县": "621226",      "徽县": "621227",      "两当县": "621228"    &#125;,    "临夏回族自治州": &#123;      "临夏市": "622901",      "临夏县": "622921",      "康乐县": "622922",      "永靖县": "622923",      "广河县": "622924",      "和政县": "622925",      "东乡族自治县": "622926",      "积石山保安族东乡族撒拉族自治县": "622927"    &#125;,    "甘南藏族自治州": &#123;      "合作市": "623001",      "临潭县": "623021",      "卓尼县": "623022",      "舟曲县": "623023",      "迭部县": "623024",      "玛曲县": "623025",      "碌曲县": "623026",      "夏河县": "623027"    &#125;  &#125;,  "青海省": &#123;    "西宁市": &#123;      "城东区": "630102",      "城中区": "630103",      "城西区": "630104",      "城北区": "630105",      "湟中区": "630106",      "大通回族土族自治县": "630121",      "湟源县": "630123"    &#125;,    "海东市": &#123;      "乐都区": "630202",      "平安区": "630203",      "民和回族土族自治县": "630222",      "互助土族自治县": "630223",      "化隆回族自治县": "630224",      "循化撒拉族自治县": "630225"    &#125;,    "海北藏族自治州": &#123;      "门源回族自治县": "632221",      "祁连县": "632222",      "海晏县": "632223",      "刚察县": "632224"    &#125;,    "黄南藏族自治州": &#123;      "同仁市": "632301",      "尖扎县": "632322",      "泽库县": "632323",      "河南蒙古族自治县": "632324"    &#125;,    "海南藏族自治州": &#123;      "共和县": "632521",      "同德县": "632522",      "贵德县": "632523",      "兴海县": "632524",      "贵南县": "632525"    &#125;,    "果洛藏族自治州": &#123;      "玛沁县": "632621",      "班玛县": "632622",      "甘德县": "632623",      "达日县": "632624",      "久治县": "632625",      "玛多县": "632626"    &#125;,    "玉树藏族自治州": &#123;      "玉树市": "632701",      "杂多县": "632722",      "称多县": "632723",      "治多县": "632724",      "囊谦县": "632725",      "曲麻莱县": "632726"    &#125;,    "海西蒙古族藏族自治州": &#123;      "格尔木市": "632801",      "德令哈市": "632802",      "茫崖市": "632803",      "乌兰县": "632821",      "都兰县": "632822",      "天峻县": "632823"    &#125;  &#125;,  "宁夏回族自治区": &#123;    "银川市": &#123;      "兴庆区": "640104",      "西夏区": "640105",      "金凤区": "640106",      "永宁县": "640121",      "贺兰县": "640122",      "灵武市": "640181"    &#125;,    "石嘴山市": &#123;      "大武口区": "640202",      "惠农区": "640205",      "平罗县": "640221"    &#125;,    "吴忠市": &#123;      "利通区": "640302",      "红寺堡区": "640303",      "盐池县": "640323",      "同心县": "640324",      "青铜峡市": "640381"    &#125;,    "固原市": &#123;      "原州区": "640402",      "西吉县": "640422",      "隆德县": "640423",      "泾源县": "640424",      "彭阳县": "640425"    &#125;,    "中卫市": &#123;      "沙坡头区": "640502",      "中宁县": "640521",      "海原县": "640522"    &#125;  &#125;,  "新疆维吾尔自治区": &#123;    "乌鲁木齐市": &#123;      "天山区": "650102",      "沙依巴克区": "650103",      "新市区": "650104",      "水磨沟区": "650105",      "头屯河区": "650106",      "达坂城区": "650107",      "米东区": "650109",      "乌鲁木齐县": "650121"    &#125;,    "克拉玛依市": &#123;      "独山子区": "650202",      "克拉玛依区": "650203",      "白碱滩区": "650204",      "乌尔禾区": "650205"    &#125;,    "吐鲁番市": &#123;      "高昌区": "650402",      "鄯善县": "650421",      "托克逊县": "650422"    &#125;,    "哈密市": &#123;      "伊州区": "650502",      "巴里坤哈萨克自治县": "650521",      "伊吾县": "650522"    &#125;,    "昌吉回族自治州": &#123;      "昌吉市": "652301",      "阜康市": "652302",      "呼图壁县": "652323",      "玛纳斯县": "652324",      "奇台县": "652325",      "吉木萨尔县": "652327",      "木垒哈萨克自治县": "652328"    &#125;,    "博尔塔拉蒙古自治州": &#123;      "博乐市": "652701",      "阿拉山口市": "652702",      "精河县": "652722",      "温泉县": "652723"    &#125;,    "巴音郭楞蒙古自治州": &#123;      "库尔勒市": "652801",      "轮台县": "652822",      "尉犁县": "652823",      "若羌县": "652824",      "且末县": "652825",      "焉耆回族自治县": "652826",      "和静县": "652827",      "和硕县": "652828",      "博湖县": "652829"    &#125;,    "阿克苏地区": &#123;      "阿克苏市": "652901",      "库车市": "652902",      "温宿县": "652922",      "沙雅县": "652924",      "新和县": "652925",      "拜城县": "652926",      "乌什县": "652927",      "阿瓦提县": "652928",      "柯坪县": "652929"    &#125;,    "克孜勒苏柯尔克孜自治州": &#123;      "阿图什市": "653001",      "阿克陶县": "653022",      "阿合奇县": "653023",      "乌恰县": "653024"    &#125;,    "喀什地区": &#123;      "喀什市": "653101",      "疏附县": "653121",      "疏勒县": "653122",      "英吉沙县": "653123",      "泽普县": "653124",      "莎车县": "653125",      "叶城县": "653126",      "麦盖提县": "653127",      "岳普湖县": "653128",      "伽师县": "653129",      "巴楚县": "653130",      "塔什库尔干塔吉克自治县": "653131"    &#125;,    "和田地区": &#123;      "和田市": "653201",      "和田县": "653221",      "墨玉县": "653222",      "皮山县": "653223",      "洛浦县": "653224",      "策勒县": "653225",      "于田县": "653226",      "民丰县": "653227"    &#125;,    "伊犁哈萨克自治州": &#123;      "伊宁市": "654002",      "奎屯市": "654003",      "霍尔果斯市": "654004",      "伊宁县": "654021",      "察布查尔锡伯自治县": "654022",      "霍城县": "654023",      "巩留县": "654024",      "新源县": "654025",      "昭苏县": "654026",      "特克斯县": "654027",      "尼勒克县": "654028"    &#125;,    "塔城地区": &#123;      "塔城市": "654201",      "乌苏市": "654202",      "额敏县": "654221",      "沙湾县": "654223",      "托里县": "654224",      "裕民县": "654225",      "和布克赛尔蒙古自治县": "654226"    &#125;,    "阿勒泰地区": &#123;      "阿勒泰市": "654301",      "布尔津县": "654321",      "富蕴县": "654322",      "福海县": "654323",      "哈巴河县": "654324",      "青河县": "654325",      "吉木乃县": "654326",      "石河子市": "659001",      "阿拉尔市": "659002",      "图木舒克市": "659003",      "五家渠市": "659004",      "北屯市": "659005",      "铁门关市": "659006",      "双河市": "659007",      "可克达拉市": "659008",      "昆玉市": "659009",      "胡杨河市": "659010"    &#125;  &#125;,  "台湾省": &#123;  &#125;,  "香港特别行政区": &#123;  &#125;,  "澳门特别行政区": &#123;  &#125;&#125;</code></pre> </details>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Laravel向Java的迁移-Bcrypt散列的通用验证</title>
      <link href="/2025/03/12/Java%20%E6%A0%A1%E9%AA%8C%20PHP%20password_hash%20Laravel%20Hashmake/"/>
      <url>/2025/03/12/Java%20%E6%A0%A1%E9%AA%8C%20PHP%20password_hash%20Laravel%20Hashmake/</url>
      
        <content type="html"><![CDATA[<p><strong>Java 校验 PHP password_hash Laravel Hash:make</strong></p><p>样板：$2y起始的60字符哈希值：$2y$10$y&#x2F;n3daDQxONNf.5dU59kw.3FyXm9JBumT9HeiJru0gXcrRBGAecdS</p><h3 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h3><blockquote><p>Laravel Hash:make对等实现</p></blockquote><blockquote><p><strong>Laravel本身随机盐，自PHP5.2.7以后也不建议手动盐而是让PHP本身断言系统来加盐</strong> </p></blockquote><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hash:<span class="title function_ invoke__">make</span>(<span class="variable">$password</span>);</span><br></pre></td></tr></table></figure></div><p><del>等价于</del></p><blockquote><p><strong>PHP5.5.0 函数password_hash的PASSWORD_BCRYPT散列算法</strong></p><p>OPTIONS：cost (integer) - 代表算法使用的 cost 可以根据自身硬件条件加大此值 默认值为10</p></blockquote><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">password_hash</span>(<span class="variable">$password</span>, PASSWORD_BCRYPT, [<span class="string">&#x27;cost&#x27;</span> =&gt; <span class="number">10</span>]);</span><br></pre></td></tr></table></figure></div><p><del>等价于</del></p><blockquote><p><strong>PHP4 函数 crypt的<code>CRYPT_BLOWFISH</code> 算法 返回一个基于标准 UNIX DES 算法或系统上其他可用的替代算法的散列字符串</strong></p></blockquote><p><strong>与上述区别</strong></p><blockquote><p>password_hash()使用了一个强的哈希算法，来产生足够强的盐值，并且会自动进行合适的轮次。</p><p>password_hash()是crypt()的一个简单封装，并且完全与现有的密码哈希兼容。推荐使用password_hash()</p></blockquote><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">crypt</span>(<span class="variable">$password</span>, <span class="variable">$salt</span>)</span><br></pre></td></tr></table></figure></div><h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 加密</span></span><br><span class="line"><span class="variable">$password</span> = <span class="string">&quot;12345678&quot;</span>;</span><br><span class="line"><span class="variable">$hash</span> = Hash:<span class="title function_ invoke__">make</span>(<span class="variable">$password</span>); <span class="comment">//Laravel</span></span><br><span class="line"><span class="variable">$hash</span> = <span class="title function_ invoke__">password_hash</span>(<span class="variable">$password</span>, PASSWORD_BCRYPT, [<span class="string">&#x27;cost&#x27;</span> =&gt; <span class="number">10</span>]); <span class="comment">//PHP</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 解密 OR 对比</span></span><br><span class="line"><span class="variable">$result</span> = <span class="title class_">Hash</span>::<span class="title function_ invoke__">check</span>(<span class="variable">$password</span>, <span class="variable">$hash</span>); <span class="comment">//Laravel</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$salt</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$hash</span>, <span class="number">0</span>, <span class="number">29</span>); <span class="comment">//PHP</span></span><br><span class="line"><span class="variable">$resultStr</span> = <span class="title function_ invoke__">crypt</span>(<span class="variable">$password</span>, <span class="variable">$salt</span>);</span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$hash</span> === <span class="variable">$resultStr</span>;</span><br></pre></td></tr></table></figure></div><h3 id="Blowfish算法"><a href="#Blowfish算法" class="headerlink" title="Blowfish算法"></a>Blowfish算法</h3><blockquote><p>使用如下盐值：“$2a$”，一个两位 cost 参数，“$” 以及 64 位由 “.&#x2F;0-9A-Za-z” 中的字符组合而成的字符串。在盐值中使用此范围之外的字符将导致 crypt() 返回一个空字符串。两位 cost 参数是循环次数以 2 为底的对数，它的范围是 04-31，超出这个范围将导致 crypt() 失败。 PHP 5.3.7 之前只支持 “$2a$” 作为盐值的前缀，PHP 5.3.7 开始引入了新的前缀来修正一个在Blowfish实现上的安全风险。可以参考<a class="link"   href="https://www.php.net/security/crypt_blowfish.php" >» this document<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>来了解关于这个修复的更多信息。总而言之，开发者如果仅针对 PHP 5.3.7及之后版本进行开发，那应该使用 “$2y$” 而非 “$2a$”</p></blockquote><p><strong>哈希示例</strong></p><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$2a$10<span class="variable">$N9qo8uLOickgx2ZMRZoMyeIjZAgcfl7p92ldGxad68LJZdL17lhWy</span></span><br><span class="line">\__/\/ \____________________/\_____________________________/</span><br><span class="line"> Alg Cost      Salt                        Hash</span><br></pre></td></tr></table></figure></div><p>参考此文：<a class="link"   href="https://blog.csdn.net/java_xiaoo/article/details/120326412" >密码学系列之:bcrypt加密算法详解<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p><h3 id="JAVA"><a href="#JAVA" class="headerlink" title="JAVA"></a>JAVA</h3><blockquote><p>找实现了blowfish算法的crypt包即可</p></blockquote><blockquote><p>借助crypto.bcrypt包来实现blowfish</p></blockquote><ol><li><strong>引POM</strong></li></ol><div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.10.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></div><ol start="2"><li><strong>加密&#x2F;校验</strong></li></ol><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;12345678&quot;</span>;</span><br><span class="line"><span class="comment">// 加密</span></span><br><span class="line"><span class="type">String</span> <span class="variable">salt</span> <span class="operator">=</span> BCrypt.gensalt(<span class="string">&quot;$2y$&quot;</span>, <span class="number">10</span>);</span><br><span class="line"><span class="type">String</span> <span class="variable">hash</span> <span class="operator">=</span> BCrypt.hashpw(password, salt);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 校验</span></span><br><span class="line"><span class="type">String</span> <span class="variable">hashVal</span> <span class="operator">=</span> <span class="string">&quot;$2y$10$rRRR2RyMp68/ZZrjniyofuWgIFd.Q1DBwtjwLxf/VVFHrpV9DC44K&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">salt</span> <span class="operator">=</span> hashVal.substring(<span class="number">0</span>, <span class="number">29</span>); <span class="comment">// 手动截取校验</span></span><br><span class="line"><span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> hashVal.equals(BCrypt.hashpw(password, salt));</span><br><span class="line"></span><br><span class="line"><span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> hashVal.equals(BCrypt.checkpw(password, hashVal));<span class="comment">// 自动识别校验</span></span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> laravel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JS文件处理-Excel/Text/Pdf</title>
      <link href="/2025/03/12/JS%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86%EF%BC%88Excel%EF%BC%8CText%EF%BC%8CPDF%EF%BC%89/"/>
      <url>/2025/03/12/JS%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86%EF%BC%88Excel%EF%BC%8CText%EF%BC%8CPDF%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h3 id="Excel"><a href="#Excel" class="headerlink" title="Excel"></a>Excel</h3><p>基于<code>vue-json-excel</code>工具包实现</p><ul><li>引入</li></ul><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vue-json-excel</span><br></pre></td></tr></table></figure></div><ul><li>封装工具类</li></ul><p>excel.js</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">var</span> <span class="variable">XLSX</span> <span class="operator">=</span> require(<span class="string">&#x27;xlsx&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 读取EXCEL为JSON对象</span></span><br><span class="line"><span class="comment"> * 传参headers = [] 可以伪造一个顺序的hash json，默认读取excel首行为header</span></span><br><span class="line"><span class="comment"> * Zhendong Zhou </span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> files 目标文件</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> headers 自定义标题头部</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> &#123;*&#125; 读取结果数组</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">export function <span class="title function_">readExcelToJson</span><span class="params">(files, headers = undefined)</span> &#123;</span><br><span class="line">  <span class="type">let</span> <span class="variable">fileReader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileReader</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>((resolve, reject) =&gt; &#123;</span><br><span class="line">    fileReader.onload = function (ev) &#123;</span><br><span class="line">      <span class="type">let</span> <span class="variable">persons</span> <span class="operator">=</span> [] <span class="comment">// 存储获取到的数据</span></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">let</span> <span class="variable">data</span> <span class="operator">=</span> ev.target.result</span><br><span class="line">        <span class="type">var</span> <span class="variable">workbook</span> <span class="operator">=</span> XLSX.read(data, &#123;</span><br><span class="line">          type: <span class="string">&#x27;binary&#x27;</span></span><br><span class="line">        &#125;) <span class="comment">// 以二进制流方式读取得到整份excel表格对象</span></span><br><span class="line">      &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        console.error(e)</span><br><span class="line">        reject(<span class="string">&#x27;文件类型不正确&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 遍历每张表读取</span></span><br><span class="line">      <span class="keyword">for</span> (let sheet in workbook.Sheets) &#123;</span><br><span class="line">        <span class="keyword">if</span> (workbook.Sheets.hasOwnProperty(sheet)) &#123;</span><br><span class="line">          <span class="type">let</span> <span class="variable">ws</span> <span class="operator">=</span> workbook.Sheets[sheet]</span><br><span class="line">          <span class="keyword">if</span> (!!!ws[<span class="string">&#x27;!ref&#x27;</span>]) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> (headers !== undefined) &#123;</span><br><span class="line">            <span class="comment">// 表格的表格范围</span></span><br><span class="line">            <span class="type">let</span> <span class="variable">range</span> <span class="operator">=</span> XLSX.utils.decode_range(ws[<span class="string">&#x27;!ref&#x27;</span>])</span><br><span class="line">            <span class="comment">// 找到worksheet中 A1,B1,C1...等设置表头的字段，替换为上方label对应的数据</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">let</span> <span class="variable">c</span> <span class="operator">=</span> range.s.c; c &lt;= range.e.c; c++) &#123;</span><br><span class="line">              <span class="type">let</span> <span class="variable">header</span> <span class="operator">=</span> XLSX.utils.encode_col(c) + <span class="string">&#x27;1&#x27;</span></span><br><span class="line">              <span class="keyword">if</span> (ws[header]) &#123;</span><br><span class="line">                ws[header].w = headers[c] || <span class="string">&quot;_EMPTY_&quot;</span>+c</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          persons = persons.concat(XLSX.utils.sheet_to_json(ws))</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      resolve(persons)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 以二进制方式打开文件</span></span><br><span class="line">    fileReader.readAsBinaryString(files[<span class="number">0</span>])</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><ul><li>使用</li></ul><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;readExcel&#125; <span class="keyword">from</span> <span class="string">&quot;@/utils/excel&quot;</span></span><br><span class="line"><span class="title function_">readExcelToJson</span>(event.<span class="property">target</span>.<span class="property">files</span>, []).<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(data)&#125;)</span><br></pre></td></tr></table></figure></div><ul><li>注意</li></ul><p>第二个可选参数headers分三种情况</p><ol><li>undefined</li></ol><p>​取excel首行当作json对象key</p><ol><li>[]</li></ol><p>​按照列顺序自定义命名key，举例：第一行: <code>_EMPTY_1</code>，第二行: <code>_EMPTY_2</code></p><ol><li>[‘第一行’,’第二行’,’第三行’]</li></ol><p>​自定义头部，按照列顺序与数组下标一一映射，不存在补为<code>_EMPTY_&#123;列数&#125;</code></p><h3 id="Text"><a href="#Text" class="headerlink" title="Text"></a>Text</h3><p>基于JS原生，无依赖，仅为下载功能</p><ul><li>工具包</li></ul><p>text.js</p><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">downloadText</span>(<span class="params">arr, fileName</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> text = <span class="string">&quot;&quot;</span></span><br><span class="line">  arr.<span class="title function_">forEach</span>(<span class="function"><span class="params">str</span> =&gt;</span> &#123;</span><br><span class="line">    text += str+<span class="string">&quot;\n&quot;</span></span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">let</span> pom = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">  pom.<span class="title function_">setAttribute</span>(<span class="string">&#x27;href&#x27;</span>, <span class="string">&#x27;data:text/plain;charset=utf-8,&#x27;</span> + <span class="built_in">encodeURIComponent</span>(text));</span><br><span class="line">  pom.<span class="title function_">setAttribute</span>(<span class="string">&#x27;download&#x27;</span>, fileName+<span class="string">&quot;.txt&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">createEvent</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> event = <span class="variable language_">document</span>.<span class="title function_">createEvent</span>(<span class="string">&#x27;MouseEvents&#x27;</span>);</span><br><span class="line">    event.<span class="title function_">initEvent</span>(<span class="string">&#x27;click&#x27;</span>, <span class="literal">true</span>, <span class="literal">true</span>);</span><br><span class="line">    pom.<span class="title function_">dispatchEvent</span>(event);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    pom.<span class="title function_">click</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><ul><li>使用</li></ul><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">downloadText</span>([<span class="string">&quot;我是第一行&quot;</span>,<span class="string">&quot;我是第二行&quot;</span>], <span class="string">&quot;这是一个txt文本文件&quot;</span>)</span><br></pre></td></tr></table></figure></div><h3 id="Pdf"><a href="#Pdf" class="headerlink" title="Pdf"></a>Pdf</h3><p>仅为pdf生成与打包压缩，压缩为可选项，基于<code>html2canvas</code>,<code>file-saver</code>,<code>JsPDF</code>,<code>JSZip</code></p><ul><li>引入</li></ul><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm install html2canvas</span><br><span class="line">npm install file-saver</span><br><span class="line">npm install jspdf</span><br><span class="line">npm install jszip</span><br></pre></td></tr></table></figure></div><ul><li>工具包</li></ul><p>pdf.js</p><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> html2canvas <span class="keyword">from</span> <span class="string">&#x27;html2canvas&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">JsPDF</span> <span class="keyword">from</span> <span class="string">&#x27;jspdf&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">JSZip</span> <span class="keyword">from</span> <span class="string">&#x27;jszip&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">FileSaver</span> <span class="keyword">from</span> <span class="string">&#x27;file-saver&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> deep = <span class="literal">true</span>;<span class="comment">// 是否深层递归</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 将指定节点元素处理为pdf并下载</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> className 元素节点class</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> filename 文件名称</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> isDeep 是否深层递归节点</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">downloadPDF</span> (<span class="params">className, filename, isDeep = <span class="literal">true</span></span>) &#123;</span><br><span class="line">  deep = isDeep;</span><br><span class="line">  <span class="comment">// 要导出pdf的节点</span></span><br><span class="line">  <span class="keyword">let</span> elements = <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(className); <span class="comment">// 需要转换的页面节点</span></span><br><span class="line">  <span class="keyword">let</span> imgMap = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> index = <span class="number">0</span>; index &lt; elements.<span class="property">length</span>; index++) &#123;</span><br><span class="line">    <span class="keyword">let</span> mapIndex = index;</span><br><span class="line">    <span class="comment">// 将元素绘制为canvas转换图片</span></span><br><span class="line">    <span class="title function_">html2canvas</span>(elements[index], &#123;</span><br><span class="line">      <span class="attr">useCORS</span>: <span class="literal">true</span>, <span class="comment">// 是否允许网页中img元素跨域，这个设置需要img元素支持及服务器支持</span></span><br><span class="line">      <span class="attr">scale</span>: <span class="number">2</span>, <span class="comment">// 这个影响生成图片的清晰度</span></span><br><span class="line">      <span class="attr">background</span>: <span class="string">&quot;#F5F5F5&quot;</span> <span class="comment">//背景</span></span><br><span class="line">    &#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">canvas</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> img = <span class="keyword">new</span> <span class="title class_">Image</span>();</span><br><span class="line">      img.<span class="property">width</span> = canvas.<span class="property">width</span>;</span><br><span class="line">      img.<span class="property">height</span> = canvas.<span class="property">height</span>;</span><br><span class="line">      img.<span class="property">src</span> = canvas.<span class="title function_">toDataURL</span>(<span class="string">&#x27;image/jpeg&#x27;</span>, <span class="number">1.0</span>);</span><br><span class="line">      imgMap.<span class="title function_">set</span>(mapIndex, img); <span class="comment">// 按照顺序保存图片</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span>(imgMap.<span class="property">size</span> === elements.<span class="property">length</span>) &#123; <span class="comment">// 当所有图片都转化完毕，则进行保存操作</span></span><br><span class="line">        <span class="keyword">let</span> pdf = <span class="keyword">new</span> <span class="title class_">JsPDF</span>(<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;pt&#x27;</span>, <span class="string">&#x27;a4&#x27;</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; imgMap.<span class="property">size</span>; i++) &#123;</span><br><span class="line">          <span class="comment">// canvas尺寸</span></span><br><span class="line">          <span class="keyword">let</span> canvasWidth = imgMap.<span class="title function_">get</span>(i).<span class="property">width</span>;</span><br><span class="line">          <span class="keyword">let</span> canvasHeight = imgMap.<span class="title function_">get</span>(i).<span class="property">height</span>;</span><br><span class="line">          <span class="keyword">let</span> pageData = imgMap.<span class="title function_">get</span>(i).<span class="property">src</span>;</span><br><span class="line">          <span class="title function_">addOneImg</span>(pdf, pageData, canvasWidth, canvasHeight);</span><br><span class="line">          <span class="keyword">if</span>(i &lt; imgMap.<span class="property">size</span>-<span class="number">1</span>) &#123;</span><br><span class="line">            pdf.<span class="title function_">addPage</span>(); <span class="comment">// 如果还有图片未添加到pdf,则增加一个页面</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 所有图片添加完毕，保存</span></span><br><span class="line">        pdf.<span class="title function_">save</span>(filename+<span class="string">&quot;.pdf&quot;</span>);</span><br><span class="line">      &#125;&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 下载PDF文件</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> className 绘制节点元素class</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> isDeep 是否深层递归</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> &#123;<span class="type">*</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span>  <span class="title function_">downloadPdfName</span> (<span class="params">className, isDeep = <span class="literal">true</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">    deep = isDeep;</span><br><span class="line">    <span class="comment">// 要导出pdf的节点</span></span><br><span class="line">    <span class="keyword">let</span> elements = <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(className); <span class="comment">// 需要转换的页面节点</span></span><br><span class="line">    <span class="keyword">let</span> imgMap = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> index = <span class="number">0</span>; index &lt; elements.<span class="property">length</span>; index++) &#123;</span><br><span class="line">      <span class="keyword">let</span> mapIndex = index;</span><br><span class="line">      <span class="comment">//将元素绘制为canvas转换图片</span></span><br><span class="line">       <span class="title function_">html2canvas</span>(elements[index], &#123;</span><br><span class="line">        <span class="attr">useCORS</span>: <span class="literal">true</span>, <span class="comment">// 是否允许网页中img元素跨域，这个设置需要img元素支持及服务器支持</span></span><br><span class="line">        <span class="attr">scale</span>: <span class="number">2</span>, <span class="comment">// 这个影响生成图片的清晰度</span></span><br><span class="line">        <span class="attr">background</span>: <span class="string">&quot;#F5F5F5&quot;</span> <span class="comment">//背景</span></span><br><span class="line">      &#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">canvas</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> img = <span class="keyword">new</span> <span class="title class_">Image</span>();</span><br><span class="line">        img.<span class="property">width</span> = canvas.<span class="property">width</span>;</span><br><span class="line">        img.<span class="property">height</span> = canvas.<span class="property">height</span>;</span><br><span class="line">        img.<span class="property">src</span> = canvas.<span class="title function_">toDataURL</span>(<span class="string">&#x27;image/jpeg&#x27;</span>, <span class="number">1.0</span>);</span><br><span class="line">        imgMap.<span class="title function_">set</span>(mapIndex, img); <span class="comment">// 按照顺序保存图片</span></span><br><span class="line">        <span class="keyword">if</span>(imgMap.<span class="property">size</span> === elements.<span class="property">length</span>) &#123; <span class="comment">// 当所有图片都转化完毕，则进行保存操作</span></span><br><span class="line">          <span class="keyword">let</span> pdf = <span class="keyword">new</span> <span class="title class_">JsPDF</span>(<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;pt&#x27;</span>, <span class="string">&#x27;a4&#x27;</span>);</span><br><span class="line">          <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; imgMap.<span class="property">size</span>; i++) &#123;</span><br><span class="line">            <span class="comment">// canvas尺寸</span></span><br><span class="line">            <span class="keyword">let</span> canvasWidth = imgMap.<span class="title function_">get</span>(i).<span class="property">width</span>;</span><br><span class="line">            <span class="keyword">let</span> canvasHeight = imgMap.<span class="title function_">get</span>(i).<span class="property">height</span>;</span><br><span class="line">            <span class="keyword">let</span> pageData = imgMap.<span class="title function_">get</span>(i).<span class="property">src</span>;</span><br><span class="line">            <span class="title function_">addOneImg</span>(pdf, pageData, canvasWidth, canvasHeight);</span><br><span class="line">            <span class="keyword">if</span>(i &lt; imgMap.<span class="property">size</span>-<span class="number">1</span>) &#123;</span><br><span class="line">              pdf.<span class="title function_">addPage</span>(); <span class="comment">// 如果还有图片未添加到pdf,则增加一个页面</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">// 所有图片添加完毕，保存</span></span><br><span class="line">          <span class="comment">// pdf.save(filename+&quot;.pdf&quot;);</span></span><br><span class="line">          <span class="keyword">let</span>  pdfBase64 = pdf.<span class="title function_">output</span>(<span class="string">&#x27;datauristring&#x27;</span>)<span class="comment">// 获取到base64 的pdf</span></span><br><span class="line">          <span class="title function_">resolve</span>(pdfBase64)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 压缩包下载</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">downloadZip</span>(<span class="params">arrPDF, name</span>) &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;下载中...&quot;</span>)</span><br><span class="line">    <span class="title function_">filesToRar</span>(arrPDF, name)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;下载完毕&quot;</span>)</span><br><span class="line">  &#125;, <span class="number">50</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 文件压缩</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">filesToRar</span>(<span class="params">arrImages, filename</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> zip = <span class="keyword">new</span> <span class="title class_">JSZip</span>()</span><br><span class="line">  <span class="keyword">const</span> cache = &#123;&#125;</span><br><span class="line">  <span class="keyword">const</span> promises = []</span><br><span class="line">  <span class="keyword">var</span> title = <span class="string">&#x27;正在加载压缩文件&#x27;</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> item <span class="keyword">of</span> arrImages) &#123;</span><br><span class="line">    <span class="keyword">const</span> promise = <span class="title function_">getImgArrayBuffer</span>(item.<span class="property">fileUrl</span>).<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 下载文件, 并存成ArrayBuffer对象(blob)</span></span><br><span class="line">      zip.<span class="title function_">file</span>(item.<span class="property">renameFileName</span>, data, &#123; <span class="attr">binary</span>: <span class="literal">true</span> &#125;) <span class="comment">// 逐个添加文件</span></span><br><span class="line">      cache[item.<span class="property">renameFileName</span>] = data</span><br><span class="line">    &#125;)</span><br><span class="line">    promises.<span class="title function_">push</span>(promise)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title class_">Promise</span>.<span class="title function_">all</span>(promises).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    zip.<span class="title function_">generateAsync</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;blob&#x27;</span> &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">content</span> =&gt;</span> &#123;</span><br><span class="line">      title = <span class="string">&#x27;正在压缩&#x27;</span></span><br><span class="line">      <span class="comment">// 生成二进制流</span></span><br><span class="line">      <span class="title class_">FileSaver</span>.<span class="title function_">saveAs</span>(content, filename) <span class="comment">// 利用file-saver保存文件  自定义文件名</span></span><br><span class="line">      title = <span class="string">&#x27;压缩完成&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;文件压缩失败：&quot;</span>+error.<span class="property">message</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取文件blob</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getImgArrayBuffer</span>(<span class="params">url</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 通过请求获取文件blob格式</span></span><br><span class="line">    <span class="keyword">const</span> xmlhttp = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span><br><span class="line">    xmlhttp.<span class="title function_">open</span>(<span class="string">&#x27;GET&#x27;</span>, url, <span class="literal">true</span>)</span><br><span class="line">    xmlhttp.<span class="property">responseType</span> = <span class="string">&#x27;blob&#x27;</span></span><br><span class="line">    xmlhttp.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="title function_">resolve</span>(<span class="variable language_">this</span>.<span class="property">response</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">reject</span>(<span class="variable language_">this</span>.<span class="property">status</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    xmlhttp.<span class="title function_">send</span>()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// img转化为pdf并保存</span></span><br><span class="line"><span class="keyword">let</span> addOneImg = <span class="keyword">function</span> (<span class="params">pdf, pageData, canvasWidth, canvasHeight</span>) &#123;</span><br><span class="line">  <span class="comment">// a4纸的尺寸[595.28,841.89]</span></span><br><span class="line">  <span class="keyword">let</span> a4Width = <span class="number">595.28</span>;</span><br><span class="line">  <span class="keyword">let</span> a4Height = <span class="number">841.89</span>;</span><br><span class="line">  <span class="comment">//html页面生成的canvas在pdf中图片的宽高</span></span><br><span class="line">  <span class="keyword">let</span> imgWidth = a4Width;</span><br><span class="line">  <span class="keyword">let</span> imgHeight = a4Width / canvasWidth * canvasHeight;</span><br><span class="line">  <span class="comment">//一页pdf显示html页面生成的canvas高度;</span></span><br><span class="line">  <span class="keyword">let</span> pageHeight = canvasWidth / a4Width * a4Height;</span><br><span class="line">  <span class="title function_">addPages</span>(pdf, pageData, <span class="number">0</span>, imgWidth, imgHeight, canvasHeight, pageHeight, a4Height);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 递归的方式对页面进行截取并添加到pdf中</span></span><br><span class="line"><span class="keyword">let</span> addPages = <span class="keyword">function</span> (<span class="params">pdf, pageData, position, imgWidth, imgHeight, canvasHeight, pageHeight, a4Height</span>) &#123;</span><br><span class="line">  pdf.<span class="title function_">addImage</span>(pageData, <span class="string">&#x27;JPEG&#x27;</span>, <span class="number">0</span>, position, imgWidth, imgHeight)</span><br><span class="line">  <span class="comment">// 减去已经绘制的区域</span></span><br><span class="line">  canvasHeight -= pageHeight;</span><br><span class="line">  position -= a4Height;</span><br><span class="line">  <span class="comment">// 当还有内容未生成pdf，则新加页面，并添加图片</span></span><br><span class="line">  <span class="keyword">if</span> (canvasHeight &gt; <span class="number">0</span> &amp;&amp; deep) &#123;</span><br><span class="line">    pdf.<span class="title function_">addPage</span>();</span><br><span class="line">    <span class="title function_">addPages</span>(pdf, pageData, position, imgWidth, imgHeight, canvasHeight, pageHeight, a4Height);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Laravel的增强极简Socket</title>
      <link href="/2025/03/12/Laravel%E8%87%AA%E5%AE%9A%E4%B9%89%E7%AE%80%E5%8D%95%E7%9A%84SOCKET%E8%BF%9E%E6%8E%A5/"/>
      <url>/2025/03/12/Laravel%E8%87%AA%E5%AE%9A%E4%B9%89%E7%AE%80%E5%8D%95%E7%9A%84SOCKET%E8%BF%9E%E6%8E%A5/</url>
      
        <content type="html"><![CDATA[<p><strong>前言</strong></p><blockquote><p>使用workman原生包</p></blockquote><ol><li><p>引包</p><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer require workerman/workerman --ignore-platform-reqs</span><br></pre></td></tr></table></figure></div><blockquote><p>–ignore-platform-reqs 是为了忽略依赖性检查，防止版本等问题产生的依赖冲突</p></blockquote></li><li><p>自定义artisan命令</p><p><strong>生成器生成</strong></p><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php artisan make:<span class="built_in">command</span> WorkermanCommand</span><br></pre></td></tr></table></figure></div><p><strong>代码</strong></p><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//命令 action：行为 -d是否守护进程</span></span><br><span class="line"><span class="keyword">protected</span> <span class="variable">$signature</span> = <span class="string">&#x27;workman &#123;action&#125; &#123;--d&#125;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span> <span class="variable">$description</span> = <span class="string">&#x27;Start a Workerman server.&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">handle</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//设置全局参数</span></span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$argv</span>;</span><br><span class="line">    <span class="variable">$action</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">argument</span>(<span class="string">&#x27;action&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$argv</span>[<span class="number">0</span>] = <span class="string">&#x27;wk&#x27;</span>;</span><br><span class="line">    <span class="variable">$argv</span>[<span class="number">1</span>] = <span class="variable">$action</span>;</span><br><span class="line">    <span class="variable">$argv</span>[<span class="number">2</span>] = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">option</span>(<span class="string">&#x27;d&#x27;</span>) ? <span class="string">&#x27;-d&#x27;</span> : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="comment">//设置端口</span></span><br><span class="line">    <span class="variable">$ws_worker</span> = <span class="keyword">new</span> <span class="title class_">Worker</span>(<span class="string">&#x27;websocket://0.0.0.0:2346&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//连接成功时的回调</span></span><br><span class="line">    <span class="comment">// Emitted when new connection come</span></span><br><span class="line">    <span class="comment">/*$ws_worker-&gt;onConnect = function ($connection) &#123;</span></span><br><span class="line"><span class="comment">        &#125;;*/</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//消费消息时的回调</span></span><br><span class="line">    <span class="variable">$ws_worker</span>-&gt;onMessage = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$connection</span>, <span class="variable">$data</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="variable">$data</span> = <span class="title function_ invoke__">json_decode</span>(<span class="variable">$data</span>);</span><br><span class="line">            <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>] = <span class="variable">$data</span>-&gt;userAgent;</span><br><span class="line">            <span class="variable">$connection</span>-&gt;<span class="title function_ invoke__">send</span>(<span class="title function_ invoke__">app</span>(<span class="string">&quot;UserService&quot;</span>)-&gt;<span class="title function_ invoke__">verifySingleTag</span>(<span class="variable">$data</span>-&gt;user, <span class="variable">$data</span>-&gt;token) ? <span class="string">&quot;true&quot;</span> : <span class="string">&quot;false&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (\<span class="built_in">Exception</span> <span class="variable">$e</span>)&#123;</span><br><span class="line">            <span class="title class_">Log</span>::<span class="title function_ invoke__">error</span>(<span class="string">&quot;SOCKET连接错误&quot;</span>,[<span class="variable">$e</span>-&gt;<span class="title function_ invoke__">getMessage</span>(),<span class="variable">$data</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//连接关闭的回调</span></span><br><span class="line">    <span class="variable">$ws_worker</span>-&gt;onClose = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$connection</span></span>) </span>&#123;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Run worker</span></span><br><span class="line">    <span class="title class_">Worker</span>::<span class="title function_ invoke__">runAll</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><blockquote><p>workerman行为在无法使用php文件单启时依赖于文件内定义全局变量来指定参数</p><p>所以使用<code>global $argv</code>来设定启动行为</p></blockquote></li><li><p>可用命令</p><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">workman start --d</span><br><span class="line">workman stop</span><br><span class="line">workman status</span><br></pre></td></tr></table></figure></div></li><li><p>写启动脚本</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup sudo su `user` -c &quot;php artisan workman start --d&quot; &gt;/dev/null 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure></div></li><li><p>注意</p><blockquote><p>此只为单进程通信接口,如果多进程通信或者需要连接控制等需要引入更多的组件</p><p>getway：网关</p><p>channel：信道</p><p>来组合控制其连接广播分发进程通信等复杂操作</p></blockquote><blockquote><p>如果服务器为云服务器记得服务器本身与云端控制<strong>放行端口</strong></p></blockquote></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> laravel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Maven基础</title>
      <link href="/2025/03/12/MAVEN/"/>
      <url>/2025/03/12/MAVEN/</url>
      
        <content type="html"><![CDATA[<p><strong>MAVEN仓库的组合命令</strong></p><ul><li><p>package</p><p><strong>依次执行了clean、resources、compile、testResources、testCompile、test、jar(打包)等７个阶段</strong></p><blockquote><p>项目编译、单元测试、打包功能，但没有把打好的可执行jar包（war包或其它形式的包）布署到本地maven仓库和远程maven私服仓库</p></blockquote></li><li><p>install</p><p><strong>依次执行了clean、resources、compile、testResources、testCompile、test、jar(打包)、install等8个阶段</strong></p><blockquote><p>项目编译、单元测试、打包功能，同时把打好的可执行jar包（war包或其它形式的包）布署到本地maven仓库，但没有布署到远程maven私服仓库</p></blockquote></li><li><p>deploy</p><p><strong>依次执行了clean、resources、compile、testResources、testCompile、test、jar(打包)、install、deploy等９个阶段</strong></p><blockquote><p>项目编译、单元测试、打包功能，同时把打好的可执行jar包（war包或其它形式的包）布署到本地maven仓库和远程maven私服仓库</p></blockquote></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> maven </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux命令</title>
      <link href="/2025/03/12/Linux/"/>
      <url>/2025/03/12/Linux/</url>
      
        <content type="html"><![CDATA[<h3 id="读"><a href="#读" class="headerlink" title="读"></a>读</h3><ul><li><p>按行输出文件内容</p><blockquote><p>tail  -<font color=red>{n}</font><a href="%E4%BB%8E%E6%9C%80%E5%90%8E"></a>   <font color=blue>{number}</font><a href="%E8%A1%8C%E6%95%B0"></a>   <font color=blue>{path}</font><a href="%E6%96%87%E4%BB%B6"></a></p></blockquote></li><li><p>检索当前存活的指定关键字进程 </p><blockquote><p>ps -ef | grep <font color=blue>{string}</font><a href="%E5%85%B3%E9%94%AE%E5%AD%97"></a> |grep -v grep</p></blockquote></li><li><p>检索指定端口的使用进程</p><blockquote><p>netstat -ntlp|grep  <font color=blue>{port}</font><a href="%E7%AB%AF%E5%8F%A3%E5%8F%B7"></a></p></blockquote></li><li><p>检索目录</p><blockquote><p>whereis <font color=blue>{dirname}</font><a href="%E7%9B%AE%E5%BD%95%E5%90%8D"></a></p></blockquote></li><li><p>查看内存更详细信息</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/meminfo |grep -E &quot;Buffer|Cache|Swap|Mem|Shmem|Slab|SReclaimable|SUnreclaim&quot;</span><br></pre></td></tr></table></figure></div></li><li><p>查看当前进程的IO使用情况</p><blockquote><p>iotop -oP</p></blockquote></li><li><p>查看内存使用情况</p><blockquote><p>free  -<font color=red>{m&#x2F;b&#x2F;g}</font><a href="%E6%8C%89MB/BYTE/GB"></a></p></blockquote></li></ul><h3 id="写"><a href="#写" class="headerlink" title="写"></a>写</h3><ul><li><p>清除内存缓存</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">清除pagecache</span></span><br><span class="line">echo 1 &gt; /proc/sys/vm/drop_caches</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">清除目录项和inode</span></span><br><span class="line">echo 2 &gt; /proc/sys/vm/drop_caches</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">清除页面缓存，目录项和inode</span></span><br><span class="line">sync &amp;&amp; echo 3 &gt; /proc/sys/vm/drop_caches</span><br></pre></td></tr></table></figure></div><blockquote><p>作用：内存会将频繁的磁盘内容加载进来缓存起来用于加速磁盘访问，内存占用过高时一般会自动释放这块内存空间，此为手动释放方法，无副作用</p></blockquote></li><li><p>杀死指定进程</p><blockquote><p>kill -9 <font color=blue>{preid}</font><a href="%E8%BF%9B%E7%A8%8BID"></a></p></blockquote></li><li><p>检索运行进程的关键字</p><blockquote><p>ps -ef | grep <font color=blue>{filename}</font><a href="%E8%BF%9B%E7%A8%8B%E5%85%B3%E9%94%AE%E5%AD%97"></a></p></blockquote></li></ul><h2 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h2><ul><li><p>GCC更新</p><blockquote><p>安装新版gcc后注意是否有原版gcc软连接存在</p></blockquote><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cc -v</span><br><span class="line">with cc</span><br><span class="line">gcc -v</span><br></pre></td></tr></table></figure></div><blockquote><p>rm -rf cc删除原版cc软连接</p><p>ln -s 新版gcc路径(例:&#x2F;usr&#x2F;local&#x2F;gcc&#x2F;bin&#x2F;gcc) cc</p><p>cc -v验证是否替换成功</p></blockquote></li><li><p>certbot命令</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">更新过期时间</span></span><br><span class="line">certbot-auto renew -v</span><br></pre></td></tr></table></figure></div></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mysql弱归档-单体场景</title>
      <link href="/2025/03/12/Mysql%208%20+%20Mybatis%20%E6%95%B0%E6%8D%AE%E5%BD%92%E6%A1%A3/"/>
      <url>/2025/03/12/Mysql%208%20+%20Mybatis%20%E6%95%B0%E6%8D%AE%E5%BD%92%E6%A1%A3/</url>
      
        <content type="html"><![CDATA[<blockquote><p>基于Mybatis</p></blockquote><p><strong>业务概述</strong></p><ul><li><strong>我为什么需要归档？</strong><ol><li>该业务数据具有周期性，超过一定周期的数据不具备价值（仅为数据追溯留作备份）</li><li>节省磁盘空间</li><li>能够优化主表性能</li></ol></li></ul><p><strong>方案</strong></p><blockquote><p>归档库 -&gt; 存储过程 -&gt; 多数据源 -&gt; 临时表标记</p></blockquote><p><strong>场景</strong></p><p>假设主库名为：master，主库与归档库均在一个账号下</p><p>具有A表与B表两个 库存日报表，其中B表是A表的子表，两个表都具备主键ID，每个月将两个表一年前的日报数据进行归档</p><h2 id="Mysql"><a href="#Mysql" class="headerlink" title="Mysql"></a>Mysql</h2><ol><li><p>建立归档库</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create schema archive;</span><br></pre></td></tr></table></figure></div></li><li><p>拷贝目标表</p><blockquote><p>归档库采用MyISAM引擎来优化空间与性能，同时仅拷贝了表结构本身，放弃所有索引</p></blockquote><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE A</span><br><span class="line">    ENGINE = MyISAM</span><br><span class="line">AS</span><br><span class="line">SELECT * FROM master.A WHERE 1=0;</span><br><span class="line">CREATE TABLE A</span><br><span class="line">    ENGINE = MyISAM</span><br><span class="line">AS</span><br><span class="line">SELECT * FROM master.B WHERE 1=0;</span><br></pre></td></tr></table></figure></div></li><li><p>编写存储过程</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER //</span><br><span class="line">CREATE PROCEDURE ArchiveAAndB()</span><br><span class="line">BEGIN</span><br><span class="line">    # 建立临时表记录需要归档目标</span><br><span class="line">    CREATE TEMPORARY TABLE temp(id bigint unsigned);</span><br><span class="line">    # 将master库A表内12个月前的待归档目标写入到临时表</span><br><span class="line">    INSERT INTO archive.temp (</span><br><span class="line">        SELECT id FROM master.A WHERE date &lt; DATE_SUB(NOW(), INTERVAL 12 MONTH)</span><br><span class="line">    );</span><br><span class="line">    # 将master库写入archive库</span><br><span class="line">    INSERT INTO archive.B (</span><br><span class="line">        SELECT * FROM master.B WHERE a_id IN (SELECT temp.id FROM temp)</span><br><span class="line">    );</span><br><span class="line">    INSERT INTO archive.A (</span><br><span class="line">        SELECT * FROM master.A WHERE id IN (SELECT temp.id FROM temp)</span><br><span class="line">    );</span><br><span class="line">    # 删除原库数据</span><br><span class="line">    DELETE FROM master.B WHERE a_id IN (SELECT temp.id FROM temp);</span><br><span class="line">    DELETE FROM master.A WHERE id IN (SELECT temp.id FROM temp);</span><br><span class="line">    # 删除临时表</span><br><span class="line">    DROP TABLE temp;</span><br><span class="line">END;</span><br><span class="line">//</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure></div><ul><li><strong>为什么要建临时表来过渡？</strong><br>此处我的业务场景下具备两个条件：1. 每个表都具备主键或与主键的关联字段    2. 真实场景下的表数量与结构更为复杂且考虑该同步是一个耗时动作防止出现执行期间可重复读的场景下有意外的命中偏差</li></ul></li></ol><h2 id="Mybatis"><a href="#Mybatis" class="headerlink" title="Mybatis"></a>Mybatis</h2><blockquote><p>多数据源我使用：com.baomidou.dynamic.datasource，在nacos进行配置，这个不多赘述</p></blockquote><ol><li><p>对应服务增加多数据源配置archive库</p></li><li><p>增加一个数据源常量</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DataSourceConsts</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">MASTER</span> <span class="operator">=</span> <span class="string">&quot;master&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">ARCHIVE</span> <span class="operator">=</span> <span class="string">&quot;archive&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">interface</span> <span class="title class_">Archive</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">TEST</span> <span class="operator">=</span> ARCHIVE + <span class="string">&quot;-test&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li><li><p>增加归档库数据服务类</p><blockquote><p>此处假设你已经存在数据接口与数据服务类，为原数据服务类增加@Primary注解，如下所示</p></blockquote><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ITestDataService</span> <span class="keyword">extends</span> <span class="title class_">IService</span>&lt;Test&gt; &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">archive</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 为原数据服务类增加注解 @Primary</span></span><br><span class="line"><span class="meta">@Primary</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor(onConstructor_ = &#123;@Lazy,@Autowired&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestDataServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;TestMapper, Test&gt; <span class="keyword">implements</span> <span class="title class_">ITestDataService</span> &#123;</span><br><span class="line">    <span class="comment">// 可以选择在数据接口写接口这里实现也可以直接写公有方法，取决于你依赖注入时是直接注入归档实现类还是注入接口声明bean</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">archive</span><span class="params">()</span> &#123;</span><br><span class="line">        baseMapper.archive();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li><li><p>建立一个归档数据服务类-继承主类，指定数据源与bean名称，防止干扰主库正常业务</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service(DataSourceConsts.Archive.TEST)</span></span><br><span class="line"><span class="meta">@DS(DataSourceConsts.ARCHIVE)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestArchiveDataServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">TestDataServiceImpl</span> &#123; <span class="comment">// 注意直接继承原数据服务类即可</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TestArchiveDataServiceImpl</span><span class="params">(Test1Service test1Service)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(test1Service);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">TestMapper</span> <span class="keyword">extends</span> <span class="title class_">BaseMapper</span>&lt;Test&gt; &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">archive</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// SQL XML</span></span><br><span class="line">&lt;update id=<span class="string">&quot;archive&quot;</span> statementType=<span class="string">&quot;CALLABLE&quot;</span>&gt;</span><br><span class="line">    &#123; CALL <span class="title function_">ArchiveAAndB</span><span class="params">()</span> &#125;</span><br><span class="line">&lt;/update&gt;</span><br></pre></td></tr></table></figure></div></li><li><p>依赖注入与调用</p></li></ol><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/test&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestController</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> ITestDataService dataService;</span><br><span class="line">    <span class="keyword">private</span> ITestDataService archiveDataService;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TestController</span><span class="params">(ITestDataService dataService, </span></span><br><span class="line"><span class="params">                          <span class="meta">@Qualifier(DataSourceConsts.Archive.TEST)</span> ITestDataService archiveDataService)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.dataService = dataService;</span><br><span class="line">        <span class="built_in">this</span>.archiveDataService = archiveDataService;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GetMapping</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">        archivedDataService.archive();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mysql自定义函数生成序列号</title>
      <link href="/2025/03/12/Mysql%20%E8%87%AA%E5%AE%9A%E4%B9%89%20%E5%BA%8F%E5%88%97%E6%B5%81%E6%B0%B4%E5%8F%B7/"/>
      <url>/2025/03/12/Mysql%20%E8%87%AA%E5%AE%9A%E4%B9%89%20%E5%BA%8F%E5%88%97%E6%B5%81%E6%B0%B4%E5%8F%B7/</url>
      
        <content type="html"><![CDATA[<p><strong>概述</strong></p><blockquote><p>一个通用场景，生成可读性单号（订单号，流水号等）<br>一般实现由服务端通过缓存&#x2F;内存序列自记录等方式完成，Database一般存储过程 函数完成</p></blockquote><h2 id="Mysql自实现多场景"><a href="#Mysql自实现多场景" class="headerlink" title="Mysql自实现多场景"></a>Mysql自实现多场景</h2><p><strong>概述</strong></p><blockquote><p>一个函数为多表，按天等多种场景服务来无感使用</p></blockquote><h3 id="建表-函数"><a href="#建表-函数" class="headerlink" title="建表,函数"></a>建表,函数</h3><div class="code-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 序列表-记录全部表的流水 序列号</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> serial_number(</span><br><span class="line">                              table_name <span class="type">varchar</span>(<span class="number">191</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">                              <span class="type">date</span> <span class="type">varchar</span>(<span class="number">10</span>),</span><br><span class="line">                              <span class="keyword">value</span> <span class="type">int</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">ALTER TABLE</span> serial_number</span><br><span class="line">    <span class="keyword">ADD</span> <span class="keyword">PRIMARY KEY</span> (table_name, <span class="type">date</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 函数-获取某个业务下的序列号 传参</span></span><br><span class="line"><span class="comment">-- table_name_in： 表名/业务名</span></span><br><span class="line"><span class="comment">-- by_day：是否按天生成</span></span><br><span class="line">DELIMITER <span class="operator">/</span><span class="operator">/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> GET_SERIAL_NUMBER(table_name_in <span class="type">VARCHAR</span>(<span class="number">191</span>), by_day <span class="type">boolean</span>) <span class="keyword">RETURNS</span> <span class="type">INT</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="comment">-- 预定义变量 日期标识 在不指定日期时默认 *</span></span><br><span class="line">    <span class="keyword">DECLARE</span> date_in <span class="type">varchar</span>(<span class="number">10</span>);</span><br><span class="line">    <span class="comment">-- 返回的序列结果</span></span><br><span class="line">    <span class="keyword">DECLARE</span> <span class="keyword">result</span> <span class="type">INT</span>;</span><br><span class="line">    <span class="comment">-- 设置真实日期值 如果指定了日期为当天 如果没有为 *</span></span><br><span class="line">    <span class="keyword">SET</span> date_in <span class="operator">=</span> IF(by_day, DATE_FORMAT(CURDATE(), <span class="string">&#x27;%Y-%m-%d&#x27;</span>), <span class="string">&#x27;*&#x27;</span>);</span><br><span class="line">    <span class="comment">-- 如果序列表存在目标序列 自增 如果不存在 建立 初始值1</span></span><br><span class="line">    <span class="keyword">INSERT INTO</span> serial_number (table_name, <span class="type">date</span>, `<span class="keyword">value</span>`)</span><br><span class="line">    <span class="keyword">VALUES</span> (table_name_in, date_in, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">ON</span> DUPLICATE KEY <span class="keyword">UPDATE</span> `<span class="keyword">value</span>` <span class="operator">=</span> `<span class="keyword">value</span>` <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">    <span class="comment">-- 查询最后的序列值 并返回 这里可能会有并发的风险 如果场景需要可以采用事务隔离</span></span><br><span class="line">    <span class="keyword">SELECT</span> s.`<span class="keyword">value</span>` <span class="keyword">INTO</span> <span class="keyword">result</span></span><br><span class="line">    <span class="keyword">FROM</span> serial_number s</span><br><span class="line">    <span class="keyword">WHERE</span> s.table_name <span class="operator">=</span> table_name_in</span><br><span class="line">      <span class="keyword">AND</span> s.date <span class="operator">=</span> date_in;</span><br><span class="line">    <span class="keyword">RETURN</span> <span class="keyword">result</span>;</span><br><span class="line"><span class="keyword">END</span> <span class="operator">/</span><span class="operator">/</span></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure></div><h3 id="示例使用"><a href="#示例使用" class="headerlink" title="示例使用"></a>示例使用</h3><div class="code-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 生成一个 SO + Ymd格式日期 + 填充0字符 + 序列号</span></span><br><span class="line"><span class="keyword">SELECT</span> (CONCAT(<span class="string">&#x27;SO&#x27;</span>, DATE_FORMAT(CURDATE(), <span class="string">&#x27;%Y%m%d&#x27;</span>),</span><br><span class="line">    LPAD(GET_SERIAL_NUMBER(<span class="string">&#x27;order&#x27;</span>, <span class="literal">true</span>), <span class="number">5</span>, <span class="string">&#x27;0&#x27;</span>));</span><br><span class="line"><span class="comment">-- 示例结果</span></span><br><span class="line">SO2024010800001</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP基础</title>
      <link href="/2025/03/12/PHP/"/>
      <url>/2025/03/12/PHP/</url>
      
        <content type="html"><![CDATA[<h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><h3 id="概论"><a href="#概论" class="headerlink" title="概论"></a>概论</h3><ul><li>PHP中变量区分大小写</li><li>初始化&gt;数组&gt;字符串&gt;浮点型&gt;整型</li><li>字符串嵌套字符串时可以单引号嵌套双引号或双引号嵌套单引号，或使用\来转义</li><li>单引号包含变量时会将变量当作字符串输出而双引号则会将变量内容链接起来</li><li>长字符串超出一行时使用Heredoc结构形式：首先使用定界符 &lt;&lt;&lt; 然后使用标识符，结尾已此标识符结束</li></ul><blockquote><p>定界符示意：</p><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$string</span>= <span class="string">&lt;&lt;&lt;GOD</span></span><br><span class="line"><span class="string">    **************************</span></span><br><span class="line"><span class="string">    **************************</span></span><br><span class="line"><span class="string">GOD</span>;   </span><br></pre></td></tr></table></figure></div></blockquote><ul><li><p>NULL（NULL）：NULL是空类型，对大小写不敏感，NULL类型只有一个取值</p><blockquote><p>表示一个变量没有值，当被赋值为NULL，或者尚未被赋值，或者被unset()，这三种情况下变量被认为为NULL</p></blockquote></li><li><p>系统常量：<strong>FILE</strong>:PHP程序文件名，<strong>LINE</strong> :PHP程序文件行数，PHP_VERSION:当前解析器的版本号，PHP_OS：执行当前PHP版本的操作系统名称</p></li><li><p>&amp;引用赋值符：指针指向引用对象,引用的对象变化它也随之变化.。例：$c&#x3D;&amp;$a;  a变c也变</p></li><li><p>三元运算符：$b&#x3D;$a&gt;&#x3D;60?’及格’:’不及格’;          判断?正确:错误</p></li><li><p>&#x3D;&#x3D;判断值相等  &#x3D;&#x3D;&#x3D;不仅值，类型也相等   !&#x3D;&#x3D;值或类型不同</p></li><li><p>xor  有切仅有一个结果为True返回True 例：$a xor $b</p></li><li><p>连接赋值运算符(“.&#x3D;”)：它将右边参数附加到左边的参数后。</p></li><li><p>创建数组：<code>$arr = array();</code></p><blockquote><p>PHP中数组使用：&#x3D;&gt; 来分隔键和值    PHP中允许键为字符串形成关联数组</p></blockquote></li></ul><h3 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h3><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> $变量名=<span class="string">&quot;&quot;</span>;</span><br></pre></td></tr></table></figure></div><h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><ul><li><p>循环</p><blockquote><p>foreach($变量名 as $key &#x3D;&gt; $v){} 遍历数组</p></blockquote></li><li><p>类</p><blockquote><p>Class 类名{};</p></blockquote></li><li><p>方法</p><blockquote><p>function 方法名(){}; </p><p>调用使用”-&gt;”</p></blockquote></li><li><p>构造函数</p><blockquote><p>function  __construct(){};&#x2F;&#x2F;初始化执行</p></blockquote></li><li><p>析构函数</p><blockquote><p>function __destruct(){};&#x2F;&#x2F;销毁执行</p></blockquote></li><li><p>静态函数</p><blockquote><p>static关键字</p><p>方法内<code>self::</code>调用,外部直接<code>类名::方法名</code></p></blockquote></li><li><p>重载</p><blockquote><p>方法的重载通过 <code>__call($name,$agrs)&#123;&#125;;</code></p><p>属性重载：__set:赋值,__get:取值,__isset:判断,__unset:销毁</p></blockquote></li><li><p>对象拷贝</p><blockquote><p><strong>clone</strong>，例：<code>$b=clone $a;</code></p></blockquote></li></ul><h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><h3 id="系统函数"><a href="#系统函数" class="headerlink" title="系统函数"></a>系统函数</h3><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取当前php消耗的内存</span></span><br><span class="line"><span class="title function_ invoke__">memory_get_usage</span>()；</span><br><span class="line"><span class="comment">//输出数据类型</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$data</span>);</span><br><span class="line"><span class="comment">//打开文件</span></span><br><span class="line"><span class="title function_ invoke__">fopen</span>(<span class="string">&quot;PATH&quot;</span>,<span class="string">&quot;r&quot;</span>);</span><br><span class="line"><span class="comment">//连接数据库</span></span><br><span class="line"><span class="title function_ invoke__">mysql_connect</span>(<span class="string">&quot;路径IP&quot;</span>,<span class="string">&quot;账号&quot;</span>,<span class="string">&quot;密码&quot;</span>):</span><br><span class="line"><span class="comment">//图形画布 </span></span><br><span class="line"><span class="title function_ invoke__">imagecreate</span>(长,宽);</span><br><span class="line"><span class="comment">//释放销毁资源</span></span><br><span class="line"><span class="keyword">unset</span>();</span><br><span class="line"><span class="comment">//定义常量</span></span><br><span class="line"><span class="comment">//第一个参数name为必选参数，常量名称,即标志符，常量的命名规则与变量的一致,不带美元符号</span></span><br><span class="line"><span class="comment">//第二个参数value为必选参数，常量值</span></span><br><span class="line"><span class="comment">//第三个参数“case_sensitive”为可选参数，指定是否大小写敏感,默认false</span></span><br><span class="line"><span class="title function_ invoke__">define</span>(name,value,case_sensitive);</span><br><span class="line"><span class="comment">//取常量</span></span><br><span class="line"><span class="title function_ invoke__">constant</span>(name)</span><br><span class="line"><span class="comment">//随机数</span></span><br><span class="line"><span class="title function_ invoke__">rand</span>(<span class="keyword">int</span>,<span class="keyword">int</span>)</span><br><span class="line"><span class="comment">//设置一个cookie</span></span><br><span class="line"><span class="title function_ invoke__">setcookie</span>(key,value);</span><br><span class="line"><span class="comment">//设置一个SESSION</span></span><br><span class="line"><span class="variable">$_SESSION</span>(<span class="string">&#x27;name&#x27;</span>)=<span class="string">&#x27;value&#x27;</span>;</span><br><span class="line"><span class="comment">//初始化session</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="comment">//销毁session 不会立即销毁 等待下次访问时才会失效</span></span><br><span class="line"><span class="title function_ invoke__">session_destroy</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//唤起cmd运行命令</span></span><br><span class="line">--command 命令 执行一个文件时必须使用绝对路径，相对路径不识别</span><br><span class="line">--output 全部输出，指针写入数组</span><br><span class="line">--val 返回值，最后输出</span><br><span class="line"><span class="title function_ invoke__">exec</span>(command,*output,*val);</span><br><span class="line"></span><br><span class="line"><span class="comment">//后台运行一个文件</span></span><br><span class="line"><span class="title function_ invoke__">pclose</span>(<span class="title function_ invoke__">popen</span>(<span class="string">&quot;命令&quot;</span>,<span class="string">&#x27;r&#x27;</span>));</span><br></pre></td></tr></table></figure></div><ul><li>数组</li></ul><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//过滤数组</span></span><br><span class="line">--<span class="keyword">array</span> 被过滤对象</span><br><span class="line">--callback 执行过滤的闭包</span><br><span class="line">--flag 传递给闭包的参数： ARRAY_FILTER_USE_KEY - callback 接受键名作为的唯一参数</span><br><span class="line">                         ARRAY_FILTER_USE_BOTH - callback 同时接受键名和键值</span><br><span class="line"><span class="title function_ invoke__">array_filter</span>(*<span class="keyword">array</span>,callback,flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">//反转键值</span></span><br><span class="line"><span class="title function_ invoke__">array_flip</span>(<span class="keyword">array</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//提取key为新数组</span></span><br><span class="line"><span class="title function_ invoke__">array_keys</span>(<span class="keyword">array</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//提取value为新数组</span></span><br><span class="line"><span class="title function_ invoke__">array_values</span>(<span class="keyword">array</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//对比两个数组差异，返回数组1中存在 数组2中不存在的数据为新数组</span></span><br><span class="line"><span class="title function_ invoke__">array_diff</span>(array1,array2)</span><br><span class="line"></span><br><span class="line"><span class="comment">//提取二维数组对象的key值为新数组</span></span><br><span class="line">--<span class="keyword">array</span>为二维数组对象 [&#123;<span class="string">&quot;a&quot;</span>=&gt;<span class="string">&quot;b&quot;</span>&#125;]</span><br><span class="line">--objKey为第二维对象的key</span><br><span class="line"><span class="title function_ invoke__">array_column</span>(<span class="keyword">array</span>,objKey)</span><br></pre></td></tr></table></figure></div><h2 id="规范"><a href="#规范" class="headerlink" title="规范"></a>规范</h2><h3 id="PSR1"><a href="#PSR1" class="headerlink" title="PSR1"></a>PSR1</h3><blockquote><p>PHP标签：文件只能使用</p><p>字符编码：文件必须仅使用UTF-8，而不能将BOM用于PHP代码。</p><p>携带BOM的文件是微软的习惯，在windows中有专门的api去处理它，如果项目转移至UNIX将会造成一些问题。</p><p>副作用：一个文件应该声明新的符号(类、函数、常量等)，并且不产生其他副作用，或者它应该执行带有副作用的逻辑，但是不应该两者都做。</p><blockquote><p>短语“副作用”是指执行与声明类、函数、常量等不直接相关的逻辑，而仅仅是包含文件。</p><p>“副作用”包括但不限于:生成输出、显式使用require或include、连接到外部服务、修改ini设置、发出错误或异常、修改全局或静态变量、从文件读写，等等。</p></blockquote><p>命名空间和类名：名称空间和类必须遵循“自动加载”PSR: [PSR-0, PSR-4]。这意味着每个类单独位于一个文件中，并且在至少一个级别的名称空间中:顶级供应商名称。类名必须用StudlyCaps声明。</p><p>PHP5.2之前类名的声明需要带前缀Vendor_,例：Vendor_ 类名</p><p>​类常量、属性和方法：常量：术语“类”指所有的类、接口和特征。类常量必须用下划线分隔符以大写形式声明；</p><p>属性：本指南有意避免任何关于使用$StudlyCaps、$camelCase或$under_score属性名的建议。</p><p>使用的任何命名约定都应该在合理的范围内一致地应用。该范围可以是供应商级、包级、类级或方法级。</p><p>方法：方法名必须在camelCase()中声明。</p></blockquote><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><h3 id="PHPUNIT"><a href="#PHPUNIT" class="headerlink" title="PHPUNIT"></a>PHPUNIT</h3><blockquote><p>对于每个测试的运行，PHPUnit 命令行工具输出一个字符来指示进展,当测试成功时输出。</p><blockquote><p>F 当测试方法运行过程中一个断言失败时输出</p><p>E 当测试方法运行过程中产生一个错误时输出</p><p>R 当测试被标记为有风险时输出</p><p>S 当测试被跳过时输出</p><p>I 当测试被标记为不完整或未实现时输出</p></blockquote><p>分两种测试：代码前测试，测试驱动开发(TDD)</p><blockquote><p>代码后测试，测试验证开发，在controller中配置，自动加载建立test与controller关联，通过路由测试，断言路由，提供入口断言出口</p></blockquote><p>基境：setUp tearDown 每个测试方法执行前后</p><p><strong>构造方法，注释声明</strong></p><blockquote><p>@depends 方法名      声明依赖，被依赖的方法可return一个值供依赖项使用</p><p><del>注意：200状态码为正常返回，302代表重定向(可能被拦截)如有加密，用户认证，权限等设置需要伪造。</del></p><p>传递Request参数时直接在路由后添加data数组即可</p><p>在使用多个@depends时注意方法参数的顺序要与注释里一致，不然报错找不到对应类</p></blockquote></blockquote><h4 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h4><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">生成代码覆盖率报告</span></span><br><span class="line">phpunit --coverage-html ./tests/codeCoverage</span><br></pre></td></tr></table></figure></div><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="CURL"><a href="#CURL" class="headerlink" title="CURL"></a>CURL</h3><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$token</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$token_decode</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$token</span>);</span><br><span class="line"><span class="comment">//zlibDecompress($token_decode);</span></span><br><span class="line"><span class="comment">//$result = unpack(&quot;Chead/C3string/C4number&quot;,$token_decode);</span></span><br><span class="line"><span class="variable">$cookieFile</span> = <span class="title function_ invoke__">dirname</span>(<span class="keyword">__FILE__</span>).<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable">$loginUrl</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable">$url</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable">$data</span>=<span class="keyword">array</span>(<span class="string">&#x27;email&#x27;</span>=&gt;<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;password&#x27;</span>=&gt;<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="variable">$ch</span>=<span class="title function_ invoke__">curl_init</span>();</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>,CURLOPT_URL,<span class="variable">$loginUrl</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>,CURLOPT_POST,<span class="literal">true</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>,CURLOPT_HEADER,<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>,CURLOPT_POSTFIELDS,<span class="variable">$data</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>,CURLOPT_COOKIEJAR,<span class="variable">$cookieFile</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_COOKIEFILE, <span class="variable">$cookieFile</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>,CURLOPT_RETURNTRANSFER,<span class="literal">true</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_SSL_VERIFYPEER, <span class="literal">false</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_SSL_VERIFYHOST, <span class="literal">false</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_FOLLOWLOCATION, <span class="number">1</span>);</span><br><span class="line"><span class="variable">$ret</span> = <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//输出</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$ret</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP杂项小记</title>
      <link href="/2025/03/12/PHP%E8%B7%AF%E7%A8%8B%E6%9D%82%E9%A1%B9/"/>
      <url>/2025/03/12/PHP%E8%B7%AF%E7%A8%8B%E6%9D%82%E9%A1%B9/</url>
      
        <content type="html"><![CDATA[<h2 id="Composer"><a href="#Composer" class="headerlink" title="Composer"></a>Composer</h2><h3 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h3><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#更新依赖时忽略版本更新</span></span><br><span class="line">composer update --ignore-platform-reqs</span><br><span class="line"><span class="comment">#安装依赖，vendor/package代指目标项目</span></span><br><span class="line">composer require vendor/package</span><br><span class="line"><span class="comment">#生成本地依赖库</span></span><br><span class="line">composer install</span><br><span class="line"><span class="comment">#更新包,不指定vendor/package则更新所有</span></span><br><span class="line">composer update [vendor/package]</span><br><span class="line"><span class="comment">#删除包</span></span><br><span class="line">composer remove vendor/package</span><br></pre></td></tr></table></figure></div><h2 id="Swoole"><a href="#Swoole" class="headerlink" title="Swoole"></a>Swoole</h2><ul><li>HTTPS配置</li></ul><blockquote><p>swoole配置https时需要声明ssl</p></blockquote><ul><li><img                       lazyload                     src="/images/loading.svg"                     data-src="http://49.232.5.44:8000/storage/links/211201-aa4e412d-9b04-4170-8ce2-492851805c95.png"                      alt="avatar"                ></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring自定义验证注解</title>
      <link href="/2025/03/12/SPRING%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E5%BA%93%E5%94%AF%E4%B8%80%E9%AA%8C%E8%AF%81%E6%B3%A8%E8%A7%A3-Valid/"/>
      <url>/2025/03/12/SPRING%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E5%BA%93%E5%94%AF%E4%B8%80%E9%AA%8C%E8%AF%81%E6%B3%A8%E8%A7%A3-Valid/</url>
      
        <content type="html"><![CDATA[<h2 id="自定义数据库唯一验证注解-Valid"><a href="#自定义数据库唯一验证注解-Valid" class="headerlink" title="自定义数据库唯一验证注解-Valid"></a>自定义数据库唯一验证注解-Valid</h2><p><strong>前提</strong></p><blockquote><p>集成MybatisPlus</p></blockquote><p><strong>限制</strong></p><blockquote><p>暂时只加了单一验证，如需额外操作(修改操作时的摒弃本身数据)等需自扩展</p></blockquote><h2 id="1-定义注解接口"><a href="#1-定义注解接口" class="headerlink" title="1. 定义注解接口"></a>1. 定义注解接口</h2><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xxx.validate.DataUniqueAnally;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.validation.Constraint;</span><br><span class="line"><span class="keyword">import</span> javax.validation.Payload;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用以对指定实体类字段做唯一验证，已存在则验证失败</span></span><br><span class="line"><span class="comment"> * 注意此处去除了DS指定，通过mybatisplus工具取entity SqlSession会话工厂</span></span><br><span class="line"><span class="comment"> * 所以如果一个如果你的实体类数据源被标记在具体业务实现类上，应同时在实体类上标注数据源/否则数据源差异</span></span><br><span class="line"><span class="comment"> * 考虑现有场景目前不支持泛型仅String数据</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Target(ElementType.FIELD)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Constraint(validatedBy = DataUniqueAnally.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> UniqueValid &#123;</span><br><span class="line">    String <span class="title function_">message</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;数据已经存在,重复操作!&quot;</span>;</span><br><span class="line">    Class&lt;?&gt; entity();<span class="comment">// 对应表</span></span><br><span class="line">    String <span class="title function_">field</span><span class="params">()</span>;<span class="comment">// 对应字段</span></span><br><span class="line">    Class&lt;?&gt;[] groups() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">    Class&lt;? <span class="keyword">extends</span> <span class="title class_">Payload</span>&gt;[] payload() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>其中 <code>entity</code> <code>field</code>为自定义参数，需要通过其反射获取一些必要工具</p><p>constraint注解定义其实现类</p><h2 id="2-实现类"><a href="#2-实现类" class="headerlink" title="2. 实现类"></a>2. 实现类</h2><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.toolkit.SqlHelper;</span><br><span class="line"><span class="keyword">import</span> xxx.UniqueValid;</span><br><span class="line"><span class="keyword">import</span> xxx.SqlUtils;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.validation.ConstraintValidator;</span><br><span class="line"><span class="keyword">import</span> javax.validation.ConstraintValidatorContext;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * DS数据源取entity定义数据源 需要切换数据源请在entity上注解DS而非具体业务实现类</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataUniqueAnally</span> <span class="keyword">implements</span> <span class="title class_">ConstraintValidator</span>&lt;UniqueValid, String&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> Class&lt;?&gt; entity;</span><br><span class="line">    <span class="keyword">private</span> String field;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取注解属性值</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> constraintAnnotation 约束注解</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">(UniqueValid constraintAnnotation)</span> &#123;</span><br><span class="line">        entity = constraintAnnotation.entity();</span><br><span class="line">        field = constraintAnnotation.field();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isValid</span><span class="params">(String value, ConstraintValidatorContext context)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (value == <span class="literal">null</span> || value.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(<span class="string">&quot;SELECT &quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">table</span> <span class="operator">=</span> SqlHelper.table(entity).getTableName();</span><br><span class="line">        sql.append(field).append(<span class="string">&quot; FROM &quot;</span>).append(table).append(<span class="string">&quot; WHERE &quot;</span>)</span><br><span class="line">                .append(field).append(<span class="string">&quot; = &#x27;&quot;</span>).append(value).append(<span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line">        <span class="type">SqlSessionFactory</span> <span class="variable">sessionFactory</span> <span class="operator">=</span> SqlHelper.sqlSessionFactory(entity);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> !SqlUtils.isDataExist(sql.toString(), sessionFactory);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">            log.error(<span class="string">&quot;验证数据唯一性失败，SQL错误：&#123;&#125;&quot;</span>, sql.toString());</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h2 id="3-执行工具包"><a href="#3-执行工具包" class="headerlink" title="3. 执行工具包"></a>3. 执行工具包</h2><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.beanutils.BeanMap;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.mapping.BoundSql;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.mapping.ParameterMapping;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.mapping.ParameterMode;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * SQL额外工具包</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SqlUtils</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isDataExist</span><span class="params">(String sql, SqlSessionFactory sqlSessionFactory)</span> <span class="keyword">throws</span> SQLException&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> sqlSessionFactory.openSession().getConnection();</span><br><span class="line">        <span class="type">String</span> <span class="variable">jdbc</span> <span class="operator">=</span> connection.getMetaData().getDatabaseProductName();</span><br><span class="line">        <span class="keyword">switch</span> (jdbc) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;MySQL&quot;</span>:</span><br><span class="line">                sql += <span class="string">&quot; LIMIT 1&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;Oracle&quot;</span>:</span><br><span class="line">                sql = <span class="string">&quot;SELECT * FROM (&quot;</span>.concat(sql).concat(<span class="string">&quot;) WHERE ROWNUM = 1&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">SQLException</span>(<span class="string">&quot;判断数据存在性：不支持的数据库驱动&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> statement.executeQuery(sql);</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> rs.next();</span><br><span class="line">        connection.close();</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="4-使用方式"><a href="#4-使用方式" class="headerlink" title="4. 使用方式"></a>4. 使用方式</h2><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@UniqueValid(entity = &#123;Entity&#125;.class, field = &#123;Entity.filed&#125;)</span></span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      
        <tags>
            
            <tag> spring </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring接口幂等验证</title>
      <link href="/2025/03/12/SPRINGBOOT%20%E6%8E%A5%E5%8F%A3%E5%B9%82%E7%AD%89%E9%AA%8C%E8%AF%81/"/>
      <url>/2025/03/12/SPRINGBOOT%20%E6%8E%A5%E5%8F%A3%E5%B9%82%E7%AD%89%E9%AA%8C%E8%AF%81/</url>
      
        <content type="html"><![CDATA[<p>简述概念</p><blockquote><p>用户对于同一操作发起的一次请求或者多次请求的结果是一致的,不会因为多次点击而产生了副作用</p></blockquote><p>实现：</p><h4 id="1-依赖"><a href="#1-依赖" class="headerlink" title="1. 依赖"></a>1. 依赖</h4><div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-collections4<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></div><h4 id="2-工具包"><a href="#2-工具包" class="headerlink" title="2. 工具包"></a>2. 工具包</h4><p>存储介质为<strong>程序运行内存</strong>，大多使用REDIS，FILE IO等存储介质</p><p>存储策略为 <strong>LRU</strong>（Least recently used:最近最少使用）</p><h5 id="约束"><a href="#约束" class="headerlink" title="约束"></a>约束</h5><blockquote><p>简化使用约束客户端请求时头部必须携带一个公有消息ID<br>服务端对此消息ID做弱验证，仅当请求包含此标识且服务端对应方法发起验证时才做幂等验证</p></blockquote><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RequestUtils</span> &#123;</span><br><span class="line">    <span class="comment">// 获取REQUEST对象 spring-web包提供</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">ServletRequestAttributes</span> <span class="variable">ATTRIBUTES</span> <span class="operator">=</span> (ServletRequestAttributes)RequestContextHolder.getRequestAttributes();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 幂等</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Idempotent</span>&#123;</span><br><span class="line">        <span class="comment">// 根据 LRUMap 集合，最大容量 100 个</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> LRUMap&lt;String, Integer&gt; CACHE = <span class="keyword">new</span> <span class="title class_">LRUMap</span>&lt;&gt;(<span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">check</span><span class="params">(Class&lt;?&gt; lockClass)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (ATTRIBUTES == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// CustomHttpHeaderConsts为自定义请求头 被NGINX放行</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">id</span> <span class="operator">=</span> ATTRIBUTES.getRequest().getHeader(CustomHttpHeaderConsts.MESSAGE_ID);</span><br><span class="line">            check(id, lockClass);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">check</span><span class="params">(String messageId, Class&lt;?&gt; lockClass)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (messageId == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!judge(messageId, lockClass)) &#123;</span><br><span class="line">                <span class="comment">// 自定义了一个全局运行异常代码抛出以告诉客户端</span></span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RunException</span>(CodeEnum.REQUEST_REPEAT);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 审判</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> id 幂等ID</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> lockClass 类同步锁</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span> 审判结果：TRUE为允许，FALSE为禁止</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">judge</span><span class="params">(String id, Class&lt;?&gt; lockClass)</span> &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (lockClass) &#123;</span><br><span class="line">                <span class="comment">// 重复请求判断</span></span><br><span class="line">                <span class="keyword">if</span> (CACHE.containsKey(id)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 非重复请求，存储请求 ID</span></span><br><span class="line">                CACHE.put(id, <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h4 id="3-使用"><a href="#3-使用" class="headerlink" title="3. 使用"></a>3. 使用</h4><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RequestUtils.Idempotent.check(getClass());</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> spring </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQL基础</title>
      <link href="/2025/03/12/SQL/"/>
      <url>/2025/03/12/SQL/</url>
      
        <content type="html"><![CDATA[<h1 id="Mysql"><a href="#Mysql" class="headerlink" title="Mysql"></a>Mysql</h1><h2 id="基础架构"><a href="#基础架构" class="headerlink" title="基础架构"></a>基础架构</h2><blockquote><p>分为Server层和存储引擎层两部分</p></blockquote><h3 id="Server层"><a href="#Server层" class="headerlink" title="Server层"></a>Server层</h3><h4 id="连接器"><a href="#连接器" class="headerlink" title="连接器"></a>连接器</h4><blockquote><p>负责跟客户端建立连接、获取权限、维持和管理连接</p></blockquote><h4 id="查询缓存"><a href="#查询缓存" class="headerlink" title="查询缓存"></a>查询缓存</h4><blockquote><p>拿到一个查询请求先去缓存中查看，存在直接返回</p></blockquote><p><strong>查询缓存往往弊大于利。</strong> 查询缓存的失效非常频繁，只要有对一个表的更新，这个表上所有的查询缓存都会被清空。</p><p>MySQL 8.0 版本直接将查询缓存的整块功能删掉了。</p><h4 id="分析器"><a href="#分析器" class="headerlink" title="分析器"></a>分析器</h4><p>没有命中缓存的真实执行部分</p><p>词法分析(语言关键字等含义解析) → 语法分析(语句整体的正确性解析)</p><h4 id="优化器"><a href="#优化器" class="headerlink" title="优化器"></a>优化器</h4><blockquote><p>索引选择，连表的引擎接口调用</p></blockquote><h4 id="执行器"><a href="#执行器" class="headerlink" title="执行器"></a>执行器</h4><p>权限判断，执行查询</p><h3 id="存储引擎"><a href="#存储引擎" class="headerlink" title="存储引擎"></a>存储引擎</h3><blockquote><p>常见的引擎有：InnoDB、 MyISAM、Memory 等多个存储引擎</p><p>最常用的是 InnoDB，它从 MySQL 5.5.5 版本开始成为了默认</p></blockquote><p>不同的存储引擎共用一个<strong>Server 层</strong></p><h3 id="日志模块"><a href="#日志模块" class="headerlink" title="日志模块"></a>日志模块</h3><ul><li><p><strong>redo log（重做日志）</strong></p><blockquote><p>WAL 技术来提升更新效率。WAL 的全称 是 Write-Ahead Logging，它的关键点就是先写日志，再写磁盘</p></blockquote><p>当有一条记录需要更新的时候，InnoDB 引擎就会先把记录写到 redo log中，并更新内存，这个时候更新就算完成了。同时，InnoDB 引擎会在适当的时候，将这个操作记录更新到磁盘里面，而这个更新往往是在系统比较空闲的时候做。</p><blockquote><p>有了 redo log，InnoDB 就可以保证即使数据库发生异常重启，之前提交的记录都不会丢失，这个能力称为<strong>crash-safe</strong>。</p></blockquote><p>redo log是InnoDB引擎特有的日志</p></li><li><p><strong>binlog（归档日志）</strong></p><p>属于MySQL的Server层</p><p>binlog 没有 crash-safe 能力</p></li><li><p><strong>区别</strong></p><ol><li>redo log 是 InnoDB 引擎特有的；binlog 是 MySQL 的 Server 层实现的，所有引擎都可以使用。</li><li>redo log 是物理日志，记录的是“在某个数据页上做了什么修改”；binlog是逻辑日志，记录的是这个语句的原始逻辑，比如“给ID&#x3D;2这一行的c字段加1”</li><li>redo log 是循环写的，空间固定会用完；binlog是可以追加写入的。“追加写”是指binlog文件写到一定大小后会切换到下一个，并不会覆盖以前的日志。</li></ol></li></ul><h2 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h2><blockquote><p>事务支持是在引擎层实现的,并不是所有的引擎都支持事务（MyISAM不支持，InnoDB支持）</p></blockquote><blockquote><p>事务就是要保证一组数据库操作，要么全部成功，要么全部失败</p></blockquote><p>四大特性有<strong>ACID(Atomicity、Consistency、Isolation、Durability</strong>，即<strong>原子性、一致性、隔离性、持久性</strong>)，其中就有隔离性</p><h3 id="隔离性和隔离级别"><a href="#隔离性和隔离级别" class="headerlink" title="隔离性和隔离级别"></a>隔离性和隔离级别</h3><blockquote><p> 当数据库上有多个事务同时执行的时候，就可能出现<strong>脏读、不可重复读 、幻读</strong>的问题，为了解决这些问题，就有 了<strong>隔离级别</strong>的概念</p></blockquote><blockquote><p>隔离级别设置的越高，也就是越严格，那就意味着效率越低，所以安全性和性能必须寻找一个平衡点。SQL标准的事务隔离级别包括<strong>读未提交、读提交、可重复读和串行化</strong></p></blockquote><ul><li><p><strong>读未提交</strong></p><p>一个事务还没提交时，它做的变更就能被别的事务看到</p></li><li><p><strong>读提交</strong></p><p>一个事务提交之后，它做的变更才会被其他事务看到</p></li><li><p><strong>可重复读</strong></p><p>一个事务执行过程中看到的数据，总是跟这个事务在启动时看到的数据是一致的</p><p>在可重复读隔离级别下，未提交变更对其他事务也是不可见的</p></li><li><p><strong>串行化</strong></p><p>对于同一行记录，“写”会加“写锁”，“读”会加“读锁”。当出现读写锁冲突的时候，后访问的事务必须等前一个事务执行完成，才能继续执行</p></li></ul><h3 id="启动方式"><a href="#启动方式" class="headerlink" title="启动方式"></a>启动方式</h3><ul><li><p>显式的启动事务</p><blockquote><p>begin 或 start transaction。配套的提交语句是 commit，回滚语句是 rollback。</p></blockquote></li><li><p>隐式默认启动</p><blockquote><p>通过配置set autocommit&#x3D;0，关闭自动提交来强制开启事务手动提交</p></blockquote><p>会导致接下来的查询都在事务中，如果是长连接，就导致了意外的长事务，最好不要使用此方式</p></li></ul><h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><ul><li><p>InnoDB实现</p><p>InnoDB 的行数据有多个版本，每个数据版本有自己的<code>row trx_id</code>，每个事务或者语句有自己的一致性视图。普通查询语句是一致性读，一致性读会根据 <code>row trx_id</code>和一致性视图确定数据版本的可见性。</p><p>1、对于可重复读，查询只承认在事务启动前就已经提交完成的数据 </p><p>2、对于读提交，查询只承认在语句启动前就已经提交完成的数据 </p><p>3、当前读，总是读取已经提交完成的最新版本。</p></li><li><p>事务B的 update 语句，如果按照一致性读，不是矛盾了吗?</p><p><strong>更新数据都是先读后写的，而这个读，只能读当前的值，称为”当前读”(current read)</strong></p></li><li><p>InnoDB为什么能够秒级创建快照支持回滚</p><p><strong>InnoDB 利用了所有数据都有多个版本的这个特性，实现了”秒级创建快照”的能力。</strong></p><p><strong>InnoDB 为每个事务构造了一个数组，用来保存这个事务启动瞬间，当前正在活跃的所有事务 ID。</strong></p></li></ul><h2 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><blockquote><p>帮助SQL获取数据的数据结构,类比“目录”</p></blockquote><h3 id="优"><a href="#优" class="headerlink" title="优"></a>优</h3><ul><li>减少扫描数据量</li><li>避免排序，临时表</li><li>随机IO变顺序IO</li><li>提供锁场景</li></ul><h3 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h3><ul><li>写入效率低（同步建立索引）</li><li>占用额外的磁盘空间</li><li>对于同列内大量重复数据索引效果差</li><li>小表意义不大，直接全表扫描更高效</li></ul><h3 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h3><ol><li><p>按功能：</p><table><thead><tr><th>索引</th><th>名称</th><th>作用</th><th>场景</th><th>注意</th></tr></thead><tbody><tr><td>INDEX</td><td>普通索引</td><td>加快访问速度</td><td>查询条件常用字段</td><td></td></tr><tr><td>UNIQUE</td><td>唯一索引</td><td>唯一值但允许空值重复,组合索引必须组合唯一</td><td>字段唯一性,例如：身份证号</td><td></td></tr><tr><td>PRIMARY</td><td>主键索引</td><td>唯一不允许空值，单表仅一个</td><td>关系数据的唯一标识,例如：ID</td><td></td></tr><tr><td>FULL_TEXT</td><td>全文索引</td><td>全文检索时的加速访问</td><td>like左右双%时索引失效，对于一些需要检索全文内容的查询场景使用</td><td>Innodb引擎5.6版本后才支持且新版必须在建立索引时声明ngram插件( WITH PARSER ngram)</td></tr></tbody></table></li><li><p>按物理实现</p><table><thead><tr><th>索引</th><th>名称</th><th>描述</th></tr></thead><tbody><tr><td>CLUSTERED</td><td>聚集索引</td><td>查询效率更高,写入效率更低<br />索引顺序与行记录顺序一致<br />单表只有一个聚集索引,有主键索引选主键索引,无主键选第一个唯一索引,都没有则生成一个隐式的聚集索引</td></tr><tr><td>NON-CLUSTERED</td><td>非聚集索引</td><td>索引顺序存储,指向内容随机存储,系统维护索引表来存储索引<br />索引叶子节点存储的是数据地址,查询会进行两次查询：找索引-&gt;找数据<br />又称”二级索引”,”辅助索引”</td></tr></tbody></table></li><li><p>按数量</p><table><thead><tr><th>索引</th><th>名称</th><th>描述</th></tr></thead><tbody><tr><td>ONLY</td><td>单一索引</td><td>单字段对应的独立的单一索引</td></tr><tr><td>UNION</td><td>联合索引</td><td>多字段联合,遵循最左原则：<br />按照最左优先的顺序进行索引匹配<br />对于联合索引(x,y,z)等价于三个索引：x,y,z    x,y     x<br />联合索引场景下，使用的索引字段越多，效率越高，这由于Mysql查询优化器的执行顺序决定</td></tr></tbody></table><blockquote><p>联合索引生效比对：x,y,z </p></blockquote><ul><li><p><input checked="" disabled="" type="checkbox"> where x&#x3D;1 and y&#x3D;1 and z&#x3D;1</p></li><li><p><input checked="" disabled="" type="checkbox"> where x&#x3D;1 and y&#x3D;1</p></li><li><p><input checked="" disabled="" type="checkbox"> where x&#x3D;1</p></li><li><p><input disabled="" type="checkbox"> where y&#x3D;1 and z&#x3D;1</p></li><li><p><input disabled="" type="checkbox"> where x&#x3D;1 and z&#x3D;1 <a href="%E4%BB%85%E5%AF%B9x%E5%AD%97%E6%AE%B5%E7%94%9F%E6%95%88"></a></p></li><li><p><input disabled="" type="checkbox"> where y&#x3D;1</p></li><li><p><input disabled="" type="checkbox"> where z&#x3D;1</p></li></ul></li><li><p>按结构</p><blockquote><p>B+树索引 Hash索引 FULLTEXT索引</p></blockquote></li></ol><h3 id="索引选择"><a href="#索引选择" class="headerlink" title="索引选择"></a>索引选择</h3><ol><li>MySQL 优化器根据搜索条件，找出所有可能使用的索引</li><li>计算全表扫描的代价</li><li>计算使用不同索引执行查询的代价</li><li>对比各种执行方案的代价，找出成本最低的那一个</li></ol><h3 id="索引场景"><a href="#索引场景" class="headerlink" title="索引场景"></a>索引场景</h3><ul><li>WHERE, GROUP BY, ORDER BY 子句中的字段</li><li>多列联合场景多，使用联合场景，注意最左匹配原则</li><li>多表连接JOIN时的连接字段</li><li>SELECT 列表存在不在索引中的字段，会先通过索引查到满足条件的主键值再“回表”查询其余字段，如果SELECT列表字段较少可以全加索引<sup>面试八股</sup></li><li>索引字段越多，存储和维护成本越高</li></ul><p><strong>不使用场景</strong></p><ul><li>数据量小的表</li><li>大量重复数据的字段</li><li>频繁更新的字段</li></ul><p><strong>失效场景</strong></p><ul><li>使用函数或者表达式计算</li><li>OR条件中存在无索引字段,存在索引的其余字段失效</li><li><kbd>&gt;</kbd><kbd>&lt;</kbd>条件的命中数量，依据配置决定，命中比例过高索引失效，选择全表扫描</li><li><kbd>!=</kbd><kbd>&lt;&gt;</kbd>不等于条件</li><li>LIKE值以<kbd>%</kbd>开头</li></ul><p><strong>什么时候不用自增主键</strong></p><blockquote><p><strong>从性能和存储空间方面考量，自增主键往往是更合理的选择</strong></p></blockquote><p>但符合以下典型的 KV 场景时不必使用自增主键</p><blockquote><ul><li>只有一个索引</li><li>该索引必须是唯一索引</li></ul></blockquote><p><strong>change buffer</strong></p><ul><li><p>场景</p><blockquote><p>当需要更新一个数据页时，如果数据页在内存中就直接更新，而如果这个数据页还没有在内存中的话，在不影响数据一致性的前提下，InooDB 会将这些更新操    作缓存在 change buffer 中，这样就不需要从磁盘中读入这个数据页了。在下次查询需要访问这个数据页的时候，将数据页读入内存，然后执行 change buffer     中与这个页有关的操作。通过这种方式就能保证这个数据逻辑的正确性。</p></blockquote><p>对于写多读少的业务来说，页面在写完以后马上被访问到的概率比较小，此时 change buffer 的使用效果最好。</p><p>这种业务模型常见的就是账单类、日志类的系统。</p></li><li><p>定义</p><p>​    实际上它是可以持久化的数据。也就是说，change buffer 在内存中有拷贝，也会被写入到磁盘上</p><p>​    只限于用在普通索引的场景下，而不适用于唯一索引。</p></li></ul><p>​<strong>redo log 主要节省的是随机写磁盘的 IO 消耗(转成顺序写)，而 change buffer 主要节省的则是随机读磁盘 的 IO 消耗</strong></p><h3 id="扩展问题"><a href="#扩展问题" class="headerlink" title="扩展问题"></a>扩展问题</h3><ul><li><p><strong>mysql有时会选错索引</strong></p><ol><li>采用 force index 强行选择一个索引</li><li>修改语句，引导 MySQL 使用我们期望的索引</li><li>新建一个更合适的索引，来提供给优化器做选择或删掉误用的索引。</li></ol></li><li><p><strong>如何给字符串加索引</strong></p><ul><li><p><strong>前缀索引</strong></p><blockquote><p>MySQL是支持前缀索引的,可以定义字符串的一部分作为索引 <code>index(column(count))</code>,示例：<code>index_email(email(6))</code></p></blockquote><p><strong>使用前缀索引，定义好长度，就可以做到既节省空间，又不用额外增加太多的查询成本。</strong></p><p>如何建立前缀索引：取决于<strong>区分度</strong></p><p>区分度越高，意味着重复的键值越少，索引命中扫描量越小</p><p><del>判断步骤</del></p><ul><li><p>计算列中不同值数量</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select count(distinct email) as L from SUser;</span><br></pre></td></tr></table></figure></div></li><li><p>依次选取不同长度的前缀判断区分度</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">count(distinct left(email,4)）as L4,</span><br><span class="line">count(distinct left(email,5)）as L5,</span><br><span class="line">count(distinct left(email,6)）as L6,</span><br><span class="line">count(distinct left(email,7)）as L7,</span><br><span class="line">from SUser;</span><br></pre></td></tr></table></figure></div></li><li><p>选择</p><p>预先设定一个可以接受的损失比例，比如5%。然后，在返回的L4~L7中，找出不小于 L * 95%的值，假设这里L6、L7都满足，你就可以选择前缀长度为6。</p></li></ul></li><li><p><strong>倒序存储</strong></p><p>拿身份证号来举例的话，同区域内前缀相同，区分度很低无法使用前缀索引</p><p>这时可以在存储时倒序存储身份证号，对字段操作时(查询，更新等)使用<code>reverse</code>函数翻转</p><p>这样身份证号的后N位提供了很好的区分度可以以此加前缀索引</p></li><li><p><strong>hash字段</strong></p><p>在表上再创建一个整数字段，来保存身份证的校验码，同时在这个字段上创建索引。</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table t add id_card_crc int unsigned, add index(id_card_crc);</span><br></pre></td></tr></table></figure></div><p>每次插入新记录的时候，都同时用crc32()这个函数得到校验码填到这个新字段</p><p>由于校验码可能存在冲突，也就是说两个不同的身份证号通过crc32()函数得到的结果可能是相同的，查询语句where部分要判断id_card的值是否精确相同</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select field_list from t where id_card_crc=crc32(&#x27;input_id_card_string&#x27;) and id_card=&#x27;input_id_card_string&#x27;</span><br></pre></td></tr></table></figure></div></li><li><p><strong>总结</strong></p><ol><li>直接创建完整索引，这样可能比较占用空间</li><li>创建前缀索引，节省空间，但会增加查询扫描次数，并且不能使用覆盖索引</li><li>倒序存储，再创建前缀索引，用于绕过字符串本身前缀的区分度不够的问题</li><li>创建hash字段索引，查询性能稳定，有额外的存储和计算消耗，跟第三种方式一样，都不支持范围扫描</li></ol></li></ul></li><li><p><strong>为什么SQL语句有时会慢</strong></p><blockquote><p>当内存数据页跟磁盘数据页内容不一致的时候，我们称这个内存页为”脏页”。</p><p>内存数据写入到磁盘后，内存和磁盘上的数据页的内容就一致了，称为”干净页”。</p></blockquote><p>刷脏页（flush）时会拉慢SQL执行，下述产生场景</p><ol><li><strong>InnoDB的redo log写满了，这时候系统会停止所有更新操作，把 checkpoint 往前推进，redo log 留出空间才可以继续写</strong></li><li><strong>系统内存不足当，需要新的内存页，而内存不够用的时候，就要淘汰一些数据页，空出内存给别的数据页使用。如果淘汰的是”脏页”，就要先将脏页写到磁盘。</strong></li><li><strong>MySQL认为系统空闲的时候，进行flush操作</strong></li><li><strong>MySQL关闭的时候会把内存的脏页都flush到磁盘上</strong></li></ol><p>InnoDB的刷脏页控制策略</p><ol><li><p>使用<code>innodb_io_capacity</code> 这个参数，它会告诉 InnoDB 你的磁盘能力。这个值应该设置成磁盘的 IOPS。磁盘的 IOPS 可以通过 fio 工具来测试。如果这个参数设置的过低，InnoDB会认为系统能力差，导致刷脏页刷的特别慢从而影响查询和更新的性能。</p></li><li><p>多关注脏页比例，不要经常接近75%。脏页比例通过 <code>Innodb_buffer_pool_pages_dirty/Innodb_buffer_pool_pages_total</code>得到</p></li><li><p>InnoDB刷脏页产生时会连坐（如果这个数据页旁边的数据页刚好是脏页，就会把这个邻居也带着一起刷掉）</p><p><code>innodb_flush_neighbors</code>参数就是用来控制这个行为的，mysql8.0中<code>innodb_flush_neighbors</code>参数的默认值已经是 0 了，用于防止连坐</p></li></ol></li><li><p><strong>为什么表数据删除一半文件大小却不变</strong></p><blockquote><p>delete 命令其实只是把记录的位置，或者数据页标记为了“可复用”，磁盘文件的大小是不会变的</p><p>通过 delete 命令是不能回收表空间的。这些可以复用，而没有被使用的空间，看起来就像是“空洞”</p></blockquote><p><strong>去除“空洞”才能达到收缩表空间的目的</strong></p><p>方案：重建表数据迁出</p></li><li><p><strong>Online DDL</strong></p><p>5.6后引入，为了对<strong>之前MySQL 从主表往临时表插入数据的过程不支持主表数据更新</strong>做优化</p><p><del>流程</del></p><ol><li>建立一个临时文件，扫描表 A 主键的所有数据页</li><li>用数据页中表 A 的记录生成 B+ 树，存储到临时文件中</li><li>生成临时文件的过程中，将所有对 A 的操作记录在一个日志文件(row log)中</li><li>临时文件生成后，将日志文件中的操作应用到临时文件，得到一个逻辑数据上与表 A 相同的数据文件</li><li>用临时文件替换表 A 的数据文件</li></ol><blockquote><p>Online 和 inplace的区别</p></blockquote><p>DDL 过程如果是 Online 的，就一定是 inplace 的；inplace 的 DDL，有可能不是 Online 的。</p><p>（整个 DDL 过程都在 InnoDB 内部完成。对于 server 层来说，没有把数据挪动到临时表，是一个<code>原地</code>操作，这就是<code>inplace</code>名称的来源）</p></li><li><p><strong>count聚合函数实现原理</strong></p><p>对于性能而言：</p><blockquote><p>count(*) ≈ count(1) &gt; count(主键)  &gt; count(字段)</p></blockquote><p>不同引擎对于count的处理方式不同</p><ul><li><p>MyISAM 引擎把一个表的总行数存在了磁盘上，因此执行 <code>count(*)</code>的时候会直接返回这个数，效率很高</p><p>如果加了 where 条件的话，MyISAM 表也是不能返回得这么快的</p></li><li><p>InnoDB 引擎执行<code>count(*)</code>的时候，需要把数据一行一行地从引擎里面读出来，然后累积计数。</p></li></ul><p>InnoDB的优化：寻找最小的索引树进行遍历</p><blockquote><p>用 show table status 命令输出结果里面也有一个 TABLE_ROWS 能代替 count(*) 吗？</p></blockquote><p>索引统计的值是通过采样来估算的。实际上，TABLE_ROWS 就是从这个采样估算得来的，因此它也很不准。官方文档说误差可能达到 40% 到 50%。所以，<strong>show table status 命令显示的行数也不能直接使用。</strong></p><p><strong>总结</strong></p><ul><li>MyISAM 表虽然 <code>count(*)</code>很快，但是不支持事务</li><li>show table status· 命令虽然返回很快，但是不准确</li><li>InnoDB 表直接 <code>count(*)</code>会遍历全表，虽然结果准确，但会导致性能问题</li></ul><p><strong>方案</strong></p><ul><li><strong>用缓存系统保存计数</strong></li><li><strong>在数据库保存计数</strong></li></ul></li><li><p><strong>order by的工作原理</strong></p><blockquote><p>全字段排序</p></blockquote><ol><li>初始化 sort_buffer，确定放入查询字段</li><li>从索引 找到第一个满足条件的主键 id</li><li>取查询字段值,存入 sort_buffer 中</li><li>从索引取下一个记录的主键 id</li><li>重复步骤 3、4 直到不满足查询条件为止</li><li>对 sort_buffer 中的数据按照排序字段做快速排序</li><li>返回结果</li></ol><p>第6步这个动作，可能在内存中完成，也可能需要使用外部排序(磁盘)，这取决于排序所需的内存和参数 <code>sort_buffer_size</code></p><p><code>sort_buffer_size</code>是 MySQL 为排序开辟的内存(sort_buffer)的大小</p><blockquote><p>rowid排序</p></blockquote><p>与上述步骤区别：在sort_buffer只存入排序字段与主键,最后返回结果时再通过主键“回表”取值</p><p>一般情况下，mysql通过判断排序内存来决定使用哪种排序方式</p><p>对于 InnoDB 表来说，rowid 排序会要求回表多造成磁盘读，因此不会被优先选择</p><blockquote><p>显示随机信息时要避免使用<code>order by rand()</code>,这需要Using temporary 和 Using filesort</p><p>采取自己设计的随机算法</p></blockquote></li><li><p><strong>SQL调优</strong></p><p>尽量不要对索引字段使用聚合函数，这会让优化器放弃走树搜索</p><p>条件判断时类型必须一致,比如连表的 varchar2与integer对比,无论是否存在索引均会放弃</p><p>字符编码问题,连表时确保所有表的字符编码集相同,比如A表utf8，B表是utf8mb4，也会放弃索引</p><p><strong>连接过程中要求在被驱动表的索引字段上加函数操作</strong>，是直接导致对被驱动表做全表扫描的原因</p></li><li><p><strong>查询慢的场景</strong></p><blockquote><p>等MDL锁，等flush，等锁</p></blockquote><p><strong>“饮鸩止渴”提高性能(短链接风暴)</strong></p><ol><li>处理掉占着连接不工作的线程</li><li>减少连接过程的消耗(比如跳过权限验证等)</li></ol><p><strong>QPS突增</strong></p><ol><li>业务下掉功能</li><li>触发高频用户禁用</li><li>改写SQL语句为select 1</li></ol></li><li><p><strong>JOIN场景</strong></p><p>小表<sup>小表定义</sup>驱动大表，连接字段使用索引连接</p></li></ul><p>[面试八股] 为什么SELECT要避免<kbd>*</kbd>,避免回表 </p><p>[小表定义] 条件查询后的扫描行数量</p><h2 id="锁"><a href="#锁" class="headerlink" title="锁"></a>锁</h2><ul><li><p>按机制</p><blockquote><p>共享锁（读锁）：其他事务可读不可写</p><p>排他锁（写锁）：其他事务不可读不可写 </p></blockquote></li><li><p>按粒度</p><blockquote><p>BDB引擎下：页面锁，表锁</p><p>INNODB引擎下：行级锁，表锁</p></blockquote><p><strong>概览</strong></p><blockquote><p>表级锁</p><blockquote><p>开销小，加锁快；不会出现死锁；锁定粒度大，发生锁冲突的概率最高，并发度最低</p><p>这些存储引擎通过总是一次性同时获取所有需要的锁以及总是按相同的顺序获取表锁来避免死锁</p><p>表级锁更适合于以查询为主，并发用户少，只有少量按索引条件更新数据的应用，如Web 应用</p></blockquote><p>行级锁</p><blockquote><p>开销大，加锁慢；会出现死锁；锁定粒度最小，发生锁冲突的概率最低，并发度也最高。</p><p>最大程度的支持并发，同时也带来了最大的锁开销。</p><p>在 InnoDB 中，除单个 SQL 组成的事务外，<br>锁是逐步获得的，这就决定了在 InnoDB 中发生死锁是可能的。</p><p>行级锁只在存储引擎层实现，而Mysql服务器层没有实现。 行级锁更适合于有大量按索引条件并发更新少量不同数据，同时又有并发查询的应用，如一些在线事务处理（OLTP）系统</p></blockquote><p>页面锁</p><blockquote><p>开销和加锁时间界于表锁和行锁之间；会出现死锁；锁定粒度界于表锁和行锁之间，并发度一般</p></blockquote></blockquote><p>间隙锁：用范围条件而不是相等条件索引数据</p></li><li><p>按行为</p><blockquote><p>乐观锁：假设不会发生并发冲突，只在提交操作时检查是否违反数据完整性。 乐观锁不能解决脏读的问题</p><p>悲观锁：假定会发生并发冲突，屏蔽一切可能的违反数据完整性操作</p></blockquote></li></ul><h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><ul><li><p>读锁（S 锁，共享锁）：<code>lock in share mode</code></p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select k from t where id=1 lock in share mode; </span><br></pre></td></tr></table></figure></div></li><li><p>写锁（X 锁，排他锁）：<code>for update</code></p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select k from t where id=1 for update;</span><br></pre></td></tr></table></figure></div></li></ul><h2 id="语句"><a href="#语句" class="headerlink" title="语句"></a>语句</h2><h3 id="系统级"><a href="#系统级" class="headerlink" title="系统级"></a>系统级</h3><p><strong>此处语句仅针对特定版本，目前视为mysql5.6-8.0同比mariadb10~</strong></p><h4 id="读"><a href="#读" class="headerlink" title="读"></a>读</h4><div class="code-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#查看最大连接数</span><br><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> &quot;max_connections&quot;;</span><br><span class="line">#连接超时时间</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">global</span> variables <span class="keyword">like</span> <span class="string">&#x27;wait_timeout&#x27;</span>;</span><br><span class="line">#查看当前进程</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">FULL</span> PROCESSLIST;</span><br><span class="line">#查看索引策略行数(限定<span class="keyword">IN</span> <span class="keyword">OR</span>数量)</span><br><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%eq_range_index_dive_limit%&#x27;</span>;</span><br><span class="line">#查看空间占用</span><br><span class="line"><span class="keyword">SELECT</span> TABLE_NAME,DATA_LENGTH,INDEX_LENGTH,(DATA_LENGTH<span class="operator">+</span>INDEX_LENGTH) <span class="keyword">as</span> length,TABLE_ROWS,concat(round((DATA_LENGTH<span class="operator">+</span>INDEX_LENGTH)<span class="operator">/</span><span class="number">1024</span><span class="operator">/</span><span class="number">1024</span>,<span class="number">3</span>), <span class="string">&#x27;MB&#x27;</span>) <span class="keyword">as</span> total_size <span class="keyword">FROM</span> information_schema.TABLES <span class="keyword">WHERE</span> TABLE_SCHEMA<span class="operator">=</span><span class="string">&#x27;bswas&#x27;</span> <span class="keyword">order</span> <span class="keyword">by</span> length <span class="keyword">desc</span>;</span><br><span class="line">#查看当前锁定事务</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> INFORMATION_SCHEMA.INNODB_LOCKS;</span><br><span class="line">#查看所有的等待事务ID</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> INFORMATION_SCHEMA.INNODB_TRX;</span><br><span class="line">#查询操作日志</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">from</span> mysql.general_log <span class="keyword">ORDER</span> <span class="keyword">BY</span> event_time <span class="keyword">DESC</span>;</span><br><span class="line">#查看是否自动<span class="keyword">COMMIT</span>(Mysql的<span class="keyword">commit</span>取决于你的引擎于设置)<span class="comment">--OFF(否) ON(是)</span></span><br><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%autocommit%&#x27;</span>;</span><br><span class="line">#查看当前数据库的事务隔离级别</span><br><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;tx_isolation&#x27;</span>;</span><br><span class="line"></span><br><span class="line">$死锁时先去查被锁定的事务 拿lock_trx_id去INNODB_TRX找对应的trx_id取其trx_mysql_thread_id将其kill掉</span><br></pre></td></tr></table></figure></div><h4 id="写"><a href="#写" class="headerlink" title="写"></a>写</h4><div class="code-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#临时修改最大连接数,完全修改需要改my.cnf重启DB</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">GLOBAL</span> max_connections<span class="operator">=</span><span class="number">300</span>;</span><br><span class="line">#杀死进程</span><br><span class="line">kill &#123;PROCESS_ID&#125;;</span><br><span class="line">#临时设置开启<span class="operator">/</span>关闭日志（<span class="keyword">ON</span><span class="operator">/</span>OFF）</span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">GLOBAL</span> log_output <span class="operator">=</span> <span class="string">&#x27;TABLE&#x27;</span>;<span class="keyword">SET</span> <span class="keyword">GLOBAL</span> general_log <span class="operator">=</span> <span class="string">&#x27;ON&#x27;</span>;</span><br></pre></td></tr></table></figure></div><h3 id="普通级"><a href="#普通级" class="headerlink" title="普通级"></a>普通级</h3><h4 id="读-1"><a href="#读-1" class="headerlink" title="读"></a>读</h4><div class="code-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#行级，排他，悲观锁(<span class="keyword">FOR</span> <span class="keyword">UPDATE</span>),必须命中索引，否则表锁，读多场景勿用，容易死锁</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">column</span> <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">where</span> &#123;索引列&#125; <span class="operator">=</span> &#123;val&#125; <span class="keyword">FOR</span> <span class="keyword">UPDATE</span>;</span><br><span class="line">#查询存储过程内容</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">column</span> <span class="keyword">FROM</span> <span class="keyword">table</span> <span class="keyword">where</span> name <span class="operator">=</span> &#123;procedure_name&#125; <span class="keyword">order</span> <span class="keyword">by</span> line;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h4 id="写-1"><a href="#写-1" class="headerlink" title="写"></a>写</h4><div class="code-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#修改时与原值运算(不需要额外查询一次)</span><br><span class="line"><span class="keyword">UPDATE</span> <span class="keyword">table</span> <span class="keyword">SET</span> <span class="keyword">column</span> <span class="operator">=</span> <span class="keyword">column</span> <span class="operator">-</span> <span class="number">1</span>;</span><br><span class="line">#删除A表存在B表不存在的数据<span class="operator">-</span>根据主键(避免MYSQL8禁止子查询含本表)</span><br><span class="line"><span class="keyword">DELETE</span> A <span class="keyword">FROM</span> A <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> B <span class="keyword">ON</span> A.id <span class="operator">=</span> B.id <span class="keyword">WHERE</span> B.id <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br></pre></td></tr></table></figure></div><h2 id="执行与函数"><a href="#执行与函数" class="headerlink" title="执行与函数"></a>执行与函数</h2><blockquote><p>group by时 having与where的区别 执行级别：where先于聚合函数，所以 where是对分组前数据进行筛选,having是对分组后数据进行筛选</p></blockquote><h1 id="Oracle"><a href="#Oracle" class="headerlink" title="Oracle"></a>Oracle</h1><h2 id="语句-1"><a href="#语句-1" class="headerlink" title="语句"></a>语句</h2><h3 id="普通级-1"><a href="#普通级-1" class="headerlink" title="普通级"></a>普通级</h3><h4 id="写-2"><a href="#写-2" class="headerlink" title="写"></a>写</h4><div class="code-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#插入一条记录<span class="keyword">and</span>标记</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">ALL</span> <span class="keyword">INTO</span> <span class="keyword">table</span> (column1,column2...) <span class="keyword">VALUES</span>(value1,value2...) <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> DUAL</span><br><span class="line">#存在则更新不存在则插入</span><br><span class="line"><span class="keyword">MERGE</span> <span class="keyword">INTO</span> <span class="keyword">table</span> t1</span><br><span class="line">                <span class="keyword">USING</span>(<span class="keyword">SELECT</span> column1,column2,column3 <span class="keyword">FROM</span> DUAL) t2</span><br><span class="line">        <span class="keyword">ON</span>(t1.column1<span class="operator">=</span>t2.column1)</span><br><span class="line">        <span class="keyword">WHEN</span> MATCHED <span class="keyword">THEN</span></span><br><span class="line">            <span class="keyword">UPDATE</span> <span class="keyword">SET</span> t1.column2<span class="operator">=</span>t2.column2,t1.column3<span class="operator">=</span>t2.column3</span><br><span class="line">        <span class="keyword">WHEN</span> <span class="keyword">NOT</span> MATCHED <span class="keyword">THEN</span></span><br><span class="line">            <span class="keyword">INSERT</span>(column1,column2,column3...)</span><br><span class="line">            <span class="keyword">VALUES</span>(t2.column1,t2.column2,t2.column3...)</span><br></pre></td></tr></table></figure></div><h1 id="Other"><a href="#Other" class="headerlink" title="Other"></a>Other</h1><h2 id="ISSUE"><a href="#ISSUE" class="headerlink" title="ISSUE"></a>ISSUE</h2><ul><li><p>Q：主键抉择</p><blockquote><p>我的抉择角度为,有独立唯一字段直接使用,没有的话建立主键是否采用自增序列还是流水号与UUID等其他散列序列值取决于主键字段的业务使用角度<br>如果它仅是内部一个隐性关联字段 则自增序列,如果它具备可读性（例如订单号等）则自定义函数生成一般由日期+业务号组成<br>如果其分库分表存在归档等 则优先选用UUID</p></blockquote></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> mysql </tag>
            
            <tag> oracle </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring长通信SEE</title>
      <link href="/2025/03/12/Spring%20Cloud%20Alibaba%20%E9%95%BF%E8%AE%A1%E7%AE%97SEE%E9%80%9A%E4%BF%A1%EF%BC%88%E7%B1%BBChatGPT%E5%9B%9E%E5%A4%8D%E5%93%8D%E5%BA%94%EF%BC%89/"/>
      <url>/2025/03/12/Spring%20Cloud%20Alibaba%20%E9%95%BF%E8%AE%A1%E7%AE%97SEE%E9%80%9A%E4%BF%A1%EF%BC%88%E7%B1%BBChatGPT%E5%9B%9E%E5%A4%8D%E5%93%8D%E5%BA%94%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<blockquote><p>采用SSE单向通信协议对长任务实时推送</p></blockquote><h2 id="服务端"><a href="#服务端" class="headerlink" title="服务端"></a>服务端</h2><ul><li><p><strong>前置</strong></p><blockquote><p>nginx 允许长连接 SSE放行</p></blockquote></li></ul><h3 id="网关过滤器（可选）"><a href="#网关过滤器（可选）" class="headerlink" title="网关过滤器（可选）"></a>网关过滤器（可选）</h3><blockquote><p>SSE无法携带自定义请求头，所以对于存在全量鉴权的网关采取两种方案</p><blockquote><p>token以 request params形式传递</p></blockquote><blockquote><p>对于SSE请求直接放行，此鉴权控制逻辑可选性的在处理器内部处理</p></blockquote></blockquote><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserGlobalFilter</span> <span class="keyword">implements</span> <span class="title class_">GlobalFilter</span>, Ordered &#123;</span><br><span class="line">    ...</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;Void&gt; <span class="title function_">filter</span><span class="params">(ServerWebExchange exchange, GatewayFilterChain chain)</span> &#123;</span><br><span class="line">        ...</span><br><span class="line"><span class="comment">// SSE请求不做验证</span></span><br><span class="line">        <span class="keyword">if</span> (MediaType.TEXT_EVENT_STREAM_VALUE.equals(request.getHeaders().getFirst(HttpHeaders.ACCEPT))) &#123;</span><br><span class="line">            <span class="keyword">return</span> chain.filter(exchange);</span><br><span class="line">        &#125;</span><br><span class="line">...</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="自定义简易消息队列-推送信息"><a href="#自定义简易消息队列-推送信息" class="headerlink" title="自定义简易消息队列 &#x2F; 推送信息"></a>自定义简易消息队列 &#x2F; 推送信息</h3><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.context.request.RequestContextHolder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.context.request.ServletRequestAttributes;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.LinkedBlockingQueue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoggerQueue</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">LoggerQueue</span> <span class="variable">messageQueue</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LoggerQueue</span>();</span><br><span class="line">    <span class="comment">// 因为保证了多线程的key一定是不一致的，所以这里使用非线程安全的HashMap</span></span><br><span class="line">    <span class="comment">// 同时因为sse通道读取与异步写入的问题，需要使用LinkedBlockingQueue来保证队列的线程安全</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Map&lt;String, LinkedBlockingQueue&lt;String&gt;&gt; queueMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Map&lt;String, Long&gt; closeObserver = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">16</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">MAX_WAIT_TIME</span> <span class="operator">=</span> <span class="number">10000L</span>;<span class="comment">// 最大等待时间（毫秒）如果某个停止工作的队列 超过该时间未产生消费，将会在下一次有队列构建时被清理</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> LoggerQueue <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> messageQueue;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">open</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ServletRequestAttributes</span> <span class="variable">servlet</span> <span class="operator">=</span> (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();</span><br><span class="line">        <span class="keyword">if</span> (servlet == <span class="literal">null</span>) &#123; <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;无法开启一个日志队列&quot;</span>);&#125;</span><br><span class="line">        <span class="built_in">this</span>.open(servlet.getSessionId());</span><br><span class="line">        <span class="keyword">return</span> servlet.getSessionId();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">open</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        queueMap.put(key, <span class="keyword">new</span> <span class="title class_">LinkedBlockingQueue</span>&lt;&gt;(<span class="number">100</span>));</span><br><span class="line">        <span class="built_in">this</span>.clearDeadLetterQueue();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(String message, String key)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!queueMap.containsKey(key)) &#123; <span class="keyword">return</span>; &#125;</span><br><span class="line">        queueMap.get(key).add(message);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">pop</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!queueMap.containsKey(key)) &#123; <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;队列已被关闭&quot;</span>); &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> queueMap.get(key).poll();</span><br><span class="line">        <span class="comment">// 队列停止工作时</span></span><br><span class="line">        <span class="keyword">if</span> (closeObserver.containsKey(key)) &#123;</span><br><span class="line">            <span class="comment">// 消息已被被消费完</span></span><br><span class="line">            <span class="keyword">if</span> (msg == <span class="literal">null</span>) &#123;</span><br><span class="line">                queueMap.remove(key);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 消息仍然在被消费</span></span><br><span class="line">                closeObserver.put(key, System.currentTimeMillis());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> msg;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 告诉这个域 我的某个队列已经停止工作了 你需要把消费完或者指定时间内未产生消费的死链 剔除</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (key == <span class="literal">null</span>) &#123; <span class="keyword">return</span>; &#125;</span><br><span class="line">        closeObserver.put(key, System.currentTimeMillis());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 清理死信队列</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">clearDeadLetterQueue</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (closeObserver.size() == <span class="number">0</span>) &#123; <span class="keyword">return</span>; &#125;</span><br><span class="line">        <span class="type">long</span> <span class="variable">time</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, Long&gt; entry : closeObserver.entrySet()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (time - entry.getValue() &gt; MAX_WAIT_TIME) &#123;</span><br><span class="line">                queueMap.remove(entry.getKey());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><blockquote><p>该简易内存消息队列 以请求的sessionId作为keyword记录消息内容，在主动关闭或者队列非活跃时清理</p></blockquote><h3 id="长任务处理：此处以一个计算业务为示例"><a href="#长任务处理：此处以一个计算业务为示例" class="headerlink" title="长任务处理：此处以一个计算业务为示例"></a>长任务处理：此处以一个计算业务为示例</h3><blockquote><p>言外阐述：建议一个独立业务处理在存在大量依赖时将依赖抽离，让服务本身保持“干净”，仅注入代理依赖的上下文对象即可</p></blockquote><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ComputeService</span> &#123;</span><br><span class="line">    <span class="comment">// 不将日志记录器与推送key绑定是因为此处分为两种调用场景，选择性是否进行推送</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">logKey</span> <span class="operator">=</span> <span class="literal">null</span>;<span class="comment">// 日志记录的KEY 推送SSE使用</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">LoggerQueue</span> <span class="variable">queue</span> <span class="operator">=</span> LoggerQueue.getInstance();<span class="comment">// 日志记录器</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ComputeContext context;<span class="comment">// 计算所需的上下文依赖</span></span><br><span class="line">   <span class="keyword">public</span> <span class="title function_">ComputeService</span><span class="params">(ComputeContext context, String key)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.context = context;</span><br><span class="line">        <span class="built_in">this</span>.logKey = key;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ComputeService</span><span class="params">(ComputeContext context)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.context = context;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 执行</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 执行一些计算操作，并在执行期间写入轨迹日志</span></span><br><span class="line">...</span><br><span class="line"><span class="built_in">this</span>.log(<span class="string">&quot;XXX所命中的模型为：&#123;&#125;&quot;</span>, xxx);</span><br><span class="line">...</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log(<span class="string">&quot;计算发生错误：&#123;&#125;&quot;</span>, e.getMessage());</span><br><span class="line">            <span class="keyword">throw</span> e;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(logKey != <span class="literal">null</span>) queue.close(logKey);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 日志推送</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">log</span><span class="params">(String message, Object... args)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (logKey == <span class="literal">null</span>) &#123; <span class="keyword">return</span>; &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> MessageFormatter.arrayFormat(message, args).getMessage();</span><br><span class="line">        queue.push(msg, logKey);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><blockquote><p>这样一个简易的业务服务就完成了，这只是方案之一，选择这种方式是它足够简单可以满足业务需求，还可以基于Slf4j进行日志注入捕获等多种方案</p></blockquote><h3 id="控制处理器"><a href="#控制处理器" class="headerlink" title="控制处理器"></a>控制处理器</h3><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Example</span></span><br><span class="line"><span class="meta">@GetMapping(value = &quot;/compute&quot;, produces = MediaType.TEXT_EVENT_STREAM_VALUE)</span></span><br><span class="line"><span class="keyword">public</span> Flux&lt;String&gt; <span class="title function_">streamEvents</span><span class="params">(<span class="meta">@RequestParam(&quot;code&quot;)</span>String code)</span> &#123;</span><br><span class="line">    <span class="comment">// 开启消息队列并返回keyword</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">id</span> <span class="operator">=</span> LoggerQueue.getInstance().open();</span><br><span class="line"><span class="comment">// 注入业务所需，传入keywrod</span></span><br><span class="line">    <span class="type">ComputeService</span> <span class="variable">computeService</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ComputeService</span>(computeContext, id);</span><br><span class="line">    <span class="comment">// 异步线程进行长耗时工作</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Thread</span>(computeService::run).start();</span><br><span class="line">    <span class="comment">// 向客户端返回一个Flux流对象-每100毫秒消费一条日志，这是由于我希望轨迹是“平稳的”，它真实的实时性不需要保证，只需要确保每100毫秒都存在一次输出</span></span><br><span class="line">    <span class="keyword">return</span> Flux.interval(Duration.ofMillis(<span class="number">100</span>))</span><br><span class="line">            .map(val -&gt; LoggerQueue.getInstance().pop(id))</span><br><span class="line">            .onErrorReturn(<span class="string">&quot;计算完毕！&quot;</span>);<span class="comment">// 在计算结束或计算完成后抛出一个结束标识，客户端应该识别该标识做显示处理</span></span><br><span class="line"><span class="comment">// 此处我强制消费结束后无论是正常结束还是异常结束都抛出错误，是用以让 异常 来关闭服务端的Flux流 避免挂起</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h2><blockquote><p>原生JS ES6支持的SSE通信对象</p></blockquote><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> event = <span class="literal">null</span></span><br><span class="line"><span class="keyword">const</span> url = <span class="string">&#x27;http://example.com?code=&#x27;</span> + <span class="string">&#x27;xxx&#x27;</span></span><br><span class="line"><span class="keyword">const</span> messgae = []</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">operation</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (event) &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">    message = []</span><br><span class="line">    event = <span class="keyword">new</span> <span class="title class_">EventSource</span>(url)</span><br><span class="line">    event.<span class="property">onmessage</span> = <span class="function"><span class="params">message</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 该message为每次推送的响应对象</span></span><br><span class="line">      message.<span class="title function_">push</span>(message.<span class="property">data</span>)</span><br><span class="line">      <span class="keyword">const</span> element = <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;el-card&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">      <span class="comment">// 在页面展示中，应该存在一个定高card来呈现message，每条新消息被推送过来应该让该card滚动条自动粘在底部</span></span><br><span class="line">      element.<span class="property">scrollTop</span> = element.<span class="property">scrollHeight</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">event</span>.<span class="property">onerror</span> = <span class="function"><span class="params">_</span> =&gt;</span> &#123;</span><br><span class="line">      event.<span class="title function_">close</span>()</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; event = <span class="literal">null</span> &#125;, <span class="number">200</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="废话"><a href="#废话" class="headerlink" title="废话"></a>废话</h2><blockquote><p>SEE轻量单向通信协议用途还有很多，常见的有<br>用户通知，资源对象请求……</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring参数解析增强-Get解析多维对象</title>
      <link href="/2025/03/12/Spring%20GET%E8%AF%B7%E6%B1%82%E4%BC%A0%E9%80%92%E4%BA%8C%E7%BB%B4%E5%AF%B9%E8%B1%A1/"/>
      <url>/2025/03/12/Spring%20GET%E8%AF%B7%E6%B1%82%E4%BC%A0%E9%80%92%E4%BA%8C%E7%BB%B4%E5%AF%B9%E8%B1%A1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>基于RESTful的接口规范,在一个复杂查询对象传递二维查询参数时无法解析</p></blockquote><h3 id="一维对象"><a href="#一维对象" class="headerlink" title="一维对象"></a>一维对象</h3><p>简单使用 <code>@ModelAttribute</code>注解绑定即可</p><h3 id="多维POJO"><a href="#多维POJO" class="headerlink" title="多维POJO"></a>多维POJO</h3><blockquote><p>自定义注解类型转换器在字段声明，用fast json转换类型</p></blockquote><h4 id="1-自定义注解"><a href="#1-自定义注解" class="headerlink" title="1. 自定义注解"></a>1. 自定义注解</h4><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.spring.annotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.METHOD, ElementType.FIELD, ElementType.PARAMETER, ElementType.ANNOTATION_TYPE&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> StringToPojoFormat &#123;</span><br><span class="line">    Class&lt;?&gt; value();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h4 id="2-自定义Formatter实现类"><a href="#2-自定义Formatter实现类" class="headerlink" title="2. 自定义Formatter实现类"></a>2. 自定义Formatter实现类</h4><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.spring.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> org.springframework.format.Formatter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.text.ParseException;</span><br><span class="line"><span class="keyword">import</span> java.util.Locale;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StringToPojoFormatter</span> <span class="keyword">implements</span> <span class="title class_">Formatter</span>&lt;Object&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> Class&lt;?&gt; clazz;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">parse</span><span class="params">(String text, Locale locale)</span> <span class="keyword">throws</span> ParseException &#123;</span><br><span class="line">        <span class="keyword">return</span> JSONObject.parseObject(text, clazz);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">print</span><span class="params">(Object object, Locale locale)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> object.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setClazz</span><span class="params">(Class&lt;?&gt; clazz)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.clazz = clazz;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h4 id="3-自定义格式化工厂供给"><a href="#3-自定义格式化工厂供给" class="headerlink" title="3. 自定义格式化工厂供给"></a>3. 自定义格式化工厂供给</h4><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.spring.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.spring.annotation.StringToPojoFormat;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.EmbeddedValueResolutionSupport;</span><br><span class="line"><span class="keyword">import</span> org.springframework.format.AnnotationFormatterFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.format.Parser;</span><br><span class="line"><span class="keyword">import</span> org.springframework.format.Printer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StringToPojoFormatAnnotationFormatterFactory</span> <span class="keyword">extends</span> <span class="title class_">EmbeddedValueResolutionSupport</span></span><br><span class="line">        <span class="keyword">implements</span> <span class="title class_">AnnotationFormatterFactory</span>&lt;StringToPojoFormat&gt;&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;Class&lt;?&gt;&gt; getFieldTypes() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;Class&lt;?&gt;&gt;()&#123;&#123;</span><br><span class="line">            add(String.class);</span><br><span class="line">            add(Object.class);</span><br><span class="line">        &#125;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Printer&lt;?&gt; getPrinter(StringToPojoFormat format, Class&lt;?&gt; aClass) &#123;</span><br><span class="line">        <span class="type">StringToPojoFormatter</span> <span class="variable">booleanFormatter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringToPojoFormatter</span>();</span><br><span class="line">        booleanFormatter.setClazz(format.value());</span><br><span class="line">        <span class="keyword">return</span> booleanFormatter;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Parser&lt;?&gt; getParser(StringToPojoFormat format, Class&lt;?&gt; aClass) &#123;</span><br><span class="line">        <span class="type">StringToPojoFormatter</span> <span class="variable">booleanFormatter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringToPojoFormatter</span>();</span><br><span class="line">        booleanFormatter.setClazz(format.value());</span><br><span class="line">        <span class="keyword">return</span> booleanFormatter;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h4 id="4-WEB-MVC配置注册"><a href="#4-WEB-MVC配置注册" class="headerlink" title="4. WEB MVC配置注册"></a>4. WEB MVC配置注册</h4><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.spring;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.spring.service.StringToPojoFormatAnnotationFormatterFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.format.FormatterRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebConfigurer</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addFormatters</span><span class="params">(FormatterRegistry registry)</span> &#123;</span><br><span class="line">        registry.addFormatterForFieldAnnotation(<span class="keyword">new</span> <span class="title class_">StringToPojoFormatAnnotationFormatterFactory</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h4 id="5-使用"><a href="#5-使用" class="headerlink" title="5. 使用"></a>5. 使用</h4><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">task</span><span class="params">(<span class="meta">@ModelAttribute</span> Test test)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Test类内嵌套对象Test2</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="meta">@StringToPojoFormat(Test2.class)</span></span><br><span class="line">    <span class="keyword">private</span> Test2 t2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> spring </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue2动态路由与树形菜单的简单实现</title>
      <link href="/2025/03/12/VUE%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1%E4%B8%8E%E6%A0%91%E5%BD%A2%E8%8F%9C%E5%8D%95/"/>
      <url>/2025/03/12/VUE%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1%E4%B8%8E%E6%A0%91%E5%BD%A2%E8%8F%9C%E5%8D%95/</url>
      
        <content type="html"><![CDATA[<h2 id="前述"><a href="#前述" class="headerlink" title="前述"></a>前述</h2><blockquote><p>VUE2.0X  v-router3.0X vuex</p></blockquote><p>此为element-ui弱定制</p><h2 id="1-静态路由与路由设置"><a href="#1-静态路由与路由设置" class="headerlink" title="1. 静态路由与路由设置"></a>1. 静态路由与路由设置</h2><p>router\index.js</p><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> constantRoutes = [</span><br><span class="line">    <span class="comment">// 不鉴权静态路由区域</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 路由体设置</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">createRouter</span> = (<span class="params"></span>) =&gt; <span class="keyword">new</span> <span class="title class_">Router</span>(&#123;</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;history&#x27;</span>, <span class="comment">// require service support</span></span><br><span class="line">  <span class="attr">scrollBehavior</span>: <span class="function">() =&gt;</span> (&#123;<span class="attr">y</span>: <span class="number">0</span>&#125;),</span><br><span class="line">  <span class="attr">base</span>: process.<span class="property">env</span>.<span class="property">BASE_URL</span>,</span><br><span class="line">  <span class="attr">routes</span>: constantRoutes</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>()</span><br><span class="line"><span class="comment">// 重写addRoutes</span></span><br><span class="line"><span class="keyword">const</span> addRoutes = <span class="title class_">Router</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">addRoutes</span>;</span><br><span class="line"><span class="title class_">Router</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">addRoutes</span> = <span class="keyword">function</span> (<span class="params">newRoutes</span>) &#123;</span><br><span class="line">  router.<span class="property">matcher</span> = <span class="title function_">createRouter</span>(constantRoutes).<span class="property">matcher</span>; <span class="comment">//通过重置matcher来重置router</span></span><br><span class="line">  addRoutes.<span class="title function_">call</span>(<span class="variable language_">this</span>, newRoutes); <span class="comment">//调用原有方法</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 刷新设置</span></span><br><span class="line"><span class="comment">// Detail see: https://github.com/vuejs/vue-router/issues/1234#issuecomment-357941465</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">resetRouter</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> newRouter = <span class="title function_">createRouter</span>()</span><br><span class="line">  router.<span class="property">matcher</span> = newRouter.<span class="property">matcher</span> <span class="comment">// reset router</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure></div><h2 id="2-动态路由触发节点"><a href="#2-动态路由触发节点" class="headerlink" title="2. 动态路由触发节点"></a>2. 动态路由触发节点</h2><blockquote><p>每个人都有自己的一套逻辑方案 多为采用 会话机制 随时检测 借助SessionStorage</p><p>我采用长持久 登录检测 LocalStorage</p></blockquote><ol><li><strong>登录成功后触发</strong></li></ol><blockquote><p>这代表菜单变更需要用户重登</p></blockquote><ol start="2"><li><strong>后台传递的扁平化示例数据</strong></li></ol><blockquote><p>至少存在三个属性，本身唯一标识(id) 父级唯一标识(parent_id) 自身所处层级&#x2F;第几级菜单(level)</p></blockquote><div class="code-container" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        id<span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        parentId<span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        level<span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        sort<span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">        title<span class="punctuation">:</span> <span class="string">&quot;菜单&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure></div><ol start="3"><li><strong>组装扁平化数据为树形</strong></li></ol><blockquote><p>常见的就是类比冒泡形式的递归合并</p><p>有类似Level的层级属性时可借助此属性来进行效率更高的简单合并</p></blockquote><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 示例属性存在sort目的是为了允许操作者排序菜单展示顺序</span></span><br><span class="line"><span class="comment">// 此处借助map映射 因为唯一标识id为int 所以加前缀转字符化 防止JS进行被动化排序</span></span><br><span class="line"><span class="keyword">let</span> prefix = <span class="string">&#x27;_&#x27;</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">convertTree</span>(<span class="params">menus</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (menus.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> [];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> list = [];</span><br><span class="line">  <span class="comment">// 此时假设拿到的数据是按 level的 esc 有序数组</span></span><br><span class="line">  <span class="comment">// 借助level属性进行分治，每一级菜单作为数组一个子节点</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; menus[menus.<span class="property">length</span>-<span class="number">1</span>].<span class="property">level</span>; i++) &#123;</span><br><span class="line">    list.<span class="title function_">push</span>(&#123;&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  menus.<span class="title function_">forEach</span>(<span class="function"><span class="params">menu</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> obj = list[menu.<span class="property">level</span>-<span class="number">1</span>];</span><br><span class="line">    obj[prefix+menu.<span class="property">id</span>] = menu;</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="comment">// 层级分割完毕后 从最低级菜单开始向上合并 i &gt; 0标识最高级菜单不需要合并 直接返回</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = list.<span class="property">length</span> - <span class="number">1</span>; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">    <span class="keyword">let</span> target = list[i-<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">let</span> current = list[i];</span><br><span class="line">    <span class="title function_">insertNode</span>(target, current);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 合并完毕后去除合并结果的映射key 其就是一个有序的树形菜单</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Object</span>.<span class="title function_">values</span>(list[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 节点插入</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">insertNode</span>(<span class="params">target, current</span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> current) &#123;</span><br><span class="line">    <span class="keyword">let</span> currObj = current[key];</span><br><span class="line">    <span class="keyword">let</span> tarObj = target[prefix + currObj.<span class="property">parentId</span>];</span><br><span class="line">    <span class="keyword">if</span> (tarObj) &#123;</span><br><span class="line">      <span class="keyword">if</span> (tarObj.<span class="property">children</span> === <span class="literal">undefined</span>) &#123;</span><br><span class="line">        tarObj.<span class="property">children</span> = [];</span><br><span class="line">      &#125;</span><br><span class="line">      tarObj.<span class="property">children</span>.<span class="title function_">push</span>(currObj);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><ol start="4"><li><strong>本地存储一下</strong></li></ol><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(menuKey, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(arr))</span><br></pre></td></tr></table></figure></div><h2 id="3-动态路由组装"><a href="#3-动态路由组装" class="headerlink" title="3. 动态路由组装"></a>3. 动态路由组装</h2><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Layout</span> <span class="keyword">from</span> <span class="string">&#x27;@/layout&#x27;</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;../../store&#x27;</span></span><br><span class="line"><span class="keyword">import</span> router, &#123; constantRoutes, resetRouter &#125; <span class="keyword">from</span> <span class="string">&quot;../../router&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> menuKey = <span class="string">&quot;USER:MENU:KEY&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> state = &#123;</span><br><span class="line">  <span class="attr">addedRoute</span>: <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(menuKey) || <span class="string">&quot;[]&quot;</span>), <span class="comment">// 序列化完毕的菜单</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> getters = &#123;</span><br><span class="line">  <span class="comment">// 根据addedRoute处理过后的要添加到所有路由中的异步路由</span></span><br><span class="line">  <span class="attr">asyncRoute</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> asyncRouteData = state.<span class="property">addedRoute</span></span><br><span class="line">    <span class="keyword">let</span> asyncRouteList = []</span><br><span class="line">    <span class="keyword">if</span>(asyncRouteData)&#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">let</span> item <span class="keyword">of</span> asyncRouteData)&#123; <span class="comment">// 具体要添加的路由内容字段，看个人项目需求</span></span><br><span class="line">        <span class="keyword">let</span> addedRouterItem = <span class="title function_">insertNode</span>(item, item.<span class="property">path</span>)</span><br><span class="line">        asyncRouteList.<span class="title function_">push</span>(addedRouterItem)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// *的后置处理路由必须在所有路由(静/动)添加完毕后再追加</span></span><br><span class="line">    asyncRouteList.<span class="title function_">push</span>(&#123; <span class="attr">path</span>: <span class="string">&#x27;*&#x27;</span>, <span class="attr">redirect</span>: <span class="string">&#x27;/404&#x27;</span>, <span class="attr">hidden</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">    <span class="comment">// 此处不使用addRoutes()添加一次，只在路由守卫方法中addRoutes()的话，初次点击自定义路由页面会有问题</span></span><br><span class="line">    router.<span class="title function_">addRoutes</span>(asyncRouteList)</span><br><span class="line">    <span class="comment">// 随便你在哪里加这个状态值 理由vuex状态来防止它无限循环加载</span></span><br><span class="line">    store.<span class="property">state</span>.<span class="property">user</span>.<span class="property">router</span> = <span class="literal">true</span></span><br><span class="line">    <span class="keyword">return</span> asyncRouteList</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 包含最初定义的静态路由和异步路由的最终路由</span></span><br><span class="line">  <span class="title function_">lastRoute</span>(<span class="params">state, getters</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> constantRoutes.<span class="title function_">concat</span>(getters.<span class="property">asyncRoute</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 将树形菜单数据组装为vue路由,多一个path参数是为了让redirect选定第一个子节点</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">insertNode</span>(<span class="params">item, path</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> obj = &#123; <span class="comment">// 此处就随便你怎么组装了 对照静态路由模板和你的数据源就行</span></span><br><span class="line">    <span class="attr">path</span>: item.<span class="property">path</span>,</span><br><span class="line">    <span class="attr">name</span>: item.<span class="property">name</span>,</span><br><span class="line">    <span class="attr">meta</span>: &#123; <span class="attr">title</span>: item.<span class="property">title</span>, <span class="attr">icon</span>: item.<span class="property">icon</span> &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (item.<span class="property">component</span>) &#123;</span><br><span class="line">    <span class="comment">// 使用require进行懒加载 必须用变量模板 否则webpack不识别</span></span><br><span class="line">    obj.<span class="property">component</span> = <span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">require</span>([<span class="string">`@/views/<span class="subst">$&#123;item.component&#125;</span>`</span>], resolve)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    obj.<span class="property">component</span> = <span class="title class_">Layout</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (item.<span class="property">children</span> &amp;&amp; item.<span class="property">children</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    obj.<span class="property">redirect</span> = path+<span class="string">&#x27;/&#x27;</span>+item.<span class="property">children</span>[<span class="number">0</span>].<span class="property">path</span></span><br><span class="line">    obj.<span class="property">children</span> = [];</span><br><span class="line">    item.<span class="property">children</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">node</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 存在子节点就去递归</span></span><br><span class="line">      obj.<span class="property">children</span>.<span class="title function_">push</span>(<span class="title function_">insertNode</span>(node, obj.<span class="property">redirect</span>))</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">namespaced</span>: <span class="literal">true</span>,</span><br><span class="line">  state,</span><br><span class="line">  getters,</span><br><span class="line">  actions</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="4-刷新-链接跳转时的路由加载"><a href="#4-刷新-链接跳转时的路由加载" class="headerlink" title="4. 刷新&#x2F;链接跳转时的路由加载"></a>4. 刷新&#x2F;链接跳转时的路由加载</h2><blockquote><p>vue是单页应用，vuex状态也限制在会话期</p></blockquote><p>借助<code>permission.js</code> 在路由守卫处控制(随便哪个位置，只要拦截在路由守卫就可以)</p><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (hasToken) &#123;</span><br><span class="line">    <span class="keyword">if</span> (to.<span class="property">path</span> === loginRoute) &#123;</span><br><span class="line">       <span class="comment">// if is logged in, redirect to the home page</span></span><br><span class="line">       <span class="title function_">next</span>(&#123; <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span> &#125;)</span><br><span class="line">       <span class="title class_">NProgress</span>.<span class="title function_">done</span>()</span><br><span class="line">     &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!to.<span class="property">name</span> &amp;&amp; !store.<span class="property">state</span>.<span class="property">user</span>.<span class="property">router</span>) &#123;</span><br><span class="line">        router.<span class="title function_">addRoutes</span>(store.<span class="property">getters</span>[<span class="string">&#x27;collectDirectory/asyncRoute&#x27;</span>])<span class="comment">// 刷新动态路由</span></span><br><span class="line">        <span class="title function_">next</span>(&#123; ...to, <span class="attr">replace</span>: <span class="literal">true</span> &#125;)<span class="comment">// 重试一次跳转</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">next</span>();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p><strong>多余的设置的只有此处一段，意思是：</strong></p><blockquote><p>登录存活时(hasToken存在)<br>且当前不去往登录页面<br>且当前要加载的路由无匹配项</p><p>且动态路由在本次会话期还未被加载</p></blockquote><p>满足上述条件时调用动态路由刷新，然后重试路由跳转</p><p>为什么需要vuex的会话加载状态？防止输入一个真实不存在的路由在此处被无限循环拦截,只去加载一次重试失败就向下放行(一般会放行给 404界面)</p><h2 id="5-菜单元素的实时刷新"><a href="#5-菜单元素的实时刷新" class="headerlink" title="5. 菜单元素的实时刷新"></a>5. 菜单元素的实时刷新</h2><p>layout&#x2F;components&#x2F;Sidebar&#x2F;index.vue</p><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 原有调用静态路由列表的v-for数据池改由调用拼接所有路由结果集的结果池</span></span><br><span class="line"><span class="title function_">routes</span>(<span class="params"></span>) &#123;</span><br><span class="line">   <span class="comment">//return this.$router.options.routes</span></span><br><span class="line">   <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">getters</span>[<span class="string">&#x27;collectDirectory/lastRoute&#x27;</span>] <span class="comment">// 对应3步骤</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      
        <tags>
            
            <tag> vue2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Web开发规范</title>
      <link href="/2025/03/12/WEB%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/"/>
      <url>/2025/03/12/WEB%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/</url>
      
        <content type="html"><![CDATA[<h2 id="制定并遵循服从标准、规范和最佳实践"><a href="#制定并遵循服从标准、规范和最佳实践" class="headerlink" title="制定并遵循服从标准、规范和最佳实践"></a>制定并遵循服从标准、规范和最佳实践</h2><p>为什么你要服从标准？</p><blockquote><p>只有服从了标准，你的架构才能够有更好的扩展性</p></blockquote><p><strong>概论</strong></p><ul><li><strong>服务间调用的协议标准和规范</strong><br>这其中包括 Restful API路径, HTTP 方法、状态码、标准头、自定义头等，返回数据 JSon Scheme……等</li><li><strong>一些命名的标准和规范</strong><br>这其中包括如：用户 ID，服务名、标签名、状态名、错误码、消息、数据库……等</li><li><strong>日志和监控的规范</strong><br>这其中包括：日志格式，监控数据，采样要求，报警……等</li><li><strong>配置上的规范</strong><br>这其中包括：操作系统配置、中间件配置，软件包……等</li><li><strong>中间件使用的规范</strong><br>数据库，缓存、消息队列……等等</li><li><strong>软件和开发库版本统一</strong><br>整个组织架构内，软件或开发库的版本最好每年都升一次级，然后在各团队内统一</li></ul><h3 id="HTTP-调用的状态返回码"><a href="#HTTP-调用的状态返回码" class="headerlink" title="HTTP 调用的状态返回码"></a>HTTP 调用的状态返回码</h3><p>业内标准：</p><ul><li>200表示成功</li><li>3xx 跳转</li><li>4xx 表示调用端出错</li><li>5xx 表示服务端出错</li></ul><p>错误做法：</p><p>无论成功和失败都返回 200，然后在 body 里指出是否error</p><p>劣处：</p><blockquote><p>监控系统将在一种低效的状态下工作。</p><p>监控系统需要把所有的网络请求包打开后才知道是否是错误，而且完全不知道是调用端出错还是服务端出错，于是一些像重试或熔断这样的控制系统完全不知道怎么搞（如果是 4xx错，那么重试或熔断是没有意义的，只有 5xx 才有意义）</p></blockquote><h3 id="Restful-API-规范"><a href="#Restful-API-规范" class="headerlink" title="Restful API 规范"></a>Restful API 规范</h3><h4 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h4><table><thead><tr><th>方法</th><th>描述</th><th>幂等</th></tr></thead><tbody><tr><td>GET</td><td>用于查询操作，对应于数据库的 <code>select</code> 操作</td><td>✔</td></tr><tr><td>PUT</td><td>用于所有的信息更新，对应于数据库的 <code>update </code>操作</td><td>✔</td></tr><tr><td>DELETE</td><td>用于更新操作，对应于数据库的 <code>delete</code> 操作</td><td>✔</td></tr><tr><td>POST</td><td>用于新增操作，对应于数据库的 <code>insert</code> 操作</td><td>❌</td></tr><tr><td>HEAD</td><td>用于返回一个资源对象的“元数据”，或是用于探测API是否健康</td><td>✔</td></tr><tr><td>PATCH</td><td>局部信息更新，对应数据库<code>update</code>操作</td><td>❌</td></tr><tr><td>OPTIONS</td><td>获取API相关信息</td><td>✔</td></tr></tbody></table><h5 id="PUT与PATCH？"><a href="#PUT与PATCH？" class="headerlink" title="PUT与PATCH？"></a>PUT与PATCH？</h5><p>都是更新业务资源信息，如果资源对象不存在则可以新建一个，但他们两者的区别是，<code>PUT</code> 用于更新一个业务对象的所有完整信息，就像是我们通过表单提交所有的数据，而 <code>PACTH</code> 则对更为API化的数据更新操作，只需要更需要更新的字段（参看 <a class="link"   href="https://tools.ietf.org/html/rfc5789" >RFC 5789<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a> ）</p><h5 id="严格地按照数据库操作的CRUD来理解API？"><a href="#严格地按照数据库操作的CRUD来理解API？" class="headerlink" title="严格地按照数据库操作的CRUD来理解API？"></a>严格地按照数据库操作的CRUD来理解API？</h5><p>不是。</p><p>假设你有一个登录的API <code>/login</code> 你觉得这个API应该是 <code>GET</code> ，<code>POST</code>，<code>PUT</code> 还是 <code>PATCH</code> ?登录的时候用户需要输入用户名和密码，然后跟数据库里的对比（select操作）后反回一个登录的session token，然后这个token作为用户登录的状态令牌。如果按上面表格来说，应该是 select 操作进行 <code>GET</code> ，但是从语义上来说，登录并不是查询信息，应该是用户状态的更新或是新增操作（新增session），所以还是应该使用 <code>POST</code>，而 <code>/logout</code> 你可以使用 <code>DELETE</code> 。<strong>这里想说明一下，不要机械地通过数据库的CRUD来对应这些动词，很多时候，还是要分析一下业务语义。</strong></p><h5 id="幂等控制？"><a href="#幂等控制？" class="headerlink" title="幂等控制？"></a>幂等控制？</h5><p>**API的幂等对于控制逻辑来说是一件很重要的事。**所谓幂等，就是该API执行多次和执行一次的结果是完全一样的，没有副作用。</p><ul><li><code>POST</code> 用于新增加数据，比如，新增一个交易订单，这肯定不能是幂等的</li><li><code>DELETE</code> 用于删除数据，一个数据删除多次和删除一次的结果是一样的，所以，是幂等的</li><li><code>PUT</code> 用于全部数更新，所以，是幂等的。</li><li><code>PATCH</code>用于局部更新，比如，更新某个字段 cnt &#x3D; cnt+1，明显不可能是幂等操作。</li></ul><p>幂等这个特性对于远程调用是一件非常关键的事，就是说，远程调用有很多时候会因为网络原因导致调用timeout，对于timeout的请求，我们是无法知道服务端是否已经是收到请求并执行了，此时，我们不能贸然重试请求，对于不是幂等的调用来说，这会是灾难性的。比如像转帐这样的业务逻辑，转一次和转多次结果是不一样的，如果重新的话有可能就会多转了一次。所以，这个时候，如果你的API遵从了HTTP动词的规范，那么你写起程序来就可以明白在哪些动词下可以重试，而在哪些动词下不能重试。如果你把所有的API都用POST来表达的话，就完全失控了。</p><h5 id="复杂查询？"><a href="#复杂查询？" class="headerlink" title="复杂查询？"></a>复杂查询？</h5><p>一般来说，对于查询类的API，主要就是要完成四种操作：排序，过滤，搜索，分页。下面是一些相关的规范。参考于两个我觉得写的最好的Restful API的规范文档，<a class="link"   href="https://github.com/microsoft/api-guidelines/blob/vNext/Guidelines.md" >Microsoft REST API Guidelines<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>，<a class="link"   href="https://github.com/paypal/api-standards/blob/master/api-style-guide.md" >Paypal API Design Guidelines<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>。</p><ul><li><strong>排序</strong>。对于结果集的排序，使用 <code>sort</code> 关键字，以及 <code>&#123;field_name&#125;|&#123;asc|desc&#125;,&#123;field_name&#125;|&#123;asc|desc&#125;</code> 的相关语法。比如，某API需要返回公司的列表，并按照某些字段排序，如：<code>GET /admin/companies?sort=rank|asc</code> 或是 <code>GET /admin/companies?sort=rank|asc,zip_code|desc</code></li><li><strong>过滤</strong>。对于结果集的过滤，使用 <code>filter</code> 关键字，以及 <code>&#123;field_name&#125; op&#123;value&#125;</code> 的语法。比如： <code>GET /companies?category=banking&amp;location=china</code> 。但是，有些时候，我们需要更为灵活的表达式，我们就需要在URL上构造我们的表达式。这里需要定义六个比较操作：<code>=</code>，<code>&lt;</code>，<code>&gt;</code>，<code>&lt;=</code>，<code>&gt;=</code>，以及三个逻辑操作：<code>and</code>，<code>or</code>，<code>not</code>。（表达式中的一些特殊字符需要做一定的转义，比如：<code>&gt;=</code> 转成 <code>ge</code>）于是，我们就会有如下的查询表达式：<code>GET /products?$filter=name eq &#39;Milk&#39; and price lt 2.55</code> 查找所有的价柗小于2.55的牛奶。</li><li><strong>搜索</strong>。对于相关的搜索，使用 <code>search</code> 关键字，以及关键词。如：<code>GET /books/search?description=algorithm</code> 或是直接就是全文搜索 <code>GET /books/search?key=algorithm</code> 。</li><li><strong>分页</strong>。对于结果集进行分页处理，分页必需是一个默认行为，这样不会产生大量的返回数据。<ul><li>使用<code>page</code>和<code>per_page</code>代表页码和每页数据量，比如：<code>GET /books?page=3&amp;per_page=20</code>。</li><li><strong>可选</strong>。上面提到的<code>page</code>方式为使用相对位置来获取数据，可能会存在两个问题：性能（大数据量）与数据偏差（高频更新）。此时可以使用绝对位置来获取数据：事先记录下当前已获取数据里最后一条数据的<code>ID</code>、<code>时间</code>等信息，以此获取 “<strong>该ID之前的数据</strong>” 或 “<strong>该时刻之前的数据</strong>”。示例：<code>GET /news?max_id=23454345&amp;per_page=20</code> 或 <code>GET /news?published_before=2011-01-01T00:00:00Z&amp;per_page=20</code>。</li></ul></li></ul><p>另外，对于一些更为复杂的操作，建议通过分别调用多个API的方式来完成，虽然这样会增加网络请求的次数，但是这样的可以让后端程序和数据耦合度更小，更容易成为微服务的架构。</p><p>最后，如果你想在Rest中使用像GraphQL那样的查询语言，你可以考虑一下类似 <a class="link"   href="https://www.odata.org/" >OData<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a> 的解决方案。OData 是 Open Data Protocol 的缩写，最初由 Microsoft 于 2007 年开发。它是一种开放协议，使您能够以简单和标准的方式创建和使用可查询和可互操作的 RESTful API。</p><h5 id="“读”时的GET参数超长？"><a href="#“读”时的GET参数超长？" class="headerlink" title="“读”时的GET参数超长？"></a>“读”时的GET参数超长？</h5><p>正常场景下，参数超长对于整个系统应用而言是一种极端个例，你不应该为此付出过多的代价<br>此时较为合适的做法有：</p><ul><li>建立中间层存储查询条件，一次查询请求拆分两次请求，第一次POST去创建请求对象返回唯一标识，第二次GET利用此标识执行查询</li><li>不必严格遵守CURD规范，此个例可以使用POST进行直接查询，其影响对于整个系统而言是“可控的”</li></ul><h4 id="问题-Q"><a href="#问题-Q" class="headerlink" title="问题&#x2F;Q"></a>问题&#x2F;Q</h4><ul><li><p><strong>POST一把梭？</strong></p><p>用POST干一切就像看到了来你家装修工人说，“老子干活就是用钉子钉一切，什么螺丝、螺栓、卡扣、插销……通通不用，钉枪一把梭，方便，快捷，安全，干完早回家……</p></li><li><p><strong>为什么要用不同的HTTP动词？</strong><br>编程世界通常来说有两种逻辑：“<strong>业务逻辑</strong>” 和 “<strong>控制逻辑</strong>”</p><ul><li><p><strong>业务逻辑</strong>。就是你实现业务需求的功能的代码，就是跟用户需求强相关的代码。比如，把用户提交的数据保存起来，查询用户的数据，完成一个订单交易，为用户退款……等等，这些是业务逻辑</p></li><li><p><strong>控制逻辑</strong>。就是我们用于控制程序运行的非功能性的代码。比如，用于控制程序循环的变量和条件，使用多线程或分布式的技术，使用HTTP&#x2F;TCP协议，使用什么样数据库，什么样的中间件……等等，这些跟用户需求完全没关系的东西。</p></li></ul><p>网络协议也是一样的，一般来说，<strong>几乎所有的主流网络协议都有两个部分，一个是协议头，一个是协议体。协议头中是协议自己要用的数据，协议体才是用户的数据。所以，协议头主要是用于协议的控制逻辑，而协议体则是业务逻辑。</strong></p><p>HTTP的动词（或是Method）是在协议头中，所以，其主要用于控制逻辑。</p><p>使用合适的HTTP动词来完善控制逻辑，以增强程序的扩展性，你可能会有如下需求：</p><ul><li><strong>缓存</strong>。通过CDN或是网关对API进行缓存，很显然，我们要在查询<code>GET</code> 操作上建议缓存。</li><li><strong>流控</strong>。你可以通过HTTP的动词进行更粒度的流控，比如：限制API的请用频率，在读操作上和写操作上应该是不一样的。</li><li><strong>路由</strong>。比如：写请求路由到写服务上，读请求路由到读服务上。</li><li><strong>权限</strong>。可以获得更细粒度的权限控制和审计。</li><li><strong>监控</strong>。因为不同的方法的API的性能都不一样，所以，可以区分做性能分析。</li><li><strong>压测</strong>。当你需要压力测试API时，如果没有动词的区分的话，我相信你的压力测试很难搞吧。</li><li>……等等</li></ul></li><li><h5 id="为什么API-要Restful，并符合规范？"><a href="#为什么API-要Restful，并符合规范？" class="headerlink" title="为什么API 要Restful，并符合规范？"></a>为什么API 要Restful，并符合规范？</h5><p>Restful API算是一个HTTP的规范和标准了，你要说是最佳实践也好，总之，它是一个全世界对HTTP API的一个共识。在这个共识上，你可以无成本地享受很多的技术红利，比如：CDN，API网关，服务治理，监控……等等。这些都是可以让你大幅度降低研发成本，避免踩坑的原因</p></li><li><h5 id="为什么“过早优化”不适用于API设计？"><a href="#为什么“过早优化”不适用于API设计？" class="headerlink" title="为什么“过早优化”不适用于API设计？"></a>为什么“过早优化”不适用于API设计？</h5><p>因为API是一种契约，一旦被使用上，就很难再变更了，就算你发行新的版本的API，你还要驱动各种调用方升级他们的调用方式。所以，接口设计就像数据库模式设计一下，一旦设计好了，未来再变更就比较难了。所以，还是要好好设计</p></li><li><h5 id="POST-更安全吗？"><a href="#POST-更安全吗？" class="headerlink" title="POST 更安全吗？"></a>POST 更安全吗？</h5><p>不会。<br>在 <strong>CSRF</strong>这个最常见的安全问题上，则完全就是针对 <code>POST</code> 的。 安全是一件很复杂的事，无论你用哪方法或动词都会不能代表你会更安全。</p></li><li><h5 id="全用-POST-可以节省时间减少沟通吗？"><a href="#全用-POST-可以节省时间减少沟通吗？" class="headerlink" title="全用 POST 可以节省时间减少沟通吗？"></a>全用 POST 可以节省时间减少沟通吗？</h5><p>不但不会，反而更糟糕。</p><ul><li>一种良好的编程风格，可以见名知意</li><li>节约了团队沟通成本，节约了新人的学习成本，当你遵从了业内规范时就代表大多数人与你的项目是“合得来”的</li><li>非规范开发的本身是技术债，在你需要增加控制逻辑时你的review成本将会极其高</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> 软件基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 设计架构 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基于ElementUI的标签页缓存</title>
      <link href="/2025/03/12/vue-element-admin%E7%9A%84%E6%A0%87%E7%AD%BE%E9%A1%B5%E7%BC%93%E5%AD%98/"/>
      <url>/2025/03/12/vue-element-admin%E7%9A%84%E6%A0%87%E7%AD%BE%E9%A1%B5%E7%BC%93%E5%AD%98/</url>
      
        <content type="html"><![CDATA[<h2 id="VUE-ELEMENT-ADMIN"><a href="#VUE-ELEMENT-ADMIN" class="headerlink" title="VUE-ELEMENT-ADMIN"></a>VUE-ELEMENT-ADMIN</h2><p>2.15.X，开启Tags的标签页会话级缓存</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="data:image/png;base64,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"                      alt="image-20220803161324580"                ></p><h3 id="1-组件准备"><a href="#1-组件准备" class="headerlink" title="1. 组件准备"></a>1. 组件准备</h3><p>确保项目内存在：</p><blockquote><p>vue-admin-template\src\layout\components\TagsView 文件夹</p><p>vue-admin-template\src\store\modules\tagsView.js 文件</p></blockquote><p>如果不存在需要去原项目拷贝</p><h3 id="2-修改AppMain声明缓存页"><a href="#2-修改AppMain声明缓存页" class="headerlink" title="2. 修改AppMain声明缓存页"></a>2. 修改<code>AppMain</code>声明缓存页</h3><p><em><strong>vue-admin-template\src\layout\components\AppMain.vue</strong></em></p><blockquote><p>keep-alive新增include属性声明缓存页面</p></blockquote><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">&quot;app-main&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">&quot;fade-transform&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;out-in&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">keep-alive</span> <span class="attr">:include</span>=<span class="string">&quot;cachedViews&quot;</span>&gt;</span> <span class="comment">&lt;!-- 此处新增 --&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">router-view</span> <span class="attr">:key</span>=<span class="string">&quot;key&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">keep-alive</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">section</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">name</span>: <span class="string">&#x27;AppMain&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">computed</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">cachedViews</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">state</span>.<span class="property">tagsView</span>.<span class="property">cachedViews</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">key</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">$route</span>.<span class="property">fullPath</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure></div><h3 id="3-修改index-js载入标签视图组件"><a href="#3-修改index-js载入标签视图组件" class="headerlink" title="3. 修改index.js载入标签视图组件"></a>3. 修改<code>index.js</code>载入标签视图组件</h3><p><em><strong>vue-admin-template\src\layout\components\index.js</strong></em></p><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> <span class="title class_">Navbar</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./Navbar&#x27;</span></span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> <span class="title class_">Sidebar</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./Sidebar&#x27;</span></span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> <span class="title class_">AppMain</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./AppMain&#x27;</span></span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> <span class="title class_">TagsView</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./TagsView&#x27;</span> &lt;!-- 导出组件/别名变量 --&gt;</span><br></pre></td></tr></table></figure></div><h3 id="4-修改index-vue全局视图加入标签组件"><a href="#4-修改index-vue全局视图加入标签组件" class="headerlink" title="4. 修改index.vue全局视图加入标签组件"></a>4. 修改<code>index.vue</code>全局视图加入标签组件</h3><p><em><strong>vue-admin-template\src\layout\index.vue</strong></em></p><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:class</span>=<span class="string">&quot;classObj&quot;</span> <span class="attr">class</span>=<span class="string">&quot;app-wrapper&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;device===&#x27;mobile&#x27;&amp;&amp;sidebar.opened&quot;</span> <span class="attr">class</span>=<span class="string">&quot;drawer-bg&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleClickOutside&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">sidebar</span> <span class="attr">class</span>=<span class="string">&quot;sidebar-container&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;main-container&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">:class</span>=<span class="string">&quot;&#123;&#x27;fixed-header&#x27;:fixedHeader&#125;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">navbar</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">tags-view</span> /&gt;</span>    <span class="comment">&lt;!-- 此处加入标签视图组件 --&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">app-main</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Navbar</span>, <span class="title class_">Sidebar</span>, <span class="title class_">AppMain</span>, <span class="title class_">TagsView</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./components&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;Layout&#x27;</span>,</span><br><span class="line">  <span class="attr">components</span>: &#123;</span><br><span class="line">    <span class="title class_">Navbar</span>,</span><br><span class="line">    <span class="title class_">Sidebar</span>,</span><br><span class="line">    <span class="title class_">AppMain</span>,</span><br><span class="line">    <span class="title class_">TagsView</span> &lt;!-- 此处加入标签视图组件 --&gt;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="5-VUEX引缓存工具"><a href="#5-VUEX引缓存工具" class="headerlink" title="5. VUEX引缓存工具"></a>5. VUEX引缓存工具</h3><p><em><strong>vue-admin-template\src\store\getters.js</strong></em></p><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getters = &#123;</span><br><span class="line">  <span class="attr">sidebar</span>: <span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">app</span>.<span class="property">sidebar</span>,</span><br><span class="line">  <span class="attr">visitedViews</span>: <span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">tagsView</span>.<span class="property">visitedViews</span>,</span><br><span class="line">  <span class="attr">cachedViews</span>: <span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">tagsView</span>.<span class="property">cachedViews</span><span class="comment">// 此处增加</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> getters</span><br></pre></td></tr></table></figure></div><p><em><strong>vue-admin-template\src\store\index.js</strong></em></p><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tagsView <span class="keyword">from</span> <span class="string">&#x27;./modules/tagsView&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">modules</span>: &#123;</span><br><span class="line">    app,</span><br><span class="line">    permission,</span><br><span class="line">    settings,</span><br><span class="line">    tagsView, &lt;!-- 此处新增--&gt;</span><br><span class="line">    user</span><br><span class="line">  &#125;,</span><br><span class="line">  getters</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div><p><em><strong>vue-admin-template\src\store\modules\settings.js</strong></em></p><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; showSettings, tagsView, fixedHeader, sidebarLogo &#125; = defaultSettings</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> state = &#123;</span><br><span class="line">  <span class="attr">showSettings</span>: showSettings,</span><br><span class="line">  <span class="attr">tagsView</span>: tagsView, &lt;!-- 此处新增--&gt;</span><br><span class="line">  <span class="attr">fixedHeader</span>: fixedHeader,</span><br><span class="line">  <span class="attr">sidebarLogo</span>: sidebarLogo</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="6-动态路由兼容与空路由组判断"><a href="#6-动态路由兼容与空路由组判断" class="headerlink" title="6. 动态路由兼容与空路由组判断"></a>6. 动态路由兼容与空路由组判断</h3><p><em><strong>vue-admin-template\src\layout\components\TagsView\index.vue</strong></em></p><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">computed</span>: &#123;</span><br><span class="line">    <span class="title function_">visitedViews</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">state</span>.<span class="property">tagsView</span>.<span class="property">visitedViews</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">routes</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="comment">// 这里指向最终路由组，如果是动态路由应该指向其最终结果 下述getters[&#x27;collectDirectory/lastRoute&#x27;]仅为本身动态路由组位置，无参考意义</span></span><br><span class="line">      <span class="comment">//return this.$router.options.routes</span></span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">getters</span>[<span class="string">&#x27;collectDirectory/lastRoute&#x27;</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">filterAffixTags</span>(<span class="params">routes, basePath = <span class="string">&#x27;/&#x27;</span></span>) &#123;</span><br><span class="line">      <span class="keyword">let</span> tags = []</span><br><span class="line">      <span class="comment">// 加上判空 如果使用动态路由或者跳转空单页时会拿不到路由组</span></span><br><span class="line">      <span class="keyword">if</span> (!!routes &amp;&amp; routes.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        routes.<span class="title function_">forEach</span>(<span class="function"><span class="params">route</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (route.<span class="property">meta</span> &amp;&amp; route.<span class="property">meta</span>.<span class="property">affix</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> tagPath = path.<span class="title function_">resolve</span>(basePath, route.<span class="property">path</span>)</span><br><span class="line">            tags.<span class="title function_">push</span>(&#123;</span><br><span class="line">              <span class="attr">fullPath</span>: tagPath,</span><br><span class="line">              <span class="attr">path</span>: tagPath,</span><br><span class="line">              <span class="attr">name</span>: route.<span class="property">name</span>,</span><br><span class="line">              <span class="attr">meta</span>: &#123; ...route.<span class="property">meta</span> &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> (route.<span class="property">children</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> tempTags = <span class="variable language_">this</span>.<span class="title function_">filterAffixTags</span>(route.<span class="property">children</span>, route.<span class="property">path</span>)</span><br><span class="line">            <span class="keyword">if</span> (tempTags.<span class="property">length</span> &gt;= <span class="number">1</span>) &#123;</span><br><span class="line">              tags = [...tags, ...tempTags]</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> tags</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></div><h3 id="7-标签页缓存未生效，每次切换都重新加载本页解决"><a href="#7-标签页缓存未生效，每次切换都重新加载本页解决" class="headerlink" title="7. 标签页缓存未生效，每次切换都重新加载本页解决"></a>7. 标签页缓存未生效，每次切换都重新加载本页解决</h3><blockquote><p>单页中的 vue 声明必须携带 name</p><p>且name必须与path拼写一致，但name必须大写，path必须小写</p><p>router中的路由声明必须声明<code>keepAlive</code>为true</p></blockquote><ul><li>示例：</li></ul><p><em><strong>router&#x2F;index.js</strong></em></p><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 其中的路由声明</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;test&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Test&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/Test&#x27;</span>),</span><br><span class="line">    <span class="attr">meta</span>: &#123;<span class="attr">title</span>: <span class="string">&#x27;测试&#x27;</span>, <span class="attr">keepAlive</span>: <span class="literal">true</span>&#125;<span class="comment">// meta中的keepAlive属性声明</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>对应view</p><div class="code-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">name</span>: <span class="string">&#x27;Test&#x27;</span><span class="comment">// 此处与路由声明的path一致 首字母大写</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure></div><h3 id="8-KeepAlive声明周期钩子函数"><a href="#8-KeepAlive声明周期钩子函数" class="headerlink" title="8. KeepAlive声明周期钩子函数"></a>8. KeepAlive声明周期钩子函数</h3><p><strong>activated</strong>：页面第一次进入的时候，钩子触发的顺序是created-&gt;mounted-&gt;activated<br><strong>deactivated</strong> ：页面退出的时候会触发deactivated，当再次前进或者后退的时候只触发activated</p>]]></content>
      
      
      
        <tags>
            
            <tag> element-ui </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Centos下PHP单体基础服务部署</title>
      <link href="/2025/03/12/centos%20PHP%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/"/>
      <url>/2025/03/12/centos%20PHP%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><p>当前环境：centos7.2</p><p>预安装：php7.4  apache2.4   certbot  mysql7</p><h2 id="切换yum源"><a href="#切换yum源" class="headerlink" title="切换yum源"></a>切换yum源</h2><p>没有安装wget使用yum安装 </p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install wget -y</span><br></pre></td></tr></table></figure></div><p>切换源</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</span><br></pre></td></tr></table></figure></div><p>清除yum缓存</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum clean all</span><br></pre></td></tr></table></figure></div><p>重新生成缓存</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum makecache</span><br></pre></td></tr></table></figure></div><p>验证</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum repolist</span><br></pre></td></tr></table></figure></div><h2 id="PHP7-4"><a href="#PHP7-4" class="headerlink" title="PHP7.4"></a>PHP7.4</h2><h3 id="下载安装编译工具"><a href="#下载安装编译工具" class="headerlink" title="下载安装编译工具"></a>下载安装编译工具</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum groupinstall &#x27;Development Tools&#x27;</span><br></pre></td></tr></table></figure></div><h3 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install libxml2 libxml2-devel openssl openssl-devel bzip2 bzip2-devel libcurl libcurl-devel libjpeg libjpeg-devel libpng libpng-devel freetype freetype-devel gmp gmp-devel libmcrypt libmcrypt-devel readline readline-devel libxslt libxslt-devel zlib zlib-devel glibc glibc-devel glib2 glib2-devel ncurses curl gdbm-devel db4-devel libXpm-devel libX11-devel gd-devel gmp-devel expat-devel xmlrpc-c xmlrpc-c-devel libicu-devel libmcrypt-devel libmemcached-devel</span><br></pre></td></tr></table></figure></div><h4 id="报错："><a href="#报错：" class="headerlink" title="报错："></a>报错：</h4><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Protected multilib versions: zlib-1.2.7-17.el7.x86_64 != zlib-1.2.7-15.el7.i686</span><br></pre></td></tr></table></figure></div><p>重新安装依赖指定忽略多库</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install libxml2 libxml2-devel openssl openssl-devel bzip2 bzip2-devel libcurl libcurl-devel libjpeg libjpeg-devel libpng libpng-devel freetype freetype-devel gmp gmp-devel libmcrypt libmcrypt-devel readline readline-devel libxslt libxslt-devel zlib zlib-devel glibc glibc-devel glib2 glib2-devel ncurses curl gdbm-devel db4-devel libXpm-devel libX11-devel gd-devel gmp-devel expat-devel xmlrpc-c xmlrpc-c-devel libicu-devel libmcrypt-devel libmemcached-devel --setopt=protected_multilib=false</span><br></pre></td></tr></table></figure></div><h3 id="下载并解压php"><a href="#下载并解压php" class="headerlink" title="下载并解压php"></a>下载并解压php</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget http:``//php.net/distributions/php-7.4.0.tar.gz</span><br><span class="line">tar -zxvf php-7.4.0.tar.gz</span><br><span class="line">cd php-7.4.0</span><br></pre></td></tr></table></figure></div><h3 id="编译与指定编译项"><a href="#编译与指定编译项" class="headerlink" title="编译与指定编译项"></a>编译与指定编译项</h3><p>注意其中的路径可自由设置</p><p>其中工作组与用户不得为root权限，应建立一个专门服务于访客的工作组与用户,例如此处的www</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=/var/developer/php/php --with-config-file-path=/var/developer/php --with-fpm-user=www --with-fpm-group=www --with-curl --with-freetype=dir --with-iconv-dir --with-kerberos --with-libdir=lib64 --with-mysqli --with-openssl --with-pdo-mysql --with-pdo-sqlite --with-pear --with-xmlrpc --with-xsl --with-zlib --with-bz2 --with-mhash --enable-fpm --enable-bcmath --enable-inline-optimization --enable-mbregex --enable-mbstring --enable-opcache --enable-pcntl --enable-shmop --enable-soap --enable-sockets --enable-sysvsem --enable-sysvshm --enable-xml --enable-fpm</span><br></pre></td></tr></table></figure></div><h4 id="报错"><a href="#报错" class="headerlink" title="报错"></a>报错</h4><p>configure: error: Package requirements (libxml-2.0 &amp;gt;&#x3D; 2.7.6) were not met:No package &#039;libxml-2.0&#039; found</p><p>libxml解决：</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y libxml2-devel</span><br></pre></td></tr></table></figure></div><p>configure: error: Package requirements (krb5-gssapi krb5) were not met:</p><p>krb5解决：</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install krb5-devel</span><br></pre></td></tr></table></figure></div><p>configure: error: libcrypto not found.</p><p>openssl解决：</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum remove openssl-devel</span><br><span class="line">yum -y install openssl-devel</span><br></pre></td></tr></table></figure></div><p>configure: error: Package requirements (sqlite3 &gt; 3.7.4) were not met: No package ‘sqlite3’ found </p><p>sqlite3解决：</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install sqlite-devel</span><br></pre></td></tr></table></figure></div><p>Please reinstall the BZip2 distribution</p><p>bzip2解决：</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install bzip2 bzip2-devel</span><br></pre></td></tr></table></figure></div><p> Package requirements (libcurl &gt;&#x3D; 7.15.5) were not met:</p><p>No package ‘libcurl’ found</p><p>libcurl解决：</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install libcurl-devel</span><br></pre></td></tr></table></figure></div><p>configure: error: Package requirements (oniguruma) were not met: No package ‘oniguruma’ found</p><p>oniguruma解决：</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install oniguruma oniguruma-devel</span><br></pre></td></tr></table></figure></div><p>configure: error: Package requirements (libxslt &gt;&#x3D; 1.1.0) were not met:No package ‘libxslt’ found </p><p>libxslt解决：</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install libxslt-devel</span><br></pre></td></tr></table></figure></div><h3 id="执行编译"><a href="#执行编译" class="headerlink" title="执行编译"></a>执行编译</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure></div><h3 id="查看版本"><a href="#查看版本" class="headerlink" title="查看版本"></a>查看版本</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/var/developer/php/php/bin/php -v</span><br></pre></td></tr></table></figure></div><h3 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/profile</span><br></pre></td></tr></table></figure></div><p>​添加至最后</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PATH=$PATH:/usr/local/php/bin</span><br><span class="line">export PATH</span><br></pre></td></tr></table></figure></div><p>​更新环境变量</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure></div><p>​验证版本</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -v</span><br></pre></td></tr></table></figure></div><h3 id="配置PHP-FPM"><a href="#配置PHP-FPM" class="headerlink" title="配置PHP-FPM"></a>配置PHP-FPM</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp php.ini-production /etc/php.ini</span><br></pre></td></tr></table></figure></div><p>在安装目录找到php.ini-production</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cp /var/developer/php/php/etc/php-fpm.conf.default /var/developer/php/php/etc/php-fpm.conf</span><br><span class="line">cp /var/developer/php/php/etc/php-fpm.d/www.conf.default /var/developer/php/php/etc/php-fpm.d/www.conf</span><br><span class="line">cp /var/developer/php/php-7.4.10/sapi/fpm/init.d.php-fpm /etc/init.d/php-fpm</span><br><span class="line">chmod +x /etc/init.d/php-fpm</span><br></pre></td></tr></table></figure></div><p>启动</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service php-fpm start</span><br></pre></td></tr></table></figure></div><p>错误：</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Starting php-fpm [23-Sep-2020 11:01:51] ERROR: [pool www] please specify user and group other than root [23-Sep-2020 11:01:51] ERROR: FPM initialization failed  failed</span><br></pre></td></tr></table></figure></div><p>解决：无法以root用户运行fpm，为了系统安全 php默认是禁用该行为的，修改<a class="link"   href="http://www.conf下/" >www.conf下<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a> user与group指定用户与工作组为其他工作组而非root</p><h2 id="Apache2-4"><a href="#Apache2-4" class="headerlink" title="Apache2.4"></a>Apache2.4</h2><p>偷懒：使用yum源安装，本环境使用centos7，默认最低版本为2.4</p><p>查看yum库：</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum list httpd*</span><br></pre></td></tr></table></figure></div><p>有2.4.16，，不需要切换yum源</p><p>安装：</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install httpd</span><br></pre></td></tr></table></figure></div><p>修改查看配置文件:</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/httpd/conf/httpd.conf</span><br></pre></td></tr></table></figure></div><p>添加开机自启</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable httpd.service</span><br></pre></td></tr></table></figure></div><p>启动，查看状态</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">service httpd start</span><br><span class="line"></span><br><span class="line">service httpd status</span><br></pre></td></tr></table></figure></div><h3 id="访问问题"><a href="#访问问题" class="headerlink" title="访问问题"></a>访问问题</h3><p>注意此处的http与https为两个不同文件</p><p>在你配置https后会为你生成一个apache对应的ssl文件，我的存放在etc&#x2F;httpd&#x2F;conf下 命名默认为httpd-ssl.conf</p><p>普通配置文件为 httpd.conf，此处命名可能有所不同，如果搜不到去目录下查找相似文件即可</p><p>配置：</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;VirtualHost *:80&gt;</span><br><span class="line">    ServerAdmin z1792524653@163.com</span><br><span class="line">    DocumentRoot /var/www/dream/public</span><br><span class="line">    DirectoryIndex /var/www/dream/public</span><br><span class="line">    &lt;Directory &quot;/var/www/dream/public&quot;&gt;</span><br><span class="line">        DirectoryIndex index.php</span><br><span class="line">        Options Indexes FollowSymlinks</span><br><span class="line">        AllowOverride All</span><br><span class="line">        Order deny,allow</span><br><span class="line">        Require all granted</span><br><span class="line">        Allow from all</span><br><span class="line">    &lt;/Directory&gt;</span><br><span class="line">    ServerName oursdreams.cn</span><br><span class="line">    ServerAlias *.oursdreams.cn</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">RewriteEngine on</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">RewriteCond %&#123;SERVER_NAME&#125; =www.oursdreams.cn [OR]</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">RewriteCond %&#123;SERVER_NAME&#125; =dream</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">RewriteRule ^ https://%&#123;SERVER_NAME&#125;%&#123;REQUEST_URI&#125; [END,NE,R=permanent]</span></span><br><span class="line">&lt;/VirtualHost&gt;</span><br><span class="line"></span><br><span class="line">&lt;IfModule dir_module&gt;</span><br><span class="line">    DirectoryIndex index.php</span><br><span class="line">&lt;/IfModule&gt;</span><br><span class="line"></span><br><span class="line">&lt;FilesMatch \.php$&gt;</span><br><span class="line">SetHandler &quot;proxy:fcgi://127.0.0.1:9000&quot;</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure></div><p>注意：此处访问为php文件，如若没有进行解析php，首先查看自己服务器上php是否全局，再查看php-fpm是否开启，它默认会占用9000端口，上方配置解析方式也是通过该内部端口进行通信，不要将该端口在防火墙上放行。</p><p>ssl:</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;IfModule mod_ssl.c&gt;</span><br><span class="line">&lt;VirtualHost *:443&gt;</span><br><span class="line">ServerAdmin z1792524653@163.com</span><br><span class="line">DocumentRoot /var/www/dream/public</span><br><span class="line">DirectoryIndex /var/www/dream/public</span><br><span class="line">    &lt;Directory &quot;/var/www/dream/public&quot;&gt;</span><br><span class="line">        DirectoryIndex index.php</span><br><span class="line">        Options Indexes FollowSymlinks</span><br><span class="line">        AllowOverride All</span><br><span class="line">        Order deny,allow</span><br><span class="line">        Require all granted</span><br><span class="line">        Allow from all</span><br><span class="line">    &lt;/Directory&gt;</span><br><span class="line">ServerName dream</span><br><span class="line">ServerAlias www.oursdreams.cn</span><br><span class="line">SSLCertificateFile /etc/letsencrypt/live/www.oursdreams.cn/cert.pem</span><br><span class="line">SSLCertificateKeyFile /etc/letsencrypt/live/www.oursdreams.cn/privkey.pem</span><br><span class="line">Include /etc/letsencrypt/options-ssl-apache.conf</span><br><span class="line">SSLCertificateChainFile /etc/letsencrypt/live/www.oursdreams.cn/chain.pem</span><br><span class="line">&lt;/VirtualHost&gt;</span><br><span class="line">&lt;/IfModule&gt;</span><br></pre></td></tr></table></figure></div><p>一般在你配置ssl证书时会自动生成，只需修改其默认指向路径即可</p><h2 id="Mysql"><a href="#Mysql" class="headerlink" title="Mysql"></a>Mysql</h2><p>下载的mysql-8.0.11 使用wget</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://dev.mysql.com/get/Downloads/MySQL-8.0/mysql-8.0.11-linux-glibc2.12-x86_64.tar.gz</span><br></pre></td></tr></table></figure></div><p>注意下方操作的目录，因为自安装，目录需要自己指定</p><p>我新建一个目录在 &#x2F;var&#x2F;developer&#x2F;mysql下</p><p>解压 </p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf mysql-8.0.11-linux-glibc2.12-x86_64.tar.gz</span><br></pre></td></tr></table></figure></div><p>重命名 </p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv mysql-8.0.11-linux-glibc2.12-x86_64 mysql-8.0.11</span><br></pre></td></tr></table></figure></div><p>创建文件夹data,存储文件</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir ./data</span><br></pre></td></tr></table></figure></div><p>创建用户及用户组</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">用户组</span></span><br><span class="line">groupadd mysql</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">用户 （用户名/密码）</span></span><br><span class="line">useradd -g mysql mysql</span><br></pre></td></tr></table></figure></div><p>授权</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">授权用户</span></span><br><span class="line">chown -R mysql.mysql /var/developer/mysql/mysql-8.0.11</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">授权组</span></span><br><span class="line">chgrp -R mysql /var/developer/mysql/mysql-8.0.11</span><br></pre></td></tr></table></figure></div><p>初始化数据库（进入解压目录下）：</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/mysqld --user=mysql --basedir=/var/developer/mysql/mysql-8.0.11/ --datadir=/var/developer/mysql/mysql-8.0.11/data/ --initialize</span><br></pre></td></tr></table></figure></div><p>注意完成的返回信息，会给你一个临时密码</p><p>配置：</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/my.cnf</span><br><span class="line"></span><br><span class="line">//安装后发现我并没有配置文件，全局搜索 find / -name &quot;my.cnf&quot; find / -name &quot;my-default.cnf&quot; 未搜到，只好自建配置</span><br><span class="line"></span><br><span class="line">sudo vim /etc/my.cnf</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">按照它的读取顺序</span></span><br></pre></td></tr></table></figure></div><p>可能会有好几个地方有 mysql 的配置文件，它的读取顺序是这样的</p><p>&#x2F;etc&#x2F;my.cnf<br>basedir&#x2F;my.cnf<br>datadir&#x2F;my.cnf<br>–defaults-extra-file #在读取全局配置文件之后，读取用户配置文件 (~&#x2F;.my.cnf)之前，读取extra指定的参数文件<br>~&#x2F;.my.cnf<br>所以我们在 &#x2F;etc 下的配置文件 my.cnf 是第一个读取的文件，读到这个文件后就不会在读后面路劲中的配置文件</p><p>部分配置信息：</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">MySQL 配置文件，</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">数据库目录 /data/mysql</span></span><br><span class="line">[client]</span><br><span class="line">port=3306</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mysql socket 文件存放地址</span></span><br><span class="line">socket=/tmp/mysql.sock</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">默认字符集</span></span><br><span class="line">default-character-set=utf8</span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line">server-id=1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">端口</span></span><br><span class="line">port=3306</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">运行用户</span></span><br><span class="line">user=mysql</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">最大连接</span></span><br><span class="line">max_connections=200</span><br><span class="line">socket=/tmp/mysql.sock</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mysql 安装目录（解压后文件的目录）</span></span><br><span class="line">basedir=/var/developer/mysql/mysql-8.0.11</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">数据目录（这里放在我们新建的 /data/mysql 下）</span></span><br><span class="line">datadir=/var/developer/mysql/mysql-8.0.11/data</span><br><span class="line">pid-file=/var/developer/mysql/mysql-8.0.11/mysql.pid</span><br><span class="line">init-connect=&#x27;SET NAMES utf8&#x27;</span><br><span class="line">character-set-server=utf8</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">数据库引擎</span></span><br><span class="line">default-storage-engine=INNODB</span><br><span class="line">log_error=/data/mysql/mysql-error.log</span><br><span class="line">slow_query_log_file=/data/mysql/mysql-slow.log</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">跳过验证密码</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">skip-grant-tables</span></span><br><span class="line"></span><br><span class="line">[mysqldump]</span><br><span class="line">quick</span><br><span class="line">max_allowed_packet=16M</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure></div><p>添加服务：# 若mysqld，以下mysql相应的修改mysqld</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cp -a /var/developer/mysql/mysql-8.0.11/support-files/mysql.server /etc/init.d/mysql</span><br><span class="line"></span><br><span class="line">chmod +x /etc/init.d/mysql</span><br><span class="line">chkconfig --add mysql</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">检查服务是否生效</span></span><br><span class="line">chkconfig --list mysql</span><br></pre></td></tr></table></figure></div><p>启动：</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">service mysql start</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看启动状态</span></span><br><span class="line">service mysql status</span><br></pre></td></tr></table></figure></div><p>登录：密码为初始化时的临时密码</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">我的myql忘了配置到全局，会提示我mysql命令不存在，先去安装目录的bin目录下登录 ./mysql -uroot -p</span></span><br></pre></td></tr></table></figure></div><p>修改下密码：</p><div class="code-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED <span class="keyword">WITH</span> mysql_native_password <span class="keyword">BY</span> <span class="string">&#x27;新密码&#x27;</span>;</span><br></pre></td></tr></table></figure></div><p>远程连接</p><p>在 my.cnf 的mysqld 下增加</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">default_authentication_plugin=mysql_native_password</span><br></pre></td></tr></table></figure></div><p>重启服务：</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service mysql restart</span><br></pre></td></tr></table></figure></div><p>远程连接授权：</p><div class="code-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;%&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;密码&#x27;</span>;</span><br><span class="line">#修改加密规则并更新密码</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;%&#x27;</span> IDENTIFIED <span class="keyword">WITH</span> mysql_native_password <span class="keyword">BY</span> <span class="string">&#x27;密码&#x27;</span>;</span><br><span class="line">#设置为远程登录</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> PRIVILEGES <span class="keyword">ON</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;%&#x27;</span> <span class="keyword">WITH</span> <span class="keyword">GRANT</span> OPTION;</span><br><span class="line">#刷新权限</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure></div><h2 id="防火墙与端口"><a href="#防火墙与端口" class="headerlink" title="防火墙与端口"></a>防火墙与端口</h2><p>先检查防火墙是否开启，注意我的环境为centos7 7与6的最大变动就是防火墙</p><p>查看防火墙状态: <strong>firewall-cmd –state</strong></p><p>开启防火墙:<strong>systemctl start firewalld.service</strong></p><p>查看防火墙所有开放的端口 <strong>firewall-cmd –zone&#x3D;public –list-ports</strong></p><p>开放3306端口 <strong>firewall-cmd –zone&#x3D;public –add-port&#x3D;3306&#x2F;tcp –permanent</strong></p><p>配置立即生效 <strong>firewall-cmd –reload</strong></p><p>查看监听的端口 <strong>netstat -lnpt</strong></p><p>检查端口被哪个进程占用 <strong>netstat -lnpt |grep 3306</strong></p><p>查看进程的详细信息 <strong>ps 3306</strong></p><h3 id="测试连接数据库"><a href="#测试连接数据库" class="headerlink" title="测试连接数据库"></a>测试连接数据库</h3><p>—-测试连接数据库时发现连接失败，检查配置与端口开放，在my.cnf中修改了端口号为3306但查看进程发现3306端口未使用</p><p>重启 &#x2F;etc&#x2F;init.d&#x2F;mysql restart</p><p>再次检查 netstat -lnpt |grep 3306</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="C:\Users\z1792\AppData\Roaming\Typora\typora-user-images\image-20200924110351649.png"                      alt="image-20200924110351649"                ></p><p>测试连接：SUCCESS!</p><h2 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h2><p>配置https协议，使用一个免费签发协议</p><p>这里使用certbot <a class="link"   href="https://certbot.eff.org/" >https://certbot.eff.org/<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装</span></span><br><span class="line">sudo yum install certbot python2-certbot-apache</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">自动颁发证书，也可手动设置</span></span><br><span class="line">sudo certbot --apache</span><br></pre></td></tr></table></figure></div><p>报错：</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Unable to find a virtual host listening on port 80 which is currently needed</span><br></pre></td></tr></table></figure></div><p>解决：httpd配置中需要声明下端口与服务</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/httpd/conf/httpd.conf</span><br></pre></td></tr></table></figure></div><p>查找是否有,没有则添加，注意下方的路径与服务名自定义为你自己的</p><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">NameVirtualHost *:80</span><br><span class="line"></span><br><span class="line">&lt;VirtualHost *:80&gt;</span><br><span class="line">ServerAdmin root@localhost</span><br><span class="line">DocumentRoot /var/www</span><br><span class="line">ServerName dream</span><br><span class="line">&lt;/VirtualHost&gt;</span><br></pre></td></tr></table></figure></div><p>重新颁发：sudo certbot –apache</p><p>OK！</p><p>每次颁发的证书有效期为三个月，设置到期自动续订</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;0 0,12 * * * root python -c &#x27;import random; import time; time.sleep(random.random() * 3600)&#x27; &amp;&amp; certbot renew -q&quot; | sudo tee -a /etc/crontab &gt; /dev/null</span><br></pre></td></tr></table></figure></div><p>测试访问：https:&#x2F;&#x2F;你的域名</p><p>如连接失败请检查您的端口是否开放，https默认为443端口，开放防火墙443端口即可</p>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 运维 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Jvm内存溢出排查</title>
      <link href="/2025/03/12/%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA%E6%8E%92%E6%9F%A5/"/>
      <url>/2025/03/12/%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA%E6%8E%92%E6%9F%A5/</url>
      
        <content type="html"><![CDATA[<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 已使用空间站总空间的百分比 每1000毫秒查询一次,一直查</span></span><br><span class="line">jstat -gcutil <span class="variable">$&#123;pid&#125;</span> 1000</span><br></pre></td></tr></table></figure></div><table><thead><tr><th>E</th><th>新生代Eden区（E，表示Eden）</th></tr></thead><tbody><tr><td>S0,S1</td><td>两个Survivor区 S0、S1，表示Survivor0、Survivor1</td></tr><tr><td>O</td><td>老年代（O，表示Old）</td></tr><tr><td>YGC</td><td>程序运行以来共发生Minor GC（YGC，表示Young GC）</td></tr><tr><td>YGCT</td><td>总耗时x秒</td></tr><tr><td>FGC</td><td>程序运行以来共发生Full GC</td></tr><tr><td>FGCT</td><td>总耗时x秒</td></tr></tbody></table><p>观察FGC的次数与每次FGC时间，如果过于频繁说明内存溢出 频繁全量GC</p><h2 id="下载heap-dump分析报告"><a href="#下载heap-dump分析报告" class="headerlink" title="下载heap dump分析报告"></a>下载heap dump分析报告</h2><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jmap -dump:live,format=b,file=heap.hprof <span class="variable">$&#123;pid&#125;</span></span><br></pre></td></tr></table></figure></div><p>将整个heap.hprof拷贝到本地，打开IDEA<br>profilter功能，打开该文件 自动进行分析，得到占用内存最高的对象，右侧查看summary堆栈报告，根据链接找产生的节点</p>]]></content>
      
      
      
        <tags>
            
            <tag> 运维 </tag>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一些软件设计原则</title>
      <link href="/2025/03/12/%E4%B8%80%E4%BA%9B%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/"/>
      <url>/2025/03/12/%E4%B8%80%E4%BA%9B%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/</url>
      
        <content type="html"><![CDATA[<p>原则可能有些学院派，也可能太为理论。由理论到应用的过程建议</p><ol><li>你可以先粗浅或是表面地知道这些原则。</li><li>但不要急着马上就使用。</li><li>在工作学习中观察和总结别人或自己的设计。</li><li>再回过头来了回顾一下这些原则，相信你会有一些自己的心得。</li><li>有适度地去实践一下。</li><li>Goto第 3步。</li></ol><h2 id="Don’t-Repeat-Yourself-DRY-重用性"><a href="#Don’t-Repeat-Yourself-DRY-重用性" class="headerlink" title="Don’t Repeat Yourself (DRY)-重用性"></a>Don’t Repeat Yourself (DRY)-重用性</h2><p>DRY 是一个最简单的法则，也是最容易被理解的。但它也可能是最难被应用的（因为要做到这样，我们需要在泛型设计上做相当的努力，这并不是一件容易的事）。它意味着，当我们在两个或多个地方的时候发现一些相似的代码的时候，我们需要把他们的共性抽象出来形一个唯一的新方法，并且改变现有的地方的代码让他们以一些合适的参数调用这个新的方法。</p><h2 id="Keep-It-Simple-Stupid-KISS-不要复杂化"><a href="#Keep-It-Simple-Stupid-KISS-不要复杂化" class="headerlink" title="Keep It Simple, Stupid (KISS)-不要复杂化"></a>Keep It Simple, Stupid (KISS)-不要复杂化</h2><p>KISS原则在设计上可能最被推崇的，在家装设计，界面设计 ，操作设计上，复杂的东西越来越被众人所BS了，而简单的东西越来越被人所认可，比如<a class="link"   href="https://coolshell.cn/articles/1907.html" >这些UI的设计<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>和我们<a class="link"   href="https://coolshell.cn/articles/3605.html" >中国网页<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>（尤其是<a class="link"   href="https://coolshell.cn/articles/3872.html" >新浪的网页<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>）者是负面的例子。“宜家”（IKEA）简约、效率的家居设计、生产思路；“微软”（Microsoft）“所见即所得”的理念；“谷歌”（Google)简约、直接的商业风格，无一例外的遵循了“kiss”原则，也正是“kiss”原则，成就了这些看似神奇的商业经典。而苹果公司的iPhone&#x2F;iPad将这个原则实践到了极至。</p><p>把一个事情搞复杂是一件简单的事，但要把一个复杂的事变简单，这是一件复杂的事。</p><h2 id="Program-to-an-interface-not-an-implementation-注重接口-而非实现"><a href="#Program-to-an-interface-not-an-implementation-注重接口-而非实现" class="headerlink" title="Program to an interface, not an implementation-注重接口,而非实现"></a>Program to an interface, not an implementation-注重接口,而非实现</h2><p>这是设计模式中最根本的哲学，注重接口，而不是实现，依赖接口，而不是实现。接口是抽象是稳定的，实现则是多种多样的。以后面我们会面向对象的SOLID原则中会提到我们的依赖倒置原则，就是这个原则的的另一种样子。还有一条原则叫 <strong>Composition over inheritance</strong>（喜欢组合而不是继承），这两条是那23个经典设计模式中的设计原则。</p><h2 id="Command-Query-Separation-CQS-命令-查询分离原则"><a href="#Command-Query-Separation-CQS-命令-查询分离原则" class="headerlink" title="Command-Query Separation (CQS)-命令-查询分离原则"></a>Command-Query Separation (CQS)-命令-查询分离原则</h2><ul><li>查询：当一个方法返回一个值来回应一个问题的时候，它就具有查询的性质；</li><li>命令：当一个方法要改变对象的状态的时候，它就具有命令的性质；</li></ul><p>通常，一个方法可能是纯的Command模式或者是纯的Query模式，或者是两者的混合体。在设计接口时，如果可能，应该尽量使接口单一化，保证方法的行为严格的是命令或者是查询，这样查询方法不会改变对象的状态，没有副作用，而会改变对象的状态的方法不可能有返回值。也就是说：如果我们要问一个问题，那么就不应该影响到它的答案。实际应用，要视具体情况而定，语义的清晰性和使用的简单性之间需要权衡。将Command和Query功能合并入一个方法，方便了客户的使用，但是，降低了清晰性，而且，可能不便于基于断言的程序设计并且需要一个变量来保存查询结果。</p><p>在系统设计中，很多系统也是以这样原则设计的，查询的功能和命令功能的系统分离，这样有则于系统性能，也有利于系统的安全性。</p><h2 id="You-Ain’t-Gonna-Need-It-YAGNI-最小化产品-MVP"><a href="#You-Ain’t-Gonna-Need-It-YAGNI-最小化产品-MVP" class="headerlink" title="You Ain’t Gonna Need It (YAGNI)-最小化产品(MVP)"></a>You Ain’t Gonna Need It (YAGNI)-最小化产品(MVP)</h2><p>这个原则简而言之为——只考虑和设计必须的功能，避免过度设计。只实现目前需要的功能，在以后您需要更多功能时，可以再进行添加。</p><ul><li>如无必要，勿增复杂性。</li><li>软件开发先是一场沟通博弈。</li></ul><p>请避免过度重构。WebSphere的设计者就<a class="link"   href="https://www.bbc.co.uk/news/business-11944966" >表示过他过度设计了这个产品<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>。我们的程序员或是架构师在设计系统的时候，会考虑很多扩展性的东西，导致在架构与设计方面使用了大量折衷，最后导致项目失败。这是个令人感到讽刺的教训，因为本来希望尽可能延长项目的生命周期，结果反而缩短了生命周期。</p><h2 id="Law-of-Demeter-LoD-迪米特法则"><a href="#Law-of-Demeter-LoD-迪米特法则" class="headerlink" title="Law of Demeter (LoD)-迪米特法则"></a>Law of Demeter (LoD)-迪米特法则</h2><p>迪米特法则(Law of Demeter)，又称“最少知识原则”（Principle of Least Knowledge），其来源于1987年荷兰大学的一个叫做Demeter的项目。Craig Larman把Law of Demeter又称作“不要和陌生人说话”。在《程序员修炼之道》中讲LoD的那一章叫作“解耦合与迪米特法则”。关于迪米特法则有一些很形象的比喻：</p><ul><li>如果你想让你的狗跑的话，你会对狗狗说还是对四条狗腿说？</li><li>如果你去店里买东西，你会把钱交给店员，还是会把钱包交给店员让他自己拿？</li></ul><p>和狗的四肢说话？让店员自己从钱包里拿钱？这听起来有点荒唐，不过在我们的代码里这几乎是见怪不怪的事情了。</p><p>对于LoD，正式的表述如下：</p><blockquote><p>对于对象 ‘O’ 中一个方法’M’，M应该只能够访问以下对象中的方法：</p><ol><li>对象O；</li><li>与O直接相关的Component Object；</li><li>由方法M创建或者实例化的对象；</li><li>作为方法M的参数的对象。</li></ol></blockquote><p>在《Clean Code》一书中，有一段Apache framework中的一段违反了LoD的代码：</p><p>final String outputDir &#x3D; ctxt.getOptions().getScratchDir().getAbsolutePath();</p><p>这么长的一串对其它对象的细节，以及细节的细节，细节的细节的细节……的调用，增加了耦合，使得代码结构复杂、僵化，难以扩展和维护。</p><p>在《重构》一书中的代码的环味道中有一种叫做“Feature Envy”(依恋情结），形象的描述了一种违反了LoC的情况。Feature Envy就是说一个对象对其它对象的内容更有兴趣，也就是说老是羡慕别的对象的成员、结构或者功能，大老远的调用人家的东西。这样的结构显然是不合理的。我们的程序应该写得比较“害羞”。不能像前面例子中的那个不把自己当外人的店员一样，拿过客人的钱包自己把钱拿出来。“害羞”的程序只和自己最近的朋友交谈。这种情况下应该调整程序的结构，让那个对象自己拥有它羡慕的feature，或者使用合理的设计模式（例如Facade和Mediator）。</p><h2 id="面向对象的S-O-L-I-D-原则"><a href="#面向对象的S-O-L-I-D-原则" class="headerlink" title="面向对象的S.O.L.I.D 原则"></a>面向对象的S.O.L.I.D 原则</h2><p>一般来说这是面向对象的五大设计原则，但是，我觉得这些原则可适用于所有的软件开发。</p><h3 id="Single-Responsibility-Principle-SRP-职责单一原则"><a href="#Single-Responsibility-Principle-SRP-职责单一原则" class="headerlink" title="Single Responsibility Principle (SRP) -职责单一原则"></a>Single Responsibility Principle (SRP) -职责单一原则</h3><p>关于单一职责原则，其核心的思想是：<strong>一个类，只做一件事，并把这件事做好，其只有一个引起它变化的原因</strong>。单一职责原则可以看作是低耦合、高内聚在面向对象原则上的引申，将职责定义为引起变化的原因，以提高内聚性来减少引起变化的原因。职责过多，可能引起它变化的原因就越多，这将导致职责依赖，相互之间就产生影响，从而极大的损伤其内聚性和耦合度。单一职责，通常意味着单一的功能，因此不要为一个模块实现过多的功能点，以保证实体只有一个引起它变化的原因。</p><ul><li>Unix&#x2F;Linux是这一原则的完美体现者。各个程序都独立负责一个单一的事。</li><li>Windows是这一原则的反面示例。几乎所有的程序都交织耦合在一起。</li></ul><h3 id="Open-Closed-Principle-OCP-开闭原则"><a href="#Open-Closed-Principle-OCP-开闭原则" class="headerlink" title="Open&#x2F;Closed Principle (OCP) -开闭原则"></a>Open&#x2F;Closed Principle (OCP) -开闭原则</h3><p>关于开发封闭原则，其核心的思想是：模块是可扩展的，而不可修改的。也就是说，<strong>对扩展是开放的，而对修改是封闭的</strong>。</p><ul><li>对扩展开放，意味着有新的需求或变化时，可以对现有代码进行扩展，以适应新的情况。</li><li>对修改封闭，意味着类一旦设计完成，就可以独立完成其工作，而不要对类进行任何修改。</li></ul><p>对于面向对象来说，需要你依赖抽象，而不是实现，23个经典设计模式中的“策略模式”就是这个实现。对于非面向对象编程，一些API需要你传入一个你可以扩展的函数，比如我们的C 语言的qsort()允许你提供一个“比较器”，STL中的容器类的内存分配，ACE中的多线程的各种锁。对于软件方面，浏览器的各种插件属于这个原则的实践。</p><h3 id="Liskov-substitution-principle-LSP-里氏代换原则"><a href="#Liskov-substitution-principle-LSP-里氏代换原则" class="headerlink" title="Liskov substitution principle (LSP)-里氏代换原则"></a>Liskov substitution principle (LSP)-<strong>里氏代换原则</strong></h3><p>软件工程大师Robert C. Martin把里氏代换原则最终简化为一句话：“Subtypes must be substitutable for their base types”。也就是，子类必须能够替换成它们的基类。即：子类应该可以替换任何基类能够出现的地方，并且经过替换以后，代码还能正常工作。另外，不应该在代码中出现if&#x2F;else之类对子类类型进行判断的条件。里氏替换原则LSP是使代码符合开闭原则的一个重要保证。正是由于子类型的可替换性才使得父类型的模块在无需修改的情况下就可以扩展。</p><p>这么说来，似乎有点教条化，我非常建议大家看看这个原则个两个最经典的案例——“正方形不是长方形”和“鸵鸟不是鸟”。通过这两个案例，你会明白《墨子 小取》中说的 ——“娣，美人也，爱娣，非爱美人也….盗，人也；恶盗，非恶人也。”——妹妹虽然是美人，但喜欢妹妹并不代表喜欢美人。盗贼是人，但讨厌盗贼也并不代表就讨厌人类。<strong>这个原则让你考虑的不是语义上对象的间的关系，而是实际需求的环境</strong>。</p><p>在很多情况下，在设计初期我们类之间的关系不是很明确，LSP则给了我们一个判断和设计类之间关系的基准：需不需要继承，以及怎样设计继承关系。</p><h3 id="Interface-Segregation-Principle-ISP-接口隔离原则"><a href="#Interface-Segregation-Principle-ISP-接口隔离原则" class="headerlink" title="Interface Segregation Principle (ISP)-接口隔离原则"></a>Interface Segregation Principle (ISP)-接口隔离原则</h3><p>接口隔离原则意思是把功能实现在接口中，而不是类中，使用多个专门的接口比使用单一的总接口要好。</p><p>举个例子，我们对电脑有不同的使用方式，比如：写作，通讯，看电影，打游戏，上网，编程，计算，数据等，如果我们把这些功能都声明在电脑的抽类里面，那么，我们的上网本，PC机，服务器，笔记本的实现类都要实现所有的这些接口，这就显得太复杂了。所以，我们可以把其这些功能接口隔离开来，比如：工作学习接口，编程开发接口，上网娱乐接口，计算和数据服务接口，这样，我们的不同功能的电脑就可以有所选择地继承这些接口。</p><p>这个原则可以提升我们“搭积木式”的软件开发。对于设计来说，Java中的各种Event Listener和Adapter，对于软件开发来说，不同的用户权限有不同的功能，不同的版本有不同的功能，都是这个原则的应用。</p><h3 id="Dependency-Inversion-Principle-DIP-依赖倒置原则"><a href="#Dependency-Inversion-Principle-DIP-依赖倒置原则" class="headerlink" title="Dependency Inversion Principle (DIP)-依赖倒置原则"></a>Dependency Inversion Principle (DIP)-依赖倒置原则</h3><p>高层模块不应该依赖于低层模块的实现，而是依赖于高层抽象。</p><p>举个例子，墙面的开关不应该依赖于电灯的开关实现，而是应该依赖于一个抽象的开关的标准接口，这样，当我们扩展程序的时候，我们的开关同样可以控制其它不同的灯，甚至不同的电器。也就是说，电灯和其它电器继承并实现我们的标准开关接口，而我们的开关产商就可不需要关于其要控制什么样的设备，只需要关心那个标准的开关标准。这就是依赖倒置原则。</p><p>这就好像浏览器并不依赖于后面的web服务器，其只依赖于HTTP协议。这个原则实在是太重要了，社会的分工化，标准化都是这个设计原则的体现。</p><h2 id="Common-Closure-Principle（CCP）-共同封闭原则"><a href="#Common-Closure-Principle（CCP）-共同封闭原则" class="headerlink" title="Common Closure Principle（CCP）-共同封闭原则"></a>Common Closure Principle（CCP）-共同封闭原则</h2><p>一个包中所有的类应该对同一种类型的变化关闭。一个变化影响一个包，便影响了包中所有的类。一个更简短的说法是：一起修改的类，应该组合在一起（同一个包里）。如果必须修改应用程序里的代码，我们希望所有的修改都发生在一个包里（修改关闭），而不是遍布在很多包里。CCP原则就是把因为某个同样的原因而需要修改的所有类组合进一个包里。如果2个类从物理上或者从概念上联系得非常紧密，它们通常一起发生改变，那么它们应该属于同一个包。</p><p>CCP延伸了开闭原则（OCP）的“关闭”概念，当因为某个原因需要修改时，把需要修改的范围限制在一个最小范围内的包里。</p><h2 id="Common-Reuse-Principle-CRP-共同重用原则"><a href="#Common-Reuse-Principle-CRP-共同重用原则" class="headerlink" title="Common Reuse Principle (CRP) -共同重用原则"></a>Common Reuse Principle (CRP) -共同重用原则</h2><p>包的所有类被一起重用。如果你重用了其中的一个类，就重用全部。换个说法是，没有被一起重用的类不应该被组合在一起。CRP原则帮助我们决定哪些类应该被放到同一个包里。依赖一个包就是依赖这个包所包含的一切。当一个包发生了改变，并发布新的版本，使用这个包的所有用户都必须在新的包环境下验证他们的工作，即使被他们使用的部分没有发生任何改变。因为如果包中包含有未被使用的类，即使用户不关心该类是否改变，但用户还是不得不升级该包并对原来的功能加以重新测试。</p><p>CCP则让系统的维护者受益。CCP让包尽可能大（CCP原则加入功能相关的类），CRP则让包尽可能小（CRP原则剔除不使用的类）。它们的出发点不一样，但不相互冲突。</p><h2 id="Hollywood-Principle-好莱坞原则"><a href="#Hollywood-Principle-好莱坞原则" class="headerlink" title="Hollywood Principle-好莱坞原则"></a>Hollywood Principle-好莱坞原则</h2><p>好莱坞原则就是一句话——“don’t call us, we’ll call you.”。意思是，好莱坞的经纪人们不希望你去联系他们，而是他们会在需要的时候来联系你。也就是说，所有的组件都是被动的，所有的组件初始化和调用都由容器负责。组件处在一个容器当中，由容器负责管理。</p><p>简单的来讲，就是由容器控制程序之间的关系，而非传统实现中，由程序代码直接操控。这也就是所谓“控制反转”的概念所在：</p><ol><li>不创建对象，而是描述创建对象的方式。</li><li>在代码中，对象与服务没有直接联系，而是容器负责将这些联系在一起。</li></ol><p>控制权由应用代码中转到了外部容器，控制权的转移，是所谓反转。</p><p>好莱坞原则就是IoC（Inversion of Control）或DI（Dependency Injection ）的基础原则。这个原则很像依赖倒置原则，依赖接口，而不是实例，但是这个原则要解决的是怎么把这个实例传入调用类中？你可能把其声明成成员，你可以通过构造函数，你可以通过函数参数。但是 IoC可以让你通过配置文件，一个由Service Container 读取的配置文件来产生实际配置的类。但是程序也有可能变得不易读了，程序的性能也有可能还会下降。</p><h2 id="High-Cohesion-Low-Loose-coupling-高内聚-低耦合"><a href="#High-Cohesion-Low-Loose-coupling-高内聚-低耦合" class="headerlink" title="High Cohesion &amp; Low&#x2F;Loose coupling - 高内聚,低耦合"></a>High Cohesion &amp; Low&#x2F;Loose coupling - 高内聚,低耦合</h2><p>这个原则是UNIX操作系统设计的经典原则，把模块间的耦合降到最低，而努力让一个模块做到精益求精。</p><ul><li>内聚：一个模块内各个元素彼此结合的紧密程度</li><li>耦合：一个软件结构内不同模块之间互连程度的度量</li></ul><p>内聚意味着重用和独立，耦合意味着多米诺效应牵一发动全身。</p><h2 id="Convention-over-Configuration（CoC）-惯例优于配置原则"><a href="#Convention-over-Configuration（CoC）-惯例优于配置原则" class="headerlink" title="Convention over Configuration（CoC）- 惯例优于配置原则"></a>Convention over Configuration（CoC）- 惯例优于配置原则</h2><p>简单点说，就是将一些公认的配置方式和信息作为内部缺省的规则来使用。例如，Hibernate的映射文件，如果约定字段名和类属性一致的话，基本上就可以不要这个配置文件了。你的应用只需要指定不convention的信息即可，从而减少了大量convention而又不得不花时间和精力啰里啰嗦的东东。配置文件很多时候相当的影响开发效率。</p><p>Rails 中很少有配置文件（但不是没有，数据库连接就是一个配置文件），Rails 的fans号称期开发效率是 java 开发的 10 倍，估计就是这个原因。Maven也使用了CoC原则，当你执行mvn -compile命令的时候，不需要指源文件放在什么地方，而编译以后的class文件放置在什么地方也没有指定，这就是CoC原则。</p><h2 id="Separation-of-Concerns-SoC-关注点分离"><a href="#Separation-of-Concerns-SoC-关注点分离" class="headerlink" title="Separation of Concerns (SoC) -关注点分离"></a>Separation of Concerns (SoC) -关注点分离</h2><p>SoC 是计算机科学中最重要的努力目标之一。这个原则，就是在软件开发中，通过各种手段，将问题的各个关注点分开。如果一个问题能分解为独立且较小的问题，就是相对较易解决的。问题太过于复杂，要解决问题需要关注的点太多，而程序员的能力是有限的，不能同时关注于问题的各个方面。正如程序员的记忆力相对于计算机知识来说那么有限一样，程序员解决问题的能力相对于要解决的问题的复杂性也是一样的非常有限。在我们分析问题的时候，如果我们把所有的东西混在一起讨论，那么就只会有一个结果——乱。</p><p>我记得在上一家公司有一个项目，讨论就讨论了1年多，项目本来不复杂，但是没有使用SoC，全部的东西混为一谈，再加上一堆程序员注入了各种不同的观点和想法，整个项目一下子就失控了。最后，本来一个1年的项目做了3年。</p><p>实现关注点分离的方法主要有两种，一种是标准化，另一种是抽象与包装。标准化就是制定一套标准，让使用者都遵守它，将人们的行为统一起来，这样使用标准的人就不用担心别人会有很多种不同的实现，使自己的程序不能和别人的配合。Java EE就是一个标准的大集合。每个开发者只需要关注于标准本身和他所在做的事情就行了。就像是开发镙丝钉的人只专注于开发镙丝钉就行了，而不用关注镙帽是怎么生产的，反正镙帽和镙丝钉按标来就一定能合得上。不断地把程序的某些部分抽像差包装起来，也是实现关注点分离的好方法。一旦一个函数被抽像出来并实现了，那么使用函数的人就不用关心这个函数是如何实现的，同样的，一旦一个类被抽像并实现了，类的使用者也不用再关注于这个类的内部是如何实现的。诸如组件，分层，面向服务，等等这些概念都是在不同的层次上做抽像和包装，以使得使用者不用关心它的内部实现细节。</p><p>说白了还是“高内聚，低耦合”。</p><h2 id="Design-by-Contract-DbC-契约式设计"><a href="#Design-by-Contract-DbC-契约式设计" class="headerlink" title="Design by Contract (DbC) -契约式设计"></a>Design by Contract (DbC) -契约式设计</h2><p>DbC的核心思想是对软件系统中的元素之间相互合作以及“责任”与“义务”的比喻。这种比喻从商业活动中“客户”与“供应商”达成“契约”而得来。例如：</p><ul><li>供应商必须提供某种产品（责任），并且他有权期望客户已经付款（权利）。</li><li>客户必须付款（责任），并且有权得到产品（权利）。</li><li>契约双方必须履行那些对所有契约都有效的责任，如法律和规定等。</li></ul><p>同样的，如果在程序设计中一个模块提供了某种功能，那么它要：</p><ul><li>期望所有调用它的客户模块都保证一定的进入条件：这就是模块的先验条件（客户的义务和供应商的权利，这样它就不用去处理不满足先验条件的情况）。</li><li>保证退出时给出特定的属性：这就是模块的后验条件——（供应商的义务，显然也是客户的权利）。</li><li>在进入时假定，并在退出时保持一些特定的属性：不变式。</li></ul><p>契约就是这些权利和义务的正式形式。我们可以用“三个问题”来总结DbC，并且作为设计者要经常问：</p><ul><li>它期望的是什么？</li><li>它要保证的是什么？</li><li>它要保持的是什么？</li></ul><p>根据Bertrand Meyer氏提出的DBC概念的描述，对于类的一个方法，都有一个前提条件以及一个后续条件，前提条件说明方法接受什么样的参数数据等，只有前提条件得到满足时，这个方法才能被调用；同时后续条件用来说明这个方法完成时的状态，如果一个方法的执行会导致这个方法的后续条件不成立，那么这个方法也不应该正常返回。</p><p>现在把前提条件以及后续条件应用到继承子类中，子类方法应该满足：</p><ol><li>前提条件不强于基类．</li><li>后续条件不弱于基类．</li></ol><p>换句话说，通过基类的接口调用一个对象时，用户只知道基类前提条件以及后续条件。因此继承类不得要求用户提供比基类方法要求的更强的前提条件，亦即，继承类方法必须接受任何基类方法能接受的任何条件（参数）。同样，继承类必须顺从基类的所有后续条件，亦即，继承类方法的行为和输出不得违反由基类建立起来的任何约束，不能让用户对继承类方法的输出感到困惑。</p><p>这样，我们就有了基于契约的LSP，基于契约的LSP是LSP的一种强化。</p><h2 id="Acyclic-Dependencies-Principle-ADP-无环依赖原则"><a href="#Acyclic-Dependencies-Principle-ADP-无环依赖原则" class="headerlink" title="Acyclic Dependencies Principle (ADP) -无环依赖原则"></a>Acyclic Dependencies Principle (ADP) -无环依赖原则</h2><p>包之间的依赖结构必须是一个直接的无环图形，也就是说，在依赖结构中不允许出现环（循环依赖）。如果包的依赖形成了环状结构，怎么样打破这种循环依赖呢？有2种方法可以打破这种循环依赖关系：第一种方法是创建新的包，如果A、B、C形成环路依赖，那么把这些共同类抽出来放在一个新的包D里。这样就把C依赖A变成了C依赖D以及A依赖D，从而打破了循环依赖关系。第二种方法是使用DIP（依赖倒置原则）和ISP（接口分隔原则）设计原则。</p><p>无环依赖原则（ADP）为我们解决包之间的关系耦合问题。在设计模块时，不能有循环依赖。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 设计架构 </tag>
            
            <tag> 软件基础 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java-Nginx堡垒机的转发邮件SMTP</title>
      <link href="/2025/03/12/%E5%86%85%E7%BD%91%E6%9C%BA%E8%BD%AC%E5%8F%91%E5%85%AC%E7%BD%91%E6%9C%BA%E9%82%AE%E4%BB%B6%E5%8F%91%E9%80%81SMTP/"/>
      <url>/2025/03/12/%E5%86%85%E7%BD%91%E6%9C%BA%E8%BD%AC%E5%8F%91%E5%85%AC%E7%BD%91%E6%9C%BA%E9%82%AE%E4%BB%B6%E5%8F%91%E9%80%81SMTP/</url>
      
        <content type="html"><![CDATA[<blockquote><p>以腾讯企业微信为例</p></blockquote><h2 id="1-内网转发公网"><a href="#1-内网转发公网" class="headerlink" title="1. 内网转发公网"></a>1. 内网转发公网</h2><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/hosts</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">增加域名转发</span></span><br><span class="line">公网机的局域IP（172.XXx.XXx.XXX） smtp.exmail.qq.com</span><br></pre></td></tr></table></figure></div><h2 id="2-公网NGINX反向代理"><a href="#2-公网NGINX反向代理" class="headerlink" title="2. 公网NGINX反向代理"></a>2. 公网NGINX反向代理</h2><blockquote><p>注意邮件请求是流式在nginx的HTTP块中配置转发是会 [EOF] 的</p><p>nginx在1.8之后的版本才增加了stream模块且不在默认编译选项中，如果没有必须从源码手动编译替换nginx</p></blockquote><h3 id="2-1-检查Nginx是否具备stream模块"><a href="#2-1-检查Nginx是否具备stream模块" class="headerlink" title="2.1 检查Nginx是否具备stream模块"></a>2.1 检查Nginx是否具备stream模块</h3><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -V</span><br></pre></td></tr></table></figure></div><p>拷贝下来输出，检查其中是否有 <code>--with-stream</code><br>例如：</p><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=/usr/local/nginx --sbin-path=/usr/local/nginx/sbin/nginx --conf-path=/usr/local/nginx/conf/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/run/nginx/nginx.pid --lock-path=/var/lock/nginx.lock --with-http_ssl_module --with-http_stub_status_module --with-http_gzip_static_module --http-client-body-temp-path=/var/tmp/nginx/client/ --http-proxy-temp-path=/var/tmp/nginx/proxy/ --http-fastcgi-temp-path=/var/tmp/nginx/fcgi/ --http-uwsgi-temp-path=/var/tmp/nginx/uwsgi --http-scgi-temp-path=/var/tmp/nginx/scgi --with-pcre --with-stream</span><br></pre></td></tr></table></figure></div><h3 id="2-2-增加Stream模块"><a href="#2-2-增加Stream模块" class="headerlink" title="2.2 增加Stream模块"></a>2.2 增加Stream模块</h3><blockquote><p>这会重新编译nginx 请提前备份方便故障恢复</p></blockquote><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">如果没有源码 nginx -v 查看你的版本重新下载一份新的源码</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">假设我处于 /usr/local/src/ 目录下</span></span><br><span class="line">wget http://nginx.org/download/nginx-1.12.2.tar.gz</span><br><span class="line">tar -zxvf nginx-1.12.2.tar.gz</span><br><span class="line">rm -rf nginx-1.12.2.tar.gz</span><br><span class="line">cd nginx-1.12.2</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">配置编译参数</span></span><br><span class="line">./configure --prefix=/usr/local/nginx --sbin-path=/usr/local/nginx/sbin/nginx --conf-path=/usr/local/nginx/conf/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/run/nginx/nginx.pid --lock-path=/var/lock/nginx.lock --with-http_ssl_module --with-http_stub_status_module --with-http_gzip_static_module --http-client-body-temp-path=/var/tmp/nginx/client/ --http-proxy-temp-path=/var/tmp/nginx/proxy/ --http-fastcgi-temp-path=/var/tmp/nginx/fcgi/ --http-uwsgi-temp-path=/var/tmp/nginx/uwsgi --http-scgi-temp-path=/var/tmp/nginx/scgi --with-pcre --with-stream</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">编译 确保你已有的nginx已备份,不要执行make install会覆盖原目录</span></span><br><span class="line">make</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">已编译完成的nginx二进制文件在 ./objs/下 拷贝替换原文件 先将原nginx停止</span></span><br><span class="line">/usr/local/nginx/sbin/nginx -s stop</span><br><span class="line">cp ./objs/nginx /usr/local/nginx/sbin/nginx</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">启动</span></span><br><span class="line">cd /usr/local/nginx/sbin</span><br><span class="line">./nginx</span><br></pre></td></tr></table></figure></div><h3 id="2-3-添加代理"><a href="#2-3-添加代理" class="headerlink" title="2.3 添加代理"></a>2.3 添加代理</h3><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/local/nginx</span><br><span class="line">vim conf/nginx.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加如下内容 与 http块持平</span></span><br><span class="line">stream &#123;</span><br><span class="line">server &#123;</span><br><span class="line">listen 465;</span><br><span class="line">proxy_pass smtp.exmail.qq.com:465;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查配置</span></span><br><span class="line"><span class="built_in">cd</span> ../sbin</span><br><span class="line">./nginx -t</span><br><span class="line"><span class="comment"># 如果输出successful就刷新配置</span></span><br><span class="line">./nginx -s reload</span><br></pre></td></tr></table></figure></div><h1 id="3-Java-发送腾讯企业邮箱"><a href="#3-Java-发送腾讯企业邮箱" class="headerlink" title="3. Java - 发送腾讯企业邮箱"></a>3. Java - 发送腾讯企业邮箱</h1><p>使用sum.mail就可以了</p><p>pom文件</p><div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sun.mail<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jakarta.mail<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.6.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p>服务类</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.mail.util.MailSSLSocketFactory;</span><br><span class="line"><span class="keyword">import</span> lombok.RequiredArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Lazy;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.activation.DataHandler;</span><br><span class="line"><span class="keyword">import</span> javax.activation.DataSource;</span><br><span class="line"><span class="keyword">import</span> javax.activation.FileDataSource;</span><br><span class="line"><span class="keyword">import</span> javax.mail.*;</span><br><span class="line"><span class="keyword">import</span> javax.mail.internet.*;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.security.GeneralSecurityException;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor(onConstructor_ = &#123;@Lazy, @Autowired&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmailService</span> &#123;</span><br><span class="line"><span class="comment">// 正常应该是动态配置注入的参数 而非硬编码</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">PROTOCOL</span> <span class="operator">=</span> <span class="string">&quot;ssl&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">HOST</span> <span class="operator">=</span> <span class="string">&quot;smtp.exmail.qq.com&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">PORT</span> <span class="operator">=</span> <span class="string">&quot;465&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SEND_ACCOUNT</span> <span class="operator">=</span> <span class="string">&quot;你的发件邮箱&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SEND_PASSWORD</span> <span class="operator">=</span> <span class="string">&quot;邮箱密码&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">send</span><span class="params">(String fromAliasName, String toEmail, String subject, String content, File attachFile)</span> &#123;</span><br><span class="line">        <span class="type">Properties</span> <span class="variable">prop</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        prop.setProperty(<span class="string">&quot;mail.transport.protocol&quot;</span>, PROTOCOL);</span><br><span class="line">        prop.setProperty(<span class="string">&quot;mail.smtp.host&quot;</span>, HOST);</span><br><span class="line">        prop.setProperty(<span class="string">&quot;mail.smtp.port&quot;</span>, PORT);</span><br><span class="line">        prop.setProperty(<span class="string">&quot;mail.smtp.auth&quot;</span>, <span class="string">&quot;true&quot;</span>);</span><br><span class="line">        <span class="type">MailSSLSocketFactory</span> <span class="variable">sslSocketFactory</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            sslSocketFactory = <span class="keyword">new</span> <span class="title class_">MailSSLSocketFactory</span>();</span><br><span class="line">            sslSocketFactory.setTrustAllHosts(<span class="literal">true</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (GeneralSecurityException e1) &#123;</span><br><span class="line">            e1.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (sslSocketFactory == <span class="literal">null</span>) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;开启 MailSSLSocketFactory 失败&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            prop.put(<span class="string">&quot;mail.smtp.ssl.enable&quot;</span>,<span class="string">&quot;true&quot;</span>);</span><br><span class="line">            prop.put(<span class="string">&quot;mail.smtp.ssl.socketFactory&quot;</span>, sslSocketFactory);</span><br><span class="line">            <span class="comment">// 创建邮件会话（注意，如果要在一个进程中切换多个邮箱账号发信，应该用 Session.getInstance）</span></span><br><span class="line">            <span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> Session.getDefaultInstance(prop, <span class="keyword">new</span> <span class="title class_">Authenticator</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">protected</span> PasswordAuthentication <span class="title function_">getPasswordAuthentication</span><span class="params">()</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">PasswordAuthentication</span>(SEND_ACCOUNT, SEND_PASSWORD);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">MimeMessage</span> <span class="variable">mimeMessage</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MimeMessage</span>(session);</span><br><span class="line">                <span class="comment">// 设置发件人别名（如果未设置别名就默认为发件人邮箱）</span></span><br><span class="line">                <span class="keyword">if</span> (fromAliasName != <span class="literal">null</span> &amp;&amp; !fromAliasName.trim().isEmpty()) &#123;</span><br><span class="line">                    mimeMessage.setFrom(<span class="keyword">new</span> <span class="title class_">InternetAddress</span>(SEND_ACCOUNT, fromAliasName));</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    mimeMessage.setFrom(<span class="keyword">new</span> <span class="title class_">InternetAddress</span>(SEND_ACCOUNT, SEND_ACCOUNT));</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 设置主题和收件人、发信时间等信息</span></span><br><span class="line">                mimeMessage.addRecipient(Message.RecipientType.TO, <span class="keyword">new</span> <span class="title class_">InternetAddress</span>(toEmail));</span><br><span class="line">                mimeMessage.setSubject(subject);</span><br><span class="line">                mimeMessage.setSentDate(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">                <span class="comment">// 如果有附件信息，则添加附件</span></span><br><span class="line">                <span class="comment">// 向multipart对象中添加邮件的各个部分内容，包括文本内容和附件</span></span><br><span class="line">                <span class="type">Multipart</span> <span class="variable">multipart</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MimeMultipart</span>();</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 添加邮件正文</span></span><br><span class="line">                <span class="type">BodyPart</span> <span class="variable">contentPart</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MimeBodyPart</span>();</span><br><span class="line">                contentPart.setContent(content, <span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line">                multipart.addBodyPart(contentPart);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 添加附件的内容</span></span><br><span class="line">                <span class="keyword">if</span> (attachFile != <span class="literal">null</span>) &#123;</span><br><span class="line">                    <span class="type">BodyPart</span> <span class="variable">attachmentBodyPart</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MimeBodyPart</span>();</span><br><span class="line">                    <span class="type">DataSource</span> <span class="variable">source</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileDataSource</span>(attachFile);</span><br><span class="line">                    attachmentBodyPart.setDataHandler(<span class="keyword">new</span> <span class="title class_">DataHandler</span>(source));</span><br><span class="line">                    attachmentBodyPart.setFileName(MimeUtility.encodeWord(attachFile.getName()));</span><br><span class="line">                    multipart.addBodyPart(attachmentBodyPart);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 将multipart对象放到message中</span></span><br><span class="line">                mimeMessage.setContent(multipart);</span><br><span class="line">                <span class="comment">// 保存邮件</span></span><br><span class="line">                mimeMessage.saveChanges();</span><br><span class="line"></span><br><span class="line">                Transport.send(mimeMessage);</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                log.error(<span class="string">&quot;发送邮件错误：&#123;&#125;&quot;</span>,e.getMessage());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android的网络请求封装-装饰</title>
      <link href="/2025/03/12/%E5%9F%BA%E4%BA%8EAndroid9%20JDK1.8%E7%9A%84%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E5%B0%81%E8%A3%85/"/>
      <url>/2025/03/12/%E5%9F%BA%E4%BA%8EAndroid9%20JDK1.8%E7%9A%84%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E5%B0%81%E8%A3%85/</url>
      
        <content type="html"><![CDATA[<blockquote><p>主体：okhttp3   retrofit2   rxjava2</p></blockquote><p>说明：请求框架   封装请求   订阅发布器</p><blockquote><p>插件：rxandroid   adapter-rxjava2   converter-gson</p></blockquote><p>说明：规范流，rxjava适配器，gson转换器</p><blockquote><p>下方示例一个登录请求，与其余请求携带令牌被拒后的重新登录统一处理回调</p></blockquote><p><strong>注意：</strong></p><blockquote><p>此处的网络连接为全局单例对象</p><p>假设你在登录请求时使用了这个单例，又根据其响应结果去更新了其一些参数：例如HEADER的TOKEN等</p><p>这个时候你必须要在登录请求结束后清除这个单例对象让它重新构建，否则你的 网络请求对象 将会按初始参数请求</p></blockquote><ol><li><p><strong>基础包</strong></p><blockquote><p>网络权限</p></blockquote><div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># AndroidManifest.xml</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.ACCESS_NETWORK_STATE&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.INTERNET&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure></div><blockquote><p>App容器 用以获取主Activity的上下文</p></blockquote><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 全局上下文获取器</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>   2021/12/3 15:53</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_">Application</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> App mContext;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate();</span><br><span class="line">        mContext = <span class="built_in">this</span>;</span><br><span class="line"></span><br><span class="line">        registerActivityLifecycleCallbacks(<span class="keyword">new</span> <span class="title class_">ActivityLifecycleCallbacks</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onActivityCreated</span><span class="params">(Activity activity, Bundle savedInstanceState)</span> &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onActivityStarted</span><span class="params">(Activity activity)</span> &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onActivityResumed</span><span class="params">(Activity activity)</span> &#123;</span><br><span class="line">                MyActivityManager.getInstance().setCurrentActivity(activity);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onActivityPaused</span><span class="params">(Activity activity)</span> &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onActivityStopped</span><span class="params">(Activity activity)</span> &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onActivitySaveInstanceState</span><span class="params">(Activity activity, Bundle outState)</span> &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onActivityDestroyed</span><span class="params">(Activity activity)</span> &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Context <span class="title function_">getAppContext</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> mContext;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><blockquote><p>全局变量</p></blockquote><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 网络请求全局变量</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/12/3 14:12</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Constant</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">VERSION_CODE</span> <span class="operator">=</span> <span class="string">&quot;v1&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">BASE_URL</span> <span class="operator">=</span> <span class="string">&quot;https://xxx/api/&quot;</span>+VERSION_CODE+<span class="string">&quot;/&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">CACHE_NAME</span> <span class="operator">=</span> <span class="string">&quot;cache_channel&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">DEFAULT_CONNECT_TIMEOUT</span> <span class="operator">=</span> <span class="number">60</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">DEFAULT_WRITE_TIMEOUT</span> <span class="operator">=</span> <span class="number">60</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">DEFAULT_READ_TIMEOUT</span> <span class="operator">=</span> <span class="number">60</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><blockquote><p>网络工具</p></blockquote><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 网络相关工具</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>   2021/12/3 15:53</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NetUtil</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isNetworkConnected</span><span class="params">(Context context)</span> &#123;</span><br><span class="line">        <span class="type">ConnectivityManager</span> <span class="variable">mConnectivityManager</span> <span class="operator">=</span> (ConnectivityManager) context</span><br><span class="line">                .getSystemService(Context.CONNECTIVITY_SERVICE);</span><br><span class="line">        <span class="keyword">if</span> (mConnectivityManager != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">NetworkInfo</span> <span class="variable">mNetworkInfo</span> <span class="operator">=</span> mConnectivityManager.getActiveNetworkInfo();</span><br><span class="line">            <span class="keyword">if</span> (mNetworkInfo != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> mNetworkInfo.isAvailable();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><blockquote><p>缓存拦截器</p></blockquote><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 请求Cache拦截器</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>   2021/12/3 15:54</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CacheInterceptor</span> <span class="keyword">implements</span> <span class="title class_">Interceptor</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Context mContext;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">CacheInterceptor</span><span class="params">(Context context)</span> &#123;</span><br><span class="line">        mContext = context;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Response <span class="title function_">intercept</span><span class="params">(<span class="meta">@NotNull</span> Chain chain)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">Request</span> <span class="variable">request</span> <span class="operator">=</span> chain.request();</span><br><span class="line">        <span class="keyword">if</span> (!NetUtil.isNetworkConnected(mContext)) &#123;</span><br><span class="line">            request = request.newBuilder()</span><br><span class="line">                    .cacheControl(CacheControl.FORCE_CACHE)</span><br><span class="line">                    .build();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Response</span> <span class="variable">response</span> <span class="operator">=</span> chain.proceed(request);</span><br><span class="line">        <span class="keyword">if</span> (NetUtil.isNetworkConnected(mContext)) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">maxAge</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="comment">// 有网络时 设置缓存超时时间0个小时</span></span><br><span class="line">            response.newBuilder()</span><br><span class="line">                    .header(<span class="string">&quot;Cache-Control&quot;</span>, <span class="string">&quot;public, max-age=&quot;</span> + maxAge)</span><br><span class="line">                    .removeHeader(Constant.CACHE_NAME)<span class="comment">// 清除头信息，因为服务器如果不支持，会返回一些干扰信息，不清除下面无法生效</span></span><br><span class="line">                    .build();</span><br><span class="line">        &#125;  <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 无网络时，设置超时为4周</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">maxStale</span> <span class="operator">=</span> <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">28</span>;</span><br><span class="line">            response.newBuilder()</span><br><span class="line">                    .header(<span class="string">&quot;Cache-Control&quot;</span>, <span class="string">&quot;public, only-if-cached, max-stale=&quot;</span> + maxStale)</span><br><span class="line">                    .removeHeader(Constant.CACHE_NAME)</span><br><span class="line">                    .build();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> response;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><blockquote><p>Header拦截器</p></blockquote><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 请求Headers拦截器</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>   2021/12/3 15:54</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HeaderInterceptor</span> <span class="keyword">implements</span> <span class="title class_">Interceptor</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Map&lt;String, String&gt; params;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">HeaderInterceptor</span><span class="params">(Map&lt;String, String&gt; p)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.params = p;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Response <span class="title function_">intercept</span><span class="params">(<span class="meta">@NotNull</span> Chain chain)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">Request</span> <span class="variable">originalRequest</span> <span class="operator">=</span> chain.request();</span><br><span class="line">        <span class="comment">//设置头部信息</span></span><br><span class="line">        Request.<span class="type">Builder</span> <span class="variable">requestBuilder</span> <span class="operator">=</span> originalRequest.newBuilder();</span><br><span class="line">        <span class="keyword">if</span> (params != <span class="literal">null</span> &amp;&amp; params.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; entry : params.entrySet()) &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> entry.getValue();</span><br><span class="line">                <span class="keyword">if</span> (TextUtils.isEmpty(value) || <span class="string">&quot;null&quot;</span>.equals(value)) &#123;</span><br><span class="line">                    value = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                requestBuilder.addHeader(entry.getKey(), value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        requestBuilder.method(originalRequest.method(), originalRequest.body());</span><br><span class="line">        <span class="type">Request</span> <span class="variable">request</span> <span class="operator">=</span> requestBuilder.build();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//打印请求信息，正式项目中可以注释掉</span></span><br><span class="line">        <span class="comment">/*RequestBody requestBody = request.body();</span></span><br><span class="line"><span class="comment">        String body = null;</span></span><br><span class="line"><span class="comment">        if (requestBody != null) &#123;</span></span><br><span class="line"><span class="comment">            Buffer buffer = new Buffer();</span></span><br><span class="line"><span class="comment">            requestBody.writeTo(buffer);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">            body = buffer.readString(StandardCharsets.UTF_8);</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        Log.e(&quot;METHOD&quot;,request.method());</span></span><br><span class="line"><span class="comment">        Log.e(&quot;URL&quot;, String.valueOf(request.url()));</span></span><br><span class="line"><span class="comment">        Log.e(&quot;HEADERS&quot;, String.valueOf(request.headers()));</span></span><br><span class="line"><span class="comment">        Log.e(&quot;BODY&quot;,&quot;body:&quot;+body);*/</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> chain.proceed(request);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div></li><li><p><strong>api接口</strong></p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * API ROUTER</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>   2021/12/3 15:55</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Api</span> &#123;</span><br><span class="line">    <span class="meta">@POST(&quot;login&quot;)</span></span><br><span class="line">    <span class="meta">@FormUrlEncoded</span></span><br><span class="line">    Observable&lt;ResponseBody&gt; <span class="title function_">login</span><span class="params">(<span class="meta">@Field(&quot;username&quot;)</span> String username, <span class="meta">@Field(&quot;password&quot;)</span> String password)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li><li><p><strong>HTTP客户端构建器</strong></p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 网络请求构建器</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>   2021/12/3 15:54</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NetBuilder</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> OkHttpClient.Builder okHttpBuilder;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">NetBuilder</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//手动创建一个OkHttpClient并设置超时时间</span></span><br><span class="line">        okHttpBuilder = <span class="keyword">new</span> <span class="title class_">OkHttpClient</span>.Builder();</span><br><span class="line">    &#125;</span><br><span class="line">     <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 连接超时</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> outTime</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> NetBuilder <span class="title function_">setConnectTimeout</span><span class="params">(<span class="type">int</span> outTime)</span> &#123;</span><br><span class="line">        okHttpBuilder.connectTimeout(outTime, TimeUnit.SECONDS);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 读超时</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> outTime</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> NetBuilder <span class="title function_">setReadTimeout</span><span class="params">(<span class="type">int</span> outTime)</span> &#123;</span><br><span class="line">        okHttpBuilder.readTimeout(outTime, TimeUnit.SECONDS);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 写超时</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> outTime</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> NetBuilder <span class="title function_">setWriteTimeout</span><span class="params">(<span class="type">int</span> outTime)</span> &#123;</span><br><span class="line">        okHttpBuilder.writeTimeout(outTime, TimeUnit.SECONDS);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 错误重连</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> retry</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> NetBuilder <span class="title function_">setRetryOnConnectionFailure</span><span class="params">(<span class="type">boolean</span> retry)</span> &#123;</span><br><span class="line">        okHttpBuilder.retryOnConnectionFailure(retry);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加拦截器</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> interceptor</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> NetBuilder <span class="title function_">addInterceptor</span><span class="params">(Interceptor interceptor)</span> &#123;</span><br><span class="line">        okHttpBuilder.addInterceptor(interceptor);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加倒数第二层拦截器</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> interceptor</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> NetBuilder <span class="title function_">addNetInterceptor</span><span class="params">(Interceptor interceptor)</span> &#123;</span><br><span class="line">        okHttpBuilder.addNetworkInterceptor(interceptor);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加缓存文件</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> cache</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> NetBuilder <span class="title function_">addCache</span><span class="params">(Cache cache)</span> &#123;</span><br><span class="line">        okHttpBuilder.cache(cache);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Retrofit <span class="title function_">build</span><span class="params">(String url)</span> &#123;</span><br><span class="line">        <span class="comment">//配置证书</span></span><br><span class="line">       <span class="comment">/*try &#123;</span></span><br><span class="line"><span class="comment">            SSLContext sslContext = SSLContext.getInstance(&quot;TLS&quot;);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">            sslContext.init(null, new X509TrustManager[]&#123;new NetUtil.TrustManager()&#125;, new SecureRandom());</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">            okHttpBuilder.sslSocketFactory(sslContext.getSocketFactory(),new NetUtil.TrustManager()).hostnameVerifier(new HostnameVerifier() &#123;</span></span><br><span class="line"><span class="comment">                @Override</span></span><br><span class="line"><span class="comment">                public boolean verify(String hostname, SSLSession session) &#123;</span></span><br><span class="line"><span class="comment">                    return true;</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment">            &#125;);</span></span><br><span class="line"><span class="comment">        &#125;catch (KeyManagementException | NoSuchAlgorithmException e)&#123;</span></span><br><span class="line"><span class="comment">            Hint.toastShort(App.getAppContext(),&quot;证书失效&quot;,Hint.COMMON);</span></span><br><span class="line"><span class="comment">        &#125;*/</span></span><br><span class="line">       <span class="comment">//构建Retrofit实例</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Retrofit</span>.Builder()</span><br><span class="line">                .client(okHttpBuilder.build())</span><br><span class="line">                .addConverterFactory(GsonConverterFactory.create())<span class="comment">//json转换成JavaBean</span></span><br><span class="line">                .addCallAdapterFactory(RxJava2CallAdapterFactory.create())</span><br><span class="line">                .baseUrl(url)</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li><li><p><strong>订阅者</strong></p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 基础订阅者</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/12/3 14:42</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BaseSubscribe</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Api okHttpApi;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Api <span class="title function_">getOkHttpApi</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (okHttpApi==<span class="literal">null</span>) &#123;</span><br><span class="line">            okHttpApi = newApi(Constant.BASE_URL, getHeaderParams(), Api.class);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> okHttpApi;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 关键方法，可以根据需求产出不同的api</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> baseUrl</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> params</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> apiClass</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;T&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt;T <span class="title function_">newApi</span><span class="params">(String baseUrl, Map&lt;String, String&gt; params, Class&lt;T&gt; apiClass)</span> &#123;</span><br><span class="line">        <span class="type">NetBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NetBuilder</span>()</span><br><span class="line">                .setConnectTimeout(Constant.DEFAULT_CONNECT_TIMEOUT)</span><br><span class="line">                .setReadTimeout(Constant.DEFAULT_READ_TIMEOUT)</span><br><span class="line">                .setWriteTimeout(Constant.DEFAULT_WRITE_TIMEOUT)</span><br><span class="line">                .setRetryOnConnectionFailure(<span class="literal">true</span>);</span><br><span class="line">        <span class="comment">//添加header</span></span><br><span class="line">        <span class="keyword">if</span> (params != <span class="literal">null</span> &amp;&amp; params.size()&gt;<span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">HeaderInterceptor</span> <span class="variable">headerInterceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HeaderInterceptor</span>(params);</span><br><span class="line">            builder.addInterceptor(headerInterceptor);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//添加缓存</span></span><br><span class="line">        <span class="type">File</span> <span class="variable">cacheFile</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(App.getAppContext().getExternalCacheDir(), Constant.CACHE_NAME);</span><br><span class="line">        <span class="type">Cache</span> <span class="variable">cache</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cache</span>(cacheFile, <span class="number">1024</span> * <span class="number">1024</span> * <span class="number">50</span>);</span><br><span class="line">        builder.addCache(cache);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//添加缓存拦截器</span></span><br><span class="line">        <span class="type">CacheInterceptor</span> <span class="variable">cacheInterceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CacheInterceptor</span>(App.getAppContext());</span><br><span class="line">        builder.addInterceptor(cacheInterceptor);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> builder.build(baseUrl).create(apiClass);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//设置表头</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String, String&gt; <span class="title function_">getHeaderParams</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//取决于你自己的存储方式，加否与获取取决于自己的业务</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> GlobalStorage.getGlobalStorage().get(<span class="string">&quot;token&quot;</span>);</span><br><span class="line"></span><br><span class="line">        String timestamp;</span><br><span class="line">        timestamp = String.valueOf(System.currentTimeMillis() / <span class="number">1000</span>);</span><br><span class="line">        Map&lt;String, String&gt; params = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">if</span> (!TextUtils.isEmpty(token)) &#123;</span><br><span class="line">            params.put(<span class="string">&quot;token&quot;</span>, token);</span><br><span class="line">        &#125;</span><br><span class="line">        params.put(<span class="string">&quot;timestamp&quot;</span>, timestamp);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> params;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置订阅 和 所在的线程环境</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> o</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> s</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">toSubscribe</span><span class="params">(Observable&lt;ResponseBody&gt; o, DisposableObserver&lt;ResponseBody&gt; s)</span> &#123;</span><br><span class="line">        o.subscribeOn(Schedulers.io())</span><br><span class="line">                .unsubscribeOn(Schedulers.io())</span><br><span class="line">                .observeOn(AndroidSchedulers.mainThread())</span><br><span class="line">                .retry(<span class="number">1</span>)<span class="comment">//请求失败重连次数</span></span><br><span class="line">                .subscribe(s);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li><li><p><strong>订阅</strong></p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * API请求订阅器</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>   2021/12/3 15:53</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Subscribe</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">login</span><span class="params">(String username, String pwd, DisposableObserver&lt;ResponseBody&gt; subscriber)</span> &#123;</span><br><span class="line">        <span class="comment">//可以在这里对请求参数加一些后置操作</span></span><br><span class="line">        pwd = Base64.encodeToString(pwd.getBytes(),Base64.DEFAULT);<span class="comment">//base64加密</span></span><br><span class="line">        Observable&lt;ResponseBody&gt; observable = BaseSubscribe.getOkHttpApi().login(username,pwd);</span><br><span class="line">        BaseSubscribe.toSubscribe(observable, subscriber);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li><li><p><strong>响应回调</strong></p><blockquote><p>回调接口</p></blockquote><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * API响应回调接口</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>   2021/12/3 15:47</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">APICallback</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">logout</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">onSuccess</span><span class="params">(T result)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">onFault</span><span class="params">(<span class="type">int</span> code, String errorMsg)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">netError</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><blockquote><p>回调处理</p></blockquote><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 处理各种业务逻辑及错误</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>   2021/12/3 15:49</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">NetCallback</span>&lt;T&gt; <span class="keyword">extends</span> <span class="title class_">DisposableObserver</span>&lt;ResponseBody&gt; <span class="keyword">implements</span> <span class="title class_">APICallback</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onNext</span><span class="params">(<span class="meta">@NonNull</span> ResponseBody body)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//此处获取响应信息，可以对响应信息做第一层的数据处理</span></span><br><span class="line">            <span class="comment">//比如对于响应码的不同操作</span></span><br><span class="line">            <span class="comment">//下方示例一些操作</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> body.string();</span><br><span class="line">            <span class="type">JSONObject</span> <span class="variable">jsonObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JSONObject</span>(result);</span><br><span class="line">            <span class="type">double</span> <span class="variable">resultCode</span> <span class="operator">=</span> jsonObject.getDouble(<span class="string">&quot;status_code&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (resultCode == <span class="number">200.0</span>) &#123;</span><br><span class="line">                <span class="type">Gson</span> <span class="variable">gson</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Gson</span>();</span><br><span class="line">                <span class="type">String</span> <span class="variable">data</span> <span class="operator">=</span> jsonObject.getString(<span class="string">&quot;data&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span> (!TextUtils.isEmpty(data)) &#123;</span><br><span class="line">                    <span class="type">T</span> <span class="variable">t</span> <span class="operator">=</span> gson.fromJson(data, getType());</span><br><span class="line">                    onSuccess(t);<span class="comment">//第一层数据处理完毕将真实响应数据向下抛</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (resultCode == <span class="number">401.0</span>) &#123;</span><br><span class="line">                logout();</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (resultCode == <span class="number">400.0</span>)&#123;</span><br><span class="line">                onFault(<span class="number">1</span>, jsonObject.getString(<span class="string">&quot;data&quot;</span>));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">errorMsg</span> <span class="operator">=</span> jsonObject.getString(<span class="string">&quot;message&quot;</span>);</span><br><span class="line">                onFault(<span class="number">0</span>, errorMsg);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 请求出错，包含网络错误</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> e</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onError</span><span class="params">(Throwable e)</span></span><br><span class="line">    &#123;</span><br><span class="line">        netError();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onComplete</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Type <span class="title function_">getType</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//获取第一个泛型类型</span></span><br><span class="line">        <span class="type">ParameterizedType</span> <span class="variable">parameterizedType</span> <span class="operator">=</span> (ParameterizedType) getClass().getGenericSuperclass();</span><br><span class="line">        <span class="keyword">assert</span> parameterizedType != <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">return</span> parameterizedType.getActualTypeArguments()[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li><li><p><strong>处理第一层的回调信息</strong></p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 统一处理的逻辑，都在类似这样的方法中处理。暴露在每个最外层的callback只处理指定场景下的业务逻辑。</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>   2021/12/3 15:48</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">HandlerCallback</span>&lt;T&gt; <span class="keyword">extends</span> <span class="title class_">NetCallback</span>&lt;T&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logout</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Context</span> <span class="variable">context</span> <span class="operator">=</span> MyActivityManager.getInstance().getCurrentActivity();</span><br><span class="line">        <span class="type">GlobalStorage</span> <span class="variable">storage</span> <span class="operator">=</span> GlobalStorage.getGlobalStorage();</span><br><span class="line">        androidx.appcompat.app.AlertDialog.<span class="type">Builder</span> <span class="variable">builder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AlertDialog</span>.Builder(context);</span><br><span class="line">        builder.setMessage(<span class="string">&quot;登录已过期，请重新登录&quot;</span>)</span><br><span class="line">                .setPositiveButton(<span class="string">&quot;确定&quot;</span>, (dialogInterface, i) -&gt; &#123;</span><br><span class="line">                  <span class="comment">//操作</span></span><br><span class="line">                &#125;).create().show();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onFault</span><span class="params">(<span class="type">int</span> code, String errorMsg)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (code==<span class="number">0</span>)&#123;</span><br><span class="line">            Hint.toastShort(App.getAppContext(), errorMsg, Hint.COMMON);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onError</span><span class="params">(Throwable e)</span> &#123;</span><br><span class="line">        Hint.toastShort(App.getAppContext(), <span class="string">&quot;内部服务器错误&quot;</span>, Hint.ERROR);<span class="comment">//这些操作仅是我的个人业务操作</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li><li><p><strong>请求</strong></p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Login是自定义的bean，通过gson转换器自动转换</span></span><br><span class="line">Subscribe.login(username, password, <span class="keyword">new</span> <span class="title class_">HandlerCallback</span>&lt;Login&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onSuccess</span><span class="params">(Login result)</span> &#123;</span><br><span class="line">                <span class="comment">//成功的操作</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onFault</span><span class="params">(<span class="type">int</span> code, String errorMsg)</span>&#123;</span><br><span class="line">                <span class="comment">//失败</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">netError</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="comment">//错误</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure></div></li></ol><h1 id="WebSocket"><a href="#WebSocket" class="headerlink" title="WebSocket"></a>WebSocket</h1><ol><li><p><strong>构建客户端</strong></p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * websocket客户端</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>   2021/12/9 15:24</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebSocketClient</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Request request;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> OkHttpClient client;</span><br><span class="line">    <span class="keyword">private</span> WebSocket webSocket;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">WebSocketClient</span><span class="params">()</span> &#123;</span><br><span class="line">        client = <span class="keyword">new</span> <span class="title class_">OkHttpClient</span>();</span><br><span class="line">        request = <span class="keyword">new</span> <span class="title class_">Request</span>.Builder()</span><br><span class="line">                .url(<span class="string">&quot;wss://xxx/&quot;</span>)</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">start</span><span class="params">(WebSocketListener listener)</span> &#123;</span><br><span class="line">        client.dispatcher().cancelAll();</span><br><span class="line">        webSocket = client.newWebSocket(request, listener);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (webSocket != <span class="literal">null</span>) &#123;</span><br><span class="line">            webSocket.close(<span class="number">1000</span>, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        client.dispatcher().executorService().shutdown();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><ol start="2"><li><strong>一些常量标识</strong></li></ol><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * WEBSOCKET的一些标识</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/12/10 14:17</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebSocketConstant</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">CLOSE_SIGN</span> <span class="operator">=</span> <span class="string">&quot;CLOSE&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">PULL_SIGN</span> <span class="operator">=</span> <span class="string">&quot;DATA&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><ol start="3"><li><strong>连接监听器</strong></li></ol><blockquote><p>此处设定心跳请求，每隔特定时间向服务端发送心跳，接收不到响应就关闭客户端并通知主线程</p><p>所以响应数据分两种格式：正常的推送数据，心跳的监测数据</p></blockquote><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * websocket监听程序</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/12/9 16:55</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SsWebSocketListener</span> <span class="keyword">extends</span> <span class="title class_">WebSocketListener</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">HEARTBEAT_HZ</span> <span class="operator">=</span> <span class="number">10</span>; <span class="comment">//心跳发送间隔也是关闭通知推送间隔</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SUBSCRIBE</span> <span class="operator">=</span> <span class="string">&quot;&#123;xxx&#125;&quot;</span>;<span class="comment">//心跳订阅信息</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="variable">START_STATUS</span> <span class="operator">=</span> <span class="literal">false</span>;<span class="comment">//当前客户端状态</span></span><br><span class="line">    <span class="keyword">public</span> WebSocket webSocket;<span class="comment">//socket客户端</span></span><br><span class="line">    <span class="keyword">public</span> Handler handler;<span class="comment">//主线程消息处理器</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Long timestamp;<span class="comment">//启动时间戳</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//构造方法获取主线程的消息处理器</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SsWebSocketListener</span><span class="params">(Handler handler)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.timestamp = <span class="keyword">new</span> <span class="title class_">Date</span>().getTime(); <span class="comment">//先记录下尝试启动时的时间戳</span></span><br><span class="line">        <span class="built_in">this</span>.handler = handler;<span class="comment">//主线程消息处理器</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onOpen</span><span class="params">(<span class="meta">@NotNull</span> WebSocket webSocket, <span class="meta">@NotNull</span> Response response)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.webSocket = webSocket;<span class="comment">//第一次打开时，赋值socket对象</span></span><br><span class="line">        openTimeTask();<span class="comment">//打开定时任务发送心跳包</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onMessage</span><span class="params">(<span class="meta">@NotNull</span> WebSocket webSocket, <span class="meta">@NotNull</span> String text)</span> &#123;</span><br><span class="line">        <span class="type">Gson</span> <span class="variable">gson</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Gson</span>();</span><br><span class="line">        <span class="type">Struct</span> <span class="variable">struct</span> <span class="operator">=</span> gson.fromJson(text, Struct.class);</span><br><span class="line">        <span class="keyword">if</span> (isPushMsg(struct))&#123;<span class="comment">//判断是正常的消息推送</span></span><br><span class="line">            <span class="comment">//消息推送给主线程，通知主线程执行UI更新</span></span><br><span class="line">            <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> handler.obtainMessage();</span><br><span class="line">            message.obj = WebSocketConstant.PULL_SIGN;<span class="comment">//标记这是一条正常消息</span></span><br><span class="line">            <span class="type">Bundle</span> <span class="variable">arg</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bundle</span>();</span><br><span class="line">            arg.putInt(<span class="string">&quot;number&quot;</span>,((Double) struct.getData()).intValue());</span><br><span class="line">            message.setData(arg);</span><br><span class="line">            handler.sendMessage(message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onFailure</span><span class="params">(<span class="meta">@NotNull</span> WebSocket webSocket, <span class="meta">@NotNull</span> Throwable t, <span class="meta">@Nullable</span> Response response)</span> &#123;</span><br><span class="line">        closeTimeTask();<span class="comment">//连接失败时关闭定时任务</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClosing</span><span class="params">(<span class="meta">@NotNull</span> WebSocket webSocket, <span class="type">int</span> code, <span class="meta">@NotNull</span> String reason)</span> &#123;</span><br><span class="line">        closeTimeTask();<span class="comment">//断开连接时关闭定时任务</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClosed</span><span class="params">(<span class="meta">@NotNull</span> WebSocket webSocket, <span class="type">int</span> code, <span class="meta">@NotNull</span> String reason)</span> &#123;</span><br><span class="line">        closeTimeTask();<span class="comment">//关闭连接时关闭定时任务</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">openTimeTask</span><span class="params">()</span>&#123;</span><br><span class="line">        START_STATUS = <span class="literal">true</span>;<span class="comment">//标记客户端状态正常</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;<span class="comment">//开启子线程</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">while</span> (START_STATUS)&#123;<span class="comment">//借助上级的标记来循环心跳</span></span><br><span class="line">                    webSocket.send(SUBSCRIBE);</span><br><span class="line">                    Thread.sleep(HEARTBEAT_HZ * <span class="number">1000</span>);<span class="comment">//睡眠间隔</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">closeTimeTask</span><span class="params">()</span>&#123;</span><br><span class="line">        START_STATUS = <span class="literal">false</span>;<span class="comment">//标记客户端关闭，让子线程跳出</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//如果启动时间至关闭 不足十秒让他sleep 防止频繁的消息推送</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">diff</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>().getTime()-<span class="built_in">this</span>.timestamp;</span><br><span class="line">        <span class="type">long</span> <span class="variable">touch</span> <span class="operator">=</span> (<span class="type">long</span>) (HEARTBEAT_HZ * <span class="number">1000</span>);</span><br><span class="line">        <span class="keyword">if</span> (diff &lt; touch)&#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                Thread.sleep(touch-diff);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//通知主线程 websocket监听被关闭,让它准备重启</span></span><br><span class="line">        <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> handler.obtainMessage();</span><br><span class="line">        message.obj = WebSocketConstant.CLOSE_SIGN;</span><br><span class="line">        handler.sendMessage(message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//判断响应类型是否为正常数据响应</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">isPushMsg</span><span class="params">(Struct struct)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;xxx&quot;</span>.equals(struct.getDataType());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//响应的数据BEAN</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Struct</span>&#123;</span><br><span class="line">        <span class="keyword">private</span> Object data;</span><br><span class="line">        <span class="keyword">private</span> String dataType;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getDataType</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> dataType;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDataType</span><span class="params">(String dataType)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.dataType = dataType;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Object <span class="title function_">getData</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> data;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setData</span><span class="params">(Object data)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.data = data;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><ol start="4"><li><strong>在ACTIVITY中使用</strong></li></ol><blockquote><p>Android的Activity生命周期不多赘述</p><p>这里再onResume时和onPause时进行socket操作，以此达到用户切出应用时退出SOCKET，切回再打开</p></blockquote><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">startWebSocket</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (webSocketClient == <span class="literal">null</span>) &#123;</span><br><span class="line">            handler();</span><br><span class="line">            webSocketClient = <span class="keyword">new</span> <span class="title class_">WebSocketClient</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        webSocketClient.start(<span class="keyword">new</span> <span class="title class_">SsWebSocketListener</span>(handler));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">closeSocket</span><span class="params">()</span> &#123;</span><br><span class="line">        webSocketClient.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">handler</span><span class="params">()</span>&#123;</span><br><span class="line">        handler = <span class="keyword">new</span> <span class="title class_">Handler</span>(Looper.getMainLooper())&#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleMessage</span><span class="params">(Message msg)</span> &#123;</span><br><span class="line">                <span class="built_in">super</span>.handleMessage(msg);</span><br><span class="line">                <span class="type">String</span> <span class="variable">status</span> <span class="operator">=</span> (String) msg.obj;</span><br><span class="line">                <span class="comment">//如果SOCKET监听因为一些原因被关闭，通过消息获取此通知，尝试重启</span></span><br><span class="line">                <span class="keyword">if</span> (status.equals(WebSocketConstant.CLOSE_SIGN))&#123;</span><br><span class="line">                    Toast.makeText(PieceworkActivity.<span class="built_in">this</span>,<span class="string">&quot;服务器连接失败&quot;</span>,Toast.LENGTH_SHORT).show();</span><br><span class="line">                    <span class="comment">//先尝试关闭已有客户端,再重启socketclient</span></span><br><span class="line">                    closeSocket();</span><br><span class="line">                    startWebSocket();<span class="comment">//如果重启失败会在监听器中Sleep十秒后再次发送失败通知来此，以此达到循环效果</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (status.equals(WebSocketConstant.PULL_SIGN))&#123;<span class="comment">//正常的消息则消费掉，更新UI</span></span><br><span class="line">                    <span class="type">int</span> <span class="variable">amount</span> <span class="operator">=</span> msg.getData().getInt(<span class="string">&quot;number&quot;</span>);</span><br><span class="line">                    <span class="keyword">if</span> (num.getText().toString().isEmpty() || Integer.parseInt((String) num.getText()) != amount)&#123;</span><br><span class="line">                        num.setText(String.valueOf(amount));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onResume</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onResume();</span><br><span class="line">        <span class="comment">//启动socket</span></span><br><span class="line">        startWebSocket();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onPause</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onPause();</span><br><span class="line">        <span class="comment">//关闭socket</span></span><br><span class="line">        closeSocket();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android通用基础功能实现</title>
      <link href="/2025/03/12/%E5%AE%89%E5%8D%93%E5%9F%BA%E6%9C%AC%E9%9C%80%E6%B1%82/"/>
      <url>/2025/03/12/%E5%AE%89%E5%8D%93%E5%9F%BA%E6%9C%AC%E9%9C%80%E6%B1%82/</url>
      
        <content type="html"><![CDATA[<h3 id="APP更新"><a href="#APP更新" class="headerlink" title="APP更新"></a>APP更新</h3><p><strong>前言</strong></p><blockquote><p>没有特殊的更新需求，GITHUB上随便找个包即可,这里使用<code>com.teprinciple:updateapputils</code></p></blockquote><p><strong>–前置–</strong></p><blockquote><p>远程服务器存放APK包与更新资源描述</p></blockquote><ol><li><p>引包</p><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implementation <span class="string">&#x27;com.teprinciple:updateapputils:2.3.0&#x27;</span>//自动更新包</span><br></pre></td></tr></table></figure></div></li><li><p>其中出现的一些基础小方法，例如获取当前最上层主线程上下文，检测网络等可按各自API版本各自些</p></li><li><p>主方法</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//远程配置文件地址</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">APK_URL</span> <span class="operator">=</span> <span class="string">&quot;https://xxxxx/apk.cnf&quot;</span>;</span><br><span class="line"><span class="comment">//初始化更新</span></span><br><span class="line"><span class="comment">//更新建立在子线程中，防止阻塞性主线程的正常UI渲染,因为我的更新检测触发点在APP打开一瞬间,所以SLEEP 500ms让UI渲染出来</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">//检查更新</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Thread</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                Thread.sleep(<span class="number">500</span>);</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e)&#123;&#125;</span><br><span class="line">            checkUpdate();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;.start();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 检查更新</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">checkUpdate</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//检查手机当前网络状态,无网络提示跳过更新</span></span><br><span class="line">    <span class="keyword">if</span> (!NetUtil.isNetworkConnected(MyActivityManager.getInstance().getCurrentActivity()))&#123;</span><br><span class="line">        Looper.prepare();</span><br><span class="line">        Hint.toastShort(MyActivityManager.getInstance().getCurrentActivity(),<span class="string">&quot;您当前无网络!&quot;</span>,Hint.COMMON);</span><br><span class="line">        Looper.loop();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//读取配置</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">conf</span> <span class="operator">=</span> readCnf();</span><br><span class="line">    <span class="keyword">if</span> (conf==<span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//获取当前主线程的上下文包信息</span></span><br><span class="line">        <span class="type">PackageInfo</span> <span class="variable">packInfo</span> <span class="operator">=</span> App.getAppContext().getPackageManager().getPackageInfo(App.getAppContext().getPackageName(), <span class="number">0</span>);</span><br><span class="line">        <span class="type">Gson</span> <span class="variable">gson</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Gson</span>();</span><br><span class="line">        Map&lt;String,String&gt; map = gson.fromJson(conf, Map.class);</span><br><span class="line">        <span class="comment">//对比应用版本与远程配置版本是否一致</span></span><br><span class="line">        <span class="keyword">if</span> (packInfo.versionName.equals(map.get(<span class="string">&quot;version&quot;</span>)))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//不一致执行更新</span></span><br><span class="line">        executeUpdate(map.get(<span class="string">&quot;url&quot;</span>),map.get(<span class="string">&quot;title&quot;</span>),map.get(<span class="string">&quot;content&quot;</span>));</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;<span class="keyword">catch</span> (PackageManager.NameNotFoundException e) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 执行更新</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">executeUpdate</span><span class="params">(String url, String title, String content)</span> &#123;</span><br><span class="line">    UpdateAppUtils.init(MyActivityManager.getInstance().getCurrentActivity());</span><br><span class="line"></span><br><span class="line">    <span class="type">UpdateConfig</span> <span class="variable">updateConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UpdateConfig</span>();</span><br><span class="line">    updateConfig.setNeedCheckMd5(<span class="literal">false</span>); <span class="comment">//不过MD5签名校验，先FALSE</span></span><br><span class="line">    updateConfig.setForce(<span class="literal">true</span>);<span class="comment">//是否强制其选择</span></span><br><span class="line">    updateConfig.setCheckWifi(<span class="literal">true</span>);<span class="comment">//是否检查当前wifi状态</span></span><br><span class="line">    updateConfig.setNotifyImgRes(R.drawable.ic_update_logo);<span class="comment">//设置更新提示图标</span></span><br><span class="line"></span><br><span class="line">    <span class="type">UiConfig</span> <span class="variable">uiConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UiConfig</span>();</span><br><span class="line">    uiConfig.setUiType(UiType.PLENTIFUL);</span><br><span class="line">    <span class="comment">//调取更新包进行更新</span></span><br><span class="line">    UpdateAppUtils</span><br><span class="line">        .getInstance()</span><br><span class="line">        .apkUrl(url)</span><br><span class="line">        .updateTitle(title)</span><br><span class="line">        .updateContent(content)</span><br><span class="line">        .uiConfig(uiConfig)</span><br><span class="line">        .updateConfig(updateConfig)</span><br><span class="line">        .update();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">readCnf</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//以文件流形式读取远程配置文件</span></span><br><span class="line">        StrictMode.ThreadPolicy policy=<span class="keyword">new</span> <span class="title class_">StrictMode</span>.ThreadPolicy.Builder().permitAll().build();</span><br><span class="line">        StrictMode.setThreadPolicy(policy);</span><br><span class="line">        <span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(APK_URL);</span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(url.openStream()));</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">str</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        String s;</span><br><span class="line">        <span class="keyword">while</span> ((s = in.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">            str.append(s);</span><br><span class="line">        &#125;</span><br><span class="line">        in.close();</span><br><span class="line">        <span class="comment">//将配置以文本方式输出</span></span><br><span class="line">        <span class="keyword">return</span> str.toString();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        Looper.prepare();</span><br><span class="line">        <span class="comment">//出现错误大概率为网络问题</span></span><br><span class="line">        Hint.toastShort(MyActivityManager.getInstance().getCurrentActivity(),<span class="string">&quot;请检查您的网络是否正常!&quot;</span>,Hint.COMMON);</span><br><span class="line">        Looper.loop();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li></ol><h3 id="单点登录实时检测"><a href="#单点登录实时检测" class="headerlink" title="单点登录实时检测"></a>单点登录实时检测</h3><h4 id="APP客户端"><a href="#APP客户端" class="headerlink" title="APP客户端"></a>APP客户端</h4><ol><li><p>建立服务</p><blockquote><p>注册android活跃服务进行保证生命周期正确性</p></blockquote></li><li><p>建立SOCKET</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//服务loop器</span></span><br><span class="line"><span class="keyword">private</span> Looper serviceLooper;</span><br><span class="line"><span class="comment">//服务的消息处理器</span></span><br><span class="line"><span class="keyword">private</span> ServiceHandler serviceHandler;</span><br><span class="line"><span class="comment">//当前活跃的socket客户端</span></span><br><span class="line"><span class="keyword">private</span> LoginSocketClient socketClient;</span><br><span class="line"><span class="comment">//建立服务消息处理器的内部类用于消费socket传递回来的消息</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">ServiceHandler</span> <span class="keyword">extends</span> <span class="title class_">Handler</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ServiceHandler</span><span class="params">(Looper looper)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(looper);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleMessage</span><span class="params">(Message msg)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (socketClient==<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">super</span>.handleMessage(msg);</span><br><span class="line">        <span class="type">String</span> <span class="variable">status</span> <span class="operator">=</span> (String) msg.obj;</span><br><span class="line">        <span class="comment">//如果SOCKET监听因为一些原因被关闭，通过消息获取此通知，尝试重启</span></span><br><span class="line">        <span class="keyword">if</span> (status.equals(SocketConstant.CLOSE_SIGN))&#123;</span><br><span class="line">            postDelayed(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                    startWebSocket(msg.arg1);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, LoginSocketListener.HEARTBEAT_HZ * <span class="number">1000</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//如果socket通知登录账号被别人顶替，通知当前服务关闭，强制踢当前用户下线</span></span><br><span class="line">        <span class="keyword">if</span> (status.equals(SocketConstant.STOP))&#123;</span><br><span class="line">            stopSelf(msg.arg1);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//服务全局挂载 不绑定任何activity实例</span></span><br><span class="line"><span class="meta">@Nullable</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> IBinder <span class="title function_">onBind</span><span class="params">(Intent intent)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//初始化获取消息处理器 循环器</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">HandlerThread</span> <span class="variable">thread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HandlerThread</span>(<span class="string">&quot;LoginListener&quot;</span>,</span><br><span class="line">                                             Process.THREAD_PRIORITY_BACKGROUND);</span><br><span class="line">    thread.start();</span><br><span class="line"></span><br><span class="line">    serviceLooper = thread.getLooper();</span><br><span class="line">    serviceHandler = <span class="keyword">new</span> <span class="title class_">ServiceHandler</span>(serviceLooper);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//服务销毁时代表当前已被踢下线</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onDestroy</span><span class="params">()</span> &#123;</span><br><span class="line">    closeSocket();</span><br><span class="line">    <span class="comment">//判断当前应用是否处于前台活动中,这里判断是为了防止API28之后的改变应用被拉入后台非活动进程中</span></span><br><span class="line">    <span class="comment">//为了供给前台进程的计算与内存会销毁非前台活动服务进程</span></span><br><span class="line">    <span class="comment">//如果其是在前台进程时被踢下线提示他 如果是后台时不提示默默销毁服务监听,等待其下一次网络请求时被踢下</span></span><br><span class="line">    <span class="keyword">if</span> (!SystemUtil.isBackground(<span class="built_in">this</span>))&#123;</span><br><span class="line">            DialogX.init(MyActivityManager.getInstance().getCurrentActivity());</span><br><span class="line">            MessageDialog.show(<span class="string">&quot;登录失效&quot;</span>, <span class="string">&quot;该账号登录过期或已在别处登录&quot;</span>, <span class="string">&quot;确定&quot;</span>)</span><br><span class="line">                    .setOkButton(<span class="keyword">new</span> <span class="title class_">OnDialogButtonClickListener</span>&lt;MessageDialog&gt;() &#123;</span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onClick</span><span class="params">(MessageDialog baseDialog, View v)</span> &#123;</span><br><span class="line">                            NetUtil.logoutAction();</span><br><span class="line">                            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;)</span><br><span class="line">                    .setTitleTextInfo(<span class="keyword">new</span> <span class="title class_">TextInfo</span>()</span><br><span class="line">                            .setBold(<span class="literal">true</span>).setFontColor(getResources().getColor(R.color.red,<span class="literal">null</span>)))</span><br><span class="line">                    .setOkTextInfo(<span class="keyword">new</span> <span class="title class_">TextInfo</span>().setFontColor(getResources().getColor(R.color.blue_tint,<span class="literal">null</span>)))</span><br><span class="line">                    .setMessageTextInfo(<span class="keyword">new</span> <span class="title class_">TextInfo</span>().setFontSize(<span class="number">15</span>))</span><br><span class="line">                    .setStyle(MaterialStyle.style()).setCancelable(<span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 启动websocket监听</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">onStartCommand</span><span class="params">(Intent intent, <span class="type">int</span> flags, <span class="type">int</span> startId)</span> &#123;</span><br><span class="line">    startWebSocket(startId);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> START_STICKY;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">startWebSocket</span><span class="params">(<span class="type">int</span> startId)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (socketClient == <span class="literal">null</span>) &#123;</span><br><span class="line">        socketClient = <span class="keyword">new</span> <span class="title class_">LoginSocketClient</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    socketClient.start(<span class="keyword">new</span> <span class="title class_">LoginSocketListener</span>(serviceHandler, startId));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">closeSocket</span><span class="params">()</span> &#123;</span><br><span class="line">    socketClient.close();</span><br><span class="line">    socketClient = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li><li><p>websocket监听器详见<a class="link"   href="http://www.oursdreams.top/article/14" >Android网络请求封装<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p></li></ol><h3 id="服务端"><a href="#服务端" class="headerlink" title="服务端"></a>服务端</h3><p>使用PHP，详见<a class="link"   href="http://www.oursdreams.top/article/19" >Laravel自定义简单的SOCKET连接<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>]]></content>
      
      
      
        <tags>
            
            <tag> android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android基础</title>
      <link href="/2025/03/12/%E5%AE%89%E5%8D%93%E6%8E%A7%E4%BB%B6%E8%81%9A%E7%84%A6%E8%A1%8C%E4%B8%BA/"/>
      <url>/2025/03/12/%E5%AE%89%E5%8D%93%E6%8E%A7%E4%BB%B6%E8%81%9A%E7%84%A6%E8%A1%8C%E4%B8%BA/</url>
      
        <content type="html"><![CDATA[<h2 id="安卓控件聚焦行为"><a href="#安卓控件聚焦行为" class="headerlink" title="安卓控件聚焦行为"></a>安卓控件聚焦行为</h2><h3 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h3><p>对一个控件操作后手动控制其前往下一控件的行为</p><p>安卓会在回车时默认向下寻找下一允许聚焦控件来指向(取决于不同API，我需要阻止这个行为)</p><h4 id="尝试方案"><a href="#尝试方案" class="headerlink" title="尝试方案"></a>尝试方案</h4><blockquote><p>在ANDROID的XML构建中我习惯的代入了JS行为</p></blockquote><ul><li><p>利用事件委托与阻止事件传播向下分发</p><blockquote><p>注册事件，起初注册setOnClickListener点击事件与setOnEditorActionListener的EDITTEXT控件操作事件</p><p>在接口实现方法中利用返回值true来阻止事件分发</p><p>发现ANDROID并不会阻止其默认行为</p></blockquote><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">implements</span> <span class="title class_">View</span>.OnClickListener, View.OnKeyListener, TextView.OnEditorActionListener</span><br><span class="line">rendering.barcode.setOnEditorActionListener(<span class="built_in">this</span>);</span><br><span class="line">rendering.number.setOnEditorActionListener(<span class="built_in">this</span>);</span><br><span class="line">rendering.location.setOnEditorActionListener(<span class="built_in">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onKey</span><span class="params">(View v, <span class="type">int</span> keyCode, KeyEvent event)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (keyCode == KeyEvent.KEYCODE_ENTER &amp;&amp; event.getAction()==KeyEvent.ACTION_DOWN)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div></li><li><p>利用子线程延迟跳回</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Thread</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="built_in">super</span>.run();</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">500</span>);</span><br><span class="line">                    activity.runOnUiThread(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                            <span class="comment">//UI聚焦操作</span></span><br><span class="line">                            barcode.requestFocus();</span><br><span class="line">                            barcode.selectAll();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;.start();</span><br></pre></td></tr></table></figure></div><p>延迟感明显，依据渲染顺序的问题必须sleep</p></li></ul><h3 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h3><h4 id="利用ANDROID默认控件属性"><a href="#利用ANDROID默认控件属性" class="headerlink" title="利用ANDROID默认控件属性"></a>利用ANDROID默认控件属性</h4><p>见名知意 nextFocusDown 向下等…..</p><p>通过指定每种指令下的焦点选择控件来契合业务</p><blockquote><div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">android:nextFocusDown=&quot;@+id/xxx&quot;</span><br><span class="line">android:nextFocusForward=&quot;@+id/xxx&quot;</span><br><span class="line">android:nextFocusLeft=&quot;@+id/xxx&quot;</span><br><span class="line">android:nextFocusRight=&quot;@+id/xxx&quot;</span><br><span class="line">android:nextFocusUp=&quot;@+id/xxx&quot;</span><br></pre></td></tr></table></figure></div></blockquote><p>如果仅仅想要控件不做任何操作，则指向id标注为控件本身ID即可</p>]]></content>
      
      
      
        <tags>
            
            <tag> android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>单号码多开微信</title>
      <link href="/2025/03/12/%E6%88%91%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E4%B8%80%E4%B8%AA%E6%89%8B%E6%9C%BA%E5%8F%B7%E6%9D%A5%E7%94%A8%E4%B8%A4%E4%B8%AA%E5%BE%AE%E4%BF%A1/"/>
      <url>/2025/03/12/%E6%88%91%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E4%B8%80%E4%B8%AA%E6%89%8B%E6%9C%BA%E5%8F%B7%E6%9D%A5%E7%94%A8%E4%B8%A4%E4%B8%AA%E5%BE%AE%E4%BF%A1/</url>
      
        <content type="html"><![CDATA[<ul><li><p><strong>过程</strong></p><ul><li>需要另一个人配合，假设两个人为 A，B</li><li>A，B都具有一个微信号，且至少其中一人微信号注册超半年</li><li>A有一个QQ号（没有则使用A手机号注册QQ号）</li><li>A微信号绑定A手机号，AQQ号</li><li>B微信号切换绑定A手机号</li><li>B微信号切换绑定B手机号（A手机号空出）</li><li>A手机号注册新微信</li><li>B微信号辅助验证</li><li>A此时拥有两个微信号，一个绑定QQ号一个绑定手机号(都可以实名同一人使用支付)</li></ul></li><li><p><strong>双开</strong></p><ul><li><p>安卓，客制系统支持应用双开即可</p></li><li><p><em>windows</em>，使用脚本启动即可</p><blockquote><p>新建.bat文件</p><div class="code-container" data-rel="Bat"><figure class="iseeu highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"></span><br><span class="line"><span class="built_in">start</span> /d &quot;D:\WeChat&quot; WeChat.exe</span><br><span class="line"><span class="built_in">start</span> /d &quot;D:\WeChat&quot; WeChat.exe</span><br><span class="line"></span><br><span class="line"><span class="keyword">exit</span></span><br></pre></td></tr></table></figure></div><p>上述 “D:\WeChat” 为自己电脑微信安装路径，不知道的可以</p><ul><li>选中桌面微信图标</li><li>右键选择打开文件所在位置</li><li>复制上方文件路径</li></ul></blockquote></li></ul></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> 日常 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java基础POI的异步导出</title>
      <link href="/2025/03/12/%E5%A4%A7%E6%89%B9%E9%87%8F%E5%BC%82%E6%AD%A5%E5%AF%BC%E5%87%BA%E6%96%B9%E6%A1%88/"/>
      <url>/2025/03/12/%E5%A4%A7%E6%89%B9%E9%87%8F%E5%BC%82%E6%AD%A5%E5%AF%BC%E5%87%BA%E6%96%B9%E6%A1%88/</url>
      
        <content type="html"><![CDATA[<ul><li>简单思路</li></ul><blockquote><p>获取数据总量，分块读取写入，多线程操作(缓存保证一致性)，数据只持留一部分在内存，其余刷进磁盘<br>用户发起导出指令后建立异步任务，前端要么通过全局通知&#x2F;SOCKET等要么随便刷新等来刷任务执行进度<br>文件持久在一个共享目录，OSS或者本地都可<br>清理方案：</p><blockquote><p>持久记录SQL与文件映射,超期清理</p><p>直接暴力定读整体目录超期清理<br>用户下载完文件后直接清理</p></blockquote></blockquote><ul><li>实现</li></ul><h4 id="1-获取导出语句的数据总量"><a href="#1-获取导出语句的数据总量" class="headerlink" title="1. 获取导出语句的数据总量"></a>1. 获取导出语句的数据总量</h4><h5 id="1-1-获取MAPPER的执行SQL"><a href="#1-1-获取MAPPER的执行SQL" class="headerlink" title="1.1 获取MAPPER的执行SQL"></a>1.1 获取MAPPER的执行SQL</h5><p>编写工具包</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xxx.mybatis.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.xxx.eum.CodeEnum;</span><br><span class="line"><span class="keyword">import</span> com.xxx.exception.RunException;</span><br><span class="line"><span class="keyword">import</span> com.xxx.util.DateUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.beanutils.BeanMap;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.mapping.BoundSql;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.mapping.ParameterMapping;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.mapping.ParameterMode;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * SQL额外工具包</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SqlUtils</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * XXX map = new XXX();</span></span><br><span class="line"><span class="comment">     * xxx.setId(1L);</span></span><br><span class="line"><span class="comment">     * execute(XxxMapper.class.getName().concat(&quot;.getXXXmethod&quot;), map, sqlSessionFactory)</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * 获取可执行SQL</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sqlId mapper sql id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> object 参数对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sqlSessionFactory sql session 工厂</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> SQL语句</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">execute</span><span class="params">(String sqlId, Object object, SqlSessionFactory sqlSessionFactory)</span> &#123;</span><br><span class="line">        <span class="type">BoundSql</span> <span class="variable">boundSql</span> <span class="operator">=</span> sqlSessionFactory.getConfiguration().getMappedStatement(sqlId).getBoundSql(object);</span><br><span class="line">        List&lt;ParameterMapping&gt; parameterMappings = boundSql.getParameterMappings();</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> boundSql.getSql();</span><br><span class="line">        Map&lt;?, Object&gt; paramMap = <span class="keyword">new</span> <span class="title class_">BeanMap</span>(object);<span class="comment">// 它是个数组 要拆分处理</span></span><br><span class="line">        List&lt;Object&gt; paramValues = getParamValues(paramMap, parameterMappings, boundSql);</span><br><span class="line">        <span class="type">String</span> <span class="variable">execSql</span> <span class="operator">=</span> getExecuteSql(sql, paramValues);</span><br><span class="line">        <span class="keyword">return</span> execSql.replace(<span class="string">&quot;\n&quot;</span>,<span class="string">&quot;&quot;</span>).replaceAll(<span class="string">&quot;[ ]+&quot;</span>,<span class="string">&quot; &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置查询参数值，返回可直接执行的sql</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sql SQL语句</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> paramValues 参数列表</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> SQL语句</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">getExecuteSql</span><span class="params">(String sql, List&lt;Object&gt; paramValues)</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (sql.contains(<span class="string">&quot;?&quot;</span>) &amp;&amp; paramValues != <span class="literal">null</span> &amp;&amp; paramValues.size() &gt; <span class="number">0</span> &amp;&amp; paramValues.get(<span class="number">0</span>) != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">Object</span> <span class="variable">paramValue</span> <span class="operator">=</span> paramValues.get(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">if</span> (paramValue != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> paramValue.toString();</span><br><span class="line">                <span class="keyword">if</span> (paramValue <span class="keyword">instanceof</span> String) &#123;</span><br><span class="line">                    value = <span class="string">&quot;&#x27;&quot;</span> + paramValue + <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (paramValue <span class="keyword">instanceof</span> Date) &#123;</span><br><span class="line">                    value = DateUtils.parseDateToStr(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>, (Date) paramValue);</span><br><span class="line">                    value = <span class="string">&quot;str_to_date(&#x27;&quot;</span> + value + <span class="string">&quot;&#x27;,&#x27;%Y-%m-%d %T&#x27;)&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                sql = sql.replaceFirst(<span class="string">&quot;\\?&quot;</span>, value);</span><br><span class="line">                paramValues.remove(<span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sql;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据动态查询条件获取查询参数值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Object&gt; <span class="title function_">getParamValues</span><span class="params">(Map&lt;?, Object&gt; paramMap,</span></span><br><span class="line"><span class="params">                                               List&lt;ParameterMapping&gt; parameterMappings, BoundSql boundSql)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (parameterMappings == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;Object&gt; paramValues = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (ParameterMapping pm : parameterMappings) &#123;</span><br><span class="line">            <span class="keyword">if</span> (pm.getMode() != ParameterMode.OUT) &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">paramName</span> <span class="operator">=</span> pm.getProperty();</span><br><span class="line">                <span class="type">Object</span> <span class="variable">paramValue</span> <span class="operator">=</span> getVal(paramMap, paramName);</span><br><span class="line">                <span class="keyword">if</span> (paramValue == <span class="literal">null</span>) &#123;</span><br><span class="line">                    <span class="comment">// 如果正常的递归数据集中找不到映射参数 就去Bound的额外生成参数中寻找映射</span></span><br><span class="line">                    paramValue = boundSql.getAdditionalParameter(paramName);</span><br><span class="line">                &#125;</span><br><span class="line">                paramValues.add(paramValue);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> paramValues;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Object <span class="title function_">getVal</span><span class="params">(Map&lt;?, Object&gt; paramMap, String paramName)</span>&#123;</span><br><span class="line">        String[] strArr = paramName.split(<span class="string">&quot;\\.&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> getVal(paramMap, strArr, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Object <span class="title function_">getVal</span><span class="params">(Map&lt;?, Object&gt; paramMap, String[] paramName, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> paramName[index];</span><br><span class="line">        <span class="keyword">if</span> (index == paramName.length-<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="string">&quot;]&quot;</span>.equals(key.substring(key.length()-<span class="number">1</span>))) &#123;</span><br><span class="line">                String[] arr = key.substring(<span class="number">0</span>, key.length()-<span class="number">1</span>).split(<span class="string">&quot;\\[&quot;</span>);</span><br><span class="line">                key = arr[<span class="number">0</span>];</span><br><span class="line">                <span class="keyword">return</span> (JSON.parseObject(JSONObject.toJSONString(paramMap.get(key)), List.class)).get(Integer.parseInt(arr[<span class="number">1</span>]));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> paramMap.get(key);</span><br><span class="line">        &#125;</span><br><span class="line">        index++;</span><br><span class="line">        paramMap = JSON.parseObject(JSONObject.toJSONString(paramMap.get(key)), Map.class);</span><br><span class="line">        <span class="keyword">return</span> getVal(paramMap, paramName, index);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">getCount</span><span class="params">(String sql, SqlSessionFactory sqlSessionFactory)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">idx</span> <span class="operator">=</span> sql.indexOf(<span class="string">&quot; FROM&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (idx == -<span class="number">1</span>)&#123;</span><br><span class="line">            idx = sql.indexOf(<span class="string">&quot; from&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        sql = <span class="string">&quot;SELECT COUNT(1)&quot;</span>.concat(sql.substring(idx));</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> sqlSessionFactory.openSession().getConnection();</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br><span class="line">            <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> statement.executeQuery(sql);</span><br><span class="line">            rs.next();</span><br><span class="line">            <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;COUNT(1)&quot;</span>);</span><br><span class="line">            connection.close();</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RunExceptionCodeEnum</span>.SERVER_ERROR.getCode(), <span class="string">&quot;获取数据总量失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h5 id="1-2-获取SQL与数据总量"><a href="#1-2-获取SQL与数据总量" class="headerlink" title="1.2 获取SQL与数据总量"></a>1.2 获取SQL与数据总量</h5><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// XxxMapper为你的实际MAPPER接口</span></span><br><span class="line"><span class="comment">// method为MAPPER内对应方法</span></span><br><span class="line"><span class="comment">// body为传入执行方法的SQL参数,因为要借助BeanMap来转换映射所以此处的body只能为一个实体对象CLASS而非一个数据结构/类型(MAP,LIST)</span></span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> SqlUtils.execute(XxxMapper.class.getName().concat(<span class="string">&quot;.method&quot;</span>), body, sqlSessionFactory);</span><br><span class="line"><span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> SqlUtils.getCount(sql, sqlSessionFactory);</span><br></pre></td></tr></table></figure></div><h4 id="2-建立导出工具包"><a href="#2-建立导出工具包" class="headerlink" title="2. 建立导出工具包"></a>2. 建立导出工具包</h4><p>还是依赖于poi包，引入其依赖使用高版本的SXSSF即可</p><div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-ooxml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></div><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xxx.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.xxx.annotation.Excel;</span><br><span class="line"><span class="keyword">import</span> com.xxx.annotation.Excels;</span><br><span class="line"><span class="keyword">import</span> com.xxx.constant.SysConfigurationConsts;</span><br><span class="line"><span class="keyword">import</span> com.xxx.eum.CodeEnum;</span><br><span class="line"><span class="keyword">import</span> com.xxx.exception.RunException;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFFont;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.hssf.util.HSSFColor;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellRangeAddressList;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.streaming.SXSSFSheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.streaming.SXSSFWorkbook;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFDataValidation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.math.BigDecimal;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 导出工具包</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExcelExportUtil</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 实体对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Class&lt;T&gt; clazz;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注解列表</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Field&gt; fields;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 文件对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> SXSSFWorkbook book;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 文件名</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String fileName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String filePath;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ExcelExportUtil</span><span class="params">(Class&lt;T&gt; clazz, String dir, String moduleName)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.clazz = clazz;</span><br><span class="line">        <span class="built_in">this</span>.buildExcelField();</span><br><span class="line">        <span class="built_in">this</span>.buildWorkBook();</span><br><span class="line">        <span class="built_in">this</span>.fileName = encodingFilename(moduleName);</span><br><span class="line">        <span class="built_in">this</span>.filePath = getAbsoluteFile(dir, fileName);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 编码文件名</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">encodingFilename</span><span class="params">(String filename)</span> &#123;</span><br><span class="line">        filename = filename + <span class="string">&quot;-&quot;</span> + DateUtils.dateTimeNow() + <span class="string">&quot;.xlsx&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> filename;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 返回预期文件名</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 文件名</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getFileName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> fileName;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取下载路径</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> filename 文件名称</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getAbsoluteFile</span><span class="params">(String filePath, String filename)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">downloadPath</span> <span class="operator">=</span> filePath + filename;</span><br><span class="line">        <span class="type">File</span> <span class="variable">desc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(downloadPath);</span><br><span class="line">        <span class="keyword">if</span> (!desc.getParentFile().exists()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!desc.getParentFile().mkdirs()) &#123;</span><br><span class="line">                log.error(<span class="string">&quot;建立存储Excel目录失败&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> downloadPath;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">buildWorkBook</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.book = <span class="keyword">new</span> <span class="title class_">SXSSFWorkbook</span>(<span class="number">500</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> SXSSFSheet <span class="title function_">buildSheet</span><span class="params">(<span class="type">int</span> start)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> book.createSheet(((start * SysConfigurationConsts.MAX_EXPORT_COUNT)+<span class="number">1</span>)+<span class="string">&quot;-&quot;</span>+((start+<span class="number">1</span>)* SysConfigurationConsts.MAX_EXPORT_COUNT));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">make</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">out</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            out = <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(filePath);</span><br><span class="line">            book.write(out);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;EXCEL文件生成失败:&#123;&#125;&quot;</span>,e.getMessage());</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RunException</span>(CodeEnum.FAIL.getCode(), <span class="string">&quot;EXCEL文件生成失败&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (book != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    book.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e1) &#123;</span><br><span class="line">                    log.error(<span class="string">&quot;EXCEL对象资源关闭失败:&#123;&#125;&quot;</span>,fileName);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (out != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    out.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e1) &#123;</span><br><span class="line">                    log.error(<span class="string">&quot;EXCEL文件资源关闭失败:&#123;&#125;&quot;</span>,fileName);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> fileName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">build</span><span class="params">(List&lt;T&gt; list, SXSSFSheet sheet)</span> &#123;</span><br><span class="line">        <span class="comment">// 标题行</span></span><br><span class="line">        <span class="type">Row</span> <span class="variable">row</span> <span class="operator">=</span> sheet.createRow(<span class="number">0</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">excelsNo</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// 写入各个字段的列头名称</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">column</span> <span class="operator">=</span> <span class="number">0</span>; column &lt; fields.size(); column++) &#123;</span><br><span class="line">            <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> fields.get(column);</span><br><span class="line">            <span class="keyword">if</span> (field.isAnnotationPresent(Excel.class)) &#123;</span><br><span class="line">                <span class="type">Excel</span> <span class="variable">excel</span> <span class="operator">=</span> field.getAnnotation(Excel.class);</span><br><span class="line">                createCell(sheet, excel, row, column);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (field.isAnnotationPresent(Excels.class)) &#123;</span><br><span class="line">                <span class="type">Excels</span> <span class="variable">attrs</span> <span class="operator">=</span> field.getAnnotation(Excels.class);</span><br><span class="line">                Excel[] excels = attrs.value();</span><br><span class="line">                <span class="comment">// 写入列名</span></span><br><span class="line">                <span class="type">Excel</span> <span class="variable">excel</span> <span class="operator">=</span> excels[excelsNo++];</span><br><span class="line">                createCell(sheet, excel, row, column);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">CellStyle</span> <span class="variable">cs</span> <span class="operator">=</span> book.createCellStyle();</span><br><span class="line">        cs.setAlignment(HorizontalAlignment.CENTER);</span><br><span class="line">        cs.setVerticalAlignment(VerticalAlignment.CENTER);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; list.size(); i++) &#123;</span><br><span class="line">            excelsNo = <span class="number">0</span>;</span><br><span class="line">            row = sheet.createRow(i + <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">column</span> <span class="operator">=</span> <span class="number">0</span>; column &lt; fields.size(); column++) &#123;</span><br><span class="line">                <span class="comment">// 获得field.</span></span><br><span class="line">                <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> fields.get(column);</span><br><span class="line">                <span class="comment">// 设置实体类私有属性可访问</span></span><br><span class="line">                field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">                <span class="keyword">if</span> (field.isAnnotationPresent(Excel.class)) &#123;</span><br><span class="line">                    addCell(field.getAnnotation(Excel.class), row, list.get(i), field, column, cs);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (field.isAnnotationPresent(Excels.class)) &#123;</span><br><span class="line">                    <span class="type">Excels</span> <span class="variable">attrs</span> <span class="operator">=</span> field.getAnnotation(Excels.class);</span><br><span class="line">                    Excel[] excels = attrs.value();</span><br><span class="line">                    <span class="type">Excel</span> <span class="variable">excel</span> <span class="operator">=</span> excels[excelsNo++];</span><br><span class="line">                    addCell(excel, row, list.get(i), field, column, cs);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">buildExcelField</span><span class="params">()</span> &#123;</span><br><span class="line">        ArrayList&lt;Field&gt; fields = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        List&lt;Field&gt; tempFields = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        tempFields.addAll(Arrays.asList(clazz.getSuperclass().getDeclaredFields()));</span><br><span class="line">        tempFields.addAll(Arrays.asList(clazz.getDeclaredFields()));</span><br><span class="line">        <span class="keyword">for</span> (Field field : tempFields) &#123;</span><br><span class="line">            <span class="comment">// 单注解</span></span><br><span class="line">            <span class="keyword">if</span> (field.isAnnotationPresent(Excel.class)) &#123;</span><br><span class="line">                <span class="type">Excel</span> <span class="variable">attr</span> <span class="operator">=</span> field.getAnnotation(Excel.class);</span><br><span class="line">                <span class="keyword">if</span> (attr != <span class="literal">null</span> &amp;&amp; (attr.type() == Excel.Type.ALL || attr.type() == Excel.Type.EXPORT)) &#123;</span><br><span class="line">                    fields.add(field);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 多注解</span></span><br><span class="line">            <span class="keyword">if</span> (field.isAnnotationPresent(Excels.class)) &#123;</span><br><span class="line">                <span class="type">Excels</span> <span class="variable">attrs</span> <span class="operator">=</span> field.getAnnotation(Excels.class);</span><br><span class="line">                Excel[] excels = attrs.value();</span><br><span class="line">                <span class="keyword">for</span> (Excel excel : excels) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (excel != <span class="literal">null</span> &amp;&amp; (excel.type() == Excel.Type.ALL || excel.type() == Excel.Type.EXPORT)) &#123;</span><br><span class="line">                        fields.add(field);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">this</span>.fields = fields;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加单元格</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addCell</span><span class="params">(Excel attr, Row row, T vo, Field field, <span class="type">int</span> column, CellStyle cs)</span> &#123;</span><br><span class="line">        Cell cell;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 设置行高</span></span><br><span class="line">            row.setHeight((<span class="type">short</span>) (attr.height() * <span class="number">20</span>));</span><br><span class="line">            <span class="comment">// 根据Excel中设置情况决定是否导出,有些情况需要保持为空,希望用户填写这一列.</span></span><br><span class="line">            <span class="keyword">if</span> (attr.isExport()) &#123;</span><br><span class="line">                <span class="comment">// 创建cell</span></span><br><span class="line">                cell = row.createCell(column);</span><br><span class="line">                cell.setCellStyle(cs);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 用于读取对象中的属性</span></span><br><span class="line">                <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> getTargetValue(vo, field, attr);</span><br><span class="line">                <span class="type">String</span> <span class="variable">dateFormat</span> <span class="operator">=</span> attr.dateFormat();</span><br><span class="line">                <span class="type">String</span> <span class="variable">readConverterExp</span> <span class="operator">=</span> attr.readConverterExp();</span><br><span class="line">                <span class="type">boolean</span> <span class="variable">isDecimalFormat</span> <span class="operator">=</span> attr.isDecimalFormat();</span><br><span class="line">                <span class="keyword">if</span> (StringUtils.isNotEmpty(dateFormat) &amp;&amp; value != <span class="literal">null</span>) &#123;</span><br><span class="line">                    cell.setCellValue(DateUtils.parseDateToStr(dateFormat, (Date) value));</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (StringUtils.isNotEmpty(readConverterExp) &amp;&amp; value != <span class="literal">null</span>) &#123;</span><br><span class="line">                    cell.setCellValue(convertByExp(String.valueOf(value), readConverterExp));</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isDecimalFormat) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (value == <span class="literal">null</span>) &#123;</span><br><span class="line">                        cell.setCellValue(<span class="number">0</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        cell.setCellValue((<span class="keyword">new</span> <span class="title class_">BigDecimal</span>(value.toString())).stripTrailingZeros().toPlainString());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    cell.setCellType(CellType.STRING);</span><br><span class="line">                    <span class="comment">// 如果数据存在就填入,不存在填入空格.</span></span><br><span class="line">                    cell.setCellValue(value == <span class="literal">null</span> ? attr.defaultValue() : value + attr.suffix());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;导出Excel失败&#123;&#125;&quot;</span>, e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取bean中的属性值</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> vo    实体对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> field 字段</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> excel 注解</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 最终的属性值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Object <span class="title function_">getTargetValue</span><span class="params">(T vo, Field field, Excel excel)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> field.get(vo);</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotEmpty(excel.targetAttr())) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">target</span> <span class="operator">=</span> excel.targetAttr();</span><br><span class="line">            <span class="keyword">if</span> (target.contains(<span class="string">&quot;.&quot;</span>)) &#123;</span><br><span class="line">                String[] targets = target.split(<span class="string">&quot;[.]&quot;</span>);</span><br><span class="line">                <span class="keyword">for</span> (String name : targets) &#123;</span><br><span class="line">                    o = getValue(o, name);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                o = getValue(o, target);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> o;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 解析导出值 0=男,1=女,2=未知</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> propertyValue 参数值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> converterExp  翻译注解</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 解析后值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">convertByExp</span><span class="params">(String propertyValue, String converterExp)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String[] convertSource = converterExp.split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (String item : convertSource) &#123;</span><br><span class="line">                String[] itemArray = item.split(<span class="string">&quot;=&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span> (itemArray[<span class="number">0</span>].equals(propertyValue)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> itemArray[<span class="number">1</span>];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> e;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> propertyValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 以类的属性的get方法方法形式获取值</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> o 属性对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name 属性名</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> value 值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Object <span class="title function_">getValue</span><span class="params">(Object o, String name)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotEmpty(name)) &#123;</span><br><span class="line">            Class&lt;?&gt; clazz = o.getClass();</span><br><span class="line">            <span class="type">String</span> <span class="variable">methodName</span> <span class="operator">=</span> <span class="string">&quot;get&quot;</span> + name.substring(<span class="number">0</span>, <span class="number">1</span>).toUpperCase() + name.substring(<span class="number">1</span>);</span><br><span class="line">            <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> clazz.getMethod(methodName);</span><br><span class="line">            o = method.invoke(o);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> o;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建单元格</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">createCell</span><span class="params">(Sheet sheet, Excel attr, Row row, <span class="type">int</span> column)</span> &#123;</span><br><span class="line">        <span class="comment">// 创建列</span></span><br><span class="line">        <span class="type">Cell</span> <span class="variable">cell</span> <span class="operator">=</span> row.createCell(column);</span><br><span class="line">        <span class="comment">// 设置列中写入内容为String类型</span></span><br><span class="line">        cell.setCellType(CellType.STRING);</span><br><span class="line">        <span class="comment">// 写入列名</span></span><br><span class="line">        cell.setCellValue(attr.name());</span><br><span class="line">        <span class="type">CellStyle</span> <span class="variable">cellStyle</span> <span class="operator">=</span> createStyle(sheet, attr, row, column);</span><br><span class="line">        cell.setCellStyle(cellStyle);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建表格样式</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> CellStyle <span class="title function_">createStyle</span><span class="params">(Sheet sheet, Excel attr, Row row, <span class="type">int</span> column)</span> &#123;</span><br><span class="line">        <span class="type">CellStyle</span> <span class="variable">cellStyle</span> <span class="operator">=</span> book.createCellStyle();</span><br><span class="line">        cellStyle.setAlignment(HorizontalAlignment.CENTER);</span><br><span class="line">        cellStyle.setVerticalAlignment(VerticalAlignment.CENTER);</span><br><span class="line">        <span class="type">Font</span> <span class="variable">font</span> <span class="operator">=</span> book.createFont();</span><br><span class="line">        <span class="keyword">if</span> (attr.name().contains(<span class="string">&quot;注：&quot;</span>)) &#123;</span><br><span class="line">            font.setColor(HSSFFont.COLOR_RED);</span><br><span class="line">            cellStyle.setFont(font);</span><br><span class="line">            cellStyle.setFillForegroundColor(HSSFColor.HSSFColorPredefined.YELLOW.getIndex());</span><br><span class="line">            sheet.setColumnWidth(column, <span class="number">6000</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 粗体显示</span></span><br><span class="line">            font.setBold(<span class="literal">true</span>);</span><br><span class="line">            <span class="comment">// 选择需要用到的字体格式</span></span><br><span class="line">            cellStyle.setFont(font);</span><br><span class="line">            cellStyle.setFillForegroundColor(HSSFColor.HSSFColorPredefined.LIGHT_YELLOW.getIndex());</span><br><span class="line">            <span class="comment">// 设置列宽</span></span><br><span class="line">            sheet.setColumnWidth(column, (<span class="type">int</span>) ((attr.width() + <span class="number">0.72</span>) * <span class="number">256</span>));</span><br><span class="line">            row.setHeight((<span class="type">short</span>) (attr.height() * <span class="number">20</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        cellStyle.setFillPattern(FillPatternType.SOLID_FOREGROUND);</span><br><span class="line">        cellStyle.setWrapText(<span class="literal">true</span>);</span><br><span class="line">        <span class="comment">// 如果设置了提示信息则鼠标放上去提示.</span></span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotEmpty(attr.prompt())) &#123;</span><br><span class="line">            <span class="comment">// 这里默认设了2-101列提示.</span></span><br><span class="line">            setXSSFPrompt(sheet, <span class="string">&quot;&quot;</span>, attr.prompt(), <span class="number">1</span>, <span class="number">100</span>, column, column);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 如果设置了combo属性则本列只能选择不能输入</span></span><br><span class="line">        <span class="keyword">if</span> (attr.combo().length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// 这里默认设了2-101列只能选择不能输入.</span></span><br><span class="line">            setXSSFValidation(sheet, attr.combo(), <span class="number">1</span>, <span class="number">100</span>, column, column);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cellStyle;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置 POI XSSFSheet 单元格提示</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sheet         表单</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> promptTitle   提示标题</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> promptContent 提示内容</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> firstRow      开始行</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> endRow        结束行</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> firstCol      开始列</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> endCol        结束列</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setXSSFPrompt</span><span class="params">(Sheet sheet, String promptTitle, String promptContent, <span class="type">int</span> firstRow, <span class="type">int</span> endRow,</span></span><br><span class="line"><span class="params">                              <span class="type">int</span> firstCol, <span class="type">int</span> endCol)</span> &#123;</span><br><span class="line">        <span class="type">DataValidationHelper</span> <span class="variable">helper</span> <span class="operator">=</span> sheet.getDataValidationHelper();</span><br><span class="line">        <span class="type">DataValidationConstraint</span> <span class="variable">constraint</span> <span class="operator">=</span> helper.createCustomConstraint(<span class="string">&quot;DD1&quot;</span>);</span><br><span class="line">        <span class="type">CellRangeAddressList</span> <span class="variable">regions</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CellRangeAddressList</span>(firstRow, endRow, firstCol, endCol);</span><br><span class="line">        <span class="type">DataValidation</span> <span class="variable">dataValidation</span> <span class="operator">=</span> helper.createValidation(constraint, regions);</span><br><span class="line">        dataValidation.createPromptBox(promptTitle, promptContent);</span><br><span class="line">        dataValidation.setShowPromptBox(<span class="literal">true</span>);</span><br><span class="line">        sheet.addValidationData(dataValidation);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置某些列的值只能输入预制的数据,显示下拉框.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sheet    要设置的sheet.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> textlist 下拉框显示的内容</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> firstRow 开始行</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> endRow   结束行</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> firstCol 开始列</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> endCol   结束列</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 设置好的sheet.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setXSSFValidation</span><span class="params">(Sheet sheet, String[] textlist, <span class="type">int</span> firstRow, <span class="type">int</span> endRow, <span class="type">int</span> firstCol, <span class="type">int</span> endCol)</span> &#123;</span><br><span class="line">        <span class="type">DataValidationHelper</span> <span class="variable">helper</span> <span class="operator">=</span> sheet.getDataValidationHelper();</span><br><span class="line">        <span class="comment">// 加载下拉列表内容</span></span><br><span class="line">        <span class="type">DataValidationConstraint</span> <span class="variable">constraint</span> <span class="operator">=</span> helper.createExplicitListConstraint(textlist);</span><br><span class="line">        <span class="comment">// 设置数据有效性加载在哪个单元格上,四个参数分别是：起始行、终止行、起始列、终止列</span></span><br><span class="line">        <span class="type">CellRangeAddressList</span> <span class="variable">regions</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CellRangeAddressList</span>(firstRow, endRow, firstCol, endCol);</span><br><span class="line">        <span class="comment">// 数据有效性对象</span></span><br><span class="line">        <span class="type">DataValidation</span> <span class="variable">dataValidation</span> <span class="operator">=</span> helper.createValidation(constraint, regions);</span><br><span class="line">        <span class="comment">// 处理Excel兼容性问题</span></span><br><span class="line">        <span class="keyword">if</span> (dataValidation <span class="keyword">instanceof</span> XSSFDataValidation) &#123;</span><br><span class="line">            dataValidation.setSuppressDropDownArrow(<span class="literal">true</span>);</span><br><span class="line">            dataValidation.setShowErrorBox(<span class="literal">true</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            dataValidation.setSuppressDropDownArrow(<span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        sheet.addValidationData(dataValidation);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><blockquote><p>相关的自定义小注解与工具类就不贴出了，都是最简单实现，网上一大片</p></blockquote><h4 id="3-建立任务缓存监听器"><a href="#3-建立任务缓存监听器" class="headerlink" title="3. 建立任务缓存监听器"></a>3. 建立任务缓存监听器</h4><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xxx.redis.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.xxx.redis.service.RedisService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Excel相关的任务缓存工具类</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExcelTaskUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">long</span> <span class="variable">EXPIRE</span> <span class="operator">=</span> <span class="number">86500</span>;<span class="comment">// 过期时间</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * REDIS缓存KEY值</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id 用户ID</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> KEY值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span> String <span class="title function_">USER_EXPORT_TASK</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;user:export:task:&quot;</span>.concat(String.valueOf(id));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加一个文件缓存任务</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> redisService 缓存服务</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fileName 文件名</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id 用户ID</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> countGroup 最大执行总量组</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">addExportFile</span><span class="params">(RedisService redisService, String fileName, Long id, <span class="type">int</span> countGroup)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> USER_EXPORT_TASK(id);</span><br><span class="line">        <span class="keyword">if</span> (!redisService.hasKey(key)) &#123;</span><br><span class="line">            redisService.hSetAll(key, <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">16</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 文件一天过期，缓存信息一天过期 不过期也会被系统清理</span></span><br><span class="line">        redisService.hSet(key, fileName, <span class="string">&quot;0/&quot;</span>.concat(String.valueOf(countGroup)), EXPIRE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 执行计划导出文件/片段执行结果</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> redisService 缓存服务</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fileName 文件名</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id 用户ID</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 任务是否全部执行完成</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">scheduleExportFile</span><span class="params">(RedisService redisService, String fileName, Long id)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> USER_EXPORT_TASK(id);</span><br><span class="line">        <span class="type">String</span> <span class="variable">val</span> <span class="operator">=</span> (String)redisService.hGet(key, fileName);</span><br><span class="line">        <span class="keyword">if</span> (val != <span class="literal">null</span>) &#123;</span><br><span class="line">            String[] arr = val.split(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">current</span> <span class="operator">=</span> Integer.parseInt(arr[<span class="number">0</span>])+<span class="number">1</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> Integer.parseInt(arr[<span class="number">1</span>]);</span><br><span class="line">            redisService.hSet(key, fileName, current+<span class="string">&quot;/&quot;</span>+count, EXPIRE);</span><br><span class="line">            <span class="keyword">return</span> current &gt;= count;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取用户下全部导出任务</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> redisService 缓存服务</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id 用户ID</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 任务列表</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;Object, Object&gt; <span class="title function_">getExportTask</span><span class="params">(RedisService redisService, Long id)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> USER_EXPORT_TASK(id);</span><br><span class="line">        <span class="keyword">if</span> (!redisService.hasKey(key)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> redisService.hGetAll(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 验证任务是否存在</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> redisService 缓存服务</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fileName 文件名</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userId 用户ID</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 验证结果</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">verifyTaskExist</span><span class="params">(RedisService redisService, String fileName, Long userId)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> USER_EXPORT_TASK(userId);</span><br><span class="line">        <span class="keyword">return</span> redisService.hasKey(key) &amp;&amp; redisService.hHasKey(key, fileName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">removeCache</span><span class="params">(RedisService redisService, String fileName, Long userId)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> USER_EXPORT_TASK(userId);</span><br><span class="line">        redisService.hDel(key, fileName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h4 id="4-联合两个工具包自定义导出"><a href="#4-联合两个工具包自定义导出" class="headerlink" title="4. 联合两个工具包自定义导出"></a>4. 联合两个工具包自定义导出</h4><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  线程池对象，springframework会存在默认实现，一般以你服务器CPU性能来分配默认参数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> ThreadPoolTaskExecutor poolTaskExecutor;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 导出记录</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> count 数据总量</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> body 请求参数</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">exportRecord</span><span class="params">(<span class="type">int</span> count, BasePageBody body)</span> &#123;</span><br><span class="line">       <span class="type">Long</span> <span class="variable">userId</span> <span class="operator">=</span> AuthContext.getUser().getId();<span class="comment">// 配合GATEWAY分发注入的全局上下文用户信息 存储在ThreadLocal</span></span><br><span class="line">       <span class="type">int</span> <span class="variable">group</span> <span class="operator">=</span> (<span class="type">int</span>)Math.ceil(count/ (<span class="type">double</span>) SysConfigurationConsts.MAX_EXPORT_COUNT);<span class="comment">// 获取分组</span></span><br><span class="line">       ExcelExportUtil&lt;Clazz&gt; exportUtil = <span class="keyword">new</span> <span class="title class_">ExcelExportUtil</span>&lt;&gt;(Clazz.class,</span><br><span class="line">               SysConfigurationConsts.PUBLIC_EXPORT_DIR, <span class="string">&quot;xxx记录&quot;</span>);<span class="comment">// 实体类对象(用以反射取属性),导出文件存储目录(分布式但集中存储,LINUX挂软链，OSS更简单),文件功能名</span></span><br><span class="line">       <span class="comment">// 建立异步任务轨迹</span></span><br><span class="line">       ExcelTaskUtil.addExportFile(redisService, exportUtil.getFileName(), userId, group);</span><br><span class="line">       <span class="comment">// 我一般采用一个公共参数对象，设定一个LIMIT来手动分页，此处不要使用mybatis分页器</span></span><br><span class="line">       body.setLimit(<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, Integer&gt;(<span class="number">2</span>)&#123;&#123;</span><br><span class="line">           put(<span class="string">&quot;start&quot;</span>, <span class="number">0</span>);</span><br><span class="line">           put(<span class="string">&quot;end&quot;</span>, SysConfigurationConsts.MAX_EXPORT_COUNT);</span><br><span class="line">       &#125;&#125;);</span><br><span class="line">       <span class="comment">// 启异步线程，取决业务，此处为非频繁操作，客户端也会限制，所以使用默认全量线程参数</span></span><br><span class="line">       <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; group; i++) &#123;</span><br><span class="line">           <span class="type">int</span> <span class="variable">finalI</span> <span class="operator">=</span> i;</span><br><span class="line">           poolTaskExecutor.execute(() -&gt; &#123;</span><br><span class="line">               <span class="keyword">try</span>&#123;</span><br><span class="line">                   body.getLimit().put(<span class="string">&quot;start&quot;</span>, SysConfigurationConsts.MAX_EXPORT_COUNT * finalI);</span><br><span class="line">                   <span class="comment">// 获取实体数据</span></span><br><span class="line">                   List&lt;Clazz&gt; list = service.xxxmethod(body.getParams(), body.getLimit());</span><br><span class="line">                   <span class="comment">// 构建工作页刷进磁盘,此时才去根据循环节点来构建工作页，防止乱序</span></span><br><span class="line">                   exportUtil.build(list, exportUtil.buildSheet(finalI));</span><br><span class="line">               &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                   log.error(<span class="string">&quot;线程池异常：&#123;&#125;&quot;</span>, e.getMessage());</span><br><span class="line">               &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                   <span class="comment">// 无论子线程任务是否完成都要刷文件执行进度，哪怕损坏文件也不要将任务挂起</span></span><br><span class="line">                   <span class="keyword">if</span> (ExcelTaskUtil.scheduleExportFile(redisService, exportUtil.getFileName(), userId)) &#123;</span><br><span class="line">                       <span class="comment">// 留任务结束后的自定义操作空间 不必切片切入所以手动make文件</span></span><br><span class="line">                       exportUtil.make();</span><br><span class="line">                   &#125;</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></div><h4 id="5-查询与下载"><a href="#5-查询与下载" class="headerlink" title="5. 查询与下载"></a>5. 查询与下载</h4><blockquote><p>挂全局公共接口即可，类全局通知</p></blockquote><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;查询所有待办任务&quot;)</span></span><br><span class="line"><span class="meta">@GetMapping(value = &quot;task&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResultsVO&lt;Map&lt;String, String&gt;&gt; <span class="title function_">task</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> ResultsVO.success(ExcelTaskUtil.getExportTask(redisService, AuthContext.getUser().getId()));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ApiOperation(&quot;下载文件&quot;)</span></span><br><span class="line"><span class="meta">@GetMapping(value = &quot;download&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">download</span><span class="params">(<span class="meta">@RequestParam(&quot;fileName&quot;)</span> String filename, HttpServletRequest request, HttpServletResponse response)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!ExcelTaskUtil.verifyTaskExist(redisService, filename, AuthContext.getUser().getId())) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RunException</span>(CodeEnum.SERVER_ERROR.getCode(), <span class="string">&quot;任务已过期&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">String</span> <span class="variable">filePath</span> <span class="operator">=</span> SysConfigurationConsts.PUBLIC_EXPORT_DIR + filename;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">new</span> <span class="title class_">File</span>(filePath).exists()) &#123;</span><br><span class="line">        ExcelTaskUtil.removeCache(redisService, filename, AuthContext.getUser().getId());</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RunException</span>(CodeEnum.SERVER_ERROR.getCode(), <span class="string">&quot;文件已被清理&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        response.setHeader(<span class="string">&quot;requestType&quot;</span>,<span class="string">&quot;file&quot;</span>);</span><br><span class="line">        response.setHeader(<span class="string">&quot;Access-Control-Expose-Headers&quot;</span>,<span class="string">&quot;requestType&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">filePrefixName</span> <span class="operator">=</span> FileUtils.getFilePrefixName(filename);</span><br><span class="line">        ExcelUtil.compatibleFileName(request, response, filePrefixName);</span><br><span class="line">        FileUtils.writeBytes(filePath, response.getOutputStream());</span><br><span class="line">        <span class="comment">//FileUtils.deleteFile(filePath);</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RunException</span>(CodeEnum.SERVER_ERROR.getCode(), e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h4 id="6-清理策略"><a href="#6-清理策略" class="headerlink" title="6. 清理策略"></a>6. 清理策略</h4><blockquote><p>考虑到业务量并不大，简单的每天定时清理即可</p><p>此方式应只做为补偿逻辑的一种而非主清理策略</p></blockquote><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">long</span> <span class="variable">ONE_DAY</span> <span class="operator">=</span> <span class="number">86400000L</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 清理失效的EXCEL文件,异步建立的EXCEL导出任务文件如果由于其余某种原因未被清理</span></span><br><span class="line"><span class="comment"> * 则此处会每天清理一遍建立时间超过一天的EXCEL文件</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Scheduled(cron = &quot;0 0 0 ? * *&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">cleanUpTheFailureExcelFile</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">File</span> <span class="variable">f</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(SysConfigurationConsts.PUBLIC_EXPORT_DIR);</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        BasicFileAttributes attr;</span><br><span class="line">        <span class="keyword">for</span> (File file : Objects.requireNonNull(f.listFiles())) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="string">&quot;.xlsx&quot;</span>.equals(file.getName().substring(file.getName().length()-<span class="number">5</span>)))&#123;</span><br><span class="line">                attr = Files.readAttributes(Paths.get(file.getPath()), BasicFileAttributes.class);</span><br><span class="line">                <span class="type">Instant</span> <span class="variable">instant</span> <span class="operator">=</span> attr.creationTime().toInstant();</span><br><span class="line">                <span class="keyword">if</span> ((System.currentTimeMillis())- DateUtils.from(instant).getTime() &gt; ONE_DAY) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (file.delete()) &#123;</span><br><span class="line">                        log.info(<span class="string">&quot;失效文件清理：&quot;</span>.concat(file.getName()));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">        log.info(<span class="string">&quot;失效文件清理失败：&#123;&#125;&quot;</span>, e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h1 id="2-0版本-与MybatisPlus结合的封装门面"><a href="#2-0版本-与MybatisPlus结合的封装门面" class="headerlink" title="2.0版本 - 与MybatisPlus结合的封装门面"></a>2.0版本 - 与MybatisPlus结合的封装门面</h1><blockquote><p>基于MybatisPlus与Apache包的封装，以门面模式简化导出工具使用</p></blockquote><h2 id="概括"><a href="#概括" class="headerlink" title="概括"></a>概括</h2><p>利用MybatisPlus的自动分页参数配置来完成功能</p><p><strong>场景</strong></p><ol><li>普通的 N 条数据单页导出（N最好小于十万）</li><li>数据导出时按数据行进行合并单元格</li><li>大量数据导出，同一个Excel文件分多工作表进行写入</li><li>针对复杂巨型数据的游标与数据加工处理</li></ol><p><strong>全代码</strong></p><p><a class="link"   href="https://github.com/our99dreams/poi-async-example" >GitHub<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p><h2 id="依赖（POM）"><a href="#依赖（POM）" class="headerlink" title="依赖（POM）"></a>依赖（POM）</h2><div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.20<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.73<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-extension<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.data<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-ooxml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></div><h2 id="注解"><a href="#注解" class="headerlink" title="注解"></a>注解</h2><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.spring.annotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.CellType;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 自定义导出Excel数据注解</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> oursdreams</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Target(ElementType.FIELD)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Excel &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 导出到Excel中的名字.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">name</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * BigDecimal 数据格式化</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">isDecimalFormat</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 时间格式</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">dateFormat</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 导出类型（0数字 1字符串）</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    CellType <span class="title function_">cellType</span><span class="params">()</span> <span class="keyword">default</span> CellType.STRING;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 导出时在excel中每个列的高度 单位为字符</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">double</span> <span class="title function_">height</span><span class="params">()</span> <span class="keyword">default</span> <span class="number">14</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 导出时在excel中每个列的宽 单位为字符</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">double</span> <span class="title function_">width</span><span class="params">()</span> <span class="keyword">default</span> <span class="number">16</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 文字后缀,如% 90 变成90%</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">suffix</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 当值为空时,字段的默认值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">defaultValue</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 提示信息</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">prompt</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置只能选择不能输入的列内容.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String[] combo() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 是否导出数据,应对需求:有时我们需要导出一份模板,这是标题需要但内容需要用户手工填写.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">isExport</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 另一个类中的属性名称,支持多级获取,以小数点隔开</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">targetAttr</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 基准列标注，此基准列一般用以单元格合并的规则指定。注：合并仅为合并行，项目场景不对列进行操作</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">datum</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 是否按行合并</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">mergeRow</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 字段类型（0：导出导入；1：仅导出；2：仅导入）</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Type <span class="title function_">type</span><span class="params">()</span> <span class="keyword">default</span> Type.ALL;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">Type</span> &#123;</span><br><span class="line">        <span class="comment">//导出导入</span></span><br><span class="line">        ALL(<span class="number">0</span>),</span><br><span class="line">        <span class="comment">//导出</span></span><br><span class="line">        EXPORT(<span class="number">1</span>),</span><br><span class="line">        <span class="comment">//导入</span></span><br><span class="line">        IMPORT(<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> value;</span><br><span class="line"></span><br><span class="line">        Type(<span class="type">int</span> value) &#123;</span><br><span class="line">            <span class="built_in">this</span>.value = value;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">value</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.spring.annotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Excel注解集</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> steven</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Target(ElementType.FIELD)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Excels &#123;</span><br><span class="line">    Excel[] value();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="导出工具包（核心）"><a href="#导出工具包（核心）" class="headerlink" title="导出工具包（核心）"></a>导出工具包（核心）</h2><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.spring.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.spring.annotation.Excel;</span><br><span class="line"><span class="keyword">import</span> com.spring.annotation.Excels;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFFont;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.hssf.util.HSSFColor;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellRangeAddress;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellRangeAddressList;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.streaming.SXSSFSheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.streaming.SXSSFWorkbook;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFDataValidation;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.StringUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.math.BigDecimal;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 实验多线程导出工具包</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/7/8</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExcelExportUtils</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">MAX_EXPORT_COUNT</span> <span class="operator">=</span> <span class="number">50000</span>;<span class="comment">// 单页最大导出数量</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">PUBLIC_EXPORT_DIR</span> <span class="operator">=</span> <span class="string">&quot;/share/storage/export/&quot;</span>;<span class="comment">// 默认的导出的目录</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 实体对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Class&lt;T&gt; clazz;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注解列表</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Field&gt; fields;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 文件对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> SXSSFWorkbook book;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 文件名</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String fileName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String filePath;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ExcelExportUtils</span><span class="params">(Class&lt;T&gt; clazz, String dir, String moduleName)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>(dir, moduleName);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">this</span>.clazz = clazz;</span><br><span class="line">        <span class="built_in">this</span>.buildExcelField();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ExcelExportUtils</span><span class="params">(String dir, String moduleName)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.buildWorkBook();</span><br><span class="line">        <span class="built_in">this</span>.fileName = encodingFilename(moduleName);</span><br><span class="line">        <span class="built_in">this</span>.filePath = getAbsoluteFile(dir, fileName);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 编码文件名</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">encodingFilename</span><span class="params">(String filename)</span> &#123;</span><br><span class="line">        filename = filename + <span class="string">&quot;-&quot;</span> + System.currentTimeMillis() + <span class="string">&quot;.xlsx&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> filename;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 返回预期文件名</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 文件名</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getFileName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> fileName;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取下载路径</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> filename 文件名称</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getAbsoluteFile</span><span class="params">(String filePath, String filename)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">downloadPath</span> <span class="operator">=</span> filePath + filename;</span><br><span class="line">        <span class="type">File</span> <span class="variable">desc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(downloadPath);</span><br><span class="line">        <span class="keyword">if</span> (!desc.getParentFile().exists()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!desc.getParentFile().mkdirs()) &#123;</span><br><span class="line">                log.error(<span class="string">&quot;建立存储Excel目录失败&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> downloadPath;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">buildWorkBook</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.book = <span class="keyword">new</span> <span class="title class_">SXSSFWorkbook</span>(MAX_EXPORT_COUNT);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> SXSSFSheet <span class="title function_">buildSheet</span><span class="params">(<span class="type">int</span> start)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> book.createSheet(((start * MAX_EXPORT_COUNT)+<span class="number">1</span>)+<span class="string">&quot;-&quot;</span>+((start+<span class="number">1</span>)* MAX_EXPORT_COUNT));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> SXSSFSheet <span class="title function_">buildSheet</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> book.createSheet(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">make</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">out</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            out = <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(filePath);</span><br><span class="line">            book.write(out);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;EXCEL文件生成失败:&#123;&#125;&quot;</span>,e.getMessage());</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;EXCEL文件生成失败&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (book != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    book.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e1) &#123;</span><br><span class="line">                    log.error(<span class="string">&quot;EXCEL对象资源关闭失败:&#123;&#125;&quot;</span>,fileName);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (out != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    out.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e1) &#123;</span><br><span class="line">                    log.error(<span class="string">&quot;EXCEL文件资源关闭失败:&#123;&#125;&quot;</span>,fileName);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> fileName;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">build</span><span class="params">(List&lt;T&gt; list, SXSSFSheet sheet)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.build(list, sheet, fields);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">build</span><span class="params">(List&lt;T&gt; list, SXSSFSheet sheet, List&lt;Field&gt; fields)</span> &#123;</span><br><span class="line">        <span class="type">Write</span> <span class="variable">write</span> <span class="operator">=</span> <span class="built_in">this</span>.build(sheet, fields);</span><br><span class="line">        write.append(list);</span><br><span class="line">        write.close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> Write <span class="title function_">build</span><span class="params">(SXSSFSheet sheet, List&lt;Field&gt; fields)</span> &#123;</span><br><span class="line">        <span class="comment">// 标题行</span></span><br><span class="line">        <span class="type">Row</span> <span class="variable">row</span> <span class="operator">=</span> sheet.createRow(<span class="number">0</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">excelsNo</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// 写入各个字段的列头名称</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">column</span> <span class="operator">=</span> <span class="number">0</span>; column &lt; fields.size(); column++) &#123;</span><br><span class="line">            <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> fields.get(column);</span><br><span class="line">            <span class="keyword">if</span> (field.isAnnotationPresent(Excel.class)) &#123;</span><br><span class="line">                <span class="type">Excel</span> <span class="variable">excel</span> <span class="operator">=</span> field.getAnnotation(Excel.class);</span><br><span class="line">                createCell(sheet, excel, row, column);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (field.isAnnotationPresent(Excels.class)) &#123;</span><br><span class="line">                <span class="type">Excels</span> <span class="variable">attrs</span> <span class="operator">=</span> field.getAnnotation(Excels.class);</span><br><span class="line">                Excel[] excels = attrs.value();</span><br><span class="line">                <span class="comment">// 写入列名</span></span><br><span class="line">                <span class="type">Excel</span> <span class="variable">excel</span> <span class="operator">=</span> excels[excelsNo++];</span><br><span class="line">                createCell(sheet, excel, row, column);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">CellStyle</span> <span class="variable">cs</span> <span class="operator">=</span> book.createCellStyle();</span><br><span class="line">        cs.setAlignment(HorizontalAlignment.CENTER);</span><br><span class="line">        cs.setVerticalAlignment(VerticalAlignment.CENTER);</span><br><span class="line">        Excel[] excels = <span class="keyword">new</span> <span class="title class_">Excel</span>[fields.size()];</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">datum</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        List&lt;Integer&gt; mergeColumn = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">column</span> <span class="operator">=</span> <span class="number">0</span>; column &lt; fields.size(); column++) &#123;</span><br><span class="line">            <span class="comment">// 获得field.</span></span><br><span class="line">            <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> fields.get(column);</span><br><span class="line">            <span class="comment">// 设置实体类私有属性可访问</span></span><br><span class="line">            field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">            <span class="keyword">if</span> (field.isAnnotationPresent(Excel.class)) &#123;</span><br><span class="line">                excels[column] = field.getAnnotation(Excel.class);</span><br><span class="line">                <span class="keyword">if</span> (excels[column].datum()) &#123;</span><br><span class="line">                    datum = column;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (excels[column].mergeRow()) &#123;</span><br><span class="line">                    mergeColumn.add(column);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">SlowSign</span> <span class="variable">slow</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SlowSign</span>(mergeColumn, sheet);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Write</span>(sheet, datum, excels, slow, cs, fields);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Write</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> Sheet sheet;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> Integer datum;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> Excel[] excels;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> SlowSign slow;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> CellStyle cs;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> List&lt;Field&gt; fields;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> <span class="variable">rowNum</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Write</span><span class="params">(Sheet sheet, Integer datum, Excel[] excels, SlowSign slow, CellStyle cs, List&lt;Field&gt; fields)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.sheet = sheet;</span><br><span class="line">            <span class="built_in">this</span>.datum = datum;</span><br><span class="line">            <span class="built_in">this</span>.excels = excels;</span><br><span class="line">            <span class="built_in">this</span>.slow = slow;</span><br><span class="line">            <span class="built_in">this</span>.cs = cs;</span><br><span class="line">            <span class="built_in">this</span>.fields = fields;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> rowNum - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">append</span><span class="params">(Object rowData)</span> &#123;</span><br><span class="line">            <span class="type">Row</span> <span class="variable">row</span> <span class="operator">=</span> sheet.createRow(rowNum);</span><br><span class="line">            <span class="comment">// 是否需要合并</span></span><br><span class="line">            <span class="keyword">if</span> (datum != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span>&#123;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">val</span> <span class="operator">=</span> String.valueOf(getTargetValue((T)rowData, fields.get(datum), excels[datum]));</span><br><span class="line">                    slow.merge(val, rowNum);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    log.error(<span class="string">&quot;导出Excel失败&#123;&#125;,&#123;&#125;&quot;</span>, e.getMessage(), JSONObject.toJSONString(e.getStackTrace()));</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">column</span> <span class="operator">=</span> <span class="number">0</span>; column &lt; fields.size(); column++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (excels[column] == <span class="literal">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                addCell(excels[column], row, (T)rowData, fields.get(column), column, cs);</span><br><span class="line">            &#125;</span><br><span class="line">            rowNum++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">append</span><span class="params">(List&lt;?&gt; data)</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (Object rowData : data) &#123; <span class="built_in">this</span>.append(rowData); &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (datum != <span class="literal">null</span>) &#123; slow.endMerge(); &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Field&gt; <span class="title function_">buildExcelField</span><span class="params">(Class&lt;?&gt; clazz)</span> &#123;</span><br><span class="line">        ArrayList&lt;Field&gt; fields = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        List&lt;Field&gt; tempFields = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        tempFields.addAll(Arrays.asList(clazz.getSuperclass().getDeclaredFields()));</span><br><span class="line">        tempFields.addAll(Arrays.asList(clazz.getDeclaredFields()));</span><br><span class="line">        <span class="keyword">for</span> (Field field : tempFields) &#123;</span><br><span class="line">            <span class="comment">// 单注解</span></span><br><span class="line">            <span class="keyword">if</span> (field.isAnnotationPresent(Excel.class)) &#123;</span><br><span class="line">                <span class="type">Excel</span> <span class="variable">attr</span> <span class="operator">=</span> field.getAnnotation(Excel.class);</span><br><span class="line">                <span class="keyword">if</span> (attr != <span class="literal">null</span> &amp;&amp; (attr.type() == Excel.Type.ALL || attr.type() == Excel.Type.EXPORT)) &#123;</span><br><span class="line">                    fields.add(field);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 多注解</span></span><br><span class="line">            <span class="keyword">if</span> (field.isAnnotationPresent(Excels.class)) &#123;</span><br><span class="line">                <span class="type">Excels</span> <span class="variable">attrs</span> <span class="operator">=</span> field.getAnnotation(Excels.class);</span><br><span class="line">                Excel[] excels = attrs.value();</span><br><span class="line">                <span class="keyword">for</span> (Excel excel : excels) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (excel != <span class="literal">null</span> &amp;&amp; (excel.type() == Excel.Type.ALL || excel.type() == Excel.Type.EXPORT)) &#123;</span><br><span class="line">                        fields.add(field);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> fields;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">buildExcelField</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.fields = <span class="built_in">this</span>.buildExcelField(clazz);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加单元格</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addCell</span><span class="params">(Excel attr, Row row, T vo, Field field, <span class="type">int</span> column, CellStyle cs)</span> &#123;</span><br><span class="line">        Cell cell;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 设置行高</span></span><br><span class="line">            row.setHeight((<span class="type">short</span>) (attr.height() * <span class="number">20</span>));</span><br><span class="line">            <span class="comment">// 根据Excel中设置情况决定是否导出,有些情况需要保持为空,希望用户填写这一列.</span></span><br><span class="line">            <span class="keyword">if</span> (attr.isExport()) &#123;</span><br><span class="line">                <span class="comment">// 创建cell</span></span><br><span class="line">                cell = row.createCell(column);</span><br><span class="line">                cell.setCellStyle(cs);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 用于读取对象中的属性</span></span><br><span class="line">                <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> getTargetValue(vo, field, attr);</span><br><span class="line">                <span class="type">String</span> <span class="variable">dateFormat</span> <span class="operator">=</span> attr.dateFormat();</span><br><span class="line">                <span class="type">boolean</span> <span class="variable">isDecimalFormat</span> <span class="operator">=</span> attr.isDecimalFormat();</span><br><span class="line">                <span class="keyword">if</span> (value <span class="keyword">instanceof</span> Date) &#123;</span><br><span class="line">                    cell.setCellValue(<span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(dateFormat).format((Date)value));</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isDecimalFormat) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (value == <span class="literal">null</span>) &#123;</span><br><span class="line">                        cell.setCellValue(<span class="number">0</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        cell.setCellValue((<span class="keyword">new</span> <span class="title class_">BigDecimal</span>(value.toString())).stripTrailingZeros().toPlainString());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    cell.setCellType(attr.cellType());</span><br><span class="line">                    <span class="keyword">if</span> (value == <span class="literal">null</span>) &#123;</span><br><span class="line">                        cell.setCellValue(attr.defaultValue());</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">switch</span> (attr.cellType()) &#123;</span><br><span class="line">                            <span class="keyword">case</span> NUMERIC:</span><br><span class="line">                                cell.setCellValue(Double.parseDouble(String.valueOf(value)));</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            <span class="keyword">default</span>:</span><br><span class="line">                                cell.setCellValue(value + attr.suffix());</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;导出Excel失败&#123;&#125;,&#123;&#125;&quot;</span>, e.getMessage(), JSONObject.toJSONString(e.getStackTrace()));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取bean中的属性值</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> vo    实体对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> field 字段</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> excel 注解</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 最终的属性值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Object <span class="title function_">getTargetValue</span><span class="params">(T vo, Field field, Excel excel)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> field.get(vo);</span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.isEmpty(excel.targetAttr())) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">target</span> <span class="operator">=</span> excel.targetAttr();</span><br><span class="line">            <span class="keyword">if</span> (target.contains(<span class="string">&quot;.&quot;</span>)) &#123;</span><br><span class="line">                String[] targets = target.split(<span class="string">&quot;[.]&quot;</span>);</span><br><span class="line">                <span class="keyword">for</span> (String name : targets) &#123;</span><br><span class="line">                    o = getValue(o, name);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                o = getValue(o, target);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> o;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 解析导出值 0=男,1=女,2=未知</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> propertyValue 参数值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> converterExp  翻译注解</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 解析后值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">convertByExp</span><span class="params">(String propertyValue, String converterExp)</span> &#123;</span><br><span class="line">        String[] convertSource = converterExp.split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (String item : convertSource) &#123;</span><br><span class="line">            String[] itemArray = item.split(<span class="string">&quot;=&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (itemArray[<span class="number">0</span>].equals(propertyValue)) &#123;</span><br><span class="line">                <span class="keyword">return</span> itemArray[<span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> propertyValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 以类的属性的get方法方法形式获取值</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> o 属性对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name 属性名</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> value 值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Object <span class="title function_">getValue</span><span class="params">(Object o, String name)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.isEmpty(name)) &#123;</span><br><span class="line">            Class&lt;?&gt; clazz = o.getClass();</span><br><span class="line">            <span class="type">String</span> <span class="variable">methodName</span> <span class="operator">=</span> <span class="string">&quot;get&quot;</span> + name.substring(<span class="number">0</span>, <span class="number">1</span>).toUpperCase() + name.substring(<span class="number">1</span>);</span><br><span class="line">            <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> clazz.getMethod(methodName);</span><br><span class="line">            o = method.invoke(o);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> o;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建单元格</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">createCell</span><span class="params">(Sheet sheet, Excel attr, Row row, <span class="type">int</span> column)</span> &#123;</span><br><span class="line">        <span class="comment">// 创建列</span></span><br><span class="line">        <span class="type">Cell</span> <span class="variable">cell</span> <span class="operator">=</span> row.createCell(column);</span><br><span class="line">        <span class="comment">// 设置列中写入内容为String类型</span></span><br><span class="line">        cell.setCellType(CellType.STRING);</span><br><span class="line">        <span class="comment">// 写入列名</span></span><br><span class="line">        cell.setCellValue(attr.name());</span><br><span class="line">        <span class="type">CellStyle</span> <span class="variable">cellStyle</span> <span class="operator">=</span> createStyle(sheet, attr, row, column);</span><br><span class="line">        cell.setCellStyle(cellStyle);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建表格样式</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> CellStyle <span class="title function_">createStyle</span><span class="params">(Sheet sheet, Excel attr, Row row, <span class="type">int</span> column)</span> &#123;</span><br><span class="line">        <span class="type">CellStyle</span> <span class="variable">cellStyle</span> <span class="operator">=</span> book.createCellStyle();</span><br><span class="line">        cellStyle.setAlignment(HorizontalAlignment.CENTER);</span><br><span class="line">        cellStyle.setVerticalAlignment(VerticalAlignment.CENTER);</span><br><span class="line">        <span class="type">Font</span> <span class="variable">font</span> <span class="operator">=</span> book.createFont();</span><br><span class="line">        <span class="keyword">if</span> (attr.name().contains(<span class="string">&quot;注：&quot;</span>)) &#123;</span><br><span class="line">            font.setColor(HSSFFont.COLOR_RED);</span><br><span class="line">            cellStyle.setFont(font);</span><br><span class="line">            cellStyle.setFillForegroundColor(HSSFColor.HSSFColorPredefined.YELLOW.getIndex());</span><br><span class="line">            sheet.setColumnWidth(column, <span class="number">6000</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 粗体显示</span></span><br><span class="line">            font.setBold(<span class="literal">true</span>);</span><br><span class="line">            <span class="comment">// 选择需要用到的字体格式</span></span><br><span class="line">            cellStyle.setFont(font);</span><br><span class="line">            cellStyle.setFillForegroundColor(HSSFColor.HSSFColorPredefined.LIGHT_YELLOW.getIndex());</span><br><span class="line">            <span class="comment">// 设置列宽</span></span><br><span class="line">            sheet.setColumnWidth(column, (<span class="type">int</span>) ((attr.width() + <span class="number">0.72</span>) * <span class="number">256</span>));</span><br><span class="line">            row.setHeight((<span class="type">short</span>) (attr.height() * <span class="number">20</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        cellStyle.setFillPattern(FillPatternType.SOLID_FOREGROUND);</span><br><span class="line">        cellStyle.setWrapText(<span class="literal">true</span>);</span><br><span class="line">        <span class="comment">// 如果设置了提示信息则鼠标放上去提示.</span></span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.isEmpty(attr.prompt())) &#123;</span><br><span class="line">            <span class="comment">// 这里默认设了2-101列提示.</span></span><br><span class="line">            setXSSFPrompt(sheet, <span class="string">&quot;&quot;</span>, attr.prompt(), <span class="number">1</span>, <span class="number">100</span>, column, column);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 如果设置了combo属性则本列只能选择不能输入</span></span><br><span class="line">        <span class="keyword">if</span> (attr.combo().length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// 这里默认设了2-101列只能选择不能输入.</span></span><br><span class="line">            setXSSFValidation(sheet, attr.combo(), <span class="number">1</span>, <span class="number">100</span>, column, column);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cellStyle;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置 POI XSSFSheet 单元格提示</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sheet         表单</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> promptTitle   提示标题</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> promptContent 提示内容</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> firstRow      开始行</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> endRow        结束行</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> firstCol      开始列</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> endCol        结束列</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setXSSFPrompt</span><span class="params">(Sheet sheet, String promptTitle, String promptContent, <span class="type">int</span> firstRow, <span class="type">int</span> endRow,</span></span><br><span class="line"><span class="params">                              <span class="type">int</span> firstCol, <span class="type">int</span> endCol)</span> &#123;</span><br><span class="line">        <span class="type">DataValidationHelper</span> <span class="variable">helper</span> <span class="operator">=</span> sheet.getDataValidationHelper();</span><br><span class="line">        <span class="type">DataValidationConstraint</span> <span class="variable">constraint</span> <span class="operator">=</span> helper.createCustomConstraint(<span class="string">&quot;DD1&quot;</span>);</span><br><span class="line">        <span class="type">CellRangeAddressList</span> <span class="variable">regions</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CellRangeAddressList</span>(firstRow, endRow, firstCol, endCol);</span><br><span class="line">        <span class="type">DataValidation</span> <span class="variable">dataValidation</span> <span class="operator">=</span> helper.createValidation(constraint, regions);</span><br><span class="line">        dataValidation.createPromptBox(promptTitle, promptContent);</span><br><span class="line">        dataValidation.setShowPromptBox(<span class="literal">true</span>);</span><br><span class="line">        sheet.addValidationData(dataValidation);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置某些列的值只能输入预制的数据,显示下拉框.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sheet    要设置的sheet.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> textlist 下拉框显示的内容</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> firstRow 开始行</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> endRow   结束行</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> firstCol 开始列</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> endCol   结束列</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setXSSFValidation</span><span class="params">(Sheet sheet, String[] textlist, <span class="type">int</span> firstRow, <span class="type">int</span> endRow, <span class="type">int</span> firstCol, <span class="type">int</span> endCol)</span> &#123;</span><br><span class="line">        <span class="type">DataValidationHelper</span> <span class="variable">helper</span> <span class="operator">=</span> sheet.getDataValidationHelper();</span><br><span class="line">        <span class="comment">// 加载下拉列表内容</span></span><br><span class="line">        <span class="type">DataValidationConstraint</span> <span class="variable">constraint</span> <span class="operator">=</span> helper.createExplicitListConstraint(textlist);</span><br><span class="line">        <span class="comment">// 设置数据有效性加载在哪个单元格上,四个参数分别是：起始行、终止行、起始列、终止列</span></span><br><span class="line">        <span class="type">CellRangeAddressList</span> <span class="variable">regions</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CellRangeAddressList</span>(firstRow, endRow, firstCol, endCol);</span><br><span class="line">        <span class="comment">// 数据有效性对象</span></span><br><span class="line">        <span class="type">DataValidation</span> <span class="variable">dataValidation</span> <span class="operator">=</span> helper.createValidation(constraint, regions);</span><br><span class="line">        <span class="comment">// 处理Excel兼容性问题</span></span><br><span class="line">        <span class="keyword">if</span> (dataValidation <span class="keyword">instanceof</span> XSSFDataValidation) &#123;</span><br><span class="line">            dataValidation.setSuppressDropDownArrow(<span class="literal">true</span>);</span><br><span class="line">            dataValidation.setShowErrorBox(<span class="literal">true</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            dataValidation.setSuppressDropDownArrow(<span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        sheet.addValidationData(dataValidation);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">SlowSign</span> &#123;</span><br><span class="line">        <span class="type">int</span> startRow;</span><br><span class="line">        String lastValue;</span><br><span class="line">        <span class="type">int</span> lastRow;</span><br><span class="line">        List&lt;Integer&gt; columns;</span><br><span class="line">        SXSSFSheet sheet;</span><br><span class="line">        SlowSign(List&lt;Integer&gt; columns, SXSSFSheet sheet) &#123;</span><br><span class="line">            <span class="built_in">this</span>.lastValue = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="built_in">this</span>.columns = columns;</span><br><span class="line">            <span class="built_in">this</span>.sheet = sheet;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">merge</span><span class="params">(String value, <span class="type">int</span> row)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!lastValue.equals(value)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (startRow != lastRow) &#123;</span><br><span class="line">                    <span class="built_in">this</span>.setMerge();</span><br><span class="line">                &#125;</span><br><span class="line">                lastValue = value == <span class="literal">null</span> ? <span class="string">&quot;&quot;</span> : value;</span><br><span class="line">                startRow = row;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">this</span>.lastRow = row;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">endMerge</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (startRow != lastRow) &#123;</span><br><span class="line">                <span class="built_in">this</span>.setMerge();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">setMerge</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (Integer column : columns) &#123;</span><br><span class="line">                <span class="type">CellRangeAddress</span> <span class="variable">mergeAddress</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CellRangeAddress</span>(startRow, lastRow, column, column);</span><br><span class="line">                sheet.addMergedRegionUnsafe(mergeAddress);</span><br><span class="line">                <span class="comment">// 删除被合并cell,暂时不知道为什么设置addMergedRegionUnsafe不会清除所属cell，所以需要手动删除一下</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> startRow+<span class="number">1</span>; i &lt;= lastRow; i++) &#123;</span><br><span class="line">                    sheet.getRow(i).removeCell(sheet.getRow(i).getCell(column));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  Excel相关的任务缓存工具类</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ExcelTaskUtil</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">long</span> <span class="variable">EXPIRE</span> <span class="operator">=</span> <span class="number">86500</span>;<span class="comment">// 过期时间</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * REDIS缓存KEY值</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> id 用户ID</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span> KEY值</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">static</span> String <span class="title function_">USER_EXPORT_TASK</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;user:export:task:&quot;</span>.concat(String.valueOf(id));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 添加一个文件缓存任务</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> redisTemplate 缓存服务</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> fileName 文件名</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> id 用户ID</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> countGroup 最大执行总量组</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">addExportFile</span><span class="params">(RedisTemplate&lt;String, Object&gt; redisTemplate, String fileName, Long id, <span class="type">int</span> countGroup)</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> USER_EXPORT_TASK(id);</span><br><span class="line">            <span class="keyword">if</span> (!redisTemplate.hasKey(key)) &#123;</span><br><span class="line">                redisTemplate.opsForHash().putAll(key, <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">16</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            redisTemplate.opsForHash().put(key, fileName, <span class="string">&quot;0/&quot;</span>.concat(String.valueOf(countGroup)));</span><br><span class="line">            <span class="comment">// 文件一天过期，缓存信息一天过期 不过期也会被系统清理</span></span><br><span class="line">            redisTemplate.expire(key, EXPIRE, TimeUnit.SECONDS);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 执行计划导出文件/片段执行结果</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> redisTemplate 缓存服务</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> fileName 文件名</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> id 用户ID</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span> 任务是否全部执行完成</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">scheduleExportFile</span><span class="params">(RedisTemplate&lt;String, Object&gt; redisTemplate, String fileName, Long id)</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> USER_EXPORT_TASK(id);</span><br><span class="line">            <span class="type">String</span> <span class="variable">val</span> <span class="operator">=</span> (String)redisTemplate.opsForHash().get(key, fileName);</span><br><span class="line">            <span class="keyword">if</span> (val != <span class="literal">null</span>) &#123;</span><br><span class="line">                String[] arr = val.split(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">                <span class="type">int</span> <span class="variable">current</span> <span class="operator">=</span> Integer.parseInt(arr[<span class="number">0</span>])+<span class="number">1</span>;</span><br><span class="line">                <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> Integer.parseInt(arr[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">                redisTemplate.opsForHash().put(key, fileName, current+<span class="string">&quot;/&quot;</span>+count);</span><br><span class="line">                <span class="comment">// 文件一天过期，缓存信息一天过期 不过期也会被系统清理</span></span><br><span class="line">                redisTemplate.expire(key, EXPIRE, TimeUnit.SECONDS);</span><br><span class="line">                <span class="keyword">return</span> current &gt;= count;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 获取用户下全部导出任务</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> redisTemplate 缓存服务</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> id 用户ID</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span> 任务列表</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;Object, Object&gt; <span class="title function_">getExportTask</span><span class="params">(RedisTemplate&lt;String, Object&gt; redisTemplate, Long id)</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> USER_EXPORT_TASK(id);</span><br><span class="line">            <span class="keyword">if</span> (!redisTemplate.hasKey(key)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.opsForHash().entries(key);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 验证任务是否存在</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> redisTemplate 缓存服务</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> fileName 文件名</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> userId 用户ID</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span> 验证结果</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">verifyTaskExist</span><span class="params">(RedisTemplate&lt;String, Object&gt; redisTemplate, String fileName, Long userId)</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> USER_EXPORT_TASK(userId);</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.hasKey(key) &amp;&amp; redisTemplate.opsForHash().hasKey(key, fileName);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">removeCache</span><span class="params">(RedisTemplate&lt;String, Object&gt; redisTemplate, String fileName, Long userId)</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> USER_EXPORT_TASK(userId);</span><br><span class="line">            redisTemplate.opsForHash().delete(key, fileName);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="门面（调用入口）"><a href="#门面（调用入口）" class="headerlink" title="门面（调用入口）"></a>门面（调用入口）</h2><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.spring.facade;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.pagination.Page;</span><br><span class="line"><span class="keyword">import</span> com.spring.util.ExcelExportUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.cursor.Cursor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class="line"><span class="keyword">import</span> lombok.RequiredArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Lazy;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.PlatformTransactionManager;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.support.TransactionTemplate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.atomic.AtomicInteger;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.atomic.AtomicReference;</span><br><span class="line"><span class="keyword">import</span> java.util.function.Consumer;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 导出门面</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/6/7</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor(onConstructor_ = &#123;@Lazy, @Autowired&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExportFacade</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> RedisTemplate&lt;String, Object&gt; redisService;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ThreadPoolTaskExecutor poolTaskExecutor;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> PlatformTransactionManager dataSourceTransactionManager;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">pages</span> <span class="operator">=</span> <span class="number">1</span>; <span class="comment">// 初始总页数</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> ExcelExportUtils.MAX_EXPORT_COUNT; <span class="comment">// 初始条数</span></span><br><span class="line">    <span class="keyword">public</span> ExportFacade <span class="title function_">setPages</span><span class="params">(<span class="type">int</span> pages)</span> &#123; <span class="built_in">this</span>.pages = pages; <span class="keyword">return</span> <span class="built_in">this</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> ExportFacade <span class="title function_">setSize</span><span class="params">(<span class="type">int</span> size)</span> &#123; <span class="built_in">this</span>.size = size; <span class="keyword">return</span> <span class="built_in">this</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> &lt;T&gt; <span class="keyword">void</span> <span class="title function_">autoPages</span><span class="params">(DataProvider&lt;T&gt; dataService)</span> &#123;</span><br><span class="line">        Page&lt;T&gt; page = <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        page.setSearchCount(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">long</span> <span class="variable">total</span> <span class="operator">=</span> dataService.page(page).getTotal();</span><br><span class="line">        <span class="built_in">this</span>.pages = (<span class="type">int</span>)Math.ceil(((<span class="type">double</span>)total) / size);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="keyword">void</span> <span class="title function_">execute</span><span class="params">(String fileName, Class&lt;T&gt; clazz, DataProvider&lt;T&gt; dataService, <span class="type">long</span> userId)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.execute(fileName, clazz, dataService, <span class="literal">false</span>, userId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="keyword">void</span> <span class="title function_">execute</span><span class="params">(String fileName, Class&lt;T&gt; clazz, DataProvider&lt;T&gt; dataService, <span class="type">boolean</span> auto, <span class="type">long</span> userId)</span> &#123;</span><br><span class="line">        ExcelExportUtils&lt;T&gt; exportUtil = <span class="keyword">new</span> <span class="title class_">ExcelExportUtils</span>&lt;&gt;(clazz,</span><br><span class="line">                ExcelExportUtils.PUBLIC_EXPORT_DIR, fileName);</span><br><span class="line">        ExcelExportUtils.ExcelTaskUtil.addExportFile(redisService, exportUtil.getFileName(), userId, pages);</span><br><span class="line">        <span class="keyword">if</span> (auto) &#123;</span><br><span class="line">            <span class="built_in">this</span>.autoPages(dataService);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= pages; i++) &#123;</span><br><span class="line">            Page&lt;T&gt; page = <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(i, size);</span><br><span class="line">            page.setSearchCount(<span class="literal">false</span>);</span><br><span class="line">            poolTaskExecutor.execute(() -&gt; &#123;</span><br><span class="line">                <span class="keyword">try</span>&#123;</span><br><span class="line">                    List&lt;T&gt; list = dataService.page(page).getRecords();</span><br><span class="line">                    exportUtil.build(list, exportUtil.buildSheet((<span class="type">int</span>)(page.getCurrent() - <span class="number">1</span>)));</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    log.error(<span class="string">&quot;线程池异常：&#123;&#125;,&#123;&#125;&quot;</span>, e.getMessage(),</span><br><span class="line">                            JSONObject.toJSONString(e.getStackTrace()));</span><br><span class="line">                &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (ExcelExportUtils.ExcelTaskUtil.scheduleExportFile(redisService, exportUtil.getFileName(), userId)) &#123;</span><br><span class="line">                        exportUtil.make();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> ExportFacade <span class="title function_">setCursor</span><span class="params">(<span class="type">int</span> handlerSize)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.handlerSize = handlerSize;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">handlerSize</span> <span class="operator">=</span> <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 游标处理-游标只有在事务中才会生效</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fileName 文件名</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> clazz 目标类</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dataService 数据供给</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> handler 额外的分批处理器-游标数据每N条进行一次截片处理（可以用以拼接第三方数据）-可以使用setCursor来指定分片大小</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userId 用户ID</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;T&gt; 目标对象-存在属性必须标注了Excel注解</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="keyword">void</span> <span class="title function_">cursor</span><span class="params">(String fileName, Class&lt;T&gt; clazz, CursorProvider&lt;T&gt; dataService, Consumer&lt;List&lt;T&gt;&gt; handler, <span class="type">long</span> userId)</span> &#123;</span><br><span class="line">        <span class="comment">// 创建一个事务模板用默认的数据源事务管理器</span></span><br><span class="line">        <span class="type">TransactionTemplate</span> <span class="variable">transactionTemplate</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TransactionTemplate</span>(dataSourceTransactionManager);</span><br><span class="line">        ExcelExportUtils&lt;T&gt; exportUtil = <span class="keyword">new</span> <span class="title class_">ExcelExportUtils</span>&lt;&gt;(ExcelExportUtils.PUBLIC_EXPORT_DIR, fileName);</span><br><span class="line"></span><br><span class="line">        <span class="type">AtomicInteger</span> <span class="variable">i</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>();</span><br><span class="line">        poolTaskExecutor.execute(() -&gt; transactionTemplate.execute(action -&gt; &#123;</span><br><span class="line">            Cursor&lt;T&gt; cursor = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">// 获取页写入对象</span></span><br><span class="line">                AtomicReference&lt;ExcelExportUtils&lt;?&gt;.Write&gt; atomic = <span class="keyword">new</span> <span class="title class_">AtomicReference</span>&lt;&gt;();</span><br><span class="line">                ExcelExportUtils&lt;?&gt;.<span class="type">Write</span> <span class="variable">write</span> <span class="operator">=</span> exportUtil.build(exportUtil.buildSheet(<span class="string">&quot;第&quot;</span> + (i.get() + <span class="number">1</span>) + <span class="string">&quot;页&quot;</span>),</span><br><span class="line">                        exportUtil.buildExcelField(clazz));</span><br><span class="line">                atomic.set(write);</span><br><span class="line"></span><br><span class="line">                cursor = dataService.cursor();</span><br><span class="line">                <span class="comment">// 每收集一定条目进行一次处理</span></span><br><span class="line">                Consumer&lt;List&lt;T&gt;&gt; resultHandler = (data) -&gt; &#123;</span><br><span class="line">                    <span class="keyword">if</span> (handler != <span class="literal">null</span>) &#123;</span><br><span class="line">                        <span class="comment">// TODO 对每批数据做一些额外的处理</span></span><br><span class="line">                        handler.accept(data);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (atomic.get().size() + data.size() &gt; size) &#123;</span><br><span class="line">                        atomic.get().close();</span><br><span class="line">                        i.getAndIncrement();</span><br><span class="line">                        atomic.set(exportUtil.build(exportUtil.buildSheet(<span class="string">&quot;第&quot;</span> + (i.get() + <span class="number">1</span>) + <span class="string">&quot;页&quot;</span>),</span><br><span class="line">                                exportUtil.buildExcelField(clazz)));</span><br><span class="line">                    &#125;</span><br><span class="line">                    atomic.get().append(data);</span><br><span class="line">                &#125;;</span><br><span class="line">                <span class="comment">// 分批处理游标数据，每收集一部分进行处理,这样是会多几次循环操作 但是可以保证职责单一与良好的隔离性</span></span><br><span class="line">                <span class="built_in">this</span>.handler(cursor, resultHandler, handlerSize);</span><br><span class="line">                write.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                log.error(<span class="string">&quot;数据导出失败：&#123;&#125;,堆栈信息：&#123;&#125;&quot;</span>, e.getMessage(), JSONObject.toJSON(e.getStackTrace()));</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (cursor != <span class="literal">null</span>) &#123; cursor.close(); &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException ignored) &#123;&#125;</span><br><span class="line">                <span class="keyword">if</span> (ExcelExportUtils.ExcelTaskUtil.scheduleExportFile(redisService, exportUtil.getFileName(), userId)) &#123;</span><br><span class="line">                    exportUtil.make();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> &lt;T&gt; <span class="keyword">void</span> <span class="title function_">handler</span><span class="params">(Cursor&lt;T&gt; cursor, Consumer&lt;List&lt;T&gt;&gt; handler, <span class="type">int</span> size)</span> &#123;</span><br><span class="line">        List&lt;T&gt; batch = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(size);</span><br><span class="line">        <span class="keyword">for</span> (T t : cursor) &#123;</span><br><span class="line">            batch.add(t);</span><br><span class="line">            <span class="keyword">if</span> (batch.size() == size) &#123;</span><br><span class="line">                handler.accept(batch);</span><br><span class="line">                batch.clear();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!batch.isEmpty()) handler.accept(batch);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DataProvider</span>&lt;T&gt; &#123;</span><br><span class="line">        Page&lt;T&gt; <span class="title function_">page</span><span class="params">(Page&lt;T&gt; page)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">CursorProvider</span>&lt;T&gt; &#123;</span><br><span class="line">        Cursor&lt;T&gt; <span class="title function_">cursor</span><span class="params">()</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="使用示例"><a href="#使用示例" class="headerlink" title="使用示例"></a>使用示例</h2><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.spring.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.spring.facade.ExportFacade;</span><br><span class="line"><span class="keyword">import</span> com.spring.repository.entity.Test;</span><br><span class="line"><span class="keyword">import</span> com.spring.repository.service.ITestDataService;</span><br><span class="line"><span class="keyword">import</span> lombok.RequiredArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Lazy;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.PlatformTransactionManager;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor(onConstructor_ = &#123;@Lazy, @Autowired&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ExportFacade exportFacade;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ITestDataService testDataService;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ThreadPoolTaskExecutor poolTaskExecutor;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> PlatformTransactionManager dataSourceTransactionManager;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> RedisTemplate&lt;String, Object&gt; redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> <span class="variable">userId</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 普通用法-自动查询条数分页</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">commonExport</span><span class="params">()</span> &#123;</span><br><span class="line">        exportFacade.execute(<span class="string">&quot;测试&quot;</span>, Test.class, testDataService::page, userId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 手动分页-禁止自动分页，手动指定查询数目与分页条数,默认情况下如果假定数据量不会超过初始值可以直接使用该方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pageExport</span><span class="params">()</span> &#123;</span><br><span class="line">        exportFacade.setPages(<span class="number">2</span>).setSize(<span class="number">1000</span>).execute(<span class="string">&quot;测试&quot;</span>, Test.class, testDataService::page, <span class="literal">false</span>, userId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 游标用法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">cursorExport</span><span class="params">()</span> &#123;</span><br><span class="line">        exportFacade.setCursor(<span class="number">2000</span>).cursor(<span class="string">&quot;测试&quot;</span>, Test.class, testDataService::cursor, items -&gt; &#123;</span><br><span class="line">            <span class="keyword">for</span> (Test item : items) &#123;</span><br><span class="line">                item.setName(item.getName() + <span class="string">&quot;-游标的额外处理&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, userId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="游标子Mapper说明"><a href="#游标子Mapper说明" class="headerlink" title="游标子Mapper说明"></a>游标子Mapper说明</h3><blockquote><p>mapper接口中使用Cursor对象接收使用 @Options注解声明游标参数</p></blockquote><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.spring.repository.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.mapper.BaseMapper;</span><br><span class="line"><span class="keyword">import</span> com.spring.repository.entity.Test;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Options;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.cursor.Cursor;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.mapping.ResultSetType;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">TestMapper</span> <span class="keyword">extends</span> <span class="title class_">BaseMapper</span>&lt;Test&gt; &#123;</span><br><span class="line">    <span class="meta">@Options(resultSetType = ResultSetType.FORWARD_ONLY, fetchSize = Integer.MIN_VALUE)</span></span><br><span class="line">    Cursor&lt;Test&gt; <span class="title function_">cursor</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="文件获取与进度监听"><a href="#文件获取与进度监听" class="headerlink" title="文件获取与进度监听"></a>文件获取与进度监听</h2><p>见第一种方案的上述的 5，6步骤</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>简单算法-Java示例</title>
      <link href="/2025/03/12/%E7%AE%97%E6%B3%95%E5%AE%9E%E8%B7%B5/"/>
      <url>/2025/03/12/%E7%AE%97%E6%B3%95%E5%AE%9E%E8%B7%B5/</url>
      
        <content type="html"><![CDATA[<h2 id="简单"><a href="#简单" class="headerlink" title="简单"></a>简单</h2><h3 id="回文字符串"><a href="#回文字符串" class="headerlink" title="回文字符串"></a>回文字符串</h3><ul><li><p>循环双指针</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 空字符串或只有单一字符 √</span></span><br><span class="line"><span class="comment"> * 不关心奇偶取中数,向上向下取皆对</span></span><br><span class="line"><span class="comment"> * 头部字符与尾部字符逐一对比</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> str 源字符串</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> boolean</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">solve</span><span class="params">(String str)</span>&#123;</span><br><span class="line">    <span class="comment">// 长度小于2 认定属于回文串</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> str.length();</span><br><span class="line">    <span class="keyword">if</span> (count &lt; <span class="number">2</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 取一个&quot;概&quot;中位数</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> count/<span class="number">2</span>;</span><br><span class="line">    <span class="comment">// 只循环前半部分来对比后半部</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="comment">// 对比字符一致性，不一致返回</span></span><br><span class="line">        <span class="keyword">if</span> (str.charAt(i) != str.charAt(count-i-<span class="number">1</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li></ul><h3 id="约瑟夫环"><a href="#约瑟夫环" class="headerlink" title="约瑟夫环"></a>约瑟夫环</h3><ul><li><p>循环链表</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ListNode</span> &#123;</span><br><span class="line">    <span class="type">int</span> val;</span><br><span class="line">    ListNode next;</span><br><span class="line">    ListNode(<span class="type">int</span> x) &#123; val = x; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 注：这里的示例以约瑟夫环人数为标准，所以下标都是1起始来避免一次length-1的计算,正常场景应该都是0起始</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * 构建一个循环链表</span></span><br><span class="line"><span class="comment">  * 从尾节点开始，获取开始位置的节点</span></span><br><span class="line"><span class="comment">  * 获取将要弹出位置的前一个节点，修改这个节点的NEXT指向，跳过并释放删除位置节点</span></span><br><span class="line"><span class="comment">  * 将弹出位置的下一个节点当作新的开始位置</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> count 总数</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> start 开始位置</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> out 第几位弹出</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span>[] solve(<span class="type">int</span> count, <span class="type">int</span> start, <span class="type">int</span> out)&#123;</span><br><span class="line">    <span class="comment">// 返回结果集</span></span><br><span class="line">    <span class="type">int</span>[] result = <span class="keyword">new</span> <span class="title class_">int</span>[count];</span><br><span class="line">    <span class="comment">// 当前下标位置</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// 头节点</span></span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">l</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="comment">// 尾节点 指向头节点 构成循环链表</span></span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">p</span> <span class="operator">=</span> l;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">2</span>; i &lt;= count; i++) &#123;</span><br><span class="line">        l.next = <span class="keyword">new</span> <span class="title class_">ListNode</span>(i);</span><br><span class="line">        l = l.next;</span><br><span class="line">    &#125;</span><br><span class="line">    l.next = p;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 从尾节点开始,对应的下标从1开始 拿到起始位置的节点</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; start; i++) &#123;</span><br><span class="line">        p = p.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 此时p为起始位置节点,如果p的下一个节点是它自己 说明循环链表只剩余一个 跳出</span></span><br><span class="line">    <span class="keyword">while</span> (p.next != p)&#123;</span><br><span class="line">        <span class="comment">// 到达删除节点的前一个位置 假设 A B C 需要删除B 此时p=A</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; out-<span class="number">1</span>; i++) &#123;</span><br><span class="line">            p = p.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 获取要删除的节点 此时p=A tmp=B</span></span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">tmp</span> <span class="operator">=</span> p.next;</span><br><span class="line">        <span class="comment">// 修改删除节点前一位置的下一指向 此时p=A 原p.next=B 现p.next=C</span></span><br><span class="line">        p.next = p.next.next;</span><br><span class="line">        <span class="comment">// 把将要删除节点的下一指向改为空(释放内存空间) 此时p=A 原tmp.next=C 现tmp.next=null</span></span><br><span class="line">        <span class="comment">// 删除链表结点时，也一定要记得手动释放内存空间，否则，也会出现内存泄漏的问题</span></span><br><span class="line">        <span class="comment">// 上述是针对于某些语言而言，对于java而言其内存由虚拟机自动管理,可以不考虑这点</span></span><br><span class="line">        tmp.next = <span class="literal">null</span>;</span><br><span class="line">        <span class="comment">// 开始位置变更为删除节点的下一位置 此时p=C</span></span><br><span class="line">        p = p.next;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 将被删除节点值插入结果集中</span></span><br><span class="line">        result[index] = tmp.val;</span><br><span class="line">        index++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 最终节点的值插入</span></span><br><span class="line">    result[count-<span class="number">1</span>] = p.val;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>什么是时空复杂度</title>
      <link href="/2025/03/12/%E6%97%B6%E7%A9%BA%E5%A4%8D%E6%9D%82%E5%BA%A6/"/>
      <url>/2025/03/12/%E6%97%B6%E7%A9%BA%E5%A4%8D%E6%9D%82%E5%BA%A6/</url>
      
        <content type="html"><![CDATA[<h3 id="类比"><a href="#类比" class="headerlink" title="类比"></a>类比</h3><ul><li><strong>O(1)</strong></li></ul><blockquote><p>O(1)就是最低的时空复杂度了，也就是耗时&#x2F;耗空间与输入数据大小无关，无论输入数据增大多少倍，</p><p>​耗时&#x2F;耗空间都不变。 哈希算法就是典型的O(1)时间复杂度，无论数据规模多大，</p><p>​都可以在一次计算后找到目标（不考虑冲突的话），冲突的话很麻烦的，指向的value会做二次hash到另外一快存储区域。</p></blockquote><p>例:</p><blockquote><p>什么是O(1)呢，就比如你是一个酒店的管理员，你负责管理酒店的钥匙，</p><p>​你很聪明，你把酒店的100把钥匙放在了100个格子里面存着，并且把格子从1~100进行了编号，</p><p>​有一天有客人来了，酒店老板说，给我拿10号房间的钥匙给我，你迅速从10号格子里面拿出钥匙给老板，</p><p>​速度非常快，这时候你就是一个电脑了，老板跟你说拿几号房房间的钥匙，你只需要看一眼就能知道钥匙在哪里。</p></blockquote><ul><li><strong>O(n)</strong></li></ul><blockquote><p>比如时间复杂度为O(n)，就代表数据量增大几倍，耗时也增大几倍。</p><p>​比如常见的遍历算法。 </p><p>​要找到一个数组里面最大的一个数，你要把n个变量都扫描一遍，操作次数为n，那么算法复杂度是O(n)</p></blockquote><p>例：</p><blockquote><p>突然，有一天，你的老板给你说，你用100个箱子存100把钥匙，太浪费空间了，你能补能把钥匙上编号一下，</p><p>​然后把钥匙要用绳子穿起来，这样我们可以把这个放箱子的地方再装修一个房间出来。</p><p>​你想了一下，是啊，现在房价这么贵，这样能多赚点钱。所以你就不能通过上面的方法来找到钥匙了，</p><p>​老板跟你说，给我拿45号房间的钥匙出来，你就需要从100个钥匙里面挨个找45个房间的钥匙。</p></blockquote><ul><li><strong>O(n^2)</strong></li></ul><blockquote><p>O()的写法为：O(n^2) </p><p>​再比如时间复杂度O(n^2)，就代表数据量增大n倍时，耗时增大n的平方倍，这是比线性更高的时间复杂度。</p><p>​比如冒泡排序，就是典型的O(n^2)的算法，对n个数排序，需要扫描n×n次。 </p><p>​用冒泡排序排一个数组，对于n个变量的数组，需要交换变量位置次，那么算法复杂度就是O(n^2) </p></blockquote><p>例：</p><blockquote><p>随着经济发展越来越好，你的老板把酒店扩大了，有100层每一层有100个房间，</p><p>​你把每一层的钥匙穿在一起，然后一共就有100个用绳子穿起来的钥匙串。</p><p>​然后老板叫你找钥匙的时候，你先要找到楼层的编号，再对应找到房间的编号，所以大概对应的是这样的代码。</p></blockquote><ul><li><strong>O(log n)</strong></li></ul><blockquote><p>再比如O(log n)，当数据增大n倍时，耗时增大log n倍（这里的log是以2为底的，</p><p>​比如，当数据增大256倍时，耗时只增大8倍，是比线性还要低的时间复杂度）。</p><p>​二分查找就是O(log n)的算法，每找一次排除一半的可能，256个数据中查找只要找8次就可以找到目标。 </p></blockquote><p>例：</p><blockquote><p>这个就像是有一百把钥匙，你突然觉得，我从头找是不是太慢了，我从中间找，</p><p>​比如我要找到23号的房间钥匙，我从中间切开，找到50编号的位置，然后23在1~50里面，</p><p>​我再把从中间切开变成25，然后23在1<del>25之间，我再切开变成12.5，然后23在12.5</del>25之间，</p><p>​依次找下去，直到找到钥匙。这种查找钥匙的方法的复杂度就是O(log^n)</p></blockquote><ul><li><strong>O(n log n)</strong></li></ul><blockquote><p>O(n log n)同理，就是n乘以log n，当数据增大256倍时，耗时增大256*8&#x3D;2048倍。</p><p>​这个复杂度高于线性低于平方。归并排序就是O(n log n)的时间复杂度。 </p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> 软件基础 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring事务失效场景</title>
      <link href="/2025/03/12/%E8%AE%B0%E4%B8%80%E6%AC%A1SpringCloud%20%E4%BA%8B%E5%8A%A1%E5%A4%B1%E6%95%88/"/>
      <url>/2025/03/12/%E8%AE%B0%E4%B8%80%E6%AC%A1SpringCloud%20%E4%BA%8B%E5%8A%A1%E5%A4%B1%E6%95%88/</url>
      
        <content type="html"><![CDATA[<blockquote><p>今天使用事务时发现同源的多SQL事务无效</p><p>遂检查Mysql 表引擎 发现<em>InnoDB</em>没问题</p></blockquote><p>排查发现是<strong>同类</strong>调用导致，记录事务注解自动回滚失效场景</p><ul><li><p>注解方法非public类型</p></li><li><p>表引擎不支持事务</p></li><li><p>try catch手动捕获未能抛出异常</p></li><li><p>checked异常与unchecked异常的差异，未在事务上指定rollbackFor的异常类型</p></li><li><p>注解配置错误，全局没有事务</p><blockquote><p>Application添加 @EnableTransactionManagement 注解配置，针对项目结构采取不同的配置申明</p></blockquote></li><li><p>被注解事务方法 必须是 基于接口的，或者基于类的代理被创建。所以同类内的方法调用会导致事务失效</p><blockquote><p>同类内A方法调用事务注解B方法</p></blockquote></li></ul><blockquote><p>对于同类失效场景</p></blockquote><p><strong><del>个人不是很理解这个设定，虽然知道AOP是基于此才能切入事务，但同类调用的无法切入实属一个极大不方便点</del></strong></p>]]></content>
      
      
      
        <tags>
            
            <tag> spring </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>通用数据结构</title>
      <link href="/2025/03/12/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
      <url>/2025/03/12/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/</url>
      
        <content type="html"><![CDATA[<h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><ul><li><p><strong>结构</strong></p><blockquote><p>线性表结构，一组连续的内存空间</p></blockquote></li><li><p><strong>特性</strong></p><blockquote><p>数组因为是一组连续的内存空间，其通过首空间内存地址与访问下标来实现随机访问</p></blockquote></li><li><p><strong>基础</strong></p><blockquote><p>数组随机访问寻址公式：a[i]_address &#x3D; base_address + i * data_type_size</p><p>首地址 加 (访问下标 乘 数据类型大小(单下标被分配的内存大小))</p></blockquote></li><li><p><strong>优劣</strong></p><blockquote><p>链表适合插入、删除，时间复杂度O(1)；数组支持随机访问，根据下标随机访问的时间复杂度为O(1),而非下标查找最优时间复杂度是O(logn)。</p></blockquote></li><li><p><strong>问题</strong></p><ul><li><p>为何数组的插入低效：</p><blockquote><p>因为数组的结构使得它在操作某个下标时 必然需要其他下标配合操作</p><p>例：在下标2处插入一个元素 这会使得下标2至末尾的所有下标元素向后移一位</p></blockquote></li><li><p>删除操作:</p><blockquote><p>数组的删除大部分不是真正意义上的删除，而是同于JVM，软删除等标记其删除，</p><p>这样就大大减少了因删除操作而带来的数据搬迁问题</p></blockquote></li><li><p>数组下标越界：</p><blockquote><p>数组越界在C语言中是一种未决行为，并没有规定数组访问越界时编译器应该如何处理，如果越界后的内存地址是可用的，那么其不会抛出任何错误，这会使得程序可以访问非法地址，警惕此漏洞攻击.</p></blockquote></li><li><p>容器替代数组:</p><blockquote><p>容器封装了一些操作，无需你去做一些繁琐的工作(例如：预设大小与自动扩容)</p><p>使用容器代表其内部存储类型也为封装类型而非基础类型，这会造成一点性能损耗</p><p>对于高级开发者而言，性能要求使得他们会优先选择数组</p></blockquote></li><li><p>数组下标为何从0开始而非1</p><blockquote><p>性能问题：下标从0开始会使得数组寻址公式最简化，假设从1开始寻址公式会变为</p><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[k]_address = base_address + (k-1)*type_size</span><br></pre></td></tr></table></figure></div><p>这使得CPU的运行多做了一次减法指令，这对于普通程序而言自然是无影响的，</p><p>但对于一个底层数据结构而言，最简化它是一个必须操作</p></blockquote></li></ul></li></ul><h2 id="链表"><a href="#链表" class="headerlink" title="链表"></a>链表</h2><ul><li><p><strong>结构</strong></p><blockquote><p>线性表结构，一组零散的内存块，通过指针串联</p></blockquote></li><li><p><strong>特性</strong></p><blockquote><p>用于缓存场景的链表清理空间策略：</p><ul><li>FIFO(先进先出)</li><li>LFU(历史最少使用)</li><li>LRU(最近最少使用)</li></ul></blockquote></li><li><p><strong>基础</strong></p><blockquote><p>记录指针,通过头节点的指针指向</p></blockquote></li><li><p><strong>优劣</strong></p><blockquote><p>因为是零散的内存块,只记录指针,所以其插入删除是高效的,访问是低效的</p><p>插入删除：O(1)    随机访问：O(n)</p></blockquote></li><li><p><strong>问题</strong></p><ul><li><p>为什么链表的访问低效</p><blockquote><p>如果访问第N个元素时,无法通过寻址公式来直接计算其内存地址,必须由头节点依次遍历</p></blockquote></li><li><p>为什么双向链表比单链表应用广泛</p><blockquote><p>单链表只存储一个向下的节点NEXT<br>双链表还存储一个向上的前驱节点指针PREV</p><p>这就使得双链表的内存消耗加大，但是对于一些场景而言其时间成本大大减少</p></blockquote><p><strong>举例</strong>：删除结点中“值等于某个给定值”的结点</p><p>单链表：遍历查找指定节点,查找前驱节点与获取后驱节点,删除</p><p>双链表：遍历查找指定节点,直接获取PREV与NEXT,删除</p></li><li><p>LRU实现</p><blockquote><p>维护一个有序单链表作为缓存</p><p>新数据被访问时，从链表头开始顺序遍历链表</p><p>1.如果此数据之前已经被缓存在链表中了，我们遍历得到这个数据对应的结点，并将其从原来的位置删除，然后再插入到链表的头部。</p><p>2.如果此数据没有在缓存链表中，又可以分为两种情况：</p><blockquote><p>如果此时缓存未满，则将此结点直接插入到链表的头部；</p><p>如果此时缓存已满，则链表尾结点删除，将新的数据结点插入链表的头部。</p></blockquote></blockquote></li><li><p>哨兵节点解决边界问题</p><blockquote><p>如果需要从一个结构中查找给定值，那么先将该值加入结构尾部</p><p>开始循环,这样使得循环体内少一次判断</p><p>此时循环必然能产生一个结果返回过来,不存在边界泄露问题</p><p>对比此结果是否在尾部(为哨兵节点)</p></blockquote><p>作用：简化边界条件的处理</p></li></ul></li></ul><h2 id="栈"><a href="#栈" class="headerlink" title="栈"></a>栈</h2><ul><li><p><strong>结构</strong></p><blockquote><p>栈基于数组实现，限制了数组的灵活操作，只对外暴露部分接口。</p></blockquote></li><li><p><strong>特性</strong></p><blockquote><p>先进后出</p></blockquote></li><li><p><strong>优劣</strong></p><blockquote><p>入栈是O(1),个别时刻会退化至O(n)，出栈O(1)</p></blockquote></li></ul><p>应用场景：例如程序执行的堆栈信息,每进入一个函数就将此函数的栈帧入栈，执行完就出栈</p><p><del>表面上看来，这些结构带来的只有限制无优势</del></p><p>但从应用角度出发：</p><p><strong>特定的数据结构是对特定场景的抽象，而且，数组或链表暴露了太多的操作接口，操作上的 确灵活自由，但使用时就比较不可控，自然也就更容易出错</strong></p><h2 id="队列"><a href="#队列" class="headerlink" title="队列"></a>队列</h2><ul><li><p><strong>结构</strong></p><blockquote><p>与栈一致，基于数组实现，限制了数组的灵活操作，只对外暴露部分接口。</p></blockquote></li><li><p><strong>特性</strong></p><blockquote><p>先进先出</p></blockquote></li></ul><p>同栈相似性大，不多赘述</p><h2 id="递归"><a href="#递归" class="headerlink" title="递归"></a>递归</h2><ul><li><p><strong>概述</strong></p><blockquote><p>函数调用自己本身的行为</p></blockquote></li><li><p><strong>条件</strong></p><blockquote><p>一个问题的解可以分解为几个子问题的解</p><p>这个问题与分解之后的子问题，除了数据规模不同，求解思路完全一样</p><p>存在递归终止条件</p></blockquote></li><li><p><strong>过程</strong></p><blockquote><p>“递”和”归”的过程</p></blockquote></li><li><p><strong>优劣</strong></p><p>劣：</p><blockquote><p>空间复杂度高、有堆栈溢出的风险、存在重复计算、过多的函数调用会耗 时较多等</p></blockquote><p>优：</p><blockquote><p>表达力很强，写起来非常简洁</p></blockquote></li><li><p><strong>问题</strong></p><ul><li><p>如何避免重复计算</p><p>在全局记录计算帧,每次外层递归时判断是否已被计算过</p></li><li><p>边界问题</p><p>递归必须存在边界,防止无限递归与循环递归,最常见的方法有限制递归深度,使用必然产生条件限制</p></li></ul></li></ul><h2 id="插入排序"><a href="#插入排序" class="headerlink" title="插入排序"></a>插入排序</h2><blockquote><p>时空复杂度O(n²)，稳定排序算法<a href="%E5%90%8C%E5%80%BC%E5%85%83%E7%B4%A0%E5%9C%A8%E6%8E%92%E5%BA%8F%E5%90%8E%E9%A1%BA%E5%BA%8F%E6%98%AF%E5%90%A6%E5%8F%98%E6%9B%B4%E4%B8%BA%E7%A8%B3%E5%AE%9A%E6%80%A7">^是否稳定</a></p></blockquote><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 在第一次遍历内拿当前元素节点向前方已排序节点进行逐一对比</span></span><br><span class="line"><span class="comment"> * (将当前元素节点插入前面已排序列表)</span></span><br><span class="line"><span class="comment"> * 再将被排序的最大值下标顶替至当前元素值</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> arr 需要排序的数组</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">insertionSort</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr.length &lt;= <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; arr.length; ++i) &#123;</span><br><span class="line">        <span class="comment">// 记录当前值</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">value</span> <span class="operator">=</span> arr[i];</span><br><span class="line">        <span class="comment">// 记录前一个下标</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i - <span class="number">1</span>;</span><br><span class="line">        <span class="comment">// 查找下标小于当前值下标的插入的位置</span></span><br><span class="line">        <span class="keyword">for</span> (; j &gt;= <span class="number">0</span>; --j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[j] &gt; value) &#123;</span><br><span class="line">                <span class="comment">// 插入，此时i的位置是提供给查找到的别的元素替换的</span></span><br><span class="line">                arr[j+<span class="number">1</span>] = arr[j];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 因为break,此时j是最后一个顶替别人的元素之前的元素节点</span></span><br><span class="line">        <span class="comment">// 将这个元素位置替换为循环开始时记录的i值</span></span><br><span class="line">        arr[j+<span class="number">1</span>] = value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p><strong>解</strong>为什么相似的排序过程插入排序要比冒泡排序好(同为原地排序算法)</p><blockquote><p>冒泡是数据交换,插入是数据移动</p><p>对于交换而言，存在三次赋值过程，记录当前-&gt;A顶替B-&gt;B改为当前</p><p>对于移动而言，存在一次赋值过程，B &#x3D; A，只在最外层循环内存在一次整体的交换</p></blockquote><h2 id="选择排序"><a href="#选择排序" class="headerlink" title="选择排序"></a>选择排序</h2><blockquote><p> 时空复杂度O(n²)，不稳定排序算法<a href="%E5%90%8C%E5%80%BC%E5%85%83%E7%B4%A0%E5%9C%A8%E6%8E%92%E5%BA%8F%E5%90%8E%E9%A1%BA%E5%BA%8F%E6%98%AF%E5%90%A6%E5%8F%98%E6%9B%B4%E4%B8%BA%E7%A8%B3%E5%AE%9A%E6%80%A7">^是否稳定</a></p></blockquote><p>类似插入排序,区别是插入对比已排序区间,选择对比未排序区间,一直从未排序区间寻找最小元素放至已排序区间末尾</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 遍历数组</span></span><br><span class="line"><span class="comment">  * 拿当前元素节点对比后续元素节点，取最小下标</span></span><br><span class="line"><span class="comment">  * 最小下标元素系欸但与当前元素节点交换</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> arr 排序数组</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">        <span class="comment">// 记录最小值下标</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">minIndex</span> <span class="operator">=</span> i;</span><br><span class="line">        <span class="comment">// 向后遍历元素节点取最小值下标</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i+<span class="number">1</span>; j &lt; arr.length; j++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[j] &lt; arr[minIndex])&#123;</span><br><span class="line">                minIndex = j;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 判断是否最小值下标是否为当前元素节点 不为则交换位置</span></span><br><span class="line">        <span class="keyword">if</span> (minIndex != i)&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">tmp</span> <span class="operator">=</span> arr[i];</span><br><span class="line">            arr[i] = arr[minIndex];</span><br><span class="line">            arr[minIndex] = tmp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="跳表"><a href="#跳表" class="headerlink" title="跳表"></a>跳表</h2><blockquote><p>Redis中的有序集合（Sorted Set）就是用跳表来实现的。</p><p>支持快速的插入、删除、查找操作，甚至可以替代红黑树（Red-black tree）</p></blockquote><ul><li><p><strong>结构</strong></p><blockquote><p>与二分查找相同，在一个有序链表上维护一个索引链，这个链每隔一定大小去指向真实节点，同理可以建立N层索引链</p></blockquote></li><li><p><strong>优劣</strong></p><blockquote><p>跳表相比较于单链表而言拥有更高效的效率，但其建立索引链的行为使得其占用存储空间跟随索引链的数量 呈等比<strong>数列形式</strong>递增</p></blockquote><p>在实际的软件开发中，原 始链表中存储的有可能是很大的对象，而索引结点只需要存储关键值和几个指针，并不需要存储对象，所以当对象比索引结点大很多时，那索引占用的额外空间 就可以忽略了</p></li><li><p><strong>问题</strong></p><ul><li><p>为什么Redis要用跳表来实现有序集合，而不是红黑树</p><blockquote><p>插入、删除、查找以及迭代输出有序序列这几个操作，红黑树也可以完成，时间复杂度跟跳表是一样的。但是，按照区间来查找数据这个操作，红黑树的 效率没有跳表高。</p></blockquote></li><li><p>索引平衡性</p><blockquote><p>跳表是通 过随机函数来维护前面提到的“平衡性”</p><p>往跳表中插入数据的时候，我们可以选择同时将这个数据插入到部分索引层中</p><p>通过一个随机函数，来决定将这个结点插入到哪几级索引中，比如随机函数生成了值K，那我们就将这个结点添加到第一级到第K级这K级索引中</p></blockquote><p>随机函数的选择很有讲究，从概率上来讲，能够保证跳表的索引大小和数据大小平衡性，不至于性能过度退化</p></li><li><p>跳表示例</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="data:image/jpg;base64,iVBORw0KGgoAAAANSUhEUgAAA2oAAAD1CAMAAAAWLfYyAAACc1BMVEX39O+5tav28u/19fDy9e729OzzsyL18ev1sSf09PIGAwL2sSX49vG2s6nx8uzz9un09er08/f38/T78+qzsKgUEhD2shzysS/r6eTy7+r78fO5trDy8PPwsyn4ryU0MS369ufu9+n58fm8ubLi4Nr7+PLw7ef1ry61sawODAnCwLsrKiWZl5La2NPw9vNJR0PyriY7OTXttSP4ti76rSrOzMft7ur47+by8eZbWVX98Nv98OKxrqMkIh6lop3wsB+Rj4r5siDm5ODrsDbu9/D3+PStq6Wpp6FVU1Dx9+L98tH7tCnsriz8riPqtC3t8u/489+Fg37vthr968/99eP4tyTrtj6gnZj86Llxb2rv9vj97Nb978j75bLJx8DqwWUdGxi/vLP2+ezmsEJDQD12dHDpv1eLiINraWXruUmAfnn958jvx3XqsCHz0ojkuEz22ZfltDbwtzTzcRH6rjJhXllQTknodR0mCAD48tfU0sz97MD536BnZF98eXTs8ePjtkH216Dtx2vtuFT94sD63qrkryr3qh/kvGH39/r8+vfuzYX99tvit1Xwrz53NwnszHz1zXz83rjz7tzirDX6sRn46MHu1ZPwrRdCKAf30pJeIgDuqSPlw3LxwFzq6N35x5xOHQIyGAPy3qncei/qi0LzuEXLZhxeNwoZCAHvfy365an06c6BURLdaRPwnFv0uoq1XhfwqnL2wW6TQwiTax3514rFdDS/jijZojCufyH71K6fWCHy4brKmTJuTxqjdTnekFTn3cnUp0bj0K29mVjlyZSvjEfbuop1XjZTQye7qoPPqmaFcUbukRyeh2WrmXUymBPbAADvm0lEQVR42uya3WvTUBTALzfn9vbiJUkTaJuQSRNI9xbGHKY0D4LWh07RsdZRNmWwgTDs3Ae+SAXnR3XrnOiUKcP54qOPgn+Cf5cnmR8g6oNuCml+SZM0fTon53duOJRkZGRkZGRkZGRkZGRkZPxfKBlmKKXDnYCsBo4UBUBhCCCEMITgCXQd7yvfS42R+Je0ouuMJrErQjACGkBcY6JQEEqKo/4BRVEgfsiHDca2CWUsLg78NjQ5OFag0QBgoN51E+fCkBEpwb3bdDUIxKFqiYIpVo1pGsZmsoWFwHEEcV13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"                      alt="跳表"                ></p></li></ul></li></ul><h2 id="示意"><a href="#示意" class="headerlink" title="示意"></a>示意</h2>]]></content>
      
      
      
        <tags>
            
            <tag> 软件基础 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>设计模式-Java示例</title>
      <link href="/2025/03/12/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
      <url>/2025/03/12/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<ul><li>工厂方法</li></ul><p><strong>在父类中提供一个创建对象的接口以允许子类决定实例化对象的类型</strong></p><blockquote><p>从业务角度行为一致，结构&#x2F;方式不同</p><blockquote><p>场景：工厂发送商品至买家手中</p><p>行为：工厂出货→物流运输→买家签收</p><p>结构：物流运输分为 陆运&#x2F;海运&#x2F;空运等</p></blockquote></blockquote><ul><li>抽象工厂</li></ul><p><strong>让你能创建一系列相关的对象，而无需指定其具体类</strong></p><blockquote><p>从描述角度一个组装品本质一致，细节不同</p><blockquote><p>场景：装修购买一套家具</p><p>结构：组成&lt; 椅子,沙发,桌子</p><p>细节：赛博朋克风格家具，维多利亚风格家具，传统风格家具</p></blockquote></blockquote><ul><li>生成器</li></ul><p><strong>使你能够分步骤创建复杂对象。该模式允许你使用相同的创建代码生成不同类型和形式的对象</strong></p><blockquote><p>从结构角度一个组装品的组成部分不同，结果&#x2F;对象一致</p><blockquote><p>场景：建造一间房屋</p><p>结构：墙面,屋顶,大门……</p><p>行为：可以为该房屋随意的扩展添加组成&#x2F;装饰 零件,例如：花园,大树,邮箱</p></blockquote></blockquote><blockquote><p>示例：Maybatis中的QUERY构建器</p></blockquote><ul><li>原型</li></ul><p><strong>让你能够复制已有对象，而又无需使代码依赖他们所属的类</strong></p><blockquote><p>从结构角度一个组装品的组成部分相同，结果&#x2F;对象不一致</p><blockquote><p>场景：图形编辑器软件</p><p>结构：形状</p><p>行为：复制一个形状到画布上，完全不干扰&#x2F;依赖 原形状</p></blockquote></blockquote><ul><li>单例</li></ul><p><strong>让你能够保证一个类只有一个实例，并提供一个访问该实例的全局节点</strong></p><blockquote><p>控制某些共享资源 （例如数据库或文件） 的访问权限</p><p>保护该实例不被其他代码覆盖</p><p>解决同一个问题的代码分散在程序各处的。 因此更好的方式是将其放在同一个类中， 特别是当其他代码已经依赖这个类时更应该如此</p><blockquote><p>场景：连接数据库</p><p>需求：执行N条SQL</p><p>行为：这N条SQL分散在程序各处的各个线程执行，但它们对于数据库的连接应该是唯一性的，因为CONNECTION的过程是极度耗费资源消耗的</p></blockquote></blockquote><ul><li>适配器</li></ul><p><strong>让接口不兼容的对象能够相互合作</strong></p><blockquote><p>转换对象接口， 使其能与其他对象进行交互</p><p>将复杂的转换过程隐藏于幕后。 被封装的对象甚至察觉不到适配器的存在</p><blockquote><p>场景：程序调用XML格式的第三方接口 给 JSON格式的插件</p><p>​同时提供<em>Type-C</em>接口与<em>Type-A</em>的充电头转换器</p><p>方式：适配器实现与其中一个现有对象兼容的接口</p><p>​现有对象可以使用该接口安全地调用适配器方法</p><p>​适配器方法被调用后将以另一个对象兼容的格式和顺序将请求传递给该对象</p></blockquote></blockquote><ul><li>桥接</li></ul><p><strong>可将一个大类或一系列紧密相关的类拆分为抽象和实现两个独立的层次结构，从而在开发时分别使用</strong></p><blockquote><p>如果你想要拆分或重组一个具有多重功能的庞杂类（例如能与多个数据库服务器进行交互的类）</p><p>如果你希望在几个独立维度上扩展一个类</p><p>如果你需要在运行时切换不同实现方法</p><blockquote><p>场景：遥控器与电子设备</p><p>方式：不必将它们联系在一起制作，单独的去制作遥控器 再 单独的制作电子设备，通过客户端实现其通用接口使其产生联系</p></blockquote></blockquote><ul><li>组合</li></ul><p><strong>你可以使用它将对象组合成树状结构，并且能像使用独立对象一样使用它们</strong></p><blockquote><p>全部对象继承通用接口，以链表的单向递归形式去设定叶节点来构造树</p><blockquote><p>场景：部队的梯次编制结构</p><p>方式：军事命令由最高层下达， 通过每个层级传递， 直到每位士兵都知道自己应该服从的命令</p></blockquote></blockquote><ul><li>装饰</li></ul><p><strong>允许你通过将对象放入包含行为的特殊封装对象中来为原对象绑定新的行为</strong></p><blockquote><p>继承原对象接口并扩展原对象功能</p><blockquote><p>场景：读取一个文件，并对文件进行 加密或压缩</p><p>行为：一个基础的文件读取类，与两个扩展类(继承)，文件加密文件压缩</p></blockquote></blockquote><ul><li>外观</li></ul><p><strong>能为程序库，框架或其他复杂类提供一个简单的接口</strong></p><blockquote><p>对一个复杂流程提供一些通用的简单处理服务</p><blockquote><p>场景：电话购物</p><p>行为：仓库→包装→发货→送货→纳税… 实际上你只需要同接线员进行沟通说明你购买什么物品其就会按照通用的服务接口进行处理</p></blockquote></blockquote><ul><li>享元</li></ul><p><strong>摒弃了在每个对象中保存所有数据的方式，通过共享多个对象所共有的相同状态，让你能在有限的内存容量中载入更多对象</strong></p><blockquote><p>创建独立的情景类来存储外在状态和对享元对象的引用</p><p>享元对象是不可变的且应该具备一个外部公开的享元工厂</p><blockquote><p>场景：程序上构建一片草原</p><p>行为：每株草都有自己的属性与坐标，它们构成一个复杂对象，但是它们的外形都是相同的，对于外形的描述应该是针对享元对象的引用</p></blockquote></blockquote><ul><li>代理</li></ul><p><strong>让你能够提供对象的代替品或其占位符。代理控制着对于原对象的访问，并允许在将请求提交给对象前后进行一些处理</strong></p><blockquote><p>建议新建一个与原服务对象接口相同的代理类， 然后更新应用以将代理对象传递给所有原始对象客户端。 代理类接收到客户端请求后会创建实际的服务对象， 并将所有工作委派给它</p><p>数据库连接池是数据库的代理信用卡是银行账户的代理</p><p> 延迟初始化(虚拟代理),如果你有一个偶尔使用的重量级服务对象,一直保持该对象运行会消耗系统资源时</p><p>访问控制(保护代理),如果你希望特定的客户端使用服务对象</p><p>本地执行远程服务(远程代理)。适用于服务对象位于远程服务器上的情形</p><p>记录日志请求(日志记录代理)。适用于当你需要保存对于服务对象的请求历史记录时</p><p>缓存请求结果(缓存代理)。适用于需要缓存客户请求结果并对缓存生命周期进行管理时，特别是当返回结果的体积非常大时</p><p>智能引用。可在没有客户端使用某个重量级对象时立即销毁该对象</p></blockquote><ul><li>责任链</li><li>命令</li><li>迭代器</li><li>中介者</li><li>备忘录</li><li>观察者</li><li>状态</li><li>策略</li><li>模板方法</li></ul><p><strong>在超类中定义一个算法框架，允许子类在不修改结构的情况下重写算法的特定步骤</strong></p><blockquote><p>只希望客户端扩展某个特定算法步骤，而不是整个算法或其结构时</p><p>多个类的算法除一些细微不同之外几乎完全一样时</p></blockquote><p>类比：真实世界的房屋构造，其是制式规整的，但你可以对其制式的每一个环节做一些微小的改动</p><ul><li>访问者</li></ul><p><strong>将算法与其作用的对象隔离开来</strong></p><blockquote><p>一个保险推销员：如果建筑是居民楼， 他会推销医疗保险如果建筑是银行， 他会推销失窃保险如果建筑是咖啡厅， 他会推销火灾和洪水保险</p><p>对一个复杂对象结构中的所有元素执行某些操作</p><p>清理辅助行为的业务逻辑</p><p>某个行为仅在类层次结构中的一些类中有意义，而在其他类中没有意义时</p></blockquote><h1 id="设计模式"><a href="#设计模式" class="headerlink" title="设计模式"></a>设计模式</h1><p><strong>来源地址：</strong><a class="link"   href="https://refactoringguru.cn/design-patterns" >常见设计模式<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p><h2 id="创建型模式"><a href="#创建型模式" class="headerlink" title="创建型模式"></a>创建型模式</h2><h3 id="工厂-★☆☆"><a href="#工厂-★☆☆" class="headerlink" title="工厂 ★☆☆"></a>工厂 ★☆☆</h3><blockquote><p>在父类中提供一个创建对象的接口以允许子类决定实例化对象的类型</p></blockquote><p>一个物流公司会将货品从出库到买家手中分为几个特定作业阶段，不管物流方式是采取公路&#x2F;铁路&#x2F;水路…运输都经由此过程</p><table><thead><tr><th>优点 √</th><th>缺点 ×</th></tr></thead><tbody><tr><td>避免紧耦合：创建者和具体产品间<br>单一职责：更易维护<br>开闭原则：利于扩展</td><td>代码复杂度加大：引入过多子类</td></tr></tbody></table><p><strong>举例</strong></p><p>种一棵果树并采摘其果实</p><p>产品接口：果树</p><p>产品实现类(继承产品接口)：苹果树类，橘子树类</p><p>工厂抽象类：采摘（定义两个方法,普通方法采摘动作,抽象方法种植果树）</p><p>具体创建者：苹果树采摘类，橘子树采摘类（实现抽象方法种植不同的果树）</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 产品接口类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">FruitTree</span>&#123;</span><br><span class="line">     <span class="keyword">void</span> <span class="title function_">fertilization</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 产品接口实现类1</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AppleTree</span> <span class="keyword">implements</span> <span class="title class_">FruitTree</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">fertilization</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;施肥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 产品接口实现类2</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">OrangeTree</span> <span class="keyword">implements</span> <span class="title class_">FruitTree</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">fertilization</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;施肥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 工厂抽象类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Factory</span>&#123;</span><br><span class="line">    <span class="keyword">abstract</span> FruitTree <span class="title function_">createTree</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">picking</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">FruitTree</span> <span class="variable">tree</span> <span class="operator">=</span> createTree();</span><br><span class="line">        tree.fertilization();</span><br><span class="line">        System.out.println(<span class="string">&quot;先施肥然后采摘了&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 具体的创建者1</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CreateAppleAction</span> <span class="keyword">extends</span> <span class="title class_">Factory</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    FruitTree <span class="title function_">createTree</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">AppleTree</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 具体的创建者2</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CreateOrangeAction</span> <span class="keyword">extends</span> <span class="title class_">Factory</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    FruitTree <span class="title function_">createTree</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">OrangeTree</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="抽象工厂-★★☆"><a href="#抽象工厂-★★☆" class="headerlink" title="抽象工厂 ★★☆"></a>抽象工厂 ★★☆</h3><blockquote><p>创建一系列相关的对象，而无需指定其具体的实现类</p></blockquote><p>家具工厂，为同类产品的不同风格提供统一规范，由各自系列去实现此规范来推出该系列风格产品</p><table><thead><tr><th>优点 √</th><th>缺点 ×</th></tr></thead><tbody><tr><td>避免紧耦合：创建者和具体产品间<br>单一职责：更易维护<br>开闭原则：利于扩展<br>兼容性：同一抽象工厂的产品相互匹配</td><td>代码复杂度加大：引入过多子类</td></tr></tbody></table><p><strong>举例</strong></p><p>基于工厂的扩展，基础部分同工厂一致，是增量的行为</p><p>接上述：手动创建具体的果树对象变为增加一层包装仅使用抽象工厂行为</p><p>通过某些条件(参数，配置等)来选择性创建具体的工厂对象</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 包装容器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Application</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> FruitTree tree;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Application</span><span class="params">(Factory factory)</span> &#123;</span><br><span class="line">        tree = factory.createTree();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 调用示例</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Demo</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">(<span class="type">int</span> money)</span>&#123;</span><br><span class="line">        <span class="comment">// 根据传入的金钱来判断</span></span><br><span class="line">        Application application;</span><br><span class="line">        <span class="comment">// 大于十块钱就种苹果树 否则 橘子树</span></span><br><span class="line">        <span class="keyword">if</span> (money &gt; <span class="number">10</span>)&#123;</span><br><span class="line">            application = <span class="keyword">new</span> <span class="title class_">Application</span>(<span class="keyword">new</span> <span class="title class_">CreateAppleAction</span>());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            application = <span class="keyword">new</span> <span class="title class_">Application</span>(<span class="keyword">new</span> <span class="title class_">CreateOrangeAction</span>());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 施肥</span></span><br><span class="line">        application.tree.fertilization();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="生成器-建造者-★★☆"><a href="#生成器-建造者-★★☆" class="headerlink" title="生成器(建造者) ★★☆"></a>生成器(建造者) ★★☆</h3><blockquote><p>分步创建复杂对象。该模式允许使用相同的创建代码生成不同类型和形式的对象</p></blockquote><p>建造房屋时，除了房屋主体架构，其余的部件都是“可选的”</p><table><thead><tr><th>优点 √</th><th>缺点 ×</th></tr></thead><tbody><tr><td>小粒度：分步创建对象,暂缓创建步骤或递归运行创建步骤。<br>可复用：生成不同形式的产品时， 可以复用相同的制造代码。<br>单一职责：将复杂构造代码从产品的业务逻辑中分离出来</td><td>代码复杂度加大：引入过多类</td></tr></tbody></table><p><strong>举例</strong></p><p>将各种可选择的步骤组件化，分步调用</p><p>去一家面馆要了一碗面，喊老板加一个鸡蛋，又喊老板加一块肉，又喊老板加一点辣椒</p><p>对于上述而言，后续步骤都是组件(可选的)，此时应用生成器来分步生成</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">A</span> <span class="variable">a</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">A</span>();</span><br><span class="line">        a.test().test2().test().test2();</span><br><span class="line">        System.out.println(a.b.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> ArrayList&lt;Integer&gt; b;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">A</span><span class="params">()</span>&#123;</span><br><span class="line">       b = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(<span class="number">16</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> A <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        b.add(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> A <span class="title function_">test2</span><span class="params">()</span>&#123;</span><br><span class="line">        b.add(<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>最为简单的写法,不多赘述,类比SpringCloud的QueryWrapper或Laravel的Builder</p><h3 id="原型-★☆☆"><a href="#原型-★☆☆" class="headerlink" title="原型 ★☆☆"></a>原型 ★☆☆</h3><blockquote><p>复制已有对象，而又无需使代码依赖它们所属的类</p></blockquote><p>现实生活中， 产品在得到大规模生产前会使用原型进行各种测试。 但在这种情况下， 原型只是一种被动的工具， 不参与任何真正的生产活动。</p><table><thead><tr><th>优点 √</th><th>缺点 ×</th></tr></thead><tbody><tr><td>解耦：克隆对象而无需与它们所属的具体类相耦合<br>可复用：克隆预生成原型,避免反复运行初始化代码<br>简洁：更方便的生成复杂对象<br>扩展：用继承以外的方式来处理复杂对象的不同配置</td><td>复杂度：克隆包含循环引用的复杂对象可能会非常麻烦</td></tr></tbody></table><p><strong>举例</strong></p><p>去面馆吃饭，一碗煮好的纯面放在桌上(抽象的原型)，抽象一个克隆方法，建立构造方法传递原型对象，克隆此对象内部属性</p><p>要了一碗牛肉面，继承这个原型，在这个原型基础上加上牛肉汤与牛肉等配料，且实现克隆方法创建新的对象传入当前对象</p><p>建立构造方法，实现父类，仅克隆此类扩展部分</p><p>再要一碗牛肉面时通过第一碗牛肉面克隆，返回原型再类型强转回具体类</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 面条</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Noodle</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String bowl;</span><br><span class="line">    <span class="keyword">private</span> String ramen;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Noodle</span><span class="params">()</span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Noodle</span><span class="params">(Noodle noodle)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.bowl = noodle.bowl;</span><br><span class="line">        <span class="built_in">this</span>.ramen = noodle.ramen;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> Noodle <span class="title function_">clone</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 牛肉面</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BeefNoodle</span> <span class="keyword">extends</span> <span class="title class_">Noodle</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String beefSoup;</span><br><span class="line">    <span class="keyword">private</span> String beef;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BeefNoodle</span><span class="params">()</span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BeefNoodle</span><span class="params">(BeefNoodle beefNoodle)</span>&#123;</span><br><span class="line">        <span class="built_in">super</span>(beefNoodle);</span><br><span class="line">        <span class="built_in">this</span>.beefSoup = beefNoodle.beefSoup;</span><br><span class="line">        <span class="built_in">this</span>.beef = beefNoodle.beef;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Noodle <span class="title function_">clone</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BeefNoodle</span>(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="单例-★☆☆"><a href="#单例-★☆☆" class="headerlink" title="单例 ★☆☆"></a>单例 ★☆☆</h3><blockquote><p>保证一个类只有一个实例，并提供一个访问该实例的全局节点</p></blockquote><p>政府是单例模式的一个很好的示例。 一个国家只有一个官方政府。 不管组成政府的每个人的身份是什么，  “某政府” 这一称谓总是鉴别那些掌权者的全局访问节点。</p><table><thead><tr><th>优点 √</th><th>缺点 ×</th></tr></thead><tbody><tr><td>唯一：你可以保证一个类只有一个实例<br>可控：你获得了一个指向该实例的全局访问节点<br>方便：仅在首次请求单例对象时对其进行初始化</td><td>违反单一职责<br>掩盖不良设计：各组件之间互相了解过多<br>并发性：多线程环境下需要特殊处理,避免多个线程多次创建单例对象<br>测试困难：单元测试可能会比较困难， 因为许多测试框架以基于继承的方式创建模拟对象</td></tr></tbody></table><p><strong>举例</strong></p><p>政府就是一个很好的例子，无论在哪个节点哪个线程上访问，其都是唯一的</p><p>不管组成政府的每个人的身份是什么，  “某政府” 这一称谓总是鉴别那些掌权者的全局访问节点</p><ul><li>单线程单例</li></ul><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;</span><br><span class="line">    <span class="keyword">public</span> String value;</span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">(String value)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstance</span><span class="params">(String value)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="literal">null</span>) &#123;</span><br><span class="line">            instance = <span class="keyword">new</span> <span class="title class_">Singleton</span>(value);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><ul><li>多线程单例</li></ul><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line">    <span class="comment">// 加volatile关键字来确保每次读值的即时性</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> Singleton instance;</span><br><span class="line">    <span class="keyword">public</span> String value;</span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">(String value)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstance</span><span class="params">(String value)</span> &#123;</span><br><span class="line">        <span class="comment">// 局部赋值一次是因为性能问题，被volatile修饰后的变量访问性能是低下的</span></span><br><span class="line">        <span class="comment">// 此能确保在当前线程内的操作访问是一次性的，这个性能差异可能会产生100倍以上的区别</span></span><br><span class="line">        <span class="type">Singleton</span> <span class="variable">result</span> <span class="operator">=</span> instance;</span><br><span class="line">        <span class="keyword">if</span> (result != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 启用同步锁进行《双重检查锁定》来确保并发场景下的实例唯一性</span></span><br><span class="line">        <span class="keyword">synchronized</span>(Singleton.class) &#123;</span><br><span class="line">            <span class="keyword">if</span> (instance == <span class="literal">null</span>) &#123;</span><br><span class="line">                instance = <span class="keyword">new</span> <span class="title class_">Singleton</span>(value);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> instance;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="结构型模式"><a href="#结构型模式" class="headerlink" title="结构型模式"></a>结构型模式</h2><h3 id="适配器-★☆☆"><a href="#适配器-★☆☆" class="headerlink" title="适配器 ★☆☆"></a>适配器 ★☆☆</h3><blockquote><p>让接口不兼容的对象能够相互合作</p></blockquote><p>如果你是第一次从美国到欧洲旅行， 那么在给笔记本充电时可能会大吃一惊。 不同国家的电源插头和插座标准不同。 美国插头和德国插座不匹配。 同时提供美国标准插座和欧洲标准插头的电源适配器可以解决你的难题。</p><table><thead><tr><th>优点 √</th><th>缺点 ×</th></tr></thead><tbody><tr><td>单一职责：接口或转换逻辑从主业务代码中抽离<br>开闭原则：在不修改现有客户端代码的情况下在程序中添加新类型的适配器</td><td>代码整体复杂度增加：需要新增一系列接口和类。 有时直接更改服务类使其与其他代码兼容会更简单</td></tr></tbody></table><p><strong>举例</strong></p><p>日常使用的手机充电线转接头，一个USB头的接口市面上大多分为三种：Micro USB(老式安卓)，Type-C(新型安卓)，Lightning(苹果)</p><p>如果我们忘带充电器或者更换手机，合适的接口充电问题将成为我们的障碍，这时需要一个《<strong>适配器</strong>》</p><p>下方用钉子来类比，圆孔只能插入圆钉，使用适配器将方钉来转换圆钉</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 圆孔</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RoundHole</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> radius;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">RoundHole</span><span class="params">(<span class="type">double</span> radius)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.radius = radius;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getRadius</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> radius;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">fits</span><span class="params">(RoundPeg peg)</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> result;</span><br><span class="line">        result = (<span class="built_in">this</span>.getRadius() &gt;= peg.getRadius());</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 圆钉</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RoundPeg</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> radius;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">RoundPeg</span><span class="params">()</span> &#123;&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">RoundPeg</span><span class="params">(<span class="type">double</span> radius)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.radius = radius;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getRadius</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> radius;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 方钉</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SquarePeg</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> width;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SquarePeg</span><span class="params">(<span class="type">double</span> width)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.width = width;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getWidth</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> width;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getSquare</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">double</span> result;</span><br><span class="line">        result = Math.pow(<span class="built_in">this</span>.width, <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 方钉适配器（转换为圆钉）</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SquarePegAdapter</span> <span class="keyword">extends</span> <span class="title class_">RoundPeg</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> SquarePeg peg;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SquarePegAdapter</span><span class="params">(SquarePeg peg)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.peg = peg;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getRadius</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">double</span> result;</span><br><span class="line">        result = (Math.sqrt(Math.pow((peg.getWidth() / <span class="number">2</span>), <span class="number">2</span>) * <span class="number">2</span>));</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="桥接-★★★"><a href="#桥接-★★★" class="headerlink" title="桥接 ★★★"></a>桥接 ★★★</h3><blockquote><p>让一个大类或紧密相关的类拆分为抽象和实现两个独立层次结构，从而能在开发时分别使用</p></blockquote><p>实现了同类规范的家电与其控制器（遥控器）是分离的且可以互相共用的</p><table><thead><tr><th>优点 √</th><th>缺点 ×</th></tr></thead><tbody><tr><td><em>业务解耦</em>：创建与平台无关的类和程序<br><em>代码解耦</em>：客户端代码仅与高层抽象部分进行互动， 不会接触到平台的详细信息<br><em>开闭</em>原则： 新增抽象部分和实现部分， 且它们之间不会相互影响<br><em>单一职责</em>：抽象部分专注于处理高层逻辑， 实现部分处理平台细节</td><td>对高内聚的类使用该模式可能会让代码更加复杂</td></tr></tbody></table><p><strong>举例</strong></p><p>设备和远程控制之间的桥接</p><p>设备抽象接口：Device</p><p>具体实现设备：Tv,Radio</p><p>远程控制器抽象接口：Remote</p><p>具体实现控制器：BasicRemote,AdvancedRemote</p><p>上述即为抽象设备与控制器的公有功能并通过接口桥接其具体实现类</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 设备抽象接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Device</span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置音量</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">setVolume</span><span class="params">(<span class="type">int</span> volume)</span>;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">getVolume</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 设备实现类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Tv</span> <span class="keyword">implements</span> <span class="title class_">Device</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">volume</span> <span class="operator">=</span> <span class="number">30</span>;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setVolume</span><span class="params">(<span class="type">int</span> volume)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.volume = volume &gt; <span class="number">100</span> ? <span class="number">100</span> : Math.max(volume, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getVolume</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> volume;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Radio</span> <span class="keyword">implements</span> <span class="title class_">Device</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">volume</span> <span class="operator">=</span> <span class="number">20</span>;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setVolume</span><span class="params">(<span class="type">int</span> volume)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.volume = volume &gt; <span class="number">120</span> ? <span class="number">120</span> : Math.max(volume, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getVolume</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> volume;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 控制器抽象接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Remote</span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 减小音量</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">volumeDown</span><span class="params">()</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 加大音量</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">volumeUp</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 控制器实现类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BasicRemote</span> <span class="keyword">implements</span> <span class="title class_">Remote</span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> Device device;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BasicRemote</span><span class="params">(Device device)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.device = device;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">volumeDown</span><span class="params">()</span> &#123;</span><br><span class="line">        device.setVolume(device.getVolume() - <span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">volumeUp</span><span class="params">()</span> &#123;</span><br><span class="line">        device.setVolume(device.getVolume() + <span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AdvancedRemote</span> <span class="keyword">extends</span> <span class="title class_">BasicRemote</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">AdvancedRemote</span><span class="params">(Device device)</span>&#123;</span><br><span class="line">        <span class="built_in">super</span>(device);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 静音</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">mute</span><span class="params">()</span> &#123;</span><br><span class="line">        device.setVolume(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="组合-★★☆"><a href="#组合-★★☆" class="headerlink" title="组合 ★★☆"></a>组合 ★★☆</h3><blockquote><p>你可以使用它将对象组合成树状结构，并且能像独立对象一样使用它们</p></blockquote><p>大部分国家的军队都采用层次结构管理。 每支部队包括几个师， 师由旅构成， 旅由团构成， 团可以继续划分为排。 最后， 每个排由一小队实实在在的士兵组成。 军事命令由最高层下达， 通过每个层级传递， 直到每位士兵都知道自己应该服从的命令。</p><table><thead><tr><th>优点 √</th><th>缺点 ×</th></tr></thead><tbody><tr><td>利用多态和递归机制更方便地使用复杂树结构<br><em>开闭原则</em>： 无需更改现有代码， 可以在应用中添加新元素， 使其成为对象树的一部分</td><td>对于功能差异较大的类， 提供公共接口或许会有困难。 在特定情况下， 你需要过度一般化组件接口， 使其变得令人难以理解</td></tr></tbody></table><p>举例：</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Shape</span>&#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">draw</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BaseShape</span> <span class="keyword">implements</span> <span class="title class_">Shape</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">draw</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;绘制形状&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 打印形状</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dot</span> <span class="keyword">extends</span> <span class="title class_">BaseShape</span>&#123;</span><br><span class="line">    Dot(<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">        <span class="built_in">this</span>.draw(x, y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">draw</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.draw(x, y);</span><br><span class="line">        System.out.println(<span class="string">&quot;绘制一个点&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span>  <span class="title class_">Circle</span> <span class="keyword">extends</span> <span class="title class_">BaseShape</span> &#123;</span><br><span class="line">    Circle(<span class="type">int</span> x, <span class="type">int</span> y, String color) &#123;</span><br><span class="line">        <span class="built_in">this</span>.draw(x, y);</span><br><span class="line">        <span class="built_in">this</span>.setColor(color);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">draw</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.draw(x, y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setColor</span><span class="params">(String color)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;上色&quot;</span>+color);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CompoundShape</span> <span class="keyword">extends</span> <span class="title class_">BaseShape</span> &#123;</span><br><span class="line">    CompoundShape(Shape... components) &#123;</span><br><span class="line">        <span class="keyword">for</span> (Shape component : components) &#123;</span><br><span class="line">            <span class="built_in">this</span>.add(component);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(Shape component)</span> &#123;</span><br><span class="line">        component.print();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">CompoundShape</span>(</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Dot</span>(<span class="number">1</span>, <span class="number">2</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Circle</span>(<span class="number">3</span>, <span class="number">4</span>, <span class="string">&quot;red&quot;</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">CompoundShape</span>(</span><br><span class="line">                    <span class="keyword">new</span> <span class="title class_">Dot</span>(<span class="number">5</span>, <span class="number">6</span>)</span><br><span class="line">            )</span><br><span class="line">    ).print();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>基于抽象做基础实现后可以以递归或树来随意实现组合类</p><h3 id="装饰-★★☆"><a href="#装饰-★★☆" class="headerlink" title="装饰 ★★☆"></a>装饰 ★★☆</h3><blockquote><p>允许你通过将对象放入包含行为的特殊封装对象中来为原对象绑定新的行为</p></blockquote><p>穿衣服是使用装饰的一个例子。 觉得冷时， 你可以穿一件毛衣。 如果穿毛衣还觉得冷， 你可以再套上一件夹克。 如果遇到下雨， 你还可以再穿一件雨衣。 所有这些衣物都 “扩展” 了你的基本行为， 但它们并不是你的一部分， 如果你不再需要某件衣物， 可以方便地随时脱掉。</p><table><thead><tr><th>优点 √</th><th>缺点 ×</th></tr></thead><tbody><tr><td>无需创建新的子类即可扩展对象行为<br />运行时添加或删除对象的功能<br />多个装饰封装对象来组合几种行为<br />单一职责。实现许多不同行为的大类拆分为多个较小的类</td><td>封装器栈中删除特定封装器比较困难<br />实现行为不受装饰栈顺序影响的装饰比较困难<br />各层的初始化配置代码看上去可能会很糟糕</td></tr></tbody></table><p>**用法：**装饰器标准用法是一个栈，如何“装饰的”必须按照顺序“拆分”，类比穿衣服: 内衣-内衬-外衣-雨衣  脱衣服则必须一层层脱</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.nio.charset.StandardCharsets;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.Deflater;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.DeflaterOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.InflaterInputStream;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 数据装饰器 </span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Decorator</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DataSource</span> &#123;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">writeData</span><span class="params">(String data)</span>;</span><br><span class="line">        String <span class="title function_">readData</span><span class="params">()</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">FileDataSource</span> <span class="keyword">implements</span> <span class="title class_">DataSource</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">FileDataSource</span><span class="params">(String name)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">writeData</span><span class="params">(String data)</span> &#123;</span><br><span class="line">            <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(name);</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="type">OutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(file);</span><br><span class="line">                fos.write(data.getBytes(StandardCharsets.UTF_8), <span class="number">0</span>, data.length());</span><br><span class="line">            &#125;<span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">readData</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="type">char</span>[] buff = <span class="literal">null</span>;</span><br><span class="line">            <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(name);</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="type">FileReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileReader</span>(file);</span><br><span class="line">                buff = <span class="keyword">new</span> <span class="title class_">char</span>[(<span class="type">int</span>)file.length()];</span><br><span class="line">                reader.read(buff);</span><br><span class="line">            &#125;<span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(buff);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">DataSourceDecorator</span> <span class="keyword">implements</span> <span class="title class_">DataSource</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> DataSource wrapper;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">DataSourceDecorator</span> <span class="params">(DataSource wrapper)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.wrapper = wrapper;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">writeData</span><span class="params">(String data)</span> &#123;</span><br><span class="line">            wrapper.writeData(data);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">readData</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> wrapper.readData();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">EncryptionDataSourceDecorator</span> <span class="keyword">extends</span> <span class="title class_">DataSourceDecorator</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">EncryptionDataSourceDecorator</span><span class="params">(DataSource wrapper)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(wrapper);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">writeData</span><span class="params">(String data)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>.writeData(encode(data));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">readData</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> decode(<span class="built_in">super</span>.readData());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> String <span class="title function_">encode</span><span class="params">(String data)</span> &#123;</span><br><span class="line">            <span class="type">byte</span>[] result = data.getBytes(StandardCharsets.UTF_8);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; result.length; i++) &#123;</span><br><span class="line">                result[i] += (<span class="type">byte</span>)<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> Base64.getEncoder().encodeToString(result);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> String <span class="title function_">decode</span><span class="params">(String data)</span> &#123;</span><br><span class="line">            <span class="type">byte</span>[] result = Base64.getDecoder().decode(data);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; result.length; i++) &#123;</span><br><span class="line">                result[i] -= (<span class="type">byte</span>)<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(result);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">CompressionDecorator</span> <span class="keyword">extends</span> <span class="title class_">DataSourceDecorator</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">CompressionDecorator</span><span class="params">(DataSource wrapper)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(wrapper);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> <span class="variable">compLevel</span> <span class="operator">=</span> <span class="number">6</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getCompressionLevel</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> compLevel;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCompressionLevel</span><span class="params">(<span class="type">int</span> level)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.compLevel = level;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">writeData</span><span class="params">(String data)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>.writeData(compress(data));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">readData</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> decompress(<span class="built_in">super</span>.readData());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">private</span> String <span class="title function_">compress</span><span class="params">(String stringData)</span> &#123;</span><br><span class="line">            <span class="type">byte</span>[] data = stringData.getBytes(StandardCharsets.UTF_8);</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="type">ByteArrayOutputStream</span> <span class="variable">bout</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>(<span class="number">512</span>);</span><br><span class="line">                <span class="type">DeflaterOutputStream</span> <span class="variable">dos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DeflaterOutputStream</span>(bout, <span class="keyword">new</span> <span class="title class_">Deflater</span>(compLevel));</span><br><span class="line">                dos.write(data);</span><br><span class="line">                dos.close();</span><br><span class="line">                bout.close();</span><br><span class="line">                <span class="keyword">return</span> Base64.getEncoder().encodeToString(bout.toByteArray());</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">private</span> String <span class="title function_">decompress</span><span class="params">(String compressData)</span> &#123;</span><br><span class="line">            <span class="type">byte</span>[] data = Base64.getDecoder().decode(compressData);</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="type">InputStream</span> <span class="variable">i</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(data);</span><br><span class="line">                <span class="type">InflaterInputStream</span> <span class="variable">iin</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InflaterInputStream</span>(i);</span><br><span class="line">                <span class="type">ByteArrayOutputStream</span> <span class="variable">bout</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>(<span class="number">512</span>);</span><br><span class="line">                <span class="type">int</span> b;</span><br><span class="line">                <span class="keyword">while</span> ((b = iin.read()) != -<span class="number">1</span>) &#123;</span><br><span class="line">                    bout.write(b);</span><br><span class="line">                &#125;</span><br><span class="line">                i.close();</span><br><span class="line">                iin.close();</span><br><span class="line">                bout.close();</span><br><span class="line">                <span class="keyword">return</span> bout.toString();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">salaryRecords</span> <span class="operator">=</span> <span class="string">&quot;测试&quot;</span>;</span><br><span class="line">        <span class="type">DataSourceDecorator</span> <span class="variable">decorator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CompressionDecorator</span>(<span class="keyword">new</span> <span class="title class_">EncryptionDataSourceDecorator</span>(<span class="keyword">new</span> <span class="title class_">FileDataSource</span>(<span class="string">&quot;decorator.txt&quot;</span>)));</span><br><span class="line">        decorator.writeData(salaryRecords);</span><br><span class="line">        <span class="type">DataSource</span> <span class="variable">plain</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileDataSource</span>(<span class="string">&quot;decorator.txt&quot;</span>);</span><br><span class="line">        System.out.println(salaryRecords);</span><br><span class="line">        System.out.println(plain.readData());</span><br><span class="line">        System.out.println(decorator.readData());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h3 id="外观-★★☆"><a href="#外观-★★☆" class="headerlink" title="外观 ★★☆"></a>外观 ★★☆</h3><blockquote><p>能为程序库，框架或其他复杂类提供一个简单的接口</p></blockquote><p>当你通过电话给商店下达订单时， 接线员就是该商店的所有服务和部门的外观。 接线员为你提供了一个同购物系统、 支付网关和各种送货服务进行互动的简单语音接口。</p><table><thead><tr><th>优点 √</th><th>缺点 ×</th></tr></thead><tbody><tr><td>让自己的代码独立于复杂子系统</td><td>外观可能成为与程序中所有类都耦合的上帝对象</td></tr></tbody></table><p>**用法：**外观的本质是为了简化实际使用者的操作的同时不影响扩展复杂&#x2F;自定义的操作行为。类比本存储库的Golang程序的php调用包Export方案</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 视频转换装饰器</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Facade</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">VideoFile</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">VideoFile</span> <span class="params">(String name)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">            <span class="built_in">this</span>.codecType = name.substring(name.indexOf(<span class="string">&quot;.&quot;</span>) + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">private</span> String codecType;</span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getCodecType</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> codecType;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> name;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">interface</span> <span class="title class_">Codec</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MPEG4CompressionCodec</span> <span class="keyword">implements</span> <span class="title class_">Codec</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">String</span> <span class="variable">type</span> <span class="operator">=</span> <span class="string">&quot;mp4&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">OggCompressionCodec</span> <span class="keyword">implements</span> <span class="title class_">Codec</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">String</span> <span class="variable">type</span> <span class="operator">=</span> <span class="string">&quot;ogg&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">CodecFactory</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> Codec <span class="title function_">extract</span><span class="params">(VideoFile file)</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">type</span> <span class="operator">=</span> file.getCodecType();</span><br><span class="line">            <span class="keyword">if</span> (type.equals(<span class="string">&quot;mp4&quot;</span>)) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;mpeg&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MPEG4CompressionCodec</span>();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;ogg&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">OggCompressionCodec</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">BitrateReader</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> VideoFile <span class="title function_">read</span><span class="params">(VideoFile file, Codec codec)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;bitrate read&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> file;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> VideoFile <span class="title function_">convert</span><span class="params">(VideoFile buffer, Codec codec)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;bitrate convert&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> buffer;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">AudioMixer</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> File <span class="title function_">fix</span><span class="params">(VideoFile result)</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;audioMixer&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;tmp&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">VideoConversionFacade</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> File <span class="title function_">conversionVideo</span><span class="params">(String filename, String format)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;facade&quot;</span>);</span><br><span class="line">            <span class="type">VideoFile</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">VideoFile</span>(filename);</span><br><span class="line">            <span class="type">Codec</span> <span class="variable">sourceCodec</span> <span class="operator">=</span> CodecFactory.extract(file);</span><br><span class="line">            Codec destinationCodec;</span><br><span class="line">            <span class="keyword">if</span> (format.equals(<span class="string">&quot;mp4&quot;</span>)) &#123;</span><br><span class="line">                destinationCodec = <span class="keyword">new</span> <span class="title class_">MPEG4CompressionCodec</span>();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                destinationCodec = <span class="keyword">new</span> <span class="title class_">OggCompressionCodec</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">VideoFile</span> <span class="variable">buffer</span> <span class="operator">=</span> BitrateReader.read(file, sourceCodec);</span><br><span class="line">            <span class="type">VideoFile</span> <span class="variable">intermediateResult</span> <span class="operator">=</span> BitrateReader.convert(buffer, destinationCodec);</span><br><span class="line">            <span class="type">File</span> <span class="variable">result</span> <span class="operator">=</span> (<span class="keyword">new</span> <span class="title class_">AudioMixer</span>()).fix(intermediateResult);</span><br><span class="line">            System.out.println(<span class="string">&quot;completed&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">VideoConversionFacade</span> <span class="variable">conversion</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">VideoConversionFacade</span>();</span><br><span class="line">        <span class="type">File</span> <span class="variable">newFile</span> <span class="operator">=</span> conversion.conversionVideo(<span class="string">&quot;youtubevideo.ogg&quot;</span>,<span class="string">&quot;mp4&quot;</span>);</span><br><span class="line">        System.out.println(newFile.getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="享元-★★★"><a href="#享元-★★★" class="headerlink" title="享元 ★★★"></a>享元 ★★★</h3><blockquote><p>摒弃了在每个对象中保存所有数据的方式，通过共享多个对象所共有的相同状态，让你能在有限的内存容量中载入更多的对象</p></blockquote><p>游戏中的场景元素是最常用的经典享元，它们的属性是同一对象</p><table><thead><tr><th>优点 √</th><th>缺点 ×</th></tr></thead><tbody><tr><td>程序中存在大量相似对象，那么你可以节省大量内存</td><td>牺牲执行速度来换取内存，因为他人每次调用享元方法时都需要重新计算部分场景数据<br />代码会变得复杂：“为什么要像这样拆分一个实体的状态”</td></tr></tbody></table><p>**用法：**多用于游戏领域，大量共用的场景属性复用</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 渲染1000000棵树来构建整片森林</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Flyweight</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Tree</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> x;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> y;</span><br><span class="line">        <span class="keyword">private</span> TreeType type;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Tree</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, TreeType type)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.x = x;</span><br><span class="line">            <span class="built_in">this</span>.y = y;</span><br><span class="line">            <span class="built_in">this</span>.type = type;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">draw</span><span class="params">(Graphics g)</span> &#123;</span><br><span class="line">            type.draw(g, x, y);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">TreeType</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">private</span> Color color;</span><br><span class="line">        <span class="keyword">private</span> String otherTreeData;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">TreeType</span><span class="params">(String name, Color color, String otherTreeData)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">            <span class="built_in">this</span>.color = color;</span><br><span class="line">            <span class="built_in">this</span>.otherTreeData = otherTreeData;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">draw</span><span class="params">(Graphics g, <span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">            g.setColor(Color.BLACK);</span><br><span class="line">            g.fillRect(x - <span class="number">1</span>, y, <span class="number">3</span>, <span class="number">5</span>);</span><br><span class="line">            g.setColor(color);</span><br><span class="line">            g.fillOval(x - <span class="number">5</span>, y - <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">TreeFactory</span> &#123;</span><br><span class="line">        <span class="keyword">static</span> Map&lt;String, TreeType&gt; treeTypes = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> TreeType <span class="title function_">getTreeType</span><span class="params">(String name, Color color, String otherTreeData)</span> &#123;</span><br><span class="line">            <span class="type">TreeType</span> <span class="variable">result</span> <span class="operator">=</span> treeTypes.get(name);</span><br><span class="line">            <span class="keyword">if</span> (result == <span class="literal">null</span>) &#123;</span><br><span class="line">                result = <span class="keyword">new</span> <span class="title class_">TreeType</span>(name, color, otherTreeData);</span><br><span class="line">                treeTypes.put(name, result);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Forest</span> <span class="keyword">extends</span> <span class="title class_">JFrame</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> List&lt;Tree&gt; trees = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">plantTree</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, String name, Color color, String otherTreeData)</span> &#123;</span><br><span class="line">            <span class="type">TreeType</span> <span class="variable">type</span> <span class="operator">=</span> TreeFactory.getTreeType(name, color, otherTreeData);</span><br><span class="line">            <span class="type">Tree</span> <span class="variable">tree</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Tree</span>(x, y, type);</span><br><span class="line">            trees.add(tree);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">paint</span><span class="params">(Graphics graphics)</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (Tree tree : trees) &#123;</span><br><span class="line">                tree.draw(graphics);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="variable">CANVAS_SIZE</span> <span class="operator">=</span> <span class="number">500</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="variable">TREES_TO_DRAW</span> <span class="operator">=</span> <span class="number">1000000</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="variable">TREE_TYPES</span> <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Forest</span> <span class="variable">forest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Forest</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; Math.floor(TREES_TO_DRAW / TREE_TYPES); i++) &#123;</span><br><span class="line">            forest.plantTree(random(<span class="number">0</span>, CANVAS_SIZE), random(<span class="number">0</span>, CANVAS_SIZE),</span><br><span class="line">                    <span class="string">&quot;Summer Oak&quot;</span>, Color.GREEN, <span class="string">&quot;Oak texture stub&quot;</span>);</span><br><span class="line">            forest.plantTree(random(<span class="number">0</span>, CANVAS_SIZE), random(<span class="number">0</span>, CANVAS_SIZE),</span><br><span class="line">                    <span class="string">&quot;Autumn Oak&quot;</span>, Color.ORANGE, <span class="string">&quot;Autumn Oak texture stub&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        forest.setSize(CANVAS_SIZE, CANVAS_SIZE);</span><br><span class="line">        forest.setVisible(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(TREES_TO_DRAW + <span class="string">&quot; trees drawn&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;---------------------&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;Memory usage:&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;Tree size (8 bytes) * &quot;</span> + TREES_TO_DRAW);</span><br><span class="line">        System.out.println(<span class="string">&quot;+ TreeTypes size (~30 bytes) * &quot;</span> + TREE_TYPES + <span class="string">&quot;&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;---------------------&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;Total: &quot;</span> + ((TREES_TO_DRAW * <span class="number">8</span> + TREE_TYPES * <span class="number">30</span>) / <span class="number">1024</span> / <span class="number">1024</span>) +</span><br><span class="line">                <span class="string">&quot;MB (instead of &quot;</span> + ((TREES_TO_DRAW * <span class="number">38</span>) / <span class="number">1024</span> / <span class="number">1024</span>) + <span class="string">&quot;MB)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">random</span><span class="params">(<span class="type">int</span> min, <span class="type">int</span> max)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> min + (<span class="type">int</span>) (Math.random() * ((max - min) + <span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="代理-★★☆"><a href="#代理-★★☆" class="headerlink" title="代理 ★★☆"></a>代理 ★★☆</h3><blockquote><p>让你能够提供对象的替代品或其占位符。代理控制着对于原对象的访问，并允许在将请求提交给对象前后进行一些处理</p></blockquote><p>信用卡是银行账户的代理， 银行账户则是一大捆现金的代理。 它们都实现了同样的接口， 均可用于进行支付。 消费者会非常满意， 因为不必随身携带大量现金； 商店老板同样会十分高兴， 因为交易收入能以电子化的方式进入商店的银行账户中， 无需担心存款时出现现金丢失或被抢劫的情况。</p><table><thead><tr><th>优点 √</th><th>缺点 ×</th></tr></thead><tbody><tr><td>你可以在客户端毫无察觉的情况下控制服务对象。<br /> 如果客户端对服务对象的生命周期没有特殊要求， 你可以对生命周期进行管理。<br />即使服务对象还未准备好或不存在， 代理也可以正常工作。<br /><em>开闭原则</em>。 你可以在不对服务或客户端做出修改的情况下创建新代理。</td><td>代码可能会变得复杂， 因为需要新建许多类。<br />服务响应可能会延迟。</td></tr></tbody></table><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Proxy</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Video</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> String id;</span><br><span class="line">        <span class="keyword">public</span> String title;</span><br><span class="line">        <span class="keyword">public</span> String data;</span><br><span class="line"></span><br><span class="line">        Video(String id, String title) &#123;</span><br><span class="line">            <span class="built_in">this</span>.id = id;</span><br><span class="line">            <span class="built_in">this</span>.title = title;</span><br><span class="line">            <span class="built_in">this</span>.data = <span class="string">&quot;Random video.&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ThirdPartyYouTubeLib</span> &#123;</span><br><span class="line">        HashMap&lt;String, Video&gt; <span class="title function_">popularVideos</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">        Video <span class="title function_">getVideo</span><span class="params">(String videoId)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ThirdPartyYouTubeClass</span> <span class="keyword">implements</span> <span class="title class_">ThirdPartyYouTubeLib</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> HashMap&lt;String, Video&gt; <span class="title function_">popularVideos</span><span class="params">()</span> &#123;</span><br><span class="line">            connectToServer(<span class="string">&quot;http://www.youtube.com&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> getRandomVideos();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> Video <span class="title function_">getVideo</span><span class="params">(String videoId)</span> &#123;</span><br><span class="line">            connectToServer(<span class="string">&quot;http://www.youtube.com/&quot;</span> + videoId);</span><br><span class="line">            <span class="keyword">return</span> getSomeVideo(videoId);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// -----------------------------------------------------------------------</span></span><br><span class="line">        <span class="comment">// Fake methods to simulate network activity. They as slow as a real life.</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">random</span><span class="params">(<span class="type">int</span> min, <span class="type">int</span> max)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> min + (<span class="type">int</span>) (Math.random() * ((max - min) + <span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">experienceNetworkLatency</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">randomLatency</span> <span class="operator">=</span> random(<span class="number">5</span>, <span class="number">10</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; randomLatency; i++) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">100</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException ex) &#123;</span><br><span class="line">                    ex.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">connectToServer</span><span class="params">(String server)</span> &#123;</span><br><span class="line">            System.out.print(<span class="string">&quot;Connecting to &quot;</span> + server + <span class="string">&quot;... &quot;</span>);</span><br><span class="line">            experienceNetworkLatency();</span><br><span class="line">            System.out.print(<span class="string">&quot;Connected!&quot;</span> + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> HashMap&lt;String, Video&gt; <span class="title function_">getRandomVideos</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.print(<span class="string">&quot;Downloading populars... &quot;</span>);</span><br><span class="line"></span><br><span class="line">            experienceNetworkLatency();</span><br><span class="line">            HashMap&lt;String, Video&gt; hmap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, Video&gt;();</span><br><span class="line">            hmap.put(<span class="string">&quot;catzzzzzzzzz&quot;</span>, <span class="keyword">new</span> <span class="title class_">Video</span>(<span class="string">&quot;sadgahasgdas&quot;</span>, <span class="string">&quot;Catzzzz.avi&quot;</span>));</span><br><span class="line">            hmap.put(<span class="string">&quot;mkafksangasj&quot;</span>, <span class="keyword">new</span> <span class="title class_">Video</span>(<span class="string">&quot;mkafksangasj&quot;</span>, <span class="string">&quot;Dog play with ball.mp4&quot;</span>));</span><br><span class="line">            hmap.put(<span class="string">&quot;dancesvideoo&quot;</span>, <span class="keyword">new</span> <span class="title class_">Video</span>(<span class="string">&quot;asdfas3ffasd&quot;</span>, <span class="string">&quot;Dancing video.mpq&quot;</span>));</span><br><span class="line">            hmap.put(<span class="string">&quot;dlsdk5jfslaf&quot;</span>, <span class="keyword">new</span> <span class="title class_">Video</span>(<span class="string">&quot;dlsdk5jfslaf&quot;</span>, <span class="string">&quot;Barcelona vs RealM.mov&quot;</span>));</span><br><span class="line">            hmap.put(<span class="string">&quot;3sdfgsd1j333&quot;</span>, <span class="keyword">new</span> <span class="title class_">Video</span>(<span class="string">&quot;3sdfgsd1j333&quot;</span>, <span class="string">&quot;Programing lesson#1.avi&quot;</span>));</span><br><span class="line"></span><br><span class="line">            System.out.print(<span class="string">&quot;Done!&quot;</span> + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> hmap;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> Video <span class="title function_">getSomeVideo</span><span class="params">(String videoId)</span> &#123;</span><br><span class="line">            System.out.print(<span class="string">&quot;Downloading video... &quot;</span>);</span><br><span class="line"></span><br><span class="line">            experienceNetworkLatency();</span><br><span class="line">            <span class="type">Video</span> <span class="variable">video</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Video</span>(videoId, <span class="string">&quot;Some video title&quot;</span>);</span><br><span class="line"></span><br><span class="line">            System.out.print(<span class="string">&quot;Done!&quot;</span> + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> video;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">YouTubeCacheProxy</span> <span class="keyword">implements</span> <span class="title class_">ThirdPartyYouTubeLib</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> ThirdPartyYouTubeLib youtubeService;</span><br><span class="line">        <span class="keyword">private</span> HashMap&lt;String, Video&gt; cachePopular = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, Video&gt;();</span><br><span class="line">        <span class="keyword">private</span> HashMap&lt;String, Video&gt; cacheAll = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, Video&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">YouTubeCacheProxy</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.youtubeService = <span class="keyword">new</span> <span class="title class_">ThirdPartyYouTubeClass</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> HashMap&lt;String, Video&gt; <span class="title function_">popularVideos</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (cachePopular.isEmpty()) &#123;</span><br><span class="line">                cachePopular = youtubeService.popularVideos();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;Retrieved list from cache.&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> cachePopular;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> Video <span class="title function_">getVideo</span><span class="params">(String videoId)</span> &#123;</span><br><span class="line">            <span class="type">Video</span> <span class="variable">video</span> <span class="operator">=</span> cacheAll.get(videoId);</span><br><span class="line">            <span class="keyword">if</span> (video == <span class="literal">null</span>) &#123;</span><br><span class="line">                video = youtubeService.getVideo(videoId);</span><br><span class="line">                cacheAll.put(videoId, video);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;Retrieved video &#x27;&quot;</span> + videoId + <span class="string">&quot;&#x27; from cache.&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> video;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reset</span><span class="params">()</span> &#123;</span><br><span class="line">            cachePopular.clear();</span><br><span class="line">            cacheAll.clear();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">YouTubeDownloader</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> ThirdPartyYouTubeLib api;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">YouTubeDownloader</span><span class="params">(ThirdPartyYouTubeLib api)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.api = api;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">renderVideoPage</span><span class="params">(String videoId)</span> &#123;</span><br><span class="line">            <span class="type">Video</span> <span class="variable">video</span> <span class="operator">=</span> api.getVideo(videoId);</span><br><span class="line">            System.out.println(<span class="string">&quot;\n-------------------------------&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;Video page (imagine fancy HTML)&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;ID: &quot;</span> + video.id);</span><br><span class="line">            System.out.println(<span class="string">&quot;Title: &quot;</span> + video.title);</span><br><span class="line">            System.out.println(<span class="string">&quot;Video: &quot;</span> + video.data);</span><br><span class="line">            System.out.println(<span class="string">&quot;-------------------------------\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">renderPopularVideos</span><span class="params">()</span> &#123;</span><br><span class="line">            HashMap&lt;String, Video&gt; list = api.popularVideos();</span><br><span class="line">            System.out.println(<span class="string">&quot;\n-------------------------------&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;Most popular videos on YouTube (imagine fancy HTML)&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (Video video : list.values()) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;ID: &quot;</span> + video.id + <span class="string">&quot; / Title: &quot;</span> + video.title);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;-------------------------------\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">YouTubeDownloader</span> <span class="variable">naiveDownloader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">YouTubeDownloader</span>(<span class="keyword">new</span> <span class="title class_">ThirdPartyYouTubeClass</span>());</span><br><span class="line">        <span class="type">YouTubeDownloader</span> <span class="variable">smartDownloader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">YouTubeDownloader</span>(<span class="keyword">new</span> <span class="title class_">YouTubeCacheProxy</span>());</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="variable">naive</span> <span class="operator">=</span> test(naiveDownloader);</span><br><span class="line">        <span class="type">long</span> <span class="variable">smart</span> <span class="operator">=</span> test(smartDownloader);</span><br><span class="line">        System.out.print(<span class="string">&quot;Time saved by caching proxy: &quot;</span> + (naive - smart) + <span class="string">&quot;ms&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">long</span> <span class="title function_">test</span><span class="params">(YouTubeDownloader downloader)</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">startTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// User behavior in our app:</span></span><br><span class="line">        downloader.renderPopularVideos();</span><br><span class="line">        downloader.renderVideoPage(<span class="string">&quot;catzzzzzzzzz&quot;</span>);</span><br><span class="line">        downloader.renderPopularVideos();</span><br><span class="line">        downloader.renderVideoPage(<span class="string">&quot;dancesvideoo&quot;</span>);</span><br><span class="line">        <span class="comment">// Users might visit the same page quite often.</span></span><br><span class="line">        downloader.renderVideoPage(<span class="string">&quot;catzzzzzzzzz&quot;</span>);</span><br><span class="line">        downloader.renderVideoPage(<span class="string">&quot;someothervid&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="variable">estimatedTime</span> <span class="operator">=</span> System.currentTimeMillis() - startTime;</span><br><span class="line">        System.out.print(<span class="string">&quot;Time elapsed: &quot;</span> + estimatedTime + <span class="string">&quot;ms\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> estimatedTime;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="行为模式"><a href="#行为模式" class="headerlink" title="行为模式"></a>行为模式</h2><h3 id="责任链-★★☆"><a href="#责任链-★★☆" class="headerlink" title="责任链 ★★☆"></a>责任链 ★★☆</h3><blockquote><p>允许你将请求沿着处理者链进行发送。收到请求后，每个处理者均可对请求进行处理，或将其传递给链上的下个处理者</p></blockquote><p>最近， 你刚为自己的电脑购买并安装了一个新的硬件设备。 身为一名极客， 你显然在电脑上安装了多个操作系统， 所以你会试着启动所有操作系统来确认其是否支持新的硬件设备。 Windows 检测到了该硬件设备并对其进行了自动启用。 但是你喜爱的 Linux 系统并不支持新硬件设备。 抱着最后一点希望， 你决定拨打包装盒上的技术支持电话。</p><p>首先你会听到自动回复器的机器合成语音， 它提供了针对各种问题的九个常用解决方案， 但其中没有一个与你遇到的问题相关。 过了一会儿， 机器人将你转接到人工接听人员处。</p><p>这位接听人员同样无法提供任何具体的解决方案。 他不断地引用手册中冗长的内容， 并不会仔细聆听你的回应。 在第 10 次听到 “你是否关闭计算机后重新启动呢？” 这句话后， 你要求与一位真正的工程师通话。</p><p>最后， 接听人员将你的电话转接给了工程师， 他或许正缩在某幢办公大楼的阴暗地下室中， 坐在他所深爱的服务器机房里， 焦躁不安地期待着同一名真人交流。 工程师告诉了你新硬件设备驱动程序的下载网址， 以及如何在 Linux 系统上进行安装。 问题终于解决了！ 你挂断了电话， 满心欢喜。</p><table><thead><tr><th>优点 √</th><th>缺点 ×</th></tr></thead><tbody><tr><td>你可以控制请求处理的顺序<br /><em>单一职责原则</em>。 你可对发起操作和执行操作的类进行解耦。<br /><em>开闭原则</em>。 你可以在不更改现有代码的情况下在程序中新增处理者。</td><td>部分请求可能未被处理。</td></tr></tbody></table><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 责任链-登录流程</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ChainOfResponsibility</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Server</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> Middleware middleware;</span><br><span class="line">        <span class="keyword">private</span> Map&lt;String, String&gt; users = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">register</span> <span class="params">(String username, String password)</span> &#123;</span><br><span class="line">            users.put(username, password);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">loginIn</span><span class="params">(String username, String password)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (middleware.check(username, password)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!users.getOrDefault(username, <span class="string">&quot;&quot;</span>).equals(password)) &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;账号密码错误&quot;</span>);</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println(<span class="string">&quot;登录成功&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMiddleware</span><span class="params">(Middleware middleware)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.middleware = middleware;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Middleware</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> Middleware next;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> Middleware <span class="title function_">link</span><span class="params">(Middleware first, Middleware... chain)</span> &#123;</span><br><span class="line">            <span class="type">Middleware</span> <span class="variable">head</span> <span class="operator">=</span> first;</span><br><span class="line">            <span class="keyword">for</span> (Middleware middleware : chain) &#123;</span><br><span class="line">                head.next = middleware;</span><br><span class="line">                head = middleware;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> first;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="type">boolean</span> <span class="title function_">check</span><span class="params">(String username, String password)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">protected</span> <span class="type">boolean</span> <span class="title function_">checkNext</span><span class="params">(String username, String password)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (next == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> next.check(username, password);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">CorsMiddleware</span> <span class="keyword">extends</span> <span class="title class_">Middleware</span> &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">check</span><span class="params">(String username, String password)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!username.equals(<span class="string">&quot;admin&quot;</span>)) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;CORS不通过&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> checkNext(username, password);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">BlockListMiddleware</span> <span class="keyword">extends</span> <span class="title class_">Middleware</span> &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">check</span><span class="params">(String username, String password)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (username.equals(<span class="string">&quot;gezi&quot;</span>)) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;已被拉黑&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> checkNext(username, password);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Server</span> <span class="variable">server</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Server</span>();</span><br><span class="line">        server.register(<span class="string">&quot;admin&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        server.register(<span class="string">&quot;gezi&quot;</span>,<span class="string">&quot;test&quot;</span>);</span><br><span class="line">        server.setMiddleware(Middleware.link(<span class="keyword">new</span> <span class="title class_">BlockListMiddleware</span>(), <span class="keyword">new</span> <span class="title class_">CorsMiddleware</span>()));</span><br><span class="line">        server.loginIn(<span class="string">&quot;admin&quot;</span>,<span class="string">&quot;test&quot;</span>);</span><br><span class="line">        server.loginIn(<span class="string">&quot;admin&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        server.loginIn(<span class="string">&quot;gezi&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        server.loginIn(<span class="string">&quot;test&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="命令-★☆☆"><a href="#命令-★☆☆" class="headerlink" title="命令 ★☆☆"></a>命令 ★☆☆</h3><blockquote><p>它可将请求转换为一个包含与请求相关的所有信息的独立对象。该转换让你能根据不同的请求将方法参数化，延迟请求或者将其放入队列中，且能实现可撤销操作。</p></blockquote><p>在市中心逛了很久的街后， 你找到了一家不错的餐厅， 坐在了临窗的座位上。 一名友善的服务员走近你， 迅速记下你点的食物， 写在一张纸上。 服务员来到厨房， 把订单贴在墙上。 过了一段时间， 厨师拿到了订单， 他根据订单来准备食物。 厨师将做好的食物和订单一起放在托盘上。 服务员看到托盘后对订单进行检查， 确保所有食物都是你要的， 然后将食物放到了你的桌上。</p><p>那张纸就是一个命令， 它在厨师开始烹饪前一直位于队列中。 命令中包含与烹饪这些食物相关的所有信息。 厨师能够根据它马上开始烹饪， 而无需跑来直接和你确认订单详情。</p><table><thead><tr><th>优点 √</th><th>缺点 ×</th></tr></thead><tbody><tr><td><em>单一职责原则</em>。 你可以解耦触发和执行操作的类。<br /><em>开闭原则</em>。 你可以在不修改已有客户端代码的情况下在程序中创建新的命令。<br />你可以实现撤销和恢复功能。<br />你可以实现操作的延迟执行。<br />你可以将一组简单命令组合成一个复杂命令。</td><td>代码可能会变得更加复杂， 因为你在发送者和接收者之间增加了一个全新的层次。</td></tr></tbody></table><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.ActionEvent;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.ActionListener;</span><br><span class="line"><span class="keyword">import</span> java.util.Stack;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 命令-编辑器</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Command</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">CommandImp</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> Editor editor;</span><br><span class="line">        <span class="keyword">public</span> String backup;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">CommandImp</span><span class="params">(Editor editor)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.editor = editor;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">backup</span><span class="params">()</span> &#123;</span><br><span class="line">            backup = editor.textField.getText();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">undo</span><span class="params">()</span> &#123;</span><br><span class="line">            editor.textField.setText(backup);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="type">boolean</span> <span class="title function_">execute</span><span class="params">()</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">CopyCommand</span> <span class="keyword">extends</span> <span class="title class_">CommandImp</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">CopyCommand</span><span class="params">(Editor editor)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(editor);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">execute</span><span class="params">()</span> &#123;</span><br><span class="line">            editor.clipboard = editor.textField.getSelectedText();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">PasteCommand</span> <span class="keyword">extends</span> <span class="title class_">CommandImp</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">PasteCommand</span><span class="params">(Editor editor)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(editor);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">execute</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (editor.clipboard == <span class="literal">null</span> || editor.clipboard.isEmpty()) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">            backup();</span><br><span class="line">            editor.textField.insert(editor.clipboard, editor.textField.getCaretPosition());</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">CutCommand</span> <span class="keyword">extends</span> <span class="title class_">CommandImp</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">CutCommand</span><span class="params">(Editor editor)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(editor);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">execute</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (editor.textField.getSelectedText().isEmpty()) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">            backup();</span><br><span class="line">            <span class="type">String</span> <span class="variable">source</span> <span class="operator">=</span> editor.textField.getText();</span><br><span class="line">            editor.clipboard = editor.textField.getSelectedText();</span><br><span class="line">            editor.textField.setText(cutString(source));</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">private</span> String <span class="title function_">cutString</span><span class="params">(String source)</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">start</span> <span class="operator">=</span> source.substring(<span class="number">0</span>, editor.textField.getSelectionStart());</span><br><span class="line">            <span class="type">String</span> <span class="variable">end</span> <span class="operator">=</span> source.substring(editor.textField.getSelectionEnd());</span><br><span class="line">            <span class="keyword">return</span> start + end;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">CommandHistory</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> Stack&lt;CommandImp&gt; history = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(CommandImp c)</span> &#123;</span><br><span class="line">            history.push(c);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> CommandImp <span class="title function_">pop</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> history.pop();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123; <span class="keyword">return</span> history.isEmpty(); &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Editor</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> JTextArea textField;</span><br><span class="line">        <span class="keyword">public</span> String clipboard;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">CommandHistory</span> <span class="variable">history</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CommandHistory</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="type">JFrame</span> <span class="variable">frame</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JFrame</span>(<span class="string">&quot;Text editor (type &amp; use buttons, Luke!)&quot;</span>);</span><br><span class="line">            <span class="type">JPanel</span> <span class="variable">content</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JPanel</span>();</span><br><span class="line">            frame.setContentPane(content);</span><br><span class="line">            frame.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);</span><br><span class="line">            content.setLayout(<span class="keyword">new</span> <span class="title class_">BoxLayout</span>(content, BoxLayout.Y_AXIS));</span><br><span class="line">            textField = <span class="keyword">new</span> <span class="title class_">JTextArea</span>();</span><br><span class="line">            textField.setLineWrap(<span class="literal">true</span>);</span><br><span class="line">            content.add(textField);</span><br><span class="line">            <span class="type">JPanel</span> <span class="variable">buttons</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JPanel</span>(<span class="keyword">new</span> <span class="title class_">FlowLayout</span>(FlowLayout.CENTER));</span><br><span class="line">            <span class="type">JButton</span> <span class="variable">ctrlC</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JButton</span>(<span class="string">&quot;Ctrl+C&quot;</span>);</span><br><span class="line">            <span class="type">JButton</span> <span class="variable">ctrlX</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JButton</span>(<span class="string">&quot;Ctrl+X&quot;</span>);</span><br><span class="line">            <span class="type">JButton</span> <span class="variable">ctrlV</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JButton</span>(<span class="string">&quot;Ctrl+V&quot;</span>);</span><br><span class="line">            <span class="type">JButton</span> <span class="variable">ctrlZ</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JButton</span>(<span class="string">&quot;Ctrl+Z&quot;</span>);</span><br><span class="line">            <span class="type">Editor</span> <span class="variable">editor</span> <span class="operator">=</span> <span class="built_in">this</span>;</span><br><span class="line">            ctrlC.addActionListener(<span class="keyword">new</span> <span class="title class_">ActionListener</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">actionPerformed</span><span class="params">(ActionEvent e)</span> &#123;</span><br><span class="line">                    executeCommand(<span class="keyword">new</span> <span class="title class_">CopyCommand</span>(editor));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            ctrlX.addActionListener(<span class="keyword">new</span> <span class="title class_">ActionListener</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">actionPerformed</span><span class="params">(ActionEvent e)</span> &#123;</span><br><span class="line">                    executeCommand(<span class="keyword">new</span> <span class="title class_">CutCommand</span>(editor));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            ctrlV.addActionListener(<span class="keyword">new</span> <span class="title class_">ActionListener</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">actionPerformed</span><span class="params">(ActionEvent e)</span> &#123;</span><br><span class="line">                    executeCommand(<span class="keyword">new</span> <span class="title class_">PasteCommand</span>(editor));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            ctrlZ.addActionListener(<span class="keyword">new</span> <span class="title class_">ActionListener</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">actionPerformed</span><span class="params">(ActionEvent e)</span> &#123;</span><br><span class="line">                    undo();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            buttons.add(ctrlC);</span><br><span class="line">            buttons.add(ctrlX);</span><br><span class="line">            buttons.add(ctrlV);</span><br><span class="line">            buttons.add(ctrlZ);</span><br><span class="line">            content.add(buttons);</span><br><span class="line">            frame.setSize(<span class="number">450</span>, <span class="number">200</span>);</span><br><span class="line">            frame.setLocationRelativeTo(<span class="literal">null</span>);</span><br><span class="line">            frame.setVisible(<span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">executeCommand</span><span class="params">(CommandImp command)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (command.execute()) &#123;</span><br><span class="line">                history.push(command);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">undo</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (history.isEmpty()) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">CommandImp</span> <span class="variable">command</span> <span class="operator">=</span> history.pop();</span><br><span class="line">            <span class="keyword">if</span> (command != <span class="literal">null</span>) &#123;</span><br><span class="line">                command.undo();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Editor</span> <span class="variable">editor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Editor</span>();</span><br><span class="line">        editor.init();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="迭代器-★★☆"><a href="#迭代器-★★☆" class="headerlink" title="迭代器 ★★☆"></a>迭代器 ★★☆</h3><blockquote><p>让你能在不暴露集合底层表现形式(列表，栈和树等)的情况下遍历集合中的所有元素。</p></blockquote><p>你计划在罗马游览数天， 参观所有主要的旅游景点。 但在到达目的地后， 你可能会浪费很多时间绕圈子， 甚至找不到罗马斗兽场在哪里。</p><p>或者你可以购买一款智能手机上的虚拟导游程序。 这款程序非常智能而且价格不贵， 你想在景点待多久都可以。</p><p>第三种选择是用部分旅行预算雇佣一位对城市了如指掌的当地向导。 向导能根据你的喜好来安排行程， 为你介绍每个景点并讲述许多激动人心的故事。 这样的旅行可能会更有趣， 但所需费用也会更高。</p><p>所有这些选择(自由漫步、 智能手机导航或真人向导)都是这个由众多罗马景点组成的集合的迭代器。</p><table><thead><tr><th>优点 √</th><th>缺点 ×</th></tr></thead><tbody><tr><td><em>单一职责原则</em>。 通过将体积庞大的遍历算法代码抽取为独立的类， 你可对客户端代码和集合进行整理。<br /> <em>开闭原则</em>。 你可实现新型的集合和迭代器并将其传递给现有代码， 无需修改现有代码。<br />你可以并行遍历同一集合， 因为每个迭代器对象都包含其自身的遍历状态。<br />相似的， 你可以暂停遍历并在需要时继续。</td><td>如果你的程序只与简单的集合进行交互， 应用该模式可能会矫枉过正。<br />对于某些特殊集合， 使用迭代器可能比直接遍历的效率低。</td></tr></tbody></table><p>**注：**迭代器旨在”安全性”与”封装性&#x2F;单一职责”</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 迭代器-访问社交关系</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Iterator</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ProfileIterator</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span>;</span><br><span class="line">        Profile <span class="title function_">getNext</span><span class="params">()</span>;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">reset</span><span class="params">()</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">FacebookIterator</span> <span class="keyword">implements</span> <span class="title class_">ProfileIterator</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> Facebook facebook;</span><br><span class="line">        <span class="keyword">private</span> String type;</span><br><span class="line">        <span class="keyword">private</span> String email;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> <span class="variable">currentPosition</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">private</span> List&lt;String&gt; emails = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">private</span> List&lt;Profile&gt; profiles = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">FacebookIterator</span><span class="params">(Facebook facebook, String type, String email)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.facebook = facebook;</span><br><span class="line">            <span class="built_in">this</span>.type = type;</span><br><span class="line">            <span class="built_in">this</span>.email = email;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">lazyLoad</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (emails.size() == <span class="number">0</span>) &#123;</span><br><span class="line">                List&lt;String&gt; profiles = facebook.requestProfileFriendsFromFacebook(<span class="built_in">this</span>.email, <span class="built_in">this</span>.type);</span><br><span class="line">                <span class="keyword">for</span> (String profile : profiles) &#123;</span><br><span class="line">                    <span class="built_in">this</span>.emails.add(profile);</span><br><span class="line">                    <span class="built_in">this</span>.profiles.add(<span class="literal">null</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span> &#123;</span><br><span class="line">            lazyLoad();</span><br><span class="line">            <span class="keyword">return</span> currentPosition &lt; emails.size();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> Profile <span class="title function_">getNext</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!hasNext()) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">String</span> <span class="variable">friendEmail</span> <span class="operator">=</span> emails.get(currentPosition);</span><br><span class="line">            <span class="type">Profile</span> <span class="variable">friendProfile</span> <span class="operator">=</span> profiles.get(currentPosition);</span><br><span class="line">            <span class="keyword">if</span> (friendProfile == <span class="literal">null</span>) &#123;</span><br><span class="line">                friendProfile = facebook.requestProfileFromFacebook(friendEmail);</span><br><span class="line">                profiles.set(currentPosition, friendProfile);</span><br><span class="line">            &#125;</span><br><span class="line">            currentPosition++;</span><br><span class="line">            <span class="keyword">return</span> friendProfile;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reset</span><span class="params">()</span> &#123;</span><br><span class="line">            currentPosition = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">LinkedInIterator</span> <span class="keyword">implements</span> <span class="title class_">ProfileIterator</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> LinkedIn linkedIn;</span><br><span class="line">        <span class="keyword">private</span> String type;</span><br><span class="line">        <span class="keyword">private</span> String email;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> <span class="variable">currentPosition</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">private</span> List&lt;String&gt; emails = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">private</span> List&lt;Profile&gt; contacts = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">LinkedInIterator</span><span class="params">(LinkedIn linkedIn, String type, String email)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.linkedIn = linkedIn;</span><br><span class="line">            <span class="built_in">this</span>.type = type;</span><br><span class="line">            <span class="built_in">this</span>.email = email;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">lazyLoad</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (emails.size() == <span class="number">0</span>) &#123;</span><br><span class="line">                List&lt;String&gt; profiles = linkedIn.requestRelatedContactsFromLinkedInAPI(<span class="built_in">this</span>.email, <span class="built_in">this</span>.type);</span><br><span class="line">                <span class="keyword">for</span> (String profile : profiles) &#123;</span><br><span class="line">                    <span class="built_in">this</span>.emails.add(profile);</span><br><span class="line">                    <span class="built_in">this</span>.contacts.add(<span class="literal">null</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span> &#123;</span><br><span class="line">            lazyLoad();</span><br><span class="line">            <span class="keyword">return</span> currentPosition &lt; emails.size();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> Profile <span class="title function_">getNext</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!hasNext()) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">String</span> <span class="variable">friendEmail</span> <span class="operator">=</span> emails.get(currentPosition);</span><br><span class="line">            <span class="type">Profile</span> <span class="variable">friendContact</span> <span class="operator">=</span> contacts.get(currentPosition);</span><br><span class="line">            <span class="keyword">if</span> (friendContact == <span class="literal">null</span>) &#123;</span><br><span class="line">                friendContact = linkedIn.requestContactInfoFromLinkedInAPI(friendEmail);</span><br><span class="line">                contacts.set(currentPosition, friendContact);</span><br><span class="line">            &#125;</span><br><span class="line">            currentPosition++;</span><br><span class="line">            <span class="keyword">return</span> friendContact;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reset</span><span class="params">()</span> &#123;</span><br><span class="line">            currentPosition = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SocialNetwork</span> &#123;</span><br><span class="line">        ProfileIterator <span class="title function_">createFriendsIterator</span><span class="params">(String profileEmail)</span>;</span><br><span class="line">        ProfileIterator <span class="title function_">createCoworkersIterator</span><span class="params">(String profileEmail)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Facebook</span> <span class="keyword">implements</span> <span class="title class_">SocialNetwork</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> List&lt;Profile&gt; profiles;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Facebook</span><span class="params">(List&lt;Profile&gt; cache)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (cache != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="built_in">this</span>.profiles = cache;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">this</span>.profiles = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> Profile <span class="title function_">requestProfileFromFacebook</span><span class="params">(String profileEmail)</span> &#123;</span><br><span class="line">            simulateNetworkLatency();</span><br><span class="line">            System.out.println(<span class="string">&quot;Facebook: Loading profile &#x27;&quot;</span> + profileEmail + <span class="string">&quot;&#x27; over the network...&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> findProfile(profileEmail);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">requestProfileFriendsFromFacebook</span><span class="params">(String profileEmail, String contactType)</span> &#123;</span><br><span class="line">            simulateNetworkLatency();</span><br><span class="line">            System.out.println(<span class="string">&quot;Facebook: Loading &#x27;&quot;</span> + contactType + <span class="string">&quot;&#x27; list of &#x27;&quot;</span> + profileEmail + <span class="string">&quot;&#x27; over the network...&quot;</span>);</span><br><span class="line">            <span class="comment">// ...and return test data.</span></span><br><span class="line">            <span class="type">Profile</span> <span class="variable">profile</span> <span class="operator">=</span> findProfile(profileEmail);</span><br><span class="line">            <span class="keyword">if</span> (profile != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> profile.getContacts(contactType);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">private</span> Profile <span class="title function_">findProfile</span><span class="params">(String profileEmail)</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (Profile profile : profiles) &#123;</span><br><span class="line">                <span class="keyword">if</span> (profile.getEmail().equals(profileEmail)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> profile;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">simulateNetworkLatency</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">2500</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException ex) &#123;</span><br><span class="line">                ex.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> ProfileIterator <span class="title function_">createFriendsIterator</span><span class="params">(String profileEmail)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FacebookIterator</span>(<span class="built_in">this</span>, <span class="string">&quot;friends&quot;</span>, profileEmail);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> ProfileIterator <span class="title function_">createCoworkersIterator</span><span class="params">(String profileEmail)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FacebookIterator</span>(<span class="built_in">this</span>, <span class="string">&quot;coworkers&quot;</span>, profileEmail);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">LinkedIn</span> <span class="keyword">implements</span> <span class="title class_">SocialNetwork</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> List&lt;Profile&gt; contacts;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">LinkedIn</span><span class="params">(List&lt;Profile&gt; cache)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (cache != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="built_in">this</span>.contacts = cache;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">this</span>.contacts = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Profile <span class="title function_">requestContactInfoFromLinkedInAPI</span><span class="params">(String profileEmail)</span> &#123;</span><br><span class="line">            simulateNetworkLatency();</span><br><span class="line">            System.out.println(<span class="string">&quot;LinkedIn: Loading profile &#x27;&quot;</span> + profileEmail + <span class="string">&quot;&#x27; over the network...&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> findContact(profileEmail);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">requestRelatedContactsFromLinkedInAPI</span><span class="params">(String profileEmail, String contactType)</span> &#123;</span><br><span class="line">            simulateNetworkLatency();</span><br><span class="line">            System.out.println(<span class="string">&quot;LinkedIn: Loading &#x27;&quot;</span> + contactType + <span class="string">&quot;&#x27; list of &#x27;&quot;</span> + profileEmail + <span class="string">&quot;&#x27; over the network...&quot;</span>);</span><br><span class="line">            <span class="type">Profile</span> <span class="variable">profile</span> <span class="operator">=</span> findContact(profileEmail);</span><br><span class="line">            <span class="keyword">if</span> (profile != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> profile.getContacts(contactType);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">private</span> Profile <span class="title function_">findContact</span><span class="params">(String profileEmail)</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (Profile profile : contacts) &#123;</span><br><span class="line">                <span class="keyword">if</span> (profile.getEmail().equals(profileEmail)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> profile;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">simulateNetworkLatency</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">2500</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException ex) &#123;</span><br><span class="line">                ex.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> ProfileIterator <span class="title function_">createFriendsIterator</span><span class="params">(String profileEmail)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">LinkedInIterator</span>(<span class="built_in">this</span>, <span class="string">&quot;friends&quot;</span>, profileEmail);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> ProfileIterator <span class="title function_">createCoworkersIterator</span><span class="params">(String profileEmail)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">LinkedInIterator</span>(<span class="built_in">this</span>, <span class="string">&quot;coworkers&quot;</span>, profileEmail);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Profile</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">private</span> String email;</span><br><span class="line">        <span class="keyword">private</span> Map&lt;String, List&lt;String&gt;&gt; contacts = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Profile</span><span class="params">(String email, String name, String... contacts)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.email = email;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">            <span class="keyword">for</span> (String contact : contacts) &#123;</span><br><span class="line">                String[] parts = contact.split(<span class="string">&quot;:&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">contactType</span> <span class="operator">=</span> <span class="string">&quot;friend&quot;</span>, contactEmail;</span><br><span class="line">                <span class="keyword">if</span> (parts.length == <span class="number">1</span>) &#123;</span><br><span class="line">                    contactEmail = parts[<span class="number">0</span>];</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    contactType = parts[<span class="number">0</span>];</span><br><span class="line">                    contactEmail = parts[<span class="number">1</span>];</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (!<span class="built_in">this</span>.contacts.containsKey(contactType)) &#123;</span><br><span class="line">                    <span class="built_in">this</span>.contacts.put(contactType, <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;());</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">this</span>.contacts.get(contactType).add(contactEmail);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getEmail</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> email;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> name;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getContacts</span><span class="params">(String contactType)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">this</span>.contacts.containsKey(contactType)) &#123;</span><br><span class="line">                <span class="built_in">this</span>.contacts.put(contactType, <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> contacts.get(contactType);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">SocialSpammer</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> SocialNetwork network;</span><br><span class="line">        <span class="keyword">public</span> ProfileIterator iterator;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">SocialSpammer</span><span class="params">(SocialNetwork network)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.network = network;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendSpamToFriends</span><span class="params">(String profileEmail, String message)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;\nIterating over friends...\n&quot;</span>);</span><br><span class="line">            iterator = network.createFriendsIterator(profileEmail);</span><br><span class="line">            <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">                <span class="type">Profile</span> <span class="variable">profile</span> <span class="operator">=</span> iterator.getNext();</span><br><span class="line">                sendMessage(profile.getEmail(), message);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendSpamToCoworkers</span><span class="params">(String profileEmail, String message)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;\nIterating over coworkers...\n&quot;</span>);</span><br><span class="line">            iterator = network.createCoworkersIterator(profileEmail);</span><br><span class="line">            <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">                <span class="type">Profile</span> <span class="variable">profile</span> <span class="operator">=</span> iterator.getNext();</span><br><span class="line">                sendMessage(profile.getEmail(), message);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendMessage</span><span class="params">(String email, String message)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Sent message to: &#x27;&quot;</span> + email + <span class="string">&quot;&#x27;. Message body: &#x27;&quot;</span> + message + <span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Please specify social network to target spam tool (default:Facebook):&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;1. Facebook&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;2. LinkedIn&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">choice</span> <span class="operator">=</span> scanner.nextLine();</span><br><span class="line"></span><br><span class="line">        SocialNetwork network;</span><br><span class="line">        <span class="keyword">if</span> (choice.equals(<span class="string">&quot;2&quot;</span>)) &#123;</span><br><span class="line">            network = <span class="keyword">new</span> <span class="title class_">LinkedIn</span>(createTestProfiles());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            network = <span class="keyword">new</span> <span class="title class_">Facebook</span>(createTestProfiles());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">SocialSpammer</span> <span class="variable">spammer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SocialSpammer</span>(network);</span><br><span class="line">        spammer.sendSpamToFriends(<span class="string">&quot;anna.smith@bing.com&quot;</span>,</span><br><span class="line">                <span class="string">&quot;Hey! This is Anna&#x27;s friend Josh. Can you do me a favor and like this post [link]?&quot;</span>);</span><br><span class="line">        spammer.sendSpamToCoworkers(<span class="string">&quot;anna.smith@bing.com&quot;</span>,</span><br><span class="line">                <span class="string">&quot;Hey! This is Anna&#x27;s boss Jason. Anna told me you would be interested in [link].&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Profile&gt; <span class="title function_">createTestProfiles</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;Profile&gt; data = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        data.add(<span class="keyword">new</span> <span class="title class_">Profile</span>(<span class="string">&quot;anna.smith@bing.com&quot;</span>, <span class="string">&quot;Anna Smith&quot;</span>, <span class="string">&quot;friends:mad_max@ya.com&quot;</span>, <span class="string">&quot;friends:catwoman@yahoo.com&quot;</span>, <span class="string">&quot;coworkers:sam@amazon.com&quot;</span>));</span><br><span class="line">        data.add(<span class="keyword">new</span> <span class="title class_">Profile</span>(<span class="string">&quot;mad_max@ya.com&quot;</span>, <span class="string">&quot;Maximilian&quot;</span>, <span class="string">&quot;friends:anna.smith@bing.com&quot;</span>, <span class="string">&quot;coworkers:sam@amazon.com&quot;</span>));</span><br><span class="line">        data.add(<span class="keyword">new</span> <span class="title class_">Profile</span>(<span class="string">&quot;bill@microsoft.eu&quot;</span>, <span class="string">&quot;Billie&quot;</span>, <span class="string">&quot;coworkers:avanger@ukr.net&quot;</span>));</span><br><span class="line">        data.add(<span class="keyword">new</span> <span class="title class_">Profile</span>(<span class="string">&quot;avanger@ukr.net&quot;</span>, <span class="string">&quot;John Day&quot;</span>, <span class="string">&quot;coworkers:bill@microsoft.eu&quot;</span>));</span><br><span class="line">        data.add(<span class="keyword">new</span> <span class="title class_">Profile</span>(<span class="string">&quot;sam@amazon.com&quot;</span>, <span class="string">&quot;Sam Kitting&quot;</span>, <span class="string">&quot;coworkers:anna.smith@bing.com&quot;</span>, <span class="string">&quot;coworkers:mad_max@ya.com&quot;</span>, <span class="string">&quot;friends:catwoman@yahoo.com&quot;</span>));</span><br><span class="line">        data.add(<span class="keyword">new</span> <span class="title class_">Profile</span>(<span class="string">&quot;catwoman@yahoo.com&quot;</span>, <span class="string">&quot;Liza&quot;</span>, <span class="string">&quot;friends:anna.smith@bing.com&quot;</span>, <span class="string">&quot;friends:sam@amazon.com&quot;</span>));</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="中介者-★★☆"><a href="#中介者-★★☆" class="headerlink" title="中介者 ★★☆"></a>中介者 ★★☆</h3><blockquote><p>让你能够减少对象之间混乱无序的依赖关系。该模式会限制对象之间的直接交互，迫使它们通过一个中介者对象进行合作。</p></blockquote><p>飞行器驾驶员们在靠近或离开空中管制区域时不会直接相互交流。 但他们会与飞机跑道附近， 塔台中的空管员通话。 如果没有空管员， 驾驶员就需要留意机场附近的所有飞机， 并与数十位飞行员组成的委员会讨论降落顺序。 那恐怕会让飞机坠毁的统计数据一飞冲天吧。</p><p>塔台无需管制飞行全程， 只需在航站区加强管控即可， 因为该区域的决策参与者数量对于飞行员来说实在太多了。</p><table><thead><tr><th>优点 √</th><th>缺点 ×</th></tr></thead><tbody><tr><td><em>单一职责原则</em>。 你可以将多个组件间的交流抽取到同一位置， 使其更易于理解和维护。<br /><em>开闭原则</em>。 你无需修改实际组件就能增加新的中介者。<br />你可以减轻应用中多个组件间的耦合情况。<br />你可以更方便地复用各个组件。</td><td>一段时间后， 中介者可能会演化成为<a class="link"   href="https://refactoringguru.cn/antipatterns/god-object" >上帝对象<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>。</td></tr></tbody></table><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 中介者-组件通知</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Mediator</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Component</span> &#123;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">setTags</span><span class="params">(<span class="type">int</span> ...tags)</span>;</span><br><span class="line">        <span class="type">boolean</span> <span class="title function_">verifyTag</span><span class="params">(<span class="type">int</span> tag)</span>;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">notify</span><span class="params">(<span class="type">int</span> tag)</span>;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">setMediator</span><span class="params">(ConcreteMediator notify)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Component1</span> <span class="keyword">implements</span> <span class="title class_">Component</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span>[] tags;</span><br><span class="line">        <span class="keyword">private</span> ConcreteMediator notify;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setTags</span><span class="params">(<span class="type">int</span>... tags)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.tags = tags;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">verifyTag</span><span class="params">(<span class="type">int</span> tag)</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i : tags) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tag == i) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">notify</span><span class="params">(<span class="type">int</span> tag)</span> &#123;</span><br><span class="line">            System.out.println(<span class="built_in">this</span>.getClass().getName()+<span class="string">&quot; 通知了&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMediator</span><span class="params">(ConcreteMediator notify)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.notify = notify;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Component2</span> <span class="keyword">implements</span> <span class="title class_">Component</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span>[] tags;</span><br><span class="line">        <span class="keyword">private</span> ConcreteMediator notify;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setTags</span><span class="params">(<span class="type">int</span>... tags)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.tags = tags;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">verifyTag</span><span class="params">(<span class="type">int</span> tag)</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i : tags) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tag == i) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">notify</span><span class="params">(<span class="type">int</span> tag)</span> &#123;</span><br><span class="line">            System.out.println(<span class="built_in">this</span>.getClass().getName()+<span class="string">&quot; 通知了&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMediator</span><span class="params">(ConcreteMediator notify)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.notify = notify;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ConcreteMediator</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> List&lt;Component&gt; components = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">notify</span><span class="params">(<span class="type">int</span> tag)</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (Component component : components) &#123;</span><br><span class="line">                <span class="keyword">if</span> (component.verifyTag(tag)) &#123;</span><br><span class="line">                    component.notify(tag);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">registerComponent</span><span class="params">(Component component)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.components.add(component);</span><br><span class="line">            component.setMediator(<span class="built_in">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Component</span> <span class="variable">component1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Component1</span>();</span><br><span class="line">        <span class="type">Component</span> <span class="variable">component2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Component2</span>();</span><br><span class="line">        component1.setTags(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line">        component2.setTags(<span class="number">1</span>);</span><br><span class="line">        <span class="type">ConcreteMediator</span> <span class="variable">mediator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConcreteMediator</span>();</span><br><span class="line">        mediator.registerComponent(component1);</span><br><span class="line">        mediator.registerComponent(component2);</span><br><span class="line">        mediator.notify(<span class="number">1</span>);</span><br><span class="line">        mediator.notify(<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p> **注：**中介者的使用比较少，JAVA多用于GUI应用，旨在集中管理依赖关系</p><h3 id="备忘录-★★★"><a href="#备忘录-★★★" class="headerlink" title="备忘录 ★★★"></a>备忘录 ★★★</h3><blockquote><p>允许在不暴露对象实现细节的情况下保存和恢复对象之前的状态</p></blockquote><p>手机的恢复出厂设置就是经典的备忘录，它备份了手机的初始状态供你恢复，此外系统镜像同理</p><table><thead><tr><th>优点 √</th><th>缺点 ×</th></tr></thead><tbody><tr><td>你可以在不破坏对象封装情况的前提下创建对象状态快照。<br />你可以通过让负责人维护原发器状态历史记录来简化原发器代码。</td><td>如果客户端过于频繁地创建备忘录， 程序将消耗大量内存。<br />负责人必须完整跟踪原发器的生命周期， 这样才能销毁弃用的备忘录。<br />绝大部分动态编程语言 （例如 PHP、 Python 和 JavaScript） 不能确保备忘录中的状态不被修改。</td></tr></tbody></table><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 备忘录-数据恢复</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Memento</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 状态数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">DataState</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> String action;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAction</span><span class="params">(String action)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.action = action;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getAction</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> action;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 备忘录</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span>  <span class="title class_">MementoDe</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> DataState state;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">MementoDe</span><span class="params">(Originator o)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.state = o.getState();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> DataState <span class="title function_">getState</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> state;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setState</span><span class="params">(DataState state)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.state = state;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 发起者对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Originator</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> DataState state;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Originator</span><span class="params">()</span> &#123;&#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Originator</span><span class="params">(DataState state)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.state = state;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 创建一个Memento，将自身作为参数传入</span></span><br><span class="line">        <span class="keyword">public</span> MementoDe <span class="title function_">getMemento</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MementoDe</span>(<span class="built_in">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 从Memento中取出保存的数据，恢复为原始状态</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMemento</span><span class="params">(MementoDe m)</span> &#123;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             * getMemento() 创建的对象，保存在某个容器里，</span></span><br><span class="line"><span class="comment">             * 当需要恢复时，将其传入当前方法, 再使用getState(),得出</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            <span class="built_in">this</span>.state = m.getState();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> DataState <span class="title function_">getState</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> state;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setState</span><span class="params">(DataState state)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.state = state;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">DataState</span> <span class="variable">state</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DataState</span>();</span><br><span class="line">        state.setAction(<span class="string">&quot;copy a character&quot;</span>);</span><br><span class="line">        <span class="type">Originator</span> <span class="variable">originator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Originator</span>();</span><br><span class="line">        System.out.println(<span class="string">&quot;创建原始数据&quot;</span>);</span><br><span class="line">        originator.setState(state);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;创建备忘录对象, 保存原始数据状态&quot;</span>);</span><br><span class="line">        <span class="type">MementoDe</span> <span class="variable">memento</span> <span class="operator">=</span> originator.getMemento();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;创建了一个新数据&quot;</span>);</span><br><span class="line">        originator.setState(<span class="keyword">new</span> <span class="title class_">DataState</span>());</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;创建新数据后：&quot;</span> + originator.getState().getAction());</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * memento 需要保存在某地，需要时取出，以恢复它内部所保存的数据</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        System.out.println(<span class="string">&quot;创建新数据后，恢复原数据&quot;</span>);</span><br><span class="line">        originator.setMemento(memento);</span><br><span class="line">        System.out.println(originator.getState().getAction());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>**注：**所有对于Serializable的实现都是备忘录</p><h3 id="观察者-★★☆"><a href="#观察者-★★☆" class="headerlink" title="观察者 ★★☆"></a>观察者 ★★☆</h3><blockquote><p>允许你定义一种订阅机制，可在对象事件发生时通知多个“观察”该对象的其他对象。</p></blockquote><p>杂志和报纸订阅</p><table><thead><tr><th>优点 √</th><th>缺点 ×</th></tr></thead><tbody><tr><td><em>开闭原则</em>。 你无需修改发布者代码就能引入新的订阅者类 （如果是发布者接口则可轻松引入发布者类）。<br />你可以在运行时建立对象之间的联系。</td><td>订阅者的通知顺序是随机的。</td></tr></tbody></table><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 观察者-邮件通知</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Observe</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 发布订阅管理器</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">EventManager</span> &#123;</span><br><span class="line">        Map&lt;String, List&lt;EventListener&gt;&gt; listeners = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">EventManager</span><span class="params">(String... operations)</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (String operation : operations) &#123;</span><br><span class="line">                <span class="built_in">this</span>.listeners.put(operation, <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">subscribe</span><span class="params">(String eventType, EventListener listener)</span> &#123;</span><br><span class="line">            List&lt;EventListener&gt; users = listeners.get(eventType);</span><br><span class="line">            users.add(listener);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">unsubscribe</span><span class="params">(String eventType, EventListener listener)</span> &#123;</span><br><span class="line">            List&lt;EventListener&gt; users = listeners.get(eventType);</span><br><span class="line">            users.remove(listener);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">notify</span><span class="params">(String eventType, String template)</span> &#123;</span><br><span class="line">            List&lt;EventListener&gt; users = listeners.get(eventType);</span><br><span class="line">            <span class="keyword">for</span> (EventListener listener : users) &#123;</span><br><span class="line">                listener.daily(eventType, template);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 事件监听接口-日报事件</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">EventListener</span> &#123;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">daily</span><span class="params">(String eventType, String template)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 邮件发布者</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Email</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> EventManager events;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Email</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="comment">// 游戏板块 与 世界板块新闻</span></span><br><span class="line">            <span class="built_in">this</span>.events = <span class="keyword">new</span> <span class="title class_">EventManager</span>(<span class="string">&quot;games&quot;</span>, <span class="string">&quot;worlds&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendGameNews</span><span class="params">(String template)</span> &#123;</span><br><span class="line">            events.notify(<span class="string">&quot;games&quot;</span>, template);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendWorldNews</span><span class="params">(String template)</span> &#123;</span><br><span class="line">            events.notify(<span class="string">&quot;worlds&quot;</span>, template);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 男孩订阅</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">BoyListener</span> <span class="keyword">implements</span> <span class="title class_">EventListener</span> &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">daily</span><span class="params">(String eventType, String template)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;男孩子们订阅的：&quot;</span>+eventType+<span class="string">&quot;板块新闻发布了。内容：&quot;</span>+template);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 男人订阅</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ManListener</span> <span class="keyword">implements</span> <span class="title class_">EventListener</span> &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">daily</span><span class="params">(String eventType, String template)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;男人们订阅的：&quot;</span>+eventType+<span class="string">&quot;板块新闻发布了。内容：&quot;</span>+template);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Email</span> <span class="variable">email</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Email</span>();</span><br><span class="line">        email.events.subscribe(<span class="string">&quot;games&quot;</span>, <span class="keyword">new</span> <span class="title class_">BoyListener</span>());</span><br><span class="line">        email.events.subscribe(<span class="string">&quot;worlds&quot;</span>, <span class="keyword">new</span> <span class="title class_">ManListener</span>());</span><br><span class="line">        email.sendWorldNews(<span class="string">&quot;乌克兰战争&quot;</span>);</span><br><span class="line">        email.sendGameNews(<span class="string">&quot;暴雪撤出中国市场&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>**注：**在经典的ORM模型中观察者模式存在高频应用，多用于订阅实体对象变更</p><h3 id="状态-★☆☆"><a href="#状态-★☆☆" class="headerlink" title="状态 ★☆☆"></a>状态 ★☆☆</h3><blockquote><p>让你能在一个对象的内部状态变化时改变其行为，使其看上去就像改变了自身所属的类一样。</p></blockquote><p>智能手机的按键和开关会根据设备当前状态完成不同行为：</p><ul><li>当手机处于解锁状态时， 按下按键将执行各种功能。</li><li>当手机处于锁定状态时， 按下任何按键都将解锁屏幕。</li><li>当手机电量不足时， 按下任何按键都将显示充电页面。</li></ul><table><thead><tr><th>优点 √</th><th>缺点 ×</th></tr></thead><tbody><tr><td><em>单一职责原则</em>。 将与特定状态相关的代码放在单独的类中。<br /><em>开闭原则</em>。 无需修改已有状态类和上下文就能引入新状态。<br />通过消除臃肿的状态机条件语句简化上下文代码。</td><td>如果状态机只有很少的几个状态， 或者很少发生改变， 那么应用该模式可能会显得小题大作。</td></tr></tbody></table><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 状态-简单播放器：准备-播放-停止</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">State</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Player</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Player</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.state = <span class="keyword">new</span> <span class="title class_">ReadyState</span>(<span class="built_in">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">private</span> PlayerState state;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">playing</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">changeState</span><span class="params">(PlayerState state)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.state = state;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> PlayerState <span class="title function_">getState</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> state;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPlaying</span><span class="params">(<span class="type">boolean</span> playing)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.playing = playing;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isPlaying</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> playing;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">start</span><span class="params">()</span> &#123;</span><br><span class="line">            state.onStart();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">stop</span><span class="params">()</span> &#123;</span><br><span class="line">            state.onStop();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 播放器状态</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">PlayerState</span> &#123;</span><br><span class="line">        Player player;</span><br><span class="line"></span><br><span class="line">        PlayerState(Player player) &#123;</span><br><span class="line">            <span class="built_in">this</span>.player = player;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">onStop</span><span class="params">()</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">onStart</span><span class="params">()</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 就绪状态</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ReadyState</span> <span class="keyword">extends</span> <span class="title class_">PlayerState</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">ReadyState</span><span class="params">(Player player)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(player);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onStop</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;未开始播放&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onStart</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;开始播放&quot;</span>);</span><br><span class="line">            player.changeState(<span class="keyword">new</span> <span class="title class_">PlayingState</span>(player));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 播放状态</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">PlayingState</span> <span class="keyword">extends</span> <span class="title class_">PlayerState</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">PlayingState</span><span class="params">(Player player)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(player);</span><br><span class="line">            player.setPlaying(<span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onStop</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;成功停止&quot;</span>);</span><br><span class="line">            player.changeState(<span class="keyword">new</span> <span class="title class_">StopState</span>(player));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onStart</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;已经播放，无需重复&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 停止状态</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">StopState</span> <span class="keyword">extends</span> <span class="title class_">PlayerState</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">StopState</span><span class="params">(Player player)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(player);</span><br><span class="line">            player.setPlaying(<span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onStop</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;已经停止，无需重复&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onStart</span><span class="params">()</span> &#123;</span><br><span class="line">            player.changeState(<span class="keyword">new</span> <span class="title class_">PlayingState</span>(player));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Player</span> <span class="variable">player</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Player</span>();</span><br><span class="line">        player.stop();</span><br><span class="line">        player.start();</span><br><span class="line">        player.start();</span><br><span class="line">        player.stop();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="策略-★☆☆"><a href="#策略-★☆☆" class="headerlink" title="策略 ★☆☆"></a>策略 ★☆☆</h3><blockquote><p>能让你定义一系列算法，并将每种算法分别放入独立的类中，以使算法的对象能够相互替换</p></blockquote><p>假如你需要前往机场。 你可以选择乘坐公共汽车、 预约出租车或骑自行车。 这些就是你的出行策略。 你可以根据预算或时间等因素来选择其中一种策略。</p><table><thead><tr><th>优点 √</th><th>缺点 ×</th></tr></thead><tbody><tr><td>你可以在运行时切换对象内的算法。<br /> 你可以将算法的实现和使用算法的代码隔离开来。<br />  你可以使用组合来代替继承。 <br /> <em>开闭原则</em>。 你无需对上下文进行修改就能够引入新的策略。</td><td>如果你的算法极少发生改变， 那么没有任何理由引入新的类和接口。 使用该模式只会让程序过于复杂。  <br />客户端必须知晓策略间的不同——它需要选择合适的策略。  <br />许多现代编程语言支持函数类型功能， 允许你在一组匿名函数中实现不同版本的算法。 这样， 你使用这些函数的方式就和使用策略对象时完全相同， 无需借助额外的类和接口来保持代码简洁。</td></tr></tbody></table><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 策略-导游路线</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Strategy</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 策略接口</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">RouteStrategy</span> &#123;</span><br><span class="line">        List&lt;String&gt; <span class="title function_">buildRoutes</span><span class="params">(String origination)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 导航</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Navigator</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> RouteStrategy strategy;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">walking</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.strategy = <span class="keyword">new</span> <span class="title class_">WalkingStrategy</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">flight</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.strategy = <span class="keyword">new</span> <span class="title class_">FlightStrategy</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getRoutes</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (strategy == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;未选择出行路线&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> strategy.buildRoutes(<span class="string">&quot;北京&quot;</span>).toString();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 步行策略</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">WalkingStrategy</span> <span class="keyword">implements</span> <span class="title class_">RouteStrategy</span>&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">buildRoutes</span><span class="params">(String origination)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;()&#123;&#123;add(origination);add(<span class="string">&quot;罗马&quot;</span>);&#125;&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 飞行策略</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">FlightStrategy</span> <span class="keyword">implements</span> <span class="title class_">RouteStrategy</span> &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">buildRoutes</span><span class="params">(String origination)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;()&#123;&#123;add(origination);add(<span class="string">&quot;上海&quot;</span>);add(<span class="string">&quot;罗马&quot;</span>);&#125;&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Navigator</span> <span class="variable">navigator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Navigator</span>();</span><br><span class="line">        navigator.flight();</span><br><span class="line">        System.out.println(navigator.getRoutes());</span><br><span class="line">        navigator.walking();</span><br><span class="line">        System.out.println(navigator.getRoutes());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="模板方法-★☆☆"><a href="#模板方法-★☆☆" class="headerlink" title="模板方法 ★☆☆"></a>模板方法 ★☆☆</h3><blockquote><p>在超类中定义一个算法的框架，允许子类在不修改结构的情况下重写算法的特定步骤。</p></blockquote><p>模板方法可用于建造大量房屋。 标准房屋建造方案中可提供几个扩展点， 允许潜在房屋业主调整成品房屋的部分细节。</p><p>每个建造步骤 （例如打地基、 建造框架、 建造墙壁和安装水电管线等） 都能进行微调， 这使得成品房屋会略有不同。</p><table><thead><tr><th>优点 √</th><th>缺点 ×</th></tr></thead><tbody><tr><td>你可仅允许客户端重写一个大型算法中的特定部分， 使得算法其他部分修改对其所造成的影响减小。  <br />你可将重复代码提取到一个超类中。</td><td>部分客户端可能会受到算法框架的限制。  <br />通过子类抑制默认步骤实现可能会导致违反<em>里氏替换原则</em>。  <br />模板方法中的步骤越多， 其维护工作就可能会越困难。</td></tr></tbody></table><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 模板方法-社交网络通信</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TemplateMethod</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Network</span> &#123;</span><br><span class="line">        String userName;</span><br><span class="line">        String password;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">post</span><span class="params">(String message)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (logIn(<span class="built_in">this</span>.userName, <span class="built_in">this</span>.password)) &#123;</span><br><span class="line">                <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> sendData(message.getBytes());</span><br><span class="line">                logOut();</span><br><span class="line">                <span class="keyword">return</span> result;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">abstract</span> <span class="type">boolean</span> <span class="title function_">logIn</span><span class="params">(String userName, String password)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">abstract</span> <span class="type">boolean</span> <span class="title function_">sendData</span><span class="params">(<span class="type">byte</span>[] data)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">logOut</span><span class="params">()</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 脸书</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Facebook</span> <span class="keyword">extends</span> <span class="title class_">Network</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Facebook</span><span class="params">(String userName, String password)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.userName = userName;</span><br><span class="line">            <span class="built_in">this</span>.password = password;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">logIn</span><span class="params">(String userName, String password)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Name: &quot;</span> + <span class="built_in">this</span>.userName);</span><br><span class="line">            System.out.print(<span class="string">&quot;Password: &quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="built_in">this</span>.password.length(); i++) &#123;</span><br><span class="line">                System.out.print(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;登录成功&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">sendData</span><span class="params">(<span class="type">byte</span>[] data)</span> &#123;</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">messagePosted</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (messagePosted) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;消息: &#x27;&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(data) + <span class="string">&quot;发布在facebook&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logOut</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;用户: &#x27;&quot;</span> + userName + <span class="string">&quot;&#x27; 注销&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 推特</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Twitter</span> <span class="keyword">extends</span> <span class="title class_">Network</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Twitter</span><span class="params">(String userName, String password)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.userName = userName;</span><br><span class="line">            <span class="built_in">this</span>.password = password;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">logIn</span><span class="params">(String userName, String password)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Name: &quot;</span> + <span class="built_in">this</span>.userName);</span><br><span class="line">            System.out.print(<span class="string">&quot;Password: &quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="built_in">this</span>.password.length(); i++) &#123;</span><br><span class="line">                System.out.print(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;登录成功&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">sendData</span><span class="params">(<span class="type">byte</span>[] data)</span> &#123;</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">messagePosted</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (messagePosted) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;消息: &#x27;&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(data) + <span class="string">&quot;发布在twitter&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logOut</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;用户: &#x27;&quot;</span> + userName + <span class="string">&quot;&#x27; 注销&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> <span class="string">&quot;admin&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;admin&quot;</span>;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Facebook</span>(username, password).post(<span class="string">&quot;你好，脸书&quot;</span>);</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Twitter</span>(username, password).post(<span class="string">&quot;你好，推特&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="访问者-★★★"><a href="#访问者-★★★" class="headerlink" title="访问者 ★★★"></a>访问者 ★★★</h3><blockquote><p>将算法与其所作用的对象隔离开</p></blockquote><p>假如有这样一位非常希望赢得新客户的资深保险代理人。 他可以拜访街区中的每栋楼， 尝试向每个路人推销保险。 所以， 根据大楼内组织类型的不同， 他可以提供专门的保单：</p><ul><li>如果建筑是居民楼， 他会推销医疗保险。</li><li>如果建筑是银行， 他会推销失窃保险。</li><li>如果建筑是咖啡厅， 他会推销火灾和洪水保险。</li></ul><table><thead><tr><th>优点 √</th><th>缺点 ×</th></tr></thead><tbody><tr><td><em>开闭原则</em>。 你可以引入在不同类对象上执行的新行为， 且无需对这些类做出修改。  <br /><em>单一职责原则</em>。 可将同一行为的不同版本移到同一个类中。  <br />访问者对象可以在与各种对象交互时收集一些有用的信息。 当你想要遍历一些复杂的对象结构 （例如对象树）， 并在结构中的每个对象上应用访问者时， 这些信息可能会有所帮助。</td><td>每次在元素层次结构中添加或移除一个类时， 你都要更新所有的访问者。  <br />在访问者同某个元素进行交互时， 它们可能没有访问元素私有成员变量和方法的必要权限。</td></tr></tbody></table><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 访问者-形状导出为 XML 文件</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Visitor</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Shape</span> &#123;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">move</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span>;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">draw</span><span class="params">()</span>;</span><br><span class="line">        String <span class="title function_">accept</span><span class="params">(ShapeVisitor visitor)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Dot</span> <span class="keyword">implements</span> <span class="title class_">Shape</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> id;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> x;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> y;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Dot</span><span class="params">(<span class="type">int</span> id, <span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.id = id;</span><br><span class="line">            <span class="built_in">this</span>.x = x;</span><br><span class="line">            <span class="built_in">this</span>.y = y;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">move</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">draw</span><span class="params">()</span> &#123;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">accept</span><span class="params">(ShapeVisitor visitor)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> visitor.visitDot(<span class="built_in">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Rectangle</span> <span class="keyword">implements</span> <span class="title class_">Shape</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> id;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> x;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> y;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> width;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> height;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Rectangle</span><span class="params">(<span class="type">int</span> id, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> width, <span class="type">int</span> height)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.id = id;</span><br><span class="line">            <span class="built_in">this</span>.x = x;</span><br><span class="line">            <span class="built_in">this</span>.y = y;</span><br><span class="line">            <span class="built_in">this</span>.width = width;</span><br><span class="line">            <span class="built_in">this</span>.height = height;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">accept</span><span class="params">(ShapeVisitor visitor)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> visitor.visitRectangle(<span class="built_in">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">move</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">draw</span><span class="params">()</span> &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ShapeVisitor</span> &#123;</span><br><span class="line">        String <span class="title function_">visitDot</span><span class="params">(Dot dot)</span>;</span><br><span class="line">        String <span class="title function_">visitRectangle</span><span class="params">(Rectangle rectangle)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">XMLExportVisitor</span> <span class="keyword">implements</span> <span class="title class_">ShapeVisitor</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">export</span><span class="params">(Shape... args)</span> &#123;</span><br><span class="line">            <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">            sb.append(<span class="string">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;utf-8\&quot;?&gt;&quot;</span> + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (Shape shape : args) &#123;</span><br><span class="line">                sb.append(shape.accept(<span class="built_in">this</span>)).append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> sb.toString();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">visitDot</span><span class="params">(Dot d)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&lt;dot&gt;&quot;</span> + <span class="string">&quot;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;    &lt;id&gt;&quot;</span> + d.id + <span class="string">&quot;&lt;/id&gt;&quot;</span> + <span class="string">&quot;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;    &lt;x&gt;&quot;</span> + d.x + <span class="string">&quot;&lt;/x&gt;&quot;</span> + <span class="string">&quot;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;    &lt;y&gt;&quot;</span> + d.y + <span class="string">&quot;&lt;/y&gt;&quot;</span> + <span class="string">&quot;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;&lt;/dot&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">visitRectangle</span><span class="params">(Rectangle r)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&lt;rectangle&gt;&quot;</span> + <span class="string">&quot;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;    &lt;id&gt;&quot;</span> + r.id + <span class="string">&quot;&lt;/id&gt;&quot;</span> + <span class="string">&quot;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;    &lt;x&gt;&quot;</span> + r.x + <span class="string">&quot;&lt;/x&gt;&quot;</span> + <span class="string">&quot;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;    &lt;y&gt;&quot;</span> + r.y + <span class="string">&quot;&lt;/y&gt;&quot;</span> + <span class="string">&quot;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;    &lt;width&gt;&quot;</span> + r.width + <span class="string">&quot;&lt;/width&gt;&quot;</span> + <span class="string">&quot;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;    &lt;height&gt;&quot;</span> + r.height + <span class="string">&quot;&lt;/height&gt;&quot;</span> + <span class="string">&quot;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;&lt;/rectangle&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Dot</span> <span class="variable">dot</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Dot</span>(<span class="number">1</span>, <span class="number">10</span>, <span class="number">55</span>);</span><br><span class="line">        <span class="type">Rectangle</span> <span class="variable">rectangle</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Rectangle</span>(<span class="number">3</span>, <span class="number">10</span>, <span class="number">17</span>, <span class="number">20</span>, <span class="number">30</span>);</span><br><span class="line">        <span class="type">XMLExportVisitor</span> <span class="variable">exportVisitor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XMLExportVisitor</span>();</span><br><span class="line">        System.out.println(exportVisitor.export(dot, rectangle));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>**注：**访问者的实现依赖于“双分派”。双分派是指：接受者和参数都能在运行时决定它的类型。(从而若有同名函数的话,依参数选定目标函数)</p><h3 id="解释器-★☆☆"><a href="#解释器-★☆☆" class="headerlink" title="解释器 ★☆☆"></a>解释器 ★☆☆</h3><blockquote><p>给定一个语言，定义它的文法表示，并定义一个解释器，这个解释器使用该标识来解释语言中的句子。<br>对于一些固定文法构建一个解释句子的解释器。</p></blockquote><p>各种编译器，运算表达式本身就是解释器</p><p> 1、可以将一个需要解释执行的语言中的句子表示为一个抽象语法树。 2、一些重复出现的问题可以用一种简单的语言来进行表达。 3、一个简单语法需要解释的场景。</p><table><thead><tr><th>优点 √</th><th>缺点 ×</th></tr></thead><tbody><tr><td>可扩展性比较好，灵活<br />增加了新的解释表达式的方式。<br />易于实现简单文法。</td><td>可利用场景比较少。<br />对于复杂的文法比较难维护。<br />解释器模式会引起类膨胀。<br />解释器模式采用递归调用方法。</td></tr></tbody></table><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 解释器-性别解释判断</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InterpreterPattern</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Expression</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="title function_">interpret</span><span class="params">(String context)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">TerminalExpression</span> <span class="keyword">implements</span> <span class="title class_">Expression</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> String data;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">TerminalExpression</span><span class="params">(String data)</span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.data = data;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">interpret</span><span class="params">(String context)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(context.contains(data))&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">OrExpression</span> <span class="keyword">implements</span> <span class="title class_">Expression</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">Expression</span> <span class="variable">expr1</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">Expression</span> <span class="variable">expr2</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">OrExpression</span><span class="params">(Expression expr1, Expression expr2)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.expr1 = expr1;</span><br><span class="line">            <span class="built_in">this</span>.expr2 = expr2;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">interpret</span><span class="params">(String context)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> expr1.interpret(context) || expr2.interpret(context);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">AndExpression</span> <span class="keyword">implements</span> <span class="title class_">Expression</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">Expression</span> <span class="variable">expr1</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">Expression</span> <span class="variable">expr2</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">AndExpression</span><span class="params">(Expression expr1, Expression expr2)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.expr1 = expr1;</span><br><span class="line">            <span class="built_in">this</span>.expr2 = expr2;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">interpret</span><span class="params">(String context)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> expr1.interpret(context) &amp;&amp; expr2.interpret(context);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Expression</span> <span class="variable">robert</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TerminalExpression</span>(<span class="string">&quot;Robert&quot;</span>);</span><br><span class="line">        <span class="type">Expression</span> <span class="variable">john</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TerminalExpression</span>(<span class="string">&quot;John&quot;</span>);</span><br><span class="line">        <span class="type">OrExpression</span> <span class="variable">isMale</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OrExpression</span>(robert, john);</span><br><span class="line"></span><br><span class="line">        <span class="type">Expression</span> <span class="variable">julie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TerminalExpression</span>(<span class="string">&quot;Julie&quot;</span>);</span><br><span class="line">        <span class="type">Expression</span> <span class="variable">married</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TerminalExpression</span>(<span class="string">&quot;Married&quot;</span>);</span><br><span class="line">        <span class="type">Expression</span> <span class="variable">isMarriedWoman</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AndExpression</span>(julie, married);</span><br><span class="line"></span><br><span class="line">        System.out.println(isMale.interpret(<span class="string">&quot;John&quot;</span>));</span><br><span class="line">        System.out.println(isMarriedWoman.interpret(<span class="string">&quot;John&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>**注：**可利用场景比较少，JAVA 中如果碰到可以用 expression4J 代替。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 设计架构 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AMIS低代码</title>
      <link href="/2022/10/02/AmisLowCode/"/>
      <url>/2022/10/02/AmisLowCode/</url>
      
        <content type="html"><![CDATA[<p>注：vue3一样可以编写自定义组件</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAr0AAAKfCAYAAABjQHDlAAALnXRFWHRteGZpbGUAJTNDbXhmaWxlJTIwaG9zdCUzRCUyMkVsZWN0cm9uJTIyJTIwbW9kaWZpZWQlM0QlMjIyMDIzLTA4LTAxVDA1JTNBNDQlM0EwNy42OTVaJTIyJTIwYWdlbnQlM0QlMjI1LjAlMjAoV2luZG93cyUyME5UJTIwMTAuMCUzQiUyMFdpbjY0JTNCJTIweDY0KSUyMEFwcGxlV2ViS2l0JTJGNTM3LjM2JTIwKEtIVE1MJTJDJTIwbGlrZSUyMEdlY2tvKSUyMGRyYXcuaW8lMkYxNS43LjMlMjBDaHJvbWUlMkY5MS4wLjQ0NzIuMTY0JTIwRWxlY3Ryb24lMkYxMy42LjElMjBTYWZhcmklMkY1MzcuMzYlMjIlMjBldGFnJTNEJTIyTVcwVFNLa3JSVFNkc18wNFR4a3ElMjIlMjB2ZXJzaW9uJTNEJTIyMTUuNy4zJTIyJTIwdHlwZSUzRCUyMmRldmljZSUyMiUzRSUzQ2RpYWdyYW0lMjBpZCUzRCUyMnBydEhnTmdRVEVQdkZDQWNUbmNUJTIyJTIwbmFtZSUzRCUyMlBhZ2UtMSUyMiUzRTdWdGJrOW8yRlA0MWV0d012c2lXSG0xZzIyU1NKalBiVE51bmpoY1VjR01RRlNaQWZuMlBMZ1pzQzh3R2JOaTJNenpJeDVJczZ6dm5PeGNaNVBWbm01OUVzcGglMkI0R09XSWJjMzNpQnZnRnpYOFYwWHlWOXZ2TlVTZ2tNdG1JaDBiRHJ0QlUlMkZwZDJhRVBTTmRwV08yTEhYTU9jJTJGeWRGRVdqdmg4emtaNVNaWUl3ZGZsYmw5NFZuN3FJcG13bXVCcGxHUjE2VyUyRnBPSiUyQmF0M0REdmZ4bmxrNm14Wk9kZ09vN3M2VG9iTjVrT1UzR2ZIMGc4b2JJNnd2T2M5MmFiZm9zazV0WDdJc2U5M2prN201aGdzM3pjd1o4ZURkWWYlMkY3OCUyQkgwUSUyQkVHZnYyWERQNSUyRiUyQmZ2QjhQYzIzSkZ1Wk4wWkRIOFVEUklhcUVhUElROE1RUlQxRW5BYzB4SWclMkJvamhTOXlMbzlPN3A0eTlvR0tDWW9OaVZEYmhOWVFSRmtZTmlMQnQwZ0NLakJjdDhXMnpzY3AzT3NtUU9WJTJGRXlUMFJ1b0llWDhPSXBGJTJCbDNQcyUyQlREQ1FPQ0VieUlwMHo4ZXQySVh2bGdzbUJadTFNNUd4emRGZWMzVjZEa2pJJTJCWTduWVFoY3pnQmgwakhwNjVuSzl4enJzR2RuMEFPY2dOTUxFNk5ka04lMkZNZUFtZ1lGRjZDQ0xFZ2doR2hpQXdVRUlESTQ0TnN4WDFFQXpTRWpSOGk2aWhvWU5kSnNmZFU5cUhRZTNpN3ZUJTJCaGMzVkVEQVJ1SFlJZExDVUljRnNRJTJCRWNnSUZLVm9SR0ZpTVJLb2hCd2d3eVdGRDhMYUUxa1M5Nkt3VjQwT0dBUGZRVWNVYU5xaGlGdFJ2V0hCa0FNY01tWkkybHhjdmhBJTJGdlRUZFIlMkJZTGVvcnRQdFNVc1VXM2clMkI0VVNLMG5xWTVlMW9rSTNsbkRmUXMwYzFuQmE0WEFFaE9taFRHSlpOeWNRMVB4N1hnU2RxQ0U5UDZKbzJCNU0wbEYlMkZtVVQlMkZnOHlZWjdhU3o0YWo1bWNscHBGUHMlMkI3emxmbUEzOGklMkJYNTFwaE9zc3A1ZVh0aEM4WDJkem4lMkJEY2FrRVB4aEpsUVhnMDNwYW50NDlZbUpGRjZmQ1NQVXJ5RFglMkZTTll3Y3Z6bFJpeFU3dGt0aCUyRjRZTUpPellpUG9DOVlsdVRwdCUyRkw2YkdDcW9aRVF5ZmFndzRLbjgzeDVNUE1uS2RncmxWTUVFb1ZXVmIzZHklMkZwRFE2OWdyMWE3VjdsQTAzcFc0Z0NUamdvR2lZTTljWnptY09LcGhocEZiQ3hqNFIzb0NVUVRtWWRTN2FhcGRCN3lXVEVpdm5IcXNaVzJUZ3ozbFlmWCUyRk9VaVNsNDQlMkZBUjdWbjNUTkZGdVppSDRpQzJYelR6Mm5JeSUyQlRwUzVmbHpsV1NxOVdydjg1cGREQnNldk95d242SlRnYlA2cTdtZHEybWFCc0Q0S1MlMkJVajJJQ3FvNHJxUFBmdmdpd1FkZXFEQWxMZnBXNTkwRXM4VU92T0pnak9kRFpCZUtHenVReTF3R0pZdmdycE5KVU5GQk5XZ0JWVFBudGVuY0ZjcmFsJTJGV0ZaJTJGMzZMJTJCeEtMOXJRWFVRV2oxaTdDUGtNMEFueERsRlN5QnNQSTZSRHVTdm9tSXdjZkVuZ21FeWFBSWxwMWRiblQlMkZkSVJ0SHFOVE9ncHRnY281M0IlMkZJeU1FNDlFZlklMkJPalRXd1VYUkRqWUNDUFA1bGdnRlFVTW5WTzQ2ZEJDaGloWVBoUUNCamt6MkZwUDRUJTJCVXlheGNDVllaa1ZhTm5pbEV5RnVCS2xLRWFuaW9zcSUyRjZ3dnBGVVFPcmxRU3FmeUNYRVhsR0VxdTNBM1dESVpZRnFEaUtVdk5Ha1Y0a2VNTHdlQ1NUaUNUTFdNWW5JcG5CWml3T1F2dlN2WU9ZdjBsVnY2UWJWbFRMdWxSZHo2Y1cxY1YxMVEzYjRtVGZ0WElKWUNRclZzYzQ0RDRySHB0S2VlTiUyQktpQzJzbUJ6NVVLeXdURXJHRzBoTmg4ejRaMFIwZXU0NSUyRjF6VTRpJTJGTkFhQUwwSkhhOVJ4QzZpQVl5bG4lMkJGMXl0NCUyQnRCaUJqa1Y2ZDh2NExrRmhKcVZ0TVBDc210YUl0VnI3S1AzQWVyN1JXVzZUQ1FUTnoyWUJvajdtSUpSMzk5eVZhaGI0MUpscWhJZkxHUkN1OHRLcDNXVHhxOHpmM1ZuRnZOTlVPRWcwTiUyRkZGN3JKcmpyVXZ2b2Ywa1JkYVBzQW56STV6TTBxWHRDTEdvaFo1Q3U0NWtmUjVkdWxSbFNlcW90Q0tVVGxLT2FqeWxMRFBEbmNEcW5Gdk9DbHBqV1ZzTVlzME56eWs3VTVVU0t1T0xZQVpIU1dpUkNSWjJDVkY5ckpJMXlDSkpVWWVKVkVZSlF5d3hmd2QxbUFiY0tvZkxPendhNmpDdG1TT3gxV0ZVWnF2WlZlNiUyQm0lMkZPdmJINDhab1IwbGElMkZ5NWswOXpITE5vTVA4ZHNHWGFaN3l1YXVjSm5YYmhNR3R3R0E5NU8lMkZRZXFpdCUyQmtJVUo0WEdlcWlWMjNacExsYldRRzE5dFA5VHB6RmdIS1JmZktuUlYzV092cktZblZWaCUyQlVUSUZxd0ZHMVBsVjBVZ1Nzc1ZGMkxPZVdReGJsQmFodVJSYkxQZ1FLWW9rWXA5d1lMbFVWS2pCZCUyRmVvWWFWVE1OaXdSMGZKTno0TVB2YzZCYTclMkIwajRhbWZaJTJGcGxSYjFGdmJveDYlMkZTUHBUYnRuMmJ1UDI3WUYwWnclMkJ5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Ueqcc85JQ5fYhyoigLmAOYG5gDlRCyXEdVkp3GlDS0c6Cza0dHTcryTpdccqVxOvaEHcTjnlFJ3hYcsttyxBSjYuef/99xV2lU6ZMkU/MOAVZqjFtzH0LS8tuP/jH/9QV1xxhbrnnnt0lpQBAwak3ruXFuxC6Ac8u9dee63O1tKjRw81aNAg9etf/7pmhhbquqykAmhD3dHOkg11R6X0miS9JWL38ccfq0svvVRvwELMLz7bbLNNidLCu+xf//qXjtfFB5sZzj77bNWoUaPwBmqMyLcx9C0vbeCD/E6dOlW/0sYJfDiMpFaOnE4blrXQH5x4iQMM8C9CXfr3719TZFcwDn1dVmou0YbmRzqLNrQSc4+kt0yU8RR21VVX6QwPRx99tPb+7rnnnmVKrd3Ln3rqKe3VveWWW3RmhjPPPDMznnDfxtC3vLTOqv/85z/6QBJseEH4C0JfevbsqQ4++GC17rrrprXb7FcBBL7//nt11113qblz5yq81kZYGDat4gCgn/3sZzWLX1bWZaUURBtaF+ks29BKzDmSXk8of/7553qDDjxX2Jx14okn6kMu6tev76mF9IpZvXq1PlRixowZChsW4MHBxpSNN944vZ1OoGe+jaFveQkM2btI5GdF2MO9996r5s2bp5D1Yb/99lP77ruv2n333b23R4F+EXj22WfVww8/rB588EGdhaFbt26qe/fuOowB+ZpDKFlcl5XQG20obWgl5hlJbwIoY3flzJkz1W233aa9v0i2Ds9VaAUeHBw6AK/u4Ycfrvr06ZPpzBa+jaFvebU2/+ABRh5KnCX/6KOPKmzk6Nixo+rQoYNq3769JsFNmzattWEF09/ly5crkNxnnnlGPf300+qJJ57Qm3v33ntv1aVLF53bvJY9unGKyvq6rMQEpg2tBMrZbIOkN0G9I2YJr2xxHvmCBQv061p4PeD9SHtanihYsAEF3jd44fDaco899lC9evXSryxDj9d1mSa+jaFveS5jSHMdkCysIxCt5557Tj3//PNqww031Onv8Op85513VjvttJM+3IDFLwI4XOTll19WL730kg5BQfrGr776SrVt21a1a9dOP4DgfpCFhxCuS79zK5802tDKYZ2Vlkh6K6RpGGw8vYIw4pS31q1ba29I586d1V577ZVK0ogbzpNPPqlwljq8bYsXL9anp4G4I1dxFgxc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"                      alt="流程图"                ></p><h2 id="组件-依赖"><a href="#组件-依赖" class="headerlink" title="组件&#x2F;依赖"></a>组件&#x2F;依赖</h2><blockquote><p>amis，amis-widget，amis-editor<br>react，mobx</p></blockquote><h2 id="制造"><a href="#制造" class="headerlink" title="制造"></a>制造</h2><p>这里我假设存在三个项目，为什么是三个而不是一个（要引入的组件有点庞大，用户只会在一个项目中使用，不让项目本身膨胀）</p><h3 id="amis-editor-页面编辑器"><a href="#amis-editor-页面编辑器" class="headerlink" title="amis-editor 页面编辑器"></a>amis-editor 页面编辑器</h3><p><strong>拉取项目</strong> <a class="link"   href="https://github.com/aisuda/amis-editor-demo.git" >编辑器<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p><ul><li><p>加入数据同步接口</p><div class="code-container" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/store/index.ts  editor的数据同步是基于mobx的mobx-state-tree</span></span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">  toggleAsideFolded,</span><br><span class="line">  toggleAsideFixed,</span><br><span class="line">  toggleOffScreen,</span><br><span class="line">  setAddPageIsOpen,</span><br><span class="line">  addPage,</span><br><span class="line">  removePageAt,</span><br><span class="line">  updatePageSchemaAt,</span><br><span class="line">  updateSchema,</span><br><span class="line">  setPreview,</span><br><span class="line">  setIsMobile,</span><br><span class="line">  <span class="title function_">afterCreate</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// persist store</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">window</span> !== <span class="string">&#x27;undefined&#x27;</span> &amp;&amp; <span class="variable language_">window</span>.<span class="property">localStorage</span>) &#123;</span><br><span class="line">      <span class="comment">// TODO 这里应该改造一下,先从服务端拉取数据 不从本地读取</span></span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> data = &#123;&#125; <span class="comment">// 假设这个是服务端获取的JSON数据</span></span><br><span class="line">        <span class="title function_">resolve</span>(data)</span><br><span class="line">      &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (data) <span class="title function_">applySnapshot</span>(self, <span class="title class_">JSON</span>.<span class="title function_">parse</span>(data));</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      <span class="title function_">reaction</span>(</span><br><span class="line">        <span class="function">() =&gt;</span> <span class="title function_">getSnapshot</span>(self),</span><br><span class="line">        <span class="function"><span class="params">json</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// TODO 同样的将这个json数据上传给服务端,当然写在这里是自动上传 也可以写一个按钮让用户手动上传</span></span><br><span class="line">            <span class="title function_">resolve</span>(<span class="literal">true</span>)</span><br><span class="line">          &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;上传成功&quot;</span>)</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div></li><li><p>添加自定义组件<br>假设已经存在了自定义组件扩展包，名为vue3-amis-custom-widget</p><div class="code-container" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json文件增加本地依赖,引入这个扩展包(假设扩展包已经使用 npm run build2lib 发布过umd包)</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    ...</span><br><span class="line"><span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        ...</span><br><span class="line"><span class="attr">&quot;amis-extend&quot;</span><span class="punctuation">:</span> <span class="string">&quot;file:../vue3-amis-custom-widget&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">...</span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div><p>在<code>index.tsx</code>文件引入自定义组件</p><div class="code-container" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 下方示例引入一个 uni-area的自定义组件</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;amis-extend/dist/uniAreaPlugin.umd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;amis-extend/dist/uniAreaRenderer.umd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;amis-extend/dist/uniAreaRenderer.css&#x27;</span></span><br></pre></td></tr></table></figure></div></li></ul><h3 id="vue3-amis-custom-widget-自定义组件扩展包"><a href="#vue3-amis-custom-widget-自定义组件扩展包" class="headerlink" title="vue3-amis-custom-widget 自定义组件扩展包"></a>vue3-amis-custom-widget 自定义组件扩展包</h3><p><strong>拉取项目</strong> 主项目地址为：<a class="link"   href="https://github.com/aisuda/amis-widget-cli" >https://github.com/aisuda/amis-widget-cli<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a><br>我们需要拉取vue3的子分支：<a class="link"   href="https://github.com/aisuda/vue3-amis-custom-widget.git" >扩展包<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a><br>按已经给出的示例自己写扩展即可<br>这里可以使用vue2&#x2F;3 react 原生js jq任意来编写，它使用的AKFun技术<br>编写完成后将其打包为lib</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build2lib</span><br></pre></td></tr></table></figure></div><p>此时可以选择将本项目通过npm发布出去，也可以跟上述一样放在一个目录下本地依赖</p><h3 id="vue3-应用项目"><a href="#vue3-应用项目" class="headerlink" title="vue3 应用项目"></a>vue3 应用项目</h3><p>这里包括上述对应用项目的集成都是可选的，也可以就放在一个新的react项目中</p><blockquote><p>写这个是假设：要求你集成到现在正在运行的vue3项目时应该怎么做</p></blockquote><p>引入amis渲染器与自定义组件的本地依赖</p><div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i amis</span><br></pre></td></tr></table></figure></div><div class="code-container" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    ...</span><br><span class="line"><span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        ...</span><br><span class="line"><span class="attr">&quot;amis-extend&quot;</span><span class="punctuation">:</span> <span class="string">&quot;file:../vue3-amis-custom-widget&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">...</span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```ts</span><br><span class="line">import &#x27;amis/sdk/sdk.js&#x27;</span><br><span class="line">import &#x27;amis/lib/themes/default.css&#x27;</span><br><span class="line">import &#x27;amis-extend/dist/uniAreaRenderer.umd&#x27;</span><br><span class="line">import &#x27;amis-extend/dist/uniAreaRenderer.css&#x27;</span><br><span class="line"></span><br><span class="line">const app = createApp(App)</span><br><span class="line">const EmployeeWindow = window as any</span><br><span class="line">app.config.globalProperties.$amis = EmployeeWindow.amisRequire(&#x27;amis/embed&#x27;)</span><br><span class="line">app.use(store).use(Antd).use(router).mount(&#x27;#app&#x27;)</span><br></pre></td></tr></table></figure></div><p>新建一个组件：Amis.vue<br>示例内容如下：</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;main&gt;</span><br><span class="line">    &lt;div id=&quot;box&quot;&gt;&lt;/div&gt;</span><br><span class="line">  &lt;/main&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">import &#123; onMounted, getCurrentInstance &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">const amisjson:any = &#123;</span><br><span class="line">  &quot;title&quot;: &quot;浏览器内核对 CSS 的支持情况&quot;,</span><br><span class="line">  &quot;remark&quot;: &quot;嘿，不保证数据准确性&quot;,</span><br><span class="line">  &quot;type&quot;: &quot;uni-area-chart&quot;</span><br><span class="line">&#125;</span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">  // eslint-disable-next-line @typescript-eslint/ban-ts-comment</span><br><span class="line">  // @ts-ignore</span><br><span class="line">  const &#123; appContext : &#123; config: &#123; globalProperties &#125; &#125; &#125; = getCurrentInstance()</span><br><span class="line">  const element:any = window.document.getElementById(&#x27;box&#x27;)</span><br><span class="line">  globalProperties.$amis.embed(element, amisjson);</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></div><p>此处的uni-area-chart就是我们编写的自定义折线图组件</p><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>在editor中编写后存储到服务端的数据分为两种：</p><ul><li>页面数据<br>这个应该结合动态菜单，在用户登录后从服务端拉取页面数据，组装成vue路由数据作为动态路由</li><li>页面内容数据<br>在进入具体页面时从服务端拉取该页面的详情数据，并使用amis把获取的JSON渲染出来，如上述示例</li></ul><p><strong>涉及到自定义接口：</strong></p><ol><li><p>我设想的分为两种，一种是由后端提供好一些标准通用接口写用户文档提供给用户，让用户按文档配置接口<br>一种时用户需要接口时就去找你们后端即时沟通，都跟前端没关系</p></li><li><p>API接口需要附带请求信息，例如：token<br>在拉取页面内容数据时，写一个递归函数，如果获取到的json数据中存在api配置信息为这个api配置插入一些当前项目下的state<br>示例：详见：<a class="link"   href="https://aisuda.bce.baidu.com/amis/zh-CN/docs/types/api" >API配置<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p><blockquote><p>概括：动态参数渲染时追加</p></blockquote><div class="code-container" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 假设下方是一个获取到的页面组件数据</span></span><br><span class="line"><span class="keyword">const</span> json = &#123;</span><br><span class="line">  <span class="string">&quot;type&quot;</span>: <span class="string">&quot;page&quot;</span>,</span><br><span class="line">  <span class="string">&quot;initApi&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;method&quot;</span>: <span class="string">&quot;get&quot;</span>,</span><br><span class="line">    <span class="string">&quot;url&quot;</span>: <span class="string">&quot;/amis/api/xxx&quot;</span>,</span><br><span class="line">    <span class="string">&quot;responseData&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;&amp;&quot;</span>: <span class="string">&quot;$$&quot;</span>,</span><br><span class="line">      <span class="string">&quot;first&quot;</span>: <span class="string">&quot;$&#123;items|first&#125;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 此时使用一个递归函数判断如果存在key为url的组件信息</span></span><br><span class="line"><span class="comment">// 先从state中获取token</span></span><br><span class="line"><span class="keyword">const</span> token = <span class="string">&quot;xxx&quot;</span></span><br><span class="line">json.<span class="property">initApi</span>.<span class="property">headers</span> = &#123;<span class="string">&quot;token&quot;</span>: token&#125;</span><br></pre></td></tr></table></figure></div></li></ol><h2 id="ERROR"><a href="#ERROR" class="headerlink" title="ERROR"></a>ERROR</h2><ul><li><p>(&#x2F;((?:https?|file):.*?)\n&#x2F;.test(…) &amp;&amp; RegExp.$1).replace is not a function<br>webpack编译的devtool修改为：source-map<br><code>vue.config.js</code></p><div class="code-container" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; defineConfig &#125; = <span class="built_in">require</span>(<span class="string">&quot;@vue/cli-service&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">CopyPlugin</span> = <span class="built_in">require</span>(<span class="string">&quot;copy-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">    <span class="attr">transpileDependencies</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">configureWebpack</span>: <span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</span><br><span class="line">        config.<span class="property">plugins</span> = config.<span class="property">plugins</span> || [];</span><br><span class="line">        config.<span class="property">plugins</span>.<span class="title function_">push</span>(</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">CopyPlugin</span>(&#123;</span><br><span class="line">                <span class="attr">patterns</span>: [&#123; <span class="attr">from</span>: <span class="string">&quot;node_modules/amis/sdk&quot;</span>, <span class="attr">to</span>: <span class="string">&quot;amis/sdk&quot;</span> &#125;],</span><br><span class="line">            &#125;)</span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> === <span class="string">&quot;production&quot;</span>) &#123;</span><br><span class="line">            <span class="comment">// 为生产环境修改配置...</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 为开发环境修改配置...</span></span><br><span class="line">            config.<span class="property">devtool</span> = <span class="string">&quot;source-map&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div></li><li><p>TypeError: tslib.__spreadArrays is not a function<br><code>npm i tslib@latest</code></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 泛前端-Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 低代码 </tag>
            
            <tag> Amis </tag>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>旧版Jetbrains家系列软件无限试用方案</title>
      <link href="/2021/03/12/Jetbrains/"/>
      <url>/2021/03/12/Jetbrains/</url>
      
        <content type="html"><![CDATA[<h2 id="无限试用"><a href="#无限试用" class="headerlink" title="无限试用"></a>无限试用</h2><p><strong>Jetbrains系列通用2021.1.3版本及以前,以WIN10为例</strong></p><ol><li><p>查看IDEA的APPDATA目录,如果您未自定义的话它一般存放在：</p><blockquote><p>C:\Users\你的用户\AppData\Roaming\JetBrains</p></blockquote><p>如果您并未看到jetbrains目录请查看您的安装路径及在磁盘检索此目录</p></li><li><p>查看注册表</p><blockquote><p>win+R 打开CMD命令行</p><p>输入：regedit</p><p>路径：HKEY_CURRENT_USER\SOFTWARE\JavaSoft\Prefs\jetbrains</p></blockquote></li><li><p>写bat脚本</p><blockquote><p>此处以我的目录为例，重置phpstorm goland intellijidea</p><p>依次删除：eval目录  options\other.xml文件   注册表</p></blockquote><p>**注意：**请将下方对应路径替换为你自己的路径，运行bat脚本时以管理员身份运行</p><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">:phpstorm</span><br><span class="line">rd /s/q C:\Users\oursdreams\AppData\Roaming\JetBrains\PhpStorm2021.1\<span class="built_in">eval</span></span><br><span class="line">del C:\Users\oursdreams\AppData\Roaming\JetBrains\PhpStorm2021.1\options\other.xml</span><br><span class="line">reg delete HKEY_CURRENT_USER\SOFTWARE\JavaSoft\Prefs\jetbrains\phpstorm /f</span><br><span class="line"></span><br><span class="line">:goland</span><br><span class="line">rd /s/q C:\Users\oursdreams\AppData\Roaming\JetBrains\GoLand2021.1\<span class="built_in">eval</span></span><br><span class="line">del C:\Users\oursdreams\AppData\Roaming\JetBrains\GoLand2021.1\options\other.xml</span><br><span class="line">reg delete HKEY_CURRENT_USER\SOFTWARE\JavaSoft\Prefs\jetbrains\goland /f</span><br><span class="line"></span><br><span class="line">:intelliJIdea</span><br><span class="line">rd /s/q C:\Users\oursdreams\AppData\Roaming\JetBrains\IntelliJIdea2021.1\<span class="built_in">eval</span></span><br><span class="line">del C:\Users\oursdreams\AppData\Roaming\JetBrains\IntelliJIdea2021.1\options\other.xml</span><br><span class="line">reg delete HKEY_CURRENT_USER\SOFTWARE\JavaSoft\Prefs\jetbrains\idea /f</span><br><span class="line"></span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure></div></li></ol><h2 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h2><blockquote><p>键位说明对应键盘键位,多键组合以+号连接</p></blockquote><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#唤出页面总览，列表显示当前打开的页面</span></span><br><span class="line">连按两次 <span class="built_in">shift</span></span><br><span class="line"><span class="comment">#向后缩进</span></span><br><span class="line">tab</span><br><span class="line"><span class="comment">#向前缩进</span></span><br><span class="line"><span class="built_in">shift</span> + tab</span><br><span class="line"><span class="comment">#创建并打开一个临时文件</span></span><br><span class="line"><span class="built_in">shift</span> + ctrl + alt + insert</span><br><span class="line"><span class="comment">#选择两个文件对比差异</span></span><br><span class="line">选中文件右击-&gt;Compare With</span><br><span class="line"><span class="comment">#比较粘贴板与当前文件差异</span></span><br><span class="line">复制当前文本后做修改-&gt;右击-&gt;Compare With Clipboard</span><br><span class="line"><span class="comment">#全局搜索文件内容</span></span><br><span class="line"><span class="built_in">shift</span> + ctrl + F</span><br><span class="line"><span class="comment">#全局替换文件内容</span></span><br><span class="line"><span class="built_in">shift</span> + ctrl + R</span><br><span class="line"><span class="comment">#git管理列表 可切换分支 上传等</span></span><br><span class="line"><span class="built_in">shift</span> + ctrl + ~</span><br><span class="line"><span class="comment">#全局搜索文件名</span></span><br><span class="line">ctrl + <span class="built_in">shift</span> + alt + N</span><br><span class="line"><span class="comment">#打开最近使用文件列表</span></span><br><span class="line">ctrl + E</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      
        <tags>
            
            <tag> tool </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
