<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="不易">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
        
        
        
            <link rel="preconnect" href="https://evan.beee.top" crossorigin>
        
    
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://example.com/2025/03/12/设计模式/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
    
    
        
        <meta name="description" content="Hexo Theme Redefine, Redefine Your Hexo Journey.">
<meta property="og:type" content="article">
<meta property="og:title" content="设计模式-Java示例">
<meta property="og:url" content="http://example.com/2025/03/12/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/index.html">
<meta property="og:site_name" content="ourdreams">
<meta property="og:description" content="Hexo Theme Redefine, Redefine Your Hexo Journey.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/images/redefine-og.webp">
<meta property="article:published_time" content="2025-03-12T14:07:05.000Z">
<meta property="article:modified_time" content="2025-03-27T08:21:30.805Z">
<meta property="article:author" content="不易">
<meta property="article:tag" content="设计架构">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/redefine-og.webp">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/redefine-favicon.svg" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/redefine-favicon.svg">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="/images/redefine-favicon.svg">
    <!--- Page Info-->
    
    <title>
        
            设计模式-Java示例 | ourdreams
        
    </title>

    <link rel="stylesheet" href="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/fonts/Chillax/chillax.css">

    <!--- Inject Part-->
    

    
<link rel="stylesheet" href="/css/style.css">


    
        <link rel="stylesheet" href="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/css/build/tailwind.css">
    

    <link rel="stylesheet" href="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/fonts/GeistMono/geist-mono.css">
    <link rel="stylesheet" href="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/fonts/Geist/geist.css">
    <!--- Font Part-->
    
    
    
    
    
    

    <script id="hexo-configurations">
    window.config = {"hostname":"example.com","root":"/","language":"zh-CN","path":"search.xml"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"delete_mask":false,"title_alignment":"left","headings_top_spacing":{"h1":"3.2rem","h2":"2.4rem","h3":"1.9rem","h4":"1.6rem","h5":"1.4rem","h6":"1.3rem"}},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":["不全的全栈"]},"code_block":{"copy":true,"style":"mac","highlight_theme":{"light":"github","dark":"vs2015"},"font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":3,"number":false,"expand":true,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"pangu_js":false,"recommendation":{"enable":false,"title":"推荐阅读","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":null,"default_mode":"light"},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null},"title":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":false,"percentage":true},"website_counter":{"url":"https://cn.vercount.one/js","enable":false,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":{"enable":false,"custom_message":null},"open_graph":{"enable":true,"image":"/images/redefine-og.webp","description":"Hexo Theme Redefine, Redefine Your Hexo Journey."},"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/wallhaven-wqery6-light.webp","dark":"/images/wallhaven-wqery6-dark.webp"},"title":"Easy to know, easy to be ignorant","subtitle":{"text":["Easier said than done."],"hitokoto":{"enable":false,"show_author":false,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":false,"smart_backspace":false},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":false,"style":"default","links":{"github":null,"instagram":null,"zhihu":null,"twitter":null,"email":null},"qrs":{"weixin":null}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null,"lrc":null}]},"mermaid":{"enable":false,"version":"11.4.1"}},"version":"2.8.2","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"width":{"home":"1200px","pages":"1000px"},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"}},"search":{"enable":true,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":null,"show_on_mobile":true,"links":null},"article_date_format":"auto","excerpt_length":200,"categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}},"footerStart":"2025/3/12 11:45:14"};
    window.lang_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    <link rel="stylesheet" href="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/fontawesome/fontawesome.min.css">
    <link rel="stylesheet" href="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/fontawesome/brands.min.css">
    <link rel="stylesheet" href="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/fontawesome/solid.min.css">
    <link rel="stylesheet" href="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/fontawesome/regular.min.css">
    
    
    
    
<meta name="generator" content="Hexo 7.3.0"></head>



<body>
	<div class="progress-bar-container">
	

	
	<span class="pjax-progress-bar"></span>
	<!--        <span class="swup-progress-icon">-->
	<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
	<!--        </span>-->
	
</div>

<main class="page-container" id="swup">

	

	<div class="main-content-container flex flex-col justify-between min-h-dvh">
		<div class="main-content-header">
			<header class="navbar-container px-6 md:px-12">
    <div class="navbar-content transition-navbar ">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                ourdreams
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    首页
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i>
                    </div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                首页
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            

            
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">28</div>
        <div class="label text-third-text-color text-sm">标签</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">9</div>
        <div class="label text-third-text-color text-sm">分类</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">46</div>
        <div class="label text-third-text-color text-sm">文章</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


		</div>

		<div class="main-content-body transition-fade-up">
			

			<div class="main-content">
				<div class="post-page-container flex relative justify-between box-border w-full h-full">
	<div class="article-content-container">

		<div class="article-title relative w-full">
			
			<div class="w-full flex items-center pt-6 justify-start">
				<h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">设计模式-Java示例</h1>
			</div>
			
		</div>

		
		<div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
			<div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
				<img src="/images/redefine-avatar.jpg">
			</div>
			<div class="info flex flex-col justify-between">
				<div class="author flex items-center">
					<span class="name text-default-text-color text-lg font-semibold">不易</span>
					
					<span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">不全的全栈</span>
					
				</div>
				<div class="meta-info">
					<div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2025-03-12 22:07:05</span>
        <span class="mobile">2025-03-12 22:07:05</span>
        <span class="hover-info">创建</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2025-03-27 16:21:30</span>
            <span class="mobile">2025-03-27 16:21:30</span>
            <span class="hover-info">更新</span>
        </span>
    

    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%9E%B6%E6%9E%84/">设计架构</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
</div>

				</div>
			</div>
		</div>
		

		


		<div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
			<ul>
<li>工厂方法</li>
</ul>
<p><strong>在父类中提供一个创建对象的接口以允许子类决定实例化对象的类型</strong></p>
<blockquote>
<p>从业务角度行为一致，结构&#x2F;方式不同</p>
<blockquote>
<p>场景：工厂发送商品至买家手中</p>
<p>行为：工厂出货→物流运输→买家签收</p>
<p>结构：物流运输分为 陆运&#x2F;海运&#x2F;空运等</p>
</blockquote>
</blockquote>
<ul>
<li>抽象工厂</li>
</ul>
<p><strong>让你能创建一系列相关的对象，而无需指定其具体类</strong></p>
<blockquote>
<p>从描述角度一个组装品本质一致，细节不同</p>
<blockquote>
<p>场景：装修购买一套家具</p>
<p>结构：组成&lt; 椅子,沙发,桌子</p>
<p>细节：赛博朋克风格家具，维多利亚风格家具，传统风格家具</p>
</blockquote>
</blockquote>
<ul>
<li>生成器</li>
</ul>
<p><strong>使你能够分步骤创建复杂对象。该模式允许你使用相同的创建代码生成不同类型和形式的对象</strong></p>
<blockquote>
<p>从结构角度一个组装品的组成部分不同，结果&#x2F;对象一致</p>
<blockquote>
<p>场景：建造一间房屋</p>
<p>结构：墙面,屋顶,大门……</p>
<p>行为：可以为该房屋随意的扩展添加组成&#x2F;装饰 零件,例如：花园,大树,邮箱</p>
</blockquote>
</blockquote>
<blockquote>
<p>示例：Maybatis中的QUERY构建器</p>
</blockquote>
<ul>
<li>原型</li>
</ul>
<p><strong>让你能够复制已有对象，而又无需使代码依赖他们所属的类</strong></p>
<blockquote>
<p>从结构角度一个组装品的组成部分相同，结果&#x2F;对象不一致</p>
<blockquote>
<p>场景：图形编辑器软件</p>
<p>结构：形状</p>
<p>行为：复制一个形状到画布上，完全不干扰&#x2F;依赖 原形状</p>
</blockquote>
</blockquote>
<ul>
<li>单例</li>
</ul>
<p><strong>让你能够保证一个类只有一个实例，并提供一个访问该实例的全局节点</strong></p>
<blockquote>
<p>控制某些共享资源 （例如数据库或文件） 的访问权限</p>
<p>保护该实例不被其他代码覆盖</p>
<p>解决同一个问题的代码分散在程序各处的。 因此更好的方式是将其放在同一个类中， 特别是当其他代码已经依赖这个类时更应该如此</p>
<blockquote>
<p>场景：连接数据库</p>
<p>需求：执行N条SQL</p>
<p>行为：这N条SQL分散在程序各处的各个线程执行，但它们对于数据库的连接应该是唯一性的，因为CONNECTION的过程是极度耗费资源消耗的</p>
</blockquote>
</blockquote>
<ul>
<li>适配器</li>
</ul>
<p><strong>让接口不兼容的对象能够相互合作</strong></p>
<blockquote>
<p>转换对象接口， 使其能与其他对象进行交互</p>
<p>将复杂的转换过程隐藏于幕后。 被封装的对象甚至察觉不到适配器的存在</p>
<blockquote>
<p>场景：程序调用XML格式的第三方接口 给 JSON格式的插件</p>
<p>​			同时提供<em>Type-C</em>接口与<em>Type-A</em>的充电头转换器</p>
<p>方式：适配器实现与其中一个现有对象兼容的接口</p>
<p>​			现有对象可以使用该接口安全地调用适配器方法</p>
<p>​			适配器方法被调用后将以另一个对象兼容的格式和顺序将请求传递给该对象</p>
</blockquote>
</blockquote>
<ul>
<li>桥接</li>
</ul>
<p><strong>可将一个大类或一系列紧密相关的类拆分为抽象和实现两个独立的层次结构，从而在开发时分别使用</strong></p>
<blockquote>
<p>如果你想要拆分或重组一个具有多重功能的庞杂类（例如能与多个数据库服务器进行交互的类）</p>
<p>如果你希望在几个独立维度上扩展一个类</p>
<p>如果你需要在运行时切换不同实现方法</p>
<blockquote>
<p>场景：遥控器与电子设备</p>
<p>方式：不必将它们联系在一起制作，单独的去制作遥控器 再 单独的制作电子设备，通过客户端实现其通用接口使其产生联系</p>
</blockquote>
</blockquote>
<ul>
<li>组合</li>
</ul>
<p><strong>你可以使用它将对象组合成树状结构，并且能像使用独立对象一样使用它们</strong></p>
<blockquote>
<p>全部对象继承通用接口，以链表的单向递归形式去设定叶节点来构造树</p>
<blockquote>
<p>场景：部队的梯次编制结构</p>
<p>方式：军事命令由最高层下达， 通过每个层级传递， 直到每位士兵都知道自己应该服从的命令</p>
</blockquote>
</blockquote>
<ul>
<li>装饰</li>
</ul>
<p><strong>允许你通过将对象放入包含行为的特殊封装对象中来为原对象绑定新的行为</strong></p>
<blockquote>
<p>继承原对象接口并扩展原对象功能</p>
<blockquote>
<p>场景：读取一个文件，并对文件进行 加密或压缩</p>
<p>行为：一个基础的文件读取类，与两个扩展类(继承)，文件加密文件压缩</p>
</blockquote>
</blockquote>
<ul>
<li>外观</li>
</ul>
<p><strong>能为程序库，框架或其他复杂类提供一个简单的接口</strong></p>
<blockquote>
<p>对一个复杂流程提供一些通用的简单处理服务</p>
<blockquote>
<p>场景：电话购物</p>
<p>行为：仓库→包装→发货→送货→纳税… 实际上你只需要同接线员进行沟通说明你购买什么物品其就会按照通用的服务接口进行处理</p>
</blockquote>
</blockquote>
<ul>
<li>享元</li>
</ul>
<p><strong>摒弃了在每个对象中保存所有数据的方式，通过共享多个对象所共有的相同状态，让你能在有限的内存容量中载入更多对象</strong></p>
<blockquote>
<p>创建独立的情景类来存储外在状态和对享元对象的引用</p>
<p>享元对象是不可变的且应该具备一个外部公开的享元工厂</p>
<blockquote>
<p>场景：程序上构建一片草原</p>
<p>行为：每株草都有自己的属性与坐标，它们构成一个复杂对象，但是它们的外形都是相同的，对于外形的描述应该是针对享元对象的引用</p>
</blockquote>
</blockquote>
<ul>
<li>代理</li>
</ul>
<p><strong>让你能够提供对象的代替品或其占位符。代理控制着对于原对象的访问，并允许在将请求提交给对象前后进行一些处理</strong></p>
<blockquote>
<p>建议新建一个与原服务对象接口相同的代理类， 然后更新应用以将代理对象传递给所有原始对象客户端。 代理类接收到客户端请求后会创建实际的服务对象， 并将所有工作委派给它</p>
<p>数据库连接池是数据库的代理	信用卡是银行账户的代理</p>
<p> 延迟初始化(虚拟代理),如果你有一个偶尔使用的重量级服务对象,一直保持该对象运行会消耗系统资源时</p>
<p>访问控制(保护代理),如果你希望特定的客户端使用服务对象</p>
<p>本地执行远程服务(远程代理)。适用于服务对象位于远程服务器上的情形</p>
<p>记录日志请求(日志记录代理)。适用于当你需要保存对于服务对象的请求历史记录时</p>
<p>缓存请求结果(缓存代理)。适用于需要缓存客户请求结果并对缓存生命周期进行管理时，特别是当返回结果的体积非常大时</p>
<p>智能引用。可在没有客户端使用某个重量级对象时立即销毁该对象</p>
</blockquote>
<ul>
<li>责任链</li>
<li>命令</li>
<li>迭代器</li>
<li>中介者</li>
<li>备忘录</li>
<li>观察者</li>
<li>状态</li>
<li>策略</li>
<li>模板方法</li>
</ul>
<p><strong>在超类中定义一个算法框架，允许子类在不修改结构的情况下重写算法的特定步骤</strong></p>
<blockquote>
<p>只希望客户端扩展某个特定算法步骤，而不是整个算法或其结构时</p>
<p>多个类的算法除一些细微不同之外几乎完全一样时</p>
</blockquote>
<p>类比：真实世界的房屋构造，其是制式规整的，但你可以对其制式的每一个环节做一些微小的改动</p>
<ul>
<li>访问者</li>
</ul>
<p><strong>将算法与其作用的对象隔离开来</strong></p>
<blockquote>
<p>一个保险推销员：如果建筑是居民楼， 他会推销医疗保险	如果建筑是银行， 他会推销失窃保险	如果建筑是咖啡厅， 他会推销火灾和洪水保险</p>
<p>对一个复杂对象结构中的所有元素执行某些操作</p>
<p>清理辅助行为的业务逻辑</p>
<p>某个行为仅在类层次结构中的一些类中有意义，而在其他类中没有意义时</p>
</blockquote>
<h1 id="设计模式"><a href="#设计模式" class="headerlink" title="设计模式"></a>设计模式</h1><p><strong>来源地址：</strong><a class="link"   target="_blank" rel="noopener" href="https://refactoringguru.cn/design-patterns" >常见设计模式<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<h2 id="创建型模式"><a href="#创建型模式" class="headerlink" title="创建型模式"></a>创建型模式</h2><h3 id="工厂-★☆☆"><a href="#工厂-★☆☆" class="headerlink" title="工厂 ★☆☆"></a>工厂 ★☆☆</h3><blockquote>
<p>在父类中提供一个创建对象的接口以允许子类决定实例化对象的类型</p>
</blockquote>
<p>一个物流公司会将货品从出库到买家手中分为几个特定作业阶段，不管物流方式是采取公路&#x2F;铁路&#x2F;水路…运输都经由此过程</p>
<table>
<thead>
<tr>
<th>优点 √</th>
<th>缺点 ×</th>
</tr>
</thead>
<tbody><tr>
<td>避免紧耦合：创建者和具体产品间<br>单一职责：更易维护<br>开闭原则：利于扩展</td>
<td>代码复杂度加大：引入过多子类</td>
</tr>
</tbody></table>
<p><strong>举例</strong></p>
<p>种一棵果树并采摘其果实</p>
<p>产品接口：果树</p>
<p>产品实现类(继承产品接口)：苹果树类，橘子树类</p>
<p>工厂抽象类：采摘（定义两个方法,普通方法采摘动作,抽象方法种植果树）</p>
<p>具体创建者：苹果树采摘类，橘子树采摘类（实现抽象方法种植不同的果树）</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 产品接口类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">FruitTree</span>&#123;</span><br><span class="line">     <span class="keyword">void</span> <span class="title function_">fertilization</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 产品接口实现类1</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AppleTree</span> <span class="keyword">implements</span> <span class="title class_">FruitTree</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">fertilization</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;施肥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 产品接口实现类2</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">OrangeTree</span> <span class="keyword">implements</span> <span class="title class_">FruitTree</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">fertilization</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;施肥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 工厂抽象类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Factory</span>&#123;</span><br><span class="line">    <span class="keyword">abstract</span> FruitTree <span class="title function_">createTree</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">picking</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">FruitTree</span> <span class="variable">tree</span> <span class="operator">=</span> createTree();</span><br><span class="line">        tree.fertilization();</span><br><span class="line">        System.out.println(<span class="string">&quot;先施肥然后采摘了&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 具体的创建者1</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CreateAppleAction</span> <span class="keyword">extends</span> <span class="title class_">Factory</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    FruitTree <span class="title function_">createTree</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">AppleTree</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 具体的创建者2</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CreateOrangeAction</span> <span class="keyword">extends</span> <span class="title class_">Factory</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    FruitTree <span class="title function_">createTree</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">OrangeTree</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="抽象工厂-★★☆"><a href="#抽象工厂-★★☆" class="headerlink" title="抽象工厂 ★★☆"></a>抽象工厂 ★★☆</h3><blockquote>
<p>创建一系列相关的对象，而无需指定其具体的实现类</p>
</blockquote>
<p>家具工厂，为同类产品的不同风格提供统一规范，由各自系列去实现此规范来推出该系列风格产品</p>
<table>
<thead>
<tr>
<th>优点 √</th>
<th>缺点 ×</th>
</tr>
</thead>
<tbody><tr>
<td>避免紧耦合：创建者和具体产品间<br>单一职责：更易维护<br>开闭原则：利于扩展<br>兼容性：同一抽象工厂的产品相互匹配</td>
<td>代码复杂度加大：引入过多子类</td>
</tr>
</tbody></table>
<p><strong>举例</strong></p>
<p>基于工厂的扩展，基础部分同工厂一致，是增量的行为</p>
<p>接上述：手动创建具体的果树对象变为增加一层包装仅使用抽象工厂行为</p>
<p>通过某些条件(参数，配置等)来选择性创建具体的工厂对象</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 包装容器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Application</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> FruitTree tree;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Application</span><span class="params">(Factory factory)</span> &#123;</span><br><span class="line">        tree = factory.createTree();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 调用示例</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Demo</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">(<span class="type">int</span> money)</span>&#123;</span><br><span class="line">        <span class="comment">// 根据传入的金钱来判断</span></span><br><span class="line">        Application application;</span><br><span class="line">        <span class="comment">// 大于十块钱就种苹果树 否则 橘子树</span></span><br><span class="line">        <span class="keyword">if</span> (money &gt; <span class="number">10</span>)&#123;</span><br><span class="line">            application = <span class="keyword">new</span> <span class="title class_">Application</span>(<span class="keyword">new</span> <span class="title class_">CreateAppleAction</span>());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            application = <span class="keyword">new</span> <span class="title class_">Application</span>(<span class="keyword">new</span> <span class="title class_">CreateOrangeAction</span>());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 施肥</span></span><br><span class="line">        application.tree.fertilization();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="生成器-建造者-★★☆"><a href="#生成器-建造者-★★☆" class="headerlink" title="生成器(建造者) ★★☆"></a>生成器(建造者) ★★☆</h3><blockquote>
<p>分步创建复杂对象。该模式允许使用相同的创建代码生成不同类型和形式的对象</p>
</blockquote>
<p>建造房屋时，除了房屋主体架构，其余的部件都是“可选的”</p>
<table>
<thead>
<tr>
<th>优点 √</th>
<th>缺点 ×</th>
</tr>
</thead>
<tbody><tr>
<td>小粒度：分步创建对象,暂缓创建步骤或递归运行创建步骤。<br>可复用：生成不同形式的产品时， 可以复用相同的制造代码。<br>单一职责：将复杂构造代码从产品的业务逻辑中分离出来</td>
<td>代码复杂度加大：引入过多类</td>
</tr>
</tbody></table>
<p><strong>举例</strong></p>
<p>将各种可选择的步骤组件化，分步调用</p>
<p>去一家面馆要了一碗面，喊老板加一个鸡蛋，又喊老板加一块肉，又喊老板加一点辣椒</p>
<p>对于上述而言，后续步骤都是组件(可选的)，此时应用生成器来分步生成</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">A</span> <span class="variable">a</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">A</span>();</span><br><span class="line">        a.test().test2().test().test2();</span><br><span class="line">        System.out.println(a.b.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> ArrayList&lt;Integer&gt; b;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">A</span><span class="params">()</span>&#123;</span><br><span class="line">       b = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(<span class="number">16</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> A <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        b.add(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> A <span class="title function_">test2</span><span class="params">()</span>&#123;</span><br><span class="line">        b.add(<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>最为简单的写法,不多赘述,类比SpringCloud的QueryWrapper或Laravel的Builder</p>
<h3 id="原型-★☆☆"><a href="#原型-★☆☆" class="headerlink" title="原型 ★☆☆"></a>原型 ★☆☆</h3><blockquote>
<p>复制已有对象，而又无需使代码依赖它们所属的类</p>
</blockquote>
<p>现实生活中， 产品在得到大规模生产前会使用原型进行各种测试。 但在这种情况下， 原型只是一种被动的工具， 不参与任何真正的生产活动。</p>
<table>
<thead>
<tr>
<th>优点 √</th>
<th>缺点 ×</th>
</tr>
</thead>
<tbody><tr>
<td>解耦：克隆对象而无需与它们所属的具体类相耦合<br>可复用：克隆预生成原型,避免反复运行初始化代码<br>简洁：更方便的生成复杂对象<br>扩展：用继承以外的方式来处理复杂对象的不同配置</td>
<td>复杂度：克隆包含循环引用的复杂对象可能会非常麻烦</td>
</tr>
</tbody></table>
<p><strong>举例</strong></p>
<p>去面馆吃饭，一碗煮好的纯面放在桌上(抽象的原型)，抽象一个克隆方法，建立构造方法传递原型对象，克隆此对象内部属性</p>
<p>要了一碗牛肉面，继承这个原型，在这个原型基础上加上牛肉汤与牛肉等配料，且实现克隆方法创建新的对象传入当前对象</p>
<p>建立构造方法，实现父类，仅克隆此类扩展部分</p>
<p>再要一碗牛肉面时通过第一碗牛肉面克隆，返回原型再类型强转回具体类</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 面条</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Noodle</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String bowl;</span><br><span class="line">    <span class="keyword">private</span> String ramen;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Noodle</span><span class="params">()</span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Noodle</span><span class="params">(Noodle noodle)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.bowl = noodle.bowl;</span><br><span class="line">        <span class="built_in">this</span>.ramen = noodle.ramen;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> Noodle <span class="title function_">clone</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 牛肉面</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BeefNoodle</span> <span class="keyword">extends</span> <span class="title class_">Noodle</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String beefSoup;</span><br><span class="line">    <span class="keyword">private</span> String beef;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BeefNoodle</span><span class="params">()</span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BeefNoodle</span><span class="params">(BeefNoodle beefNoodle)</span>&#123;</span><br><span class="line">        <span class="built_in">super</span>(beefNoodle);</span><br><span class="line">        <span class="built_in">this</span>.beefSoup = beefNoodle.beefSoup;</span><br><span class="line">        <span class="built_in">this</span>.beef = beefNoodle.beef;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Noodle <span class="title function_">clone</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BeefNoodle</span>(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="单例-★☆☆"><a href="#单例-★☆☆" class="headerlink" title="单例 ★☆☆"></a>单例 ★☆☆</h3><blockquote>
<p>保证一个类只有一个实例，并提供一个访问该实例的全局节点</p>
</blockquote>
<p>政府是单例模式的一个很好的示例。 一个国家只有一个官方政府。 不管组成政府的每个人的身份是什么，  “某政府” 这一称谓总是鉴别那些掌权者的全局访问节点。</p>
<table>
<thead>
<tr>
<th>优点 √</th>
<th>缺点 ×</th>
</tr>
</thead>
<tbody><tr>
<td>唯一：你可以保证一个类只有一个实例<br>可控：你获得了一个指向该实例的全局访问节点<br>方便：仅在首次请求单例对象时对其进行初始化</td>
<td>违反单一职责<br>掩盖不良设计：各组件之间互相了解过多<br>并发性：多线程环境下需要特殊处理,避免多个线程多次创建单例对象<br>测试困难：单元测试可能会比较困难， 因为许多测试框架以基于继承的方式创建模拟对象</td>
</tr>
</tbody></table>
<p><strong>举例</strong></p>
<p>政府就是一个很好的例子，无论在哪个节点哪个线程上访问，其都是唯一的</p>
<p>不管组成政府的每个人的身份是什么，  “某政府” 这一称谓总是鉴别那些掌权者的全局访问节点</p>
<ul>
<li>单线程单例</li>
</ul>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;</span><br><span class="line">    <span class="keyword">public</span> String value;</span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">(String value)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstance</span><span class="params">(String value)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="literal">null</span>) &#123;</span><br><span class="line">            instance = <span class="keyword">new</span> <span class="title class_">Singleton</span>(value);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li>多线程单例</li>
</ul>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line">    <span class="comment">// 加volatile关键字来确保每次读值的即时性</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> Singleton instance;</span><br><span class="line">    <span class="keyword">public</span> String value;</span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">(String value)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstance</span><span class="params">(String value)</span> &#123;</span><br><span class="line">        <span class="comment">// 局部赋值一次是因为性能问题，被volatile修饰后的变量访问性能是低下的</span></span><br><span class="line">        <span class="comment">// 此能确保在当前线程内的操作访问是一次性的，这个性能差异可能会产生100倍以上的区别</span></span><br><span class="line">        <span class="type">Singleton</span> <span class="variable">result</span> <span class="operator">=</span> instance;</span><br><span class="line">        <span class="keyword">if</span> (result != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 启用同步锁进行《双重检查锁定》来确保并发场景下的实例唯一性</span></span><br><span class="line">        <span class="keyword">synchronized</span>(Singleton.class) &#123;</span><br><span class="line">            <span class="keyword">if</span> (instance == <span class="literal">null</span>) &#123;</span><br><span class="line">                instance = <span class="keyword">new</span> <span class="title class_">Singleton</span>(value);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> instance;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="结构型模式"><a href="#结构型模式" class="headerlink" title="结构型模式"></a>结构型模式</h2><h3 id="适配器-★☆☆"><a href="#适配器-★☆☆" class="headerlink" title="适配器 ★☆☆"></a>适配器 ★☆☆</h3><blockquote>
<p>让接口不兼容的对象能够相互合作</p>
</blockquote>
<p>如果你是第一次从美国到欧洲旅行， 那么在给笔记本充电时可能会大吃一惊。 不同国家的电源插头和插座标准不同。 美国插头和德国插座不匹配。 同时提供美国标准插座和欧洲标准插头的电源适配器可以解决你的难题。</p>
<table>
<thead>
<tr>
<th>优点 √</th>
<th>缺点 ×</th>
</tr>
</thead>
<tbody><tr>
<td>单一职责：接口或转换逻辑从主业务代码中抽离<br>开闭原则：在不修改现有客户端代码的情况下在程序中添加新类型的适配器</td>
<td>代码整体复杂度增加：需要新增一系列接口和类。 有时直接更改服务类使其与其他代码兼容会更简单</td>
</tr>
</tbody></table>
<p><strong>举例</strong></p>
<p>日常使用的手机充电线转接头，一个USB头的接口市面上大多分为三种：Micro USB(老式安卓)，Type-C(新型安卓)，Lightning(苹果)</p>
<p>如果我们忘带充电器或者更换手机，合适的接口充电问题将成为我们的障碍，这时需要一个《<strong>适配器</strong>》</p>
<p>下方用钉子来类比，圆孔只能插入圆钉，使用适配器将方钉来转换圆钉</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 圆孔</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RoundHole</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> radius;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">RoundHole</span><span class="params">(<span class="type">double</span> radius)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.radius = radius;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getRadius</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> radius;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">fits</span><span class="params">(RoundPeg peg)</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> result;</span><br><span class="line">        result = (<span class="built_in">this</span>.getRadius() &gt;= peg.getRadius());</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 圆钉</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RoundPeg</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> radius;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">RoundPeg</span><span class="params">()</span> &#123;&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">RoundPeg</span><span class="params">(<span class="type">double</span> radius)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.radius = radius;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getRadius</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> radius;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 方钉</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SquarePeg</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> width;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SquarePeg</span><span class="params">(<span class="type">double</span> width)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.width = width;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getWidth</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> width;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getSquare</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">double</span> result;</span><br><span class="line">        result = Math.pow(<span class="built_in">this</span>.width, <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 方钉适配器（转换为圆钉）</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SquarePegAdapter</span> <span class="keyword">extends</span> <span class="title class_">RoundPeg</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> SquarePeg peg;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SquarePegAdapter</span><span class="params">(SquarePeg peg)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.peg = peg;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getRadius</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">double</span> result;</span><br><span class="line">        result = (Math.sqrt(Math.pow((peg.getWidth() / <span class="number">2</span>), <span class="number">2</span>) * <span class="number">2</span>));</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="桥接-★★★"><a href="#桥接-★★★" class="headerlink" title="桥接 ★★★"></a>桥接 ★★★</h3><blockquote>
<p>让一个大类或紧密相关的类拆分为抽象和实现两个独立层次结构，从而能在开发时分别使用</p>
</blockquote>
<p>实现了同类规范的家电与其控制器（遥控器）是分离的且可以互相共用的</p>
<table>
<thead>
<tr>
<th>优点 √</th>
<th>缺点 ×</th>
</tr>
</thead>
<tbody><tr>
<td><em>业务解耦</em>：创建与平台无关的类和程序<br><em>代码解耦</em>：客户端代码仅与高层抽象部分进行互动， 不会接触到平台的详细信息<br><em>开闭</em>原则： 新增抽象部分和实现部分， 且它们之间不会相互影响<br><em>单一职责</em>：抽象部分专注于处理高层逻辑， 实现部分处理平台细节</td>
<td>对高内聚的类使用该模式可能会让代码更加复杂</td>
</tr>
</tbody></table>
<p><strong>举例</strong></p>
<p>设备和远程控制之间的桥接</p>
<p>设备抽象接口：Device</p>
<p>具体实现设备：Tv,Radio</p>
<p>远程控制器抽象接口：Remote</p>
<p>具体实现控制器：BasicRemote,AdvancedRemote</p>
<p>上述即为抽象设备与控制器的公有功能并通过接口桥接其具体实现类</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 设备抽象接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Device</span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置音量</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">setVolume</span><span class="params">(<span class="type">int</span> volume)</span>;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">getVolume</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 设备实现类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Tv</span> <span class="keyword">implements</span> <span class="title class_">Device</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">volume</span> <span class="operator">=</span> <span class="number">30</span>;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setVolume</span><span class="params">(<span class="type">int</span> volume)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.volume = volume &gt; <span class="number">100</span> ? <span class="number">100</span> : Math.max(volume, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getVolume</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> volume;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Radio</span> <span class="keyword">implements</span> <span class="title class_">Device</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">volume</span> <span class="operator">=</span> <span class="number">20</span>;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setVolume</span><span class="params">(<span class="type">int</span> volume)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.volume = volume &gt; <span class="number">120</span> ? <span class="number">120</span> : Math.max(volume, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getVolume</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> volume;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 控制器抽象接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Remote</span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 减小音量</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">volumeDown</span><span class="params">()</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 加大音量</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">volumeUp</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 控制器实现类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BasicRemote</span> <span class="keyword">implements</span> <span class="title class_">Remote</span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> Device device;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BasicRemote</span><span class="params">(Device device)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.device = device;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">volumeDown</span><span class="params">()</span> &#123;</span><br><span class="line">        device.setVolume(device.getVolume() - <span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">volumeUp</span><span class="params">()</span> &#123;</span><br><span class="line">        device.setVolume(device.getVolume() + <span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AdvancedRemote</span> <span class="keyword">extends</span> <span class="title class_">BasicRemote</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">AdvancedRemote</span><span class="params">(Device device)</span>&#123;</span><br><span class="line">        <span class="built_in">super</span>(device);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 静音</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">mute</span><span class="params">()</span> &#123;</span><br><span class="line">        device.setVolume(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="组合-★★☆"><a href="#组合-★★☆" class="headerlink" title="组合 ★★☆"></a>组合 ★★☆</h3><blockquote>
<p>你可以使用它将对象组合成树状结构，并且能像独立对象一样使用它们</p>
</blockquote>
<p>大部分国家的军队都采用层次结构管理。 每支部队包括几个师， 师由旅构成， 旅由团构成， 团可以继续划分为排。 最后， 每个排由一小队实实在在的士兵组成。 军事命令由最高层下达， 通过每个层级传递， 直到每位士兵都知道自己应该服从的命令。</p>
<table>
<thead>
<tr>
<th>优点 √</th>
<th>缺点 ×</th>
</tr>
</thead>
<tbody><tr>
<td>利用多态和递归机制更方便地使用复杂树结构<br><em>开闭原则</em>： 无需更改现有代码， 可以在应用中添加新元素， 使其成为对象树的一部分</td>
<td>对于功能差异较大的类， 提供公共接口或许会有困难。 在特定情况下， 你需要过度一般化组件接口， 使其变得令人难以理解</td>
</tr>
</tbody></table>
<p>举例：</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Shape</span>&#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">draw</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BaseShape</span> <span class="keyword">implements</span> <span class="title class_">Shape</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">draw</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;绘制形状&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 打印形状</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dot</span> <span class="keyword">extends</span> <span class="title class_">BaseShape</span>&#123;</span><br><span class="line">    Dot(<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">        <span class="built_in">this</span>.draw(x, y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">draw</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.draw(x, y);</span><br><span class="line">        System.out.println(<span class="string">&quot;绘制一个点&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span>  <span class="title class_">Circle</span> <span class="keyword">extends</span> <span class="title class_">BaseShape</span> &#123;</span><br><span class="line">    Circle(<span class="type">int</span> x, <span class="type">int</span> y, String color) &#123;</span><br><span class="line">        <span class="built_in">this</span>.draw(x, y);</span><br><span class="line">        <span class="built_in">this</span>.setColor(color);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">draw</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.draw(x, y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setColor</span><span class="params">(String color)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;上色&quot;</span>+color);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CompoundShape</span> <span class="keyword">extends</span> <span class="title class_">BaseShape</span> &#123;</span><br><span class="line">    CompoundShape(Shape... components) &#123;</span><br><span class="line">        <span class="keyword">for</span> (Shape component : components) &#123;</span><br><span class="line">            <span class="built_in">this</span>.add(component);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(Shape component)</span> &#123;</span><br><span class="line">        component.print();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">CompoundShape</span>(</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Dot</span>(<span class="number">1</span>, <span class="number">2</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Circle</span>(<span class="number">3</span>, <span class="number">4</span>, <span class="string">&quot;red&quot;</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">CompoundShape</span>(</span><br><span class="line">                    <span class="keyword">new</span> <span class="title class_">Dot</span>(<span class="number">5</span>, <span class="number">6</span>)</span><br><span class="line">            )</span><br><span class="line">    ).print();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>基于抽象做基础实现后可以以递归或树来随意实现组合类</p>
<h3 id="装饰-★★☆"><a href="#装饰-★★☆" class="headerlink" title="装饰 ★★☆"></a>装饰 ★★☆</h3><blockquote>
<p>允许你通过将对象放入包含行为的特殊封装对象中来为原对象绑定新的行为</p>
</blockquote>
<p>穿衣服是使用装饰的一个例子。 觉得冷时， 你可以穿一件毛衣。 如果穿毛衣还觉得冷， 你可以再套上一件夹克。 如果遇到下雨， 你还可以再穿一件雨衣。 所有这些衣物都 “扩展” 了你的基本行为， 但它们并不是你的一部分， 如果你不再需要某件衣物， 可以方便地随时脱掉。</p>
<table>
<thead>
<tr>
<th>优点 √</th>
<th>缺点 ×</th>
</tr>
</thead>
<tbody><tr>
<td>无需创建新的子类即可扩展对象行为<br />运行时添加或删除对象的功能<br />多个装饰封装对象来组合几种行为<br />单一职责。实现许多不同行为的大类拆分为多个较小的类</td>
<td>封装器栈中删除特定封装器比较困难<br />实现行为不受装饰栈顺序影响的装饰比较困难<br />各层的初始化配置代码看上去可能会很糟糕</td>
</tr>
</tbody></table>
<p>**用法：**装饰器标准用法是一个栈，如何“装饰的”必须按照顺序“拆分”，类比穿衣服: 内衣-内衬-外衣-雨衣  脱衣服则必须一层层脱</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.nio.charset.StandardCharsets;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.Deflater;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.DeflaterOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.InflaterInputStream;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 数据装饰器 </span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Decorator</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DataSource</span> &#123;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">writeData</span><span class="params">(String data)</span>;</span><br><span class="line">        String <span class="title function_">readData</span><span class="params">()</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">FileDataSource</span> <span class="keyword">implements</span> <span class="title class_">DataSource</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">FileDataSource</span><span class="params">(String name)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">writeData</span><span class="params">(String data)</span> &#123;</span><br><span class="line">            <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(name);</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="type">OutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(file);</span><br><span class="line">                fos.write(data.getBytes(StandardCharsets.UTF_8), <span class="number">0</span>, data.length());</span><br><span class="line">            &#125;<span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">readData</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="type">char</span>[] buff = <span class="literal">null</span>;</span><br><span class="line">            <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(name);</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="type">FileReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileReader</span>(file);</span><br><span class="line">                buff = <span class="keyword">new</span> <span class="title class_">char</span>[(<span class="type">int</span>)file.length()];</span><br><span class="line">                reader.read(buff);</span><br><span class="line">            &#125;<span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(buff);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">DataSourceDecorator</span> <span class="keyword">implements</span> <span class="title class_">DataSource</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> DataSource wrapper;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">DataSourceDecorator</span> <span class="params">(DataSource wrapper)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.wrapper = wrapper;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">writeData</span><span class="params">(String data)</span> &#123;</span><br><span class="line">            wrapper.writeData(data);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">readData</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> wrapper.readData();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">EncryptionDataSourceDecorator</span> <span class="keyword">extends</span> <span class="title class_">DataSourceDecorator</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">EncryptionDataSourceDecorator</span><span class="params">(DataSource wrapper)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(wrapper);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">writeData</span><span class="params">(String data)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>.writeData(encode(data));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">readData</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> decode(<span class="built_in">super</span>.readData());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> String <span class="title function_">encode</span><span class="params">(String data)</span> &#123;</span><br><span class="line">            <span class="type">byte</span>[] result = data.getBytes(StandardCharsets.UTF_8);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; result.length; i++) &#123;</span><br><span class="line">                result[i] += (<span class="type">byte</span>)<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> Base64.getEncoder().encodeToString(result);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> String <span class="title function_">decode</span><span class="params">(String data)</span> &#123;</span><br><span class="line">            <span class="type">byte</span>[] result = Base64.getDecoder().decode(data);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; result.length; i++) &#123;</span><br><span class="line">                result[i] -= (<span class="type">byte</span>)<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(result);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">CompressionDecorator</span> <span class="keyword">extends</span> <span class="title class_">DataSourceDecorator</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">CompressionDecorator</span><span class="params">(DataSource wrapper)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(wrapper);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> <span class="variable">compLevel</span> <span class="operator">=</span> <span class="number">6</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getCompressionLevel</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> compLevel;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCompressionLevel</span><span class="params">(<span class="type">int</span> level)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.compLevel = level;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">writeData</span><span class="params">(String data)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>.writeData(compress(data));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">readData</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> decompress(<span class="built_in">super</span>.readData());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">private</span> String <span class="title function_">compress</span><span class="params">(String stringData)</span> &#123;</span><br><span class="line">            <span class="type">byte</span>[] data = stringData.getBytes(StandardCharsets.UTF_8);</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="type">ByteArrayOutputStream</span> <span class="variable">bout</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>(<span class="number">512</span>);</span><br><span class="line">                <span class="type">DeflaterOutputStream</span> <span class="variable">dos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DeflaterOutputStream</span>(bout, <span class="keyword">new</span> <span class="title class_">Deflater</span>(compLevel));</span><br><span class="line">                dos.write(data);</span><br><span class="line">                dos.close();</span><br><span class="line">                bout.close();</span><br><span class="line">                <span class="keyword">return</span> Base64.getEncoder().encodeToString(bout.toByteArray());</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">private</span> String <span class="title function_">decompress</span><span class="params">(String compressData)</span> &#123;</span><br><span class="line">            <span class="type">byte</span>[] data = Base64.getDecoder().decode(compressData);</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="type">InputStream</span> <span class="variable">i</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(data);</span><br><span class="line">                <span class="type">InflaterInputStream</span> <span class="variable">iin</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InflaterInputStream</span>(i);</span><br><span class="line">                <span class="type">ByteArrayOutputStream</span> <span class="variable">bout</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>(<span class="number">512</span>);</span><br><span class="line">                <span class="type">int</span> b;</span><br><span class="line">                <span class="keyword">while</span> ((b = iin.read()) != -<span class="number">1</span>) &#123;</span><br><span class="line">                    bout.write(b);</span><br><span class="line">                &#125;</span><br><span class="line">                i.close();</span><br><span class="line">                iin.close();</span><br><span class="line">                bout.close();</span><br><span class="line">                <span class="keyword">return</span> bout.toString();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">salaryRecords</span> <span class="operator">=</span> <span class="string">&quot;测试&quot;</span>;</span><br><span class="line">        <span class="type">DataSourceDecorator</span> <span class="variable">decorator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CompressionDecorator</span>(<span class="keyword">new</span> <span class="title class_">EncryptionDataSourceDecorator</span>(<span class="keyword">new</span> <span class="title class_">FileDataSource</span>(<span class="string">&quot;decorator.txt&quot;</span>)));</span><br><span class="line">        decorator.writeData(salaryRecords);</span><br><span class="line">        <span class="type">DataSource</span> <span class="variable">plain</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileDataSource</span>(<span class="string">&quot;decorator.txt&quot;</span>);</span><br><span class="line">        System.out.println(salaryRecords);</span><br><span class="line">        System.out.println(plain.readData());</span><br><span class="line">        System.out.println(decorator.readData());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h3 id="外观-★★☆"><a href="#外观-★★☆" class="headerlink" title="外观 ★★☆"></a>外观 ★★☆</h3><blockquote>
<p>能为程序库，框架或其他复杂类提供一个简单的接口</p>
</blockquote>
<p>当你通过电话给商店下达订单时， 接线员就是该商店的所有服务和部门的外观。 接线员为你提供了一个同购物系统、 支付网关和各种送货服务进行互动的简单语音接口。</p>
<table>
<thead>
<tr>
<th>优点 √</th>
<th>缺点 ×</th>
</tr>
</thead>
<tbody><tr>
<td>让自己的代码独立于复杂子系统</td>
<td>外观可能成为与程序中所有类都耦合的上帝对象</td>
</tr>
</tbody></table>
<p>**用法：**外观的本质是为了简化实际使用者的操作的同时不影响扩展复杂&#x2F;自定义的操作行为。类比本存储库的Golang程序的php调用包Export方案</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 视频转换装饰器</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Facade</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">VideoFile</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">VideoFile</span> <span class="params">(String name)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">            <span class="built_in">this</span>.codecType = name.substring(name.indexOf(<span class="string">&quot;.&quot;</span>) + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">private</span> String codecType;</span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getCodecType</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> codecType;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> name;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">interface</span> <span class="title class_">Codec</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MPEG4CompressionCodec</span> <span class="keyword">implements</span> <span class="title class_">Codec</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">String</span> <span class="variable">type</span> <span class="operator">=</span> <span class="string">&quot;mp4&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">OggCompressionCodec</span> <span class="keyword">implements</span> <span class="title class_">Codec</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">String</span> <span class="variable">type</span> <span class="operator">=</span> <span class="string">&quot;ogg&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">CodecFactory</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> Codec <span class="title function_">extract</span><span class="params">(VideoFile file)</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">type</span> <span class="operator">=</span> file.getCodecType();</span><br><span class="line">            <span class="keyword">if</span> (type.equals(<span class="string">&quot;mp4&quot;</span>)) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;mpeg&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MPEG4CompressionCodec</span>();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;ogg&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">OggCompressionCodec</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">BitrateReader</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> VideoFile <span class="title function_">read</span><span class="params">(VideoFile file, Codec codec)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;bitrate read&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> file;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> VideoFile <span class="title function_">convert</span><span class="params">(VideoFile buffer, Codec codec)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;bitrate convert&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> buffer;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">AudioMixer</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> File <span class="title function_">fix</span><span class="params">(VideoFile result)</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;audioMixer&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;tmp&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">VideoConversionFacade</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> File <span class="title function_">conversionVideo</span><span class="params">(String filename, String format)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;facade&quot;</span>);</span><br><span class="line">            <span class="type">VideoFile</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">VideoFile</span>(filename);</span><br><span class="line">            <span class="type">Codec</span> <span class="variable">sourceCodec</span> <span class="operator">=</span> CodecFactory.extract(file);</span><br><span class="line">            Codec destinationCodec;</span><br><span class="line">            <span class="keyword">if</span> (format.equals(<span class="string">&quot;mp4&quot;</span>)) &#123;</span><br><span class="line">                destinationCodec = <span class="keyword">new</span> <span class="title class_">MPEG4CompressionCodec</span>();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                destinationCodec = <span class="keyword">new</span> <span class="title class_">OggCompressionCodec</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">VideoFile</span> <span class="variable">buffer</span> <span class="operator">=</span> BitrateReader.read(file, sourceCodec);</span><br><span class="line">            <span class="type">VideoFile</span> <span class="variable">intermediateResult</span> <span class="operator">=</span> BitrateReader.convert(buffer, destinationCodec);</span><br><span class="line">            <span class="type">File</span> <span class="variable">result</span> <span class="operator">=</span> (<span class="keyword">new</span> <span class="title class_">AudioMixer</span>()).fix(intermediateResult);</span><br><span class="line">            System.out.println(<span class="string">&quot;completed&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">VideoConversionFacade</span> <span class="variable">conversion</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">VideoConversionFacade</span>();</span><br><span class="line">        <span class="type">File</span> <span class="variable">newFile</span> <span class="operator">=</span> conversion.conversionVideo(<span class="string">&quot;youtubevideo.ogg&quot;</span>,<span class="string">&quot;mp4&quot;</span>);</span><br><span class="line">        System.out.println(newFile.getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="享元-★★★"><a href="#享元-★★★" class="headerlink" title="享元 ★★★"></a>享元 ★★★</h3><blockquote>
<p>摒弃了在每个对象中保存所有数据的方式，通过共享多个对象所共有的相同状态，让你能在有限的内存容量中载入更多的对象</p>
</blockquote>
<p>游戏中的场景元素是最常用的经典享元，它们的属性是同一对象</p>
<table>
<thead>
<tr>
<th>优点 √</th>
<th>缺点 ×</th>
</tr>
</thead>
<tbody><tr>
<td>程序中存在大量相似对象，那么你可以节省大量内存</td>
<td>牺牲执行速度来换取内存，因为他人每次调用享元方法时都需要重新计算部分场景数据<br />代码会变得复杂：“为什么要像这样拆分一个实体的状态”</td>
</tr>
</tbody></table>
<p>**用法：**多用于游戏领域，大量共用的场景属性复用</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 渲染1000000棵树来构建整片森林</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Flyweight</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Tree</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> x;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> y;</span><br><span class="line">        <span class="keyword">private</span> TreeType type;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Tree</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, TreeType type)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.x = x;</span><br><span class="line">            <span class="built_in">this</span>.y = y;</span><br><span class="line">            <span class="built_in">this</span>.type = type;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">draw</span><span class="params">(Graphics g)</span> &#123;</span><br><span class="line">            type.draw(g, x, y);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">TreeType</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">private</span> Color color;</span><br><span class="line">        <span class="keyword">private</span> String otherTreeData;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">TreeType</span><span class="params">(String name, Color color, String otherTreeData)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">            <span class="built_in">this</span>.color = color;</span><br><span class="line">            <span class="built_in">this</span>.otherTreeData = otherTreeData;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">draw</span><span class="params">(Graphics g, <span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">            g.setColor(Color.BLACK);</span><br><span class="line">            g.fillRect(x - <span class="number">1</span>, y, <span class="number">3</span>, <span class="number">5</span>);</span><br><span class="line">            g.setColor(color);</span><br><span class="line">            g.fillOval(x - <span class="number">5</span>, y - <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">TreeFactory</span> &#123;</span><br><span class="line">        <span class="keyword">static</span> Map&lt;String, TreeType&gt; treeTypes = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> TreeType <span class="title function_">getTreeType</span><span class="params">(String name, Color color, String otherTreeData)</span> &#123;</span><br><span class="line">            <span class="type">TreeType</span> <span class="variable">result</span> <span class="operator">=</span> treeTypes.get(name);</span><br><span class="line">            <span class="keyword">if</span> (result == <span class="literal">null</span>) &#123;</span><br><span class="line">                result = <span class="keyword">new</span> <span class="title class_">TreeType</span>(name, color, otherTreeData);</span><br><span class="line">                treeTypes.put(name, result);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Forest</span> <span class="keyword">extends</span> <span class="title class_">JFrame</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> List&lt;Tree&gt; trees = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">plantTree</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, String name, Color color, String otherTreeData)</span> &#123;</span><br><span class="line">            <span class="type">TreeType</span> <span class="variable">type</span> <span class="operator">=</span> TreeFactory.getTreeType(name, color, otherTreeData);</span><br><span class="line">            <span class="type">Tree</span> <span class="variable">tree</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Tree</span>(x, y, type);</span><br><span class="line">            trees.add(tree);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">paint</span><span class="params">(Graphics graphics)</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (Tree tree : trees) &#123;</span><br><span class="line">                tree.draw(graphics);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="variable">CANVAS_SIZE</span> <span class="operator">=</span> <span class="number">500</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="variable">TREES_TO_DRAW</span> <span class="operator">=</span> <span class="number">1000000</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="variable">TREE_TYPES</span> <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Forest</span> <span class="variable">forest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Forest</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; Math.floor(TREES_TO_DRAW / TREE_TYPES); i++) &#123;</span><br><span class="line">            forest.plantTree(random(<span class="number">0</span>, CANVAS_SIZE), random(<span class="number">0</span>, CANVAS_SIZE),</span><br><span class="line">                    <span class="string">&quot;Summer Oak&quot;</span>, Color.GREEN, <span class="string">&quot;Oak texture stub&quot;</span>);</span><br><span class="line">            forest.plantTree(random(<span class="number">0</span>, CANVAS_SIZE), random(<span class="number">0</span>, CANVAS_SIZE),</span><br><span class="line">                    <span class="string">&quot;Autumn Oak&quot;</span>, Color.ORANGE, <span class="string">&quot;Autumn Oak texture stub&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        forest.setSize(CANVAS_SIZE, CANVAS_SIZE);</span><br><span class="line">        forest.setVisible(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(TREES_TO_DRAW + <span class="string">&quot; trees drawn&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;---------------------&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;Memory usage:&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;Tree size (8 bytes) * &quot;</span> + TREES_TO_DRAW);</span><br><span class="line">        System.out.println(<span class="string">&quot;+ TreeTypes size (~30 bytes) * &quot;</span> + TREE_TYPES + <span class="string">&quot;&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;---------------------&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;Total: &quot;</span> + ((TREES_TO_DRAW * <span class="number">8</span> + TREE_TYPES * <span class="number">30</span>) / <span class="number">1024</span> / <span class="number">1024</span>) +</span><br><span class="line">                <span class="string">&quot;MB (instead of &quot;</span> + ((TREES_TO_DRAW * <span class="number">38</span>) / <span class="number">1024</span> / <span class="number">1024</span>) + <span class="string">&quot;MB)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">random</span><span class="params">(<span class="type">int</span> min, <span class="type">int</span> max)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> min + (<span class="type">int</span>) (Math.random() * ((max - min) + <span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="代理-★★☆"><a href="#代理-★★☆" class="headerlink" title="代理 ★★☆"></a>代理 ★★☆</h3><blockquote>
<p>让你能够提供对象的替代品或其占位符。代理控制着对于原对象的访问，并允许在将请求提交给对象前后进行一些处理</p>
</blockquote>
<p>信用卡是银行账户的代理， 银行账户则是一大捆现金的代理。 它们都实现了同样的接口， 均可用于进行支付。 消费者会非常满意， 因为不必随身携带大量现金； 商店老板同样会十分高兴， 因为交易收入能以电子化的方式进入商店的银行账户中， 无需担心存款时出现现金丢失或被抢劫的情况。</p>
<table>
<thead>
<tr>
<th>优点 √</th>
<th>缺点 ×</th>
</tr>
</thead>
<tbody><tr>
<td>你可以在客户端毫无察觉的情况下控制服务对象。<br /> 如果客户端对服务对象的生命周期没有特殊要求， 你可以对生命周期进行管理。<br />即使服务对象还未准备好或不存在， 代理也可以正常工作。<br /><em>开闭原则</em>。 你可以在不对服务或客户端做出修改的情况下创建新代理。</td>
<td>代码可能会变得复杂， 因为需要新建许多类。<br />服务响应可能会延迟。</td>
</tr>
</tbody></table>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Proxy</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Video</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> String id;</span><br><span class="line">        <span class="keyword">public</span> String title;</span><br><span class="line">        <span class="keyword">public</span> String data;</span><br><span class="line"></span><br><span class="line">        Video(String id, String title) &#123;</span><br><span class="line">            <span class="built_in">this</span>.id = id;</span><br><span class="line">            <span class="built_in">this</span>.title = title;</span><br><span class="line">            <span class="built_in">this</span>.data = <span class="string">&quot;Random video.&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ThirdPartyYouTubeLib</span> &#123;</span><br><span class="line">        HashMap&lt;String, Video&gt; <span class="title function_">popularVideos</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">        Video <span class="title function_">getVideo</span><span class="params">(String videoId)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ThirdPartyYouTubeClass</span> <span class="keyword">implements</span> <span class="title class_">ThirdPartyYouTubeLib</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> HashMap&lt;String, Video&gt; <span class="title function_">popularVideos</span><span class="params">()</span> &#123;</span><br><span class="line">            connectToServer(<span class="string">&quot;http://www.youtube.com&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> getRandomVideos();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> Video <span class="title function_">getVideo</span><span class="params">(String videoId)</span> &#123;</span><br><span class="line">            connectToServer(<span class="string">&quot;http://www.youtube.com/&quot;</span> + videoId);</span><br><span class="line">            <span class="keyword">return</span> getSomeVideo(videoId);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// -----------------------------------------------------------------------</span></span><br><span class="line">        <span class="comment">// Fake methods to simulate network activity. They as slow as a real life.</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">random</span><span class="params">(<span class="type">int</span> min, <span class="type">int</span> max)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> min + (<span class="type">int</span>) (Math.random() * ((max - min) + <span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">experienceNetworkLatency</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">randomLatency</span> <span class="operator">=</span> random(<span class="number">5</span>, <span class="number">10</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; randomLatency; i++) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">100</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException ex) &#123;</span><br><span class="line">                    ex.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">connectToServer</span><span class="params">(String server)</span> &#123;</span><br><span class="line">            System.out.print(<span class="string">&quot;Connecting to &quot;</span> + server + <span class="string">&quot;... &quot;</span>);</span><br><span class="line">            experienceNetworkLatency();</span><br><span class="line">            System.out.print(<span class="string">&quot;Connected!&quot;</span> + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> HashMap&lt;String, Video&gt; <span class="title function_">getRandomVideos</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.print(<span class="string">&quot;Downloading populars... &quot;</span>);</span><br><span class="line"></span><br><span class="line">            experienceNetworkLatency();</span><br><span class="line">            HashMap&lt;String, Video&gt; hmap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, Video&gt;();</span><br><span class="line">            hmap.put(<span class="string">&quot;catzzzzzzzzz&quot;</span>, <span class="keyword">new</span> <span class="title class_">Video</span>(<span class="string">&quot;sadgahasgdas&quot;</span>, <span class="string">&quot;Catzzzz.avi&quot;</span>));</span><br><span class="line">            hmap.put(<span class="string">&quot;mkafksangasj&quot;</span>, <span class="keyword">new</span> <span class="title class_">Video</span>(<span class="string">&quot;mkafksangasj&quot;</span>, <span class="string">&quot;Dog play with ball.mp4&quot;</span>));</span><br><span class="line">            hmap.put(<span class="string">&quot;dancesvideoo&quot;</span>, <span class="keyword">new</span> <span class="title class_">Video</span>(<span class="string">&quot;asdfas3ffasd&quot;</span>, <span class="string">&quot;Dancing video.mpq&quot;</span>));</span><br><span class="line">            hmap.put(<span class="string">&quot;dlsdk5jfslaf&quot;</span>, <span class="keyword">new</span> <span class="title class_">Video</span>(<span class="string">&quot;dlsdk5jfslaf&quot;</span>, <span class="string">&quot;Barcelona vs RealM.mov&quot;</span>));</span><br><span class="line">            hmap.put(<span class="string">&quot;3sdfgsd1j333&quot;</span>, <span class="keyword">new</span> <span class="title class_">Video</span>(<span class="string">&quot;3sdfgsd1j333&quot;</span>, <span class="string">&quot;Programing lesson#1.avi&quot;</span>));</span><br><span class="line"></span><br><span class="line">            System.out.print(<span class="string">&quot;Done!&quot;</span> + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> hmap;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> Video <span class="title function_">getSomeVideo</span><span class="params">(String videoId)</span> &#123;</span><br><span class="line">            System.out.print(<span class="string">&quot;Downloading video... &quot;</span>);</span><br><span class="line"></span><br><span class="line">            experienceNetworkLatency();</span><br><span class="line">            <span class="type">Video</span> <span class="variable">video</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Video</span>(videoId, <span class="string">&quot;Some video title&quot;</span>);</span><br><span class="line"></span><br><span class="line">            System.out.print(<span class="string">&quot;Done!&quot;</span> + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> video;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">YouTubeCacheProxy</span> <span class="keyword">implements</span> <span class="title class_">ThirdPartyYouTubeLib</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> ThirdPartyYouTubeLib youtubeService;</span><br><span class="line">        <span class="keyword">private</span> HashMap&lt;String, Video&gt; cachePopular = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, Video&gt;();</span><br><span class="line">        <span class="keyword">private</span> HashMap&lt;String, Video&gt; cacheAll = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, Video&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">YouTubeCacheProxy</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.youtubeService = <span class="keyword">new</span> <span class="title class_">ThirdPartyYouTubeClass</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> HashMap&lt;String, Video&gt; <span class="title function_">popularVideos</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (cachePopular.isEmpty()) &#123;</span><br><span class="line">                cachePopular = youtubeService.popularVideos();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;Retrieved list from cache.&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> cachePopular;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> Video <span class="title function_">getVideo</span><span class="params">(String videoId)</span> &#123;</span><br><span class="line">            <span class="type">Video</span> <span class="variable">video</span> <span class="operator">=</span> cacheAll.get(videoId);</span><br><span class="line">            <span class="keyword">if</span> (video == <span class="literal">null</span>) &#123;</span><br><span class="line">                video = youtubeService.getVideo(videoId);</span><br><span class="line">                cacheAll.put(videoId, video);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;Retrieved video &#x27;&quot;</span> + videoId + <span class="string">&quot;&#x27; from cache.&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> video;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reset</span><span class="params">()</span> &#123;</span><br><span class="line">            cachePopular.clear();</span><br><span class="line">            cacheAll.clear();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">YouTubeDownloader</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> ThirdPartyYouTubeLib api;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">YouTubeDownloader</span><span class="params">(ThirdPartyYouTubeLib api)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.api = api;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">renderVideoPage</span><span class="params">(String videoId)</span> &#123;</span><br><span class="line">            <span class="type">Video</span> <span class="variable">video</span> <span class="operator">=</span> api.getVideo(videoId);</span><br><span class="line">            System.out.println(<span class="string">&quot;\n-------------------------------&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;Video page (imagine fancy HTML)&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;ID: &quot;</span> + video.id);</span><br><span class="line">            System.out.println(<span class="string">&quot;Title: &quot;</span> + video.title);</span><br><span class="line">            System.out.println(<span class="string">&quot;Video: &quot;</span> + video.data);</span><br><span class="line">            System.out.println(<span class="string">&quot;-------------------------------\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">renderPopularVideos</span><span class="params">()</span> &#123;</span><br><span class="line">            HashMap&lt;String, Video&gt; list = api.popularVideos();</span><br><span class="line">            System.out.println(<span class="string">&quot;\n-------------------------------&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;Most popular videos on YouTube (imagine fancy HTML)&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (Video video : list.values()) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;ID: &quot;</span> + video.id + <span class="string">&quot; / Title: &quot;</span> + video.title);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;-------------------------------\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">YouTubeDownloader</span> <span class="variable">naiveDownloader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">YouTubeDownloader</span>(<span class="keyword">new</span> <span class="title class_">ThirdPartyYouTubeClass</span>());</span><br><span class="line">        <span class="type">YouTubeDownloader</span> <span class="variable">smartDownloader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">YouTubeDownloader</span>(<span class="keyword">new</span> <span class="title class_">YouTubeCacheProxy</span>());</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="variable">naive</span> <span class="operator">=</span> test(naiveDownloader);</span><br><span class="line">        <span class="type">long</span> <span class="variable">smart</span> <span class="operator">=</span> test(smartDownloader);</span><br><span class="line">        System.out.print(<span class="string">&quot;Time saved by caching proxy: &quot;</span> + (naive - smart) + <span class="string">&quot;ms&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">long</span> <span class="title function_">test</span><span class="params">(YouTubeDownloader downloader)</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">startTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// User behavior in our app:</span></span><br><span class="line">        downloader.renderPopularVideos();</span><br><span class="line">        downloader.renderVideoPage(<span class="string">&quot;catzzzzzzzzz&quot;</span>);</span><br><span class="line">        downloader.renderPopularVideos();</span><br><span class="line">        downloader.renderVideoPage(<span class="string">&quot;dancesvideoo&quot;</span>);</span><br><span class="line">        <span class="comment">// Users might visit the same page quite often.</span></span><br><span class="line">        downloader.renderVideoPage(<span class="string">&quot;catzzzzzzzzz&quot;</span>);</span><br><span class="line">        downloader.renderVideoPage(<span class="string">&quot;someothervid&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="variable">estimatedTime</span> <span class="operator">=</span> System.currentTimeMillis() - startTime;</span><br><span class="line">        System.out.print(<span class="string">&quot;Time elapsed: &quot;</span> + estimatedTime + <span class="string">&quot;ms\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> estimatedTime;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>



<h2 id="行为模式"><a href="#行为模式" class="headerlink" title="行为模式"></a>行为模式</h2><h3 id="责任链-★★☆"><a href="#责任链-★★☆" class="headerlink" title="责任链 ★★☆"></a>责任链 ★★☆</h3><blockquote>
<p>允许你将请求沿着处理者链进行发送。收到请求后，每个处理者均可对请求进行处理，或将其传递给链上的下个处理者</p>
</blockquote>
<p>最近， 你刚为自己的电脑购买并安装了一个新的硬件设备。 身为一名极客， 你显然在电脑上安装了多个操作系统， 所以你会试着启动所有操作系统来确认其是否支持新的硬件设备。 Windows 检测到了该硬件设备并对其进行了自动启用。 但是你喜爱的 Linux 系统并不支持新硬件设备。 抱着最后一点希望， 你决定拨打包装盒上的技术支持电话。</p>
<p>首先你会听到自动回复器的机器合成语音， 它提供了针对各种问题的九个常用解决方案， 但其中没有一个与你遇到的问题相关。 过了一会儿， 机器人将你转接到人工接听人员处。</p>
<p>这位接听人员同样无法提供任何具体的解决方案。 他不断地引用手册中冗长的内容， 并不会仔细聆听你的回应。 在第 10 次听到 “你是否关闭计算机后重新启动呢？” 这句话后， 你要求与一位真正的工程师通话。</p>
<p>最后， 接听人员将你的电话转接给了工程师， 他或许正缩在某幢办公大楼的阴暗地下室中， 坐在他所深爱的服务器机房里， 焦躁不安地期待着同一名真人交流。 工程师告诉了你新硬件设备驱动程序的下载网址， 以及如何在 Linux 系统上进行安装。 问题终于解决了！ 你挂断了电话， 满心欢喜。</p>
<table>
<thead>
<tr>
<th>优点 √</th>
<th>缺点 ×</th>
</tr>
</thead>
<tbody><tr>
<td>你可以控制请求处理的顺序<br /><em>单一职责原则</em>。 你可对发起操作和执行操作的类进行解耦。<br /><em>开闭原则</em>。 你可以在不更改现有代码的情况下在程序中新增处理者。</td>
<td>部分请求可能未被处理。</td>
</tr>
</tbody></table>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 责任链-登录流程</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ChainOfResponsibility</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Server</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> Middleware middleware;</span><br><span class="line">        <span class="keyword">private</span> Map&lt;String, String&gt; users = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">register</span> <span class="params">(String username, String password)</span> &#123;</span><br><span class="line">            users.put(username, password);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">loginIn</span><span class="params">(String username, String password)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (middleware.check(username, password)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!users.getOrDefault(username, <span class="string">&quot;&quot;</span>).equals(password)) &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;账号密码错误&quot;</span>);</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println(<span class="string">&quot;登录成功&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMiddleware</span><span class="params">(Middleware middleware)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.middleware = middleware;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Middleware</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> Middleware next;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> Middleware <span class="title function_">link</span><span class="params">(Middleware first, Middleware... chain)</span> &#123;</span><br><span class="line">            <span class="type">Middleware</span> <span class="variable">head</span> <span class="operator">=</span> first;</span><br><span class="line">            <span class="keyword">for</span> (Middleware middleware : chain) &#123;</span><br><span class="line">                head.next = middleware;</span><br><span class="line">                head = middleware;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> first;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="type">boolean</span> <span class="title function_">check</span><span class="params">(String username, String password)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">protected</span> <span class="type">boolean</span> <span class="title function_">checkNext</span><span class="params">(String username, String password)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (next == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> next.check(username, password);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">CorsMiddleware</span> <span class="keyword">extends</span> <span class="title class_">Middleware</span> &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">check</span><span class="params">(String username, String password)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!username.equals(<span class="string">&quot;admin&quot;</span>)) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;CORS不通过&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> checkNext(username, password);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">BlockListMiddleware</span> <span class="keyword">extends</span> <span class="title class_">Middleware</span> &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">check</span><span class="params">(String username, String password)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (username.equals(<span class="string">&quot;gezi&quot;</span>)) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;已被拉黑&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> checkNext(username, password);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Server</span> <span class="variable">server</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Server</span>();</span><br><span class="line">        server.register(<span class="string">&quot;admin&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        server.register(<span class="string">&quot;gezi&quot;</span>,<span class="string">&quot;test&quot;</span>);</span><br><span class="line">        server.setMiddleware(Middleware.link(<span class="keyword">new</span> <span class="title class_">BlockListMiddleware</span>(), <span class="keyword">new</span> <span class="title class_">CorsMiddleware</span>()));</span><br><span class="line">        server.loginIn(<span class="string">&quot;admin&quot;</span>,<span class="string">&quot;test&quot;</span>);</span><br><span class="line">        server.loginIn(<span class="string">&quot;admin&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        server.loginIn(<span class="string">&quot;gezi&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        server.loginIn(<span class="string">&quot;test&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="命令-★☆☆"><a href="#命令-★☆☆" class="headerlink" title="命令 ★☆☆"></a>命令 ★☆☆</h3><blockquote>
<p>它可将请求转换为一个包含与请求相关的所有信息的独立对象。该转换让你能根据不同的请求将方法参数化，延迟请求或者将其放入队列中，且能实现可撤销操作。</p>
</blockquote>
<p>在市中心逛了很久的街后， 你找到了一家不错的餐厅， 坐在了临窗的座位上。 一名友善的服务员走近你， 迅速记下你点的食物， 写在一张纸上。 服务员来到厨房， 把订单贴在墙上。 过了一段时间， 厨师拿到了订单， 他根据订单来准备食物。 厨师将做好的食物和订单一起放在托盘上。 服务员看到托盘后对订单进行检查， 确保所有食物都是你要的， 然后将食物放到了你的桌上。</p>
<p>那张纸就是一个命令， 它在厨师开始烹饪前一直位于队列中。 命令中包含与烹饪这些食物相关的所有信息。 厨师能够根据它马上开始烹饪， 而无需跑来直接和你确认订单详情。</p>
<table>
<thead>
<tr>
<th>优点 √</th>
<th>缺点 ×</th>
</tr>
</thead>
<tbody><tr>
<td><em>单一职责原则</em>。 你可以解耦触发和执行操作的类。<br /><em>开闭原则</em>。 你可以在不修改已有客户端代码的情况下在程序中创建新的命令。<br />你可以实现撤销和恢复功能。<br />你可以实现操作的延迟执行。<br />你可以将一组简单命令组合成一个复杂命令。</td>
<td>代码可能会变得更加复杂， 因为你在发送者和接收者之间增加了一个全新的层次。</td>
</tr>
</tbody></table>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.ActionEvent;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.ActionListener;</span><br><span class="line"><span class="keyword">import</span> java.util.Stack;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 命令-编辑器</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Command</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">CommandImp</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> Editor editor;</span><br><span class="line">        <span class="keyword">public</span> String backup;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">CommandImp</span><span class="params">(Editor editor)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.editor = editor;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">backup</span><span class="params">()</span> &#123;</span><br><span class="line">            backup = editor.textField.getText();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">undo</span><span class="params">()</span> &#123;</span><br><span class="line">            editor.textField.setText(backup);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="type">boolean</span> <span class="title function_">execute</span><span class="params">()</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">CopyCommand</span> <span class="keyword">extends</span> <span class="title class_">CommandImp</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">CopyCommand</span><span class="params">(Editor editor)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(editor);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">execute</span><span class="params">()</span> &#123;</span><br><span class="line">            editor.clipboard = editor.textField.getSelectedText();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">PasteCommand</span> <span class="keyword">extends</span> <span class="title class_">CommandImp</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">PasteCommand</span><span class="params">(Editor editor)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(editor);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">execute</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (editor.clipboard == <span class="literal">null</span> || editor.clipboard.isEmpty()) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">            backup();</span><br><span class="line">            editor.textField.insert(editor.clipboard, editor.textField.getCaretPosition());</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">CutCommand</span> <span class="keyword">extends</span> <span class="title class_">CommandImp</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">CutCommand</span><span class="params">(Editor editor)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(editor);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">execute</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (editor.textField.getSelectedText().isEmpty()) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">            backup();</span><br><span class="line">            <span class="type">String</span> <span class="variable">source</span> <span class="operator">=</span> editor.textField.getText();</span><br><span class="line">            editor.clipboard = editor.textField.getSelectedText();</span><br><span class="line">            editor.textField.setText(cutString(source));</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">private</span> String <span class="title function_">cutString</span><span class="params">(String source)</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">start</span> <span class="operator">=</span> source.substring(<span class="number">0</span>, editor.textField.getSelectionStart());</span><br><span class="line">            <span class="type">String</span> <span class="variable">end</span> <span class="operator">=</span> source.substring(editor.textField.getSelectionEnd());</span><br><span class="line">            <span class="keyword">return</span> start + end;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">CommandHistory</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> Stack&lt;CommandImp&gt; history = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(CommandImp c)</span> &#123;</span><br><span class="line">            history.push(c);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> CommandImp <span class="title function_">pop</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> history.pop();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123; <span class="keyword">return</span> history.isEmpty(); &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Editor</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> JTextArea textField;</span><br><span class="line">        <span class="keyword">public</span> String clipboard;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">CommandHistory</span> <span class="variable">history</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CommandHistory</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="type">JFrame</span> <span class="variable">frame</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JFrame</span>(<span class="string">&quot;Text editor (type &amp; use buttons, Luke!)&quot;</span>);</span><br><span class="line">            <span class="type">JPanel</span> <span class="variable">content</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JPanel</span>();</span><br><span class="line">            frame.setContentPane(content);</span><br><span class="line">            frame.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);</span><br><span class="line">            content.setLayout(<span class="keyword">new</span> <span class="title class_">BoxLayout</span>(content, BoxLayout.Y_AXIS));</span><br><span class="line">            textField = <span class="keyword">new</span> <span class="title class_">JTextArea</span>();</span><br><span class="line">            textField.setLineWrap(<span class="literal">true</span>);</span><br><span class="line">            content.add(textField);</span><br><span class="line">            <span class="type">JPanel</span> <span class="variable">buttons</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JPanel</span>(<span class="keyword">new</span> <span class="title class_">FlowLayout</span>(FlowLayout.CENTER));</span><br><span class="line">            <span class="type">JButton</span> <span class="variable">ctrlC</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JButton</span>(<span class="string">&quot;Ctrl+C&quot;</span>);</span><br><span class="line">            <span class="type">JButton</span> <span class="variable">ctrlX</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JButton</span>(<span class="string">&quot;Ctrl+X&quot;</span>);</span><br><span class="line">            <span class="type">JButton</span> <span class="variable">ctrlV</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JButton</span>(<span class="string">&quot;Ctrl+V&quot;</span>);</span><br><span class="line">            <span class="type">JButton</span> <span class="variable">ctrlZ</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JButton</span>(<span class="string">&quot;Ctrl+Z&quot;</span>);</span><br><span class="line">            <span class="type">Editor</span> <span class="variable">editor</span> <span class="operator">=</span> <span class="built_in">this</span>;</span><br><span class="line">            ctrlC.addActionListener(<span class="keyword">new</span> <span class="title class_">ActionListener</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">actionPerformed</span><span class="params">(ActionEvent e)</span> &#123;</span><br><span class="line">                    executeCommand(<span class="keyword">new</span> <span class="title class_">CopyCommand</span>(editor));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            ctrlX.addActionListener(<span class="keyword">new</span> <span class="title class_">ActionListener</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">actionPerformed</span><span class="params">(ActionEvent e)</span> &#123;</span><br><span class="line">                    executeCommand(<span class="keyword">new</span> <span class="title class_">CutCommand</span>(editor));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            ctrlV.addActionListener(<span class="keyword">new</span> <span class="title class_">ActionListener</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">actionPerformed</span><span class="params">(ActionEvent e)</span> &#123;</span><br><span class="line">                    executeCommand(<span class="keyword">new</span> <span class="title class_">PasteCommand</span>(editor));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            ctrlZ.addActionListener(<span class="keyword">new</span> <span class="title class_">ActionListener</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">actionPerformed</span><span class="params">(ActionEvent e)</span> &#123;</span><br><span class="line">                    undo();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            buttons.add(ctrlC);</span><br><span class="line">            buttons.add(ctrlX);</span><br><span class="line">            buttons.add(ctrlV);</span><br><span class="line">            buttons.add(ctrlZ);</span><br><span class="line">            content.add(buttons);</span><br><span class="line">            frame.setSize(<span class="number">450</span>, <span class="number">200</span>);</span><br><span class="line">            frame.setLocationRelativeTo(<span class="literal">null</span>);</span><br><span class="line">            frame.setVisible(<span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">executeCommand</span><span class="params">(CommandImp command)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (command.execute()) &#123;</span><br><span class="line">                history.push(command);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">undo</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (history.isEmpty()) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">CommandImp</span> <span class="variable">command</span> <span class="operator">=</span> history.pop();</span><br><span class="line">            <span class="keyword">if</span> (command != <span class="literal">null</span>) &#123;</span><br><span class="line">                command.undo();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Editor</span> <span class="variable">editor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Editor</span>();</span><br><span class="line">        editor.init();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="迭代器-★★☆"><a href="#迭代器-★★☆" class="headerlink" title="迭代器 ★★☆"></a>迭代器 ★★☆</h3><blockquote>
<p>让你能在不暴露集合底层表现形式(列表，栈和树等)的情况下遍历集合中的所有元素。</p>
</blockquote>
<p>你计划在罗马游览数天， 参观所有主要的旅游景点。 但在到达目的地后， 你可能会浪费很多时间绕圈子， 甚至找不到罗马斗兽场在哪里。</p>
<p>或者你可以购买一款智能手机上的虚拟导游程序。 这款程序非常智能而且价格不贵， 你想在景点待多久都可以。</p>
<p>第三种选择是用部分旅行预算雇佣一位对城市了如指掌的当地向导。 向导能根据你的喜好来安排行程， 为你介绍每个景点并讲述许多激动人心的故事。 这样的旅行可能会更有趣， 但所需费用也会更高。</p>
<p>所有这些选择(自由漫步、 智能手机导航或真人向导)都是这个由众多罗马景点组成的集合的迭代器。</p>
<table>
<thead>
<tr>
<th>优点 √</th>
<th>缺点 ×</th>
</tr>
</thead>
<tbody><tr>
<td><em>单一职责原则</em>。 通过将体积庞大的遍历算法代码抽取为独立的类， 你可对客户端代码和集合进行整理。<br /> <em>开闭原则</em>。 你可实现新型的集合和迭代器并将其传递给现有代码， 无需修改现有代码。<br />你可以并行遍历同一集合， 因为每个迭代器对象都包含其自身的遍历状态。<br />相似的， 你可以暂停遍历并在需要时继续。</td>
<td>如果你的程序只与简单的集合进行交互， 应用该模式可能会矫枉过正。<br />对于某些特殊集合， 使用迭代器可能比直接遍历的效率低。</td>
</tr>
</tbody></table>
<p>**注：**迭代器旨在”安全性”与”封装性&#x2F;单一职责”</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 迭代器-访问社交关系</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Iterator</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ProfileIterator</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span>;</span><br><span class="line">        Profile <span class="title function_">getNext</span><span class="params">()</span>;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">reset</span><span class="params">()</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">FacebookIterator</span> <span class="keyword">implements</span> <span class="title class_">ProfileIterator</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> Facebook facebook;</span><br><span class="line">        <span class="keyword">private</span> String type;</span><br><span class="line">        <span class="keyword">private</span> String email;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> <span class="variable">currentPosition</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">private</span> List&lt;String&gt; emails = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">private</span> List&lt;Profile&gt; profiles = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">FacebookIterator</span><span class="params">(Facebook facebook, String type, String email)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.facebook = facebook;</span><br><span class="line">            <span class="built_in">this</span>.type = type;</span><br><span class="line">            <span class="built_in">this</span>.email = email;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">lazyLoad</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (emails.size() == <span class="number">0</span>) &#123;</span><br><span class="line">                List&lt;String&gt; profiles = facebook.requestProfileFriendsFromFacebook(<span class="built_in">this</span>.email, <span class="built_in">this</span>.type);</span><br><span class="line">                <span class="keyword">for</span> (String profile : profiles) &#123;</span><br><span class="line">                    <span class="built_in">this</span>.emails.add(profile);</span><br><span class="line">                    <span class="built_in">this</span>.profiles.add(<span class="literal">null</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span> &#123;</span><br><span class="line">            lazyLoad();</span><br><span class="line">            <span class="keyword">return</span> currentPosition &lt; emails.size();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> Profile <span class="title function_">getNext</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!hasNext()) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">String</span> <span class="variable">friendEmail</span> <span class="operator">=</span> emails.get(currentPosition);</span><br><span class="line">            <span class="type">Profile</span> <span class="variable">friendProfile</span> <span class="operator">=</span> profiles.get(currentPosition);</span><br><span class="line">            <span class="keyword">if</span> (friendProfile == <span class="literal">null</span>) &#123;</span><br><span class="line">                friendProfile = facebook.requestProfileFromFacebook(friendEmail);</span><br><span class="line">                profiles.set(currentPosition, friendProfile);</span><br><span class="line">            &#125;</span><br><span class="line">            currentPosition++;</span><br><span class="line">            <span class="keyword">return</span> friendProfile;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reset</span><span class="params">()</span> &#123;</span><br><span class="line">            currentPosition = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">LinkedInIterator</span> <span class="keyword">implements</span> <span class="title class_">ProfileIterator</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> LinkedIn linkedIn;</span><br><span class="line">        <span class="keyword">private</span> String type;</span><br><span class="line">        <span class="keyword">private</span> String email;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> <span class="variable">currentPosition</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">private</span> List&lt;String&gt; emails = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">private</span> List&lt;Profile&gt; contacts = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">LinkedInIterator</span><span class="params">(LinkedIn linkedIn, String type, String email)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.linkedIn = linkedIn;</span><br><span class="line">            <span class="built_in">this</span>.type = type;</span><br><span class="line">            <span class="built_in">this</span>.email = email;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">lazyLoad</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (emails.size() == <span class="number">0</span>) &#123;</span><br><span class="line">                List&lt;String&gt; profiles = linkedIn.requestRelatedContactsFromLinkedInAPI(<span class="built_in">this</span>.email, <span class="built_in">this</span>.type);</span><br><span class="line">                <span class="keyword">for</span> (String profile : profiles) &#123;</span><br><span class="line">                    <span class="built_in">this</span>.emails.add(profile);</span><br><span class="line">                    <span class="built_in">this</span>.contacts.add(<span class="literal">null</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span> &#123;</span><br><span class="line">            lazyLoad();</span><br><span class="line">            <span class="keyword">return</span> currentPosition &lt; emails.size();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> Profile <span class="title function_">getNext</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!hasNext()) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">String</span> <span class="variable">friendEmail</span> <span class="operator">=</span> emails.get(currentPosition);</span><br><span class="line">            <span class="type">Profile</span> <span class="variable">friendContact</span> <span class="operator">=</span> contacts.get(currentPosition);</span><br><span class="line">            <span class="keyword">if</span> (friendContact == <span class="literal">null</span>) &#123;</span><br><span class="line">                friendContact = linkedIn.requestContactInfoFromLinkedInAPI(friendEmail);</span><br><span class="line">                contacts.set(currentPosition, friendContact);</span><br><span class="line">            &#125;</span><br><span class="line">            currentPosition++;</span><br><span class="line">            <span class="keyword">return</span> friendContact;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reset</span><span class="params">()</span> &#123;</span><br><span class="line">            currentPosition = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SocialNetwork</span> &#123;</span><br><span class="line">        ProfileIterator <span class="title function_">createFriendsIterator</span><span class="params">(String profileEmail)</span>;</span><br><span class="line">        ProfileIterator <span class="title function_">createCoworkersIterator</span><span class="params">(String profileEmail)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Facebook</span> <span class="keyword">implements</span> <span class="title class_">SocialNetwork</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> List&lt;Profile&gt; profiles;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Facebook</span><span class="params">(List&lt;Profile&gt; cache)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (cache != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="built_in">this</span>.profiles = cache;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">this</span>.profiles = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> Profile <span class="title function_">requestProfileFromFacebook</span><span class="params">(String profileEmail)</span> &#123;</span><br><span class="line">            simulateNetworkLatency();</span><br><span class="line">            System.out.println(<span class="string">&quot;Facebook: Loading profile &#x27;&quot;</span> + profileEmail + <span class="string">&quot;&#x27; over the network...&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> findProfile(profileEmail);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">requestProfileFriendsFromFacebook</span><span class="params">(String profileEmail, String contactType)</span> &#123;</span><br><span class="line">            simulateNetworkLatency();</span><br><span class="line">            System.out.println(<span class="string">&quot;Facebook: Loading &#x27;&quot;</span> + contactType + <span class="string">&quot;&#x27; list of &#x27;&quot;</span> + profileEmail + <span class="string">&quot;&#x27; over the network...&quot;</span>);</span><br><span class="line">            <span class="comment">// ...and return test data.</span></span><br><span class="line">            <span class="type">Profile</span> <span class="variable">profile</span> <span class="operator">=</span> findProfile(profileEmail);</span><br><span class="line">            <span class="keyword">if</span> (profile != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> profile.getContacts(contactType);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">private</span> Profile <span class="title function_">findProfile</span><span class="params">(String profileEmail)</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (Profile profile : profiles) &#123;</span><br><span class="line">                <span class="keyword">if</span> (profile.getEmail().equals(profileEmail)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> profile;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">simulateNetworkLatency</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">2500</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException ex) &#123;</span><br><span class="line">                ex.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> ProfileIterator <span class="title function_">createFriendsIterator</span><span class="params">(String profileEmail)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FacebookIterator</span>(<span class="built_in">this</span>, <span class="string">&quot;friends&quot;</span>, profileEmail);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> ProfileIterator <span class="title function_">createCoworkersIterator</span><span class="params">(String profileEmail)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FacebookIterator</span>(<span class="built_in">this</span>, <span class="string">&quot;coworkers&quot;</span>, profileEmail);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">LinkedIn</span> <span class="keyword">implements</span> <span class="title class_">SocialNetwork</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> List&lt;Profile&gt; contacts;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">LinkedIn</span><span class="params">(List&lt;Profile&gt; cache)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (cache != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="built_in">this</span>.contacts = cache;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">this</span>.contacts = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Profile <span class="title function_">requestContactInfoFromLinkedInAPI</span><span class="params">(String profileEmail)</span> &#123;</span><br><span class="line">            simulateNetworkLatency();</span><br><span class="line">            System.out.println(<span class="string">&quot;LinkedIn: Loading profile &#x27;&quot;</span> + profileEmail + <span class="string">&quot;&#x27; over the network...&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> findContact(profileEmail);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">requestRelatedContactsFromLinkedInAPI</span><span class="params">(String profileEmail, String contactType)</span> &#123;</span><br><span class="line">            simulateNetworkLatency();</span><br><span class="line">            System.out.println(<span class="string">&quot;LinkedIn: Loading &#x27;&quot;</span> + contactType + <span class="string">&quot;&#x27; list of &#x27;&quot;</span> + profileEmail + <span class="string">&quot;&#x27; over the network...&quot;</span>);</span><br><span class="line">            <span class="type">Profile</span> <span class="variable">profile</span> <span class="operator">=</span> findContact(profileEmail);</span><br><span class="line">            <span class="keyword">if</span> (profile != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> profile.getContacts(contactType);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">private</span> Profile <span class="title function_">findContact</span><span class="params">(String profileEmail)</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (Profile profile : contacts) &#123;</span><br><span class="line">                <span class="keyword">if</span> (profile.getEmail().equals(profileEmail)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> profile;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">simulateNetworkLatency</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">2500</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException ex) &#123;</span><br><span class="line">                ex.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> ProfileIterator <span class="title function_">createFriendsIterator</span><span class="params">(String profileEmail)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">LinkedInIterator</span>(<span class="built_in">this</span>, <span class="string">&quot;friends&quot;</span>, profileEmail);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> ProfileIterator <span class="title function_">createCoworkersIterator</span><span class="params">(String profileEmail)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">LinkedInIterator</span>(<span class="built_in">this</span>, <span class="string">&quot;coworkers&quot;</span>, profileEmail);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Profile</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">private</span> String email;</span><br><span class="line">        <span class="keyword">private</span> Map&lt;String, List&lt;String&gt;&gt; contacts = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Profile</span><span class="params">(String email, String name, String... contacts)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.email = email;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">            <span class="keyword">for</span> (String contact : contacts) &#123;</span><br><span class="line">                String[] parts = contact.split(<span class="string">&quot;:&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">contactType</span> <span class="operator">=</span> <span class="string">&quot;friend&quot;</span>, contactEmail;</span><br><span class="line">                <span class="keyword">if</span> (parts.length == <span class="number">1</span>) &#123;</span><br><span class="line">                    contactEmail = parts[<span class="number">0</span>];</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    contactType = parts[<span class="number">0</span>];</span><br><span class="line">                    contactEmail = parts[<span class="number">1</span>];</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (!<span class="built_in">this</span>.contacts.containsKey(contactType)) &#123;</span><br><span class="line">                    <span class="built_in">this</span>.contacts.put(contactType, <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;());</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">this</span>.contacts.get(contactType).add(contactEmail);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getEmail</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> email;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> name;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getContacts</span><span class="params">(String contactType)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">this</span>.contacts.containsKey(contactType)) &#123;</span><br><span class="line">                <span class="built_in">this</span>.contacts.put(contactType, <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> contacts.get(contactType);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">SocialSpammer</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> SocialNetwork network;</span><br><span class="line">        <span class="keyword">public</span> ProfileIterator iterator;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">SocialSpammer</span><span class="params">(SocialNetwork network)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.network = network;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendSpamToFriends</span><span class="params">(String profileEmail, String message)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;\nIterating over friends...\n&quot;</span>);</span><br><span class="line">            iterator = network.createFriendsIterator(profileEmail);</span><br><span class="line">            <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">                <span class="type">Profile</span> <span class="variable">profile</span> <span class="operator">=</span> iterator.getNext();</span><br><span class="line">                sendMessage(profile.getEmail(), message);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendSpamToCoworkers</span><span class="params">(String profileEmail, String message)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;\nIterating over coworkers...\n&quot;</span>);</span><br><span class="line">            iterator = network.createCoworkersIterator(profileEmail);</span><br><span class="line">            <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">                <span class="type">Profile</span> <span class="variable">profile</span> <span class="operator">=</span> iterator.getNext();</span><br><span class="line">                sendMessage(profile.getEmail(), message);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendMessage</span><span class="params">(String email, String message)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Sent message to: &#x27;&quot;</span> + email + <span class="string">&quot;&#x27;. Message body: &#x27;&quot;</span> + message + <span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Please specify social network to target spam tool (default:Facebook):&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;1. Facebook&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;2. LinkedIn&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">choice</span> <span class="operator">=</span> scanner.nextLine();</span><br><span class="line"></span><br><span class="line">        SocialNetwork network;</span><br><span class="line">        <span class="keyword">if</span> (choice.equals(<span class="string">&quot;2&quot;</span>)) &#123;</span><br><span class="line">            network = <span class="keyword">new</span> <span class="title class_">LinkedIn</span>(createTestProfiles());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            network = <span class="keyword">new</span> <span class="title class_">Facebook</span>(createTestProfiles());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">SocialSpammer</span> <span class="variable">spammer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SocialSpammer</span>(network);</span><br><span class="line">        spammer.sendSpamToFriends(<span class="string">&quot;anna.smith@bing.com&quot;</span>,</span><br><span class="line">                <span class="string">&quot;Hey! This is Anna&#x27;s friend Josh. Can you do me a favor and like this post [link]?&quot;</span>);</span><br><span class="line">        spammer.sendSpamToCoworkers(<span class="string">&quot;anna.smith@bing.com&quot;</span>,</span><br><span class="line">                <span class="string">&quot;Hey! This is Anna&#x27;s boss Jason. Anna told me you would be interested in [link].&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Profile&gt; <span class="title function_">createTestProfiles</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;Profile&gt; data = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        data.add(<span class="keyword">new</span> <span class="title class_">Profile</span>(<span class="string">&quot;anna.smith@bing.com&quot;</span>, <span class="string">&quot;Anna Smith&quot;</span>, <span class="string">&quot;friends:mad_max@ya.com&quot;</span>, <span class="string">&quot;friends:catwoman@yahoo.com&quot;</span>, <span class="string">&quot;coworkers:sam@amazon.com&quot;</span>));</span><br><span class="line">        data.add(<span class="keyword">new</span> <span class="title class_">Profile</span>(<span class="string">&quot;mad_max@ya.com&quot;</span>, <span class="string">&quot;Maximilian&quot;</span>, <span class="string">&quot;friends:anna.smith@bing.com&quot;</span>, <span class="string">&quot;coworkers:sam@amazon.com&quot;</span>));</span><br><span class="line">        data.add(<span class="keyword">new</span> <span class="title class_">Profile</span>(<span class="string">&quot;bill@microsoft.eu&quot;</span>, <span class="string">&quot;Billie&quot;</span>, <span class="string">&quot;coworkers:avanger@ukr.net&quot;</span>));</span><br><span class="line">        data.add(<span class="keyword">new</span> <span class="title class_">Profile</span>(<span class="string">&quot;avanger@ukr.net&quot;</span>, <span class="string">&quot;John Day&quot;</span>, <span class="string">&quot;coworkers:bill@microsoft.eu&quot;</span>));</span><br><span class="line">        data.add(<span class="keyword">new</span> <span class="title class_">Profile</span>(<span class="string">&quot;sam@amazon.com&quot;</span>, <span class="string">&quot;Sam Kitting&quot;</span>, <span class="string">&quot;coworkers:anna.smith@bing.com&quot;</span>, <span class="string">&quot;coworkers:mad_max@ya.com&quot;</span>, <span class="string">&quot;friends:catwoman@yahoo.com&quot;</span>));</span><br><span class="line">        data.add(<span class="keyword">new</span> <span class="title class_">Profile</span>(<span class="string">&quot;catwoman@yahoo.com&quot;</span>, <span class="string">&quot;Liza&quot;</span>, <span class="string">&quot;friends:anna.smith@bing.com&quot;</span>, <span class="string">&quot;friends:sam@amazon.com&quot;</span>));</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="中介者-★★☆"><a href="#中介者-★★☆" class="headerlink" title="中介者 ★★☆"></a>中介者 ★★☆</h3><blockquote>
<p>让你能够减少对象之间混乱无序的依赖关系。该模式会限制对象之间的直接交互，迫使它们通过一个中介者对象进行合作。</p>
</blockquote>
<p>飞行器驾驶员们在靠近或离开空中管制区域时不会直接相互交流。 但他们会与飞机跑道附近， 塔台中的空管员通话。 如果没有空管员， 驾驶员就需要留意机场附近的所有飞机， 并与数十位飞行员组成的委员会讨论降落顺序。 那恐怕会让飞机坠毁的统计数据一飞冲天吧。</p>
<p>塔台无需管制飞行全程， 只需在航站区加强管控即可， 因为该区域的决策参与者数量对于飞行员来说实在太多了。</p>
<table>
<thead>
<tr>
<th>优点 √</th>
<th>缺点 ×</th>
</tr>
</thead>
<tbody><tr>
<td><em>单一职责原则</em>。 你可以将多个组件间的交流抽取到同一位置， 使其更易于理解和维护。<br /><em>开闭原则</em>。 你无需修改实际组件就能增加新的中介者。<br />你可以减轻应用中多个组件间的耦合情况。<br />你可以更方便地复用各个组件。</td>
<td>一段时间后， 中介者可能会演化成为<a class="link"   target="_blank" rel="noopener" href="https://refactoringguru.cn/antipatterns/god-object" >上帝对象<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>。</td>
</tr>
</tbody></table>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 中介者-组件通知</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Mediator</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Component</span> &#123;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">setTags</span><span class="params">(<span class="type">int</span> ...tags)</span>;</span><br><span class="line">        <span class="type">boolean</span> <span class="title function_">verifyTag</span><span class="params">(<span class="type">int</span> tag)</span>;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">notify</span><span class="params">(<span class="type">int</span> tag)</span>;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">setMediator</span><span class="params">(ConcreteMediator notify)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Component1</span> <span class="keyword">implements</span> <span class="title class_">Component</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span>[] tags;</span><br><span class="line">        <span class="keyword">private</span> ConcreteMediator notify;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setTags</span><span class="params">(<span class="type">int</span>... tags)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.tags = tags;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">verifyTag</span><span class="params">(<span class="type">int</span> tag)</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i : tags) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tag == i) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">notify</span><span class="params">(<span class="type">int</span> tag)</span> &#123;</span><br><span class="line">            System.out.println(<span class="built_in">this</span>.getClass().getName()+<span class="string">&quot; 通知了&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMediator</span><span class="params">(ConcreteMediator notify)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.notify = notify;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Component2</span> <span class="keyword">implements</span> <span class="title class_">Component</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span>[] tags;</span><br><span class="line">        <span class="keyword">private</span> ConcreteMediator notify;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setTags</span><span class="params">(<span class="type">int</span>... tags)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.tags = tags;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">verifyTag</span><span class="params">(<span class="type">int</span> tag)</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i : tags) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tag == i) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">notify</span><span class="params">(<span class="type">int</span> tag)</span> &#123;</span><br><span class="line">            System.out.println(<span class="built_in">this</span>.getClass().getName()+<span class="string">&quot; 通知了&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMediator</span><span class="params">(ConcreteMediator notify)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.notify = notify;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ConcreteMediator</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> List&lt;Component&gt; components = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">notify</span><span class="params">(<span class="type">int</span> tag)</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (Component component : components) &#123;</span><br><span class="line">                <span class="keyword">if</span> (component.verifyTag(tag)) &#123;</span><br><span class="line">                    component.notify(tag);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">registerComponent</span><span class="params">(Component component)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.components.add(component);</span><br><span class="line">            component.setMediator(<span class="built_in">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Component</span> <span class="variable">component1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Component1</span>();</span><br><span class="line">        <span class="type">Component</span> <span class="variable">component2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Component2</span>();</span><br><span class="line">        component1.setTags(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line">        component2.setTags(<span class="number">1</span>);</span><br><span class="line">        <span class="type">ConcreteMediator</span> <span class="variable">mediator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConcreteMediator</span>();</span><br><span class="line">        mediator.registerComponent(component1);</span><br><span class="line">        mediator.registerComponent(component2);</span><br><span class="line">        mediator.notify(<span class="number">1</span>);</span><br><span class="line">        mediator.notify(<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p> **注：**中介者的使用比较少，JAVA多用于GUI应用，旨在集中管理依赖关系</p>
<h3 id="备忘录-★★★"><a href="#备忘录-★★★" class="headerlink" title="备忘录 ★★★"></a>备忘录 ★★★</h3><blockquote>
<p>允许在不暴露对象实现细节的情况下保存和恢复对象之前的状态</p>
</blockquote>
<p>手机的恢复出厂设置就是经典的备忘录，它备份了手机的初始状态供你恢复，此外系统镜像同理</p>
<table>
<thead>
<tr>
<th>优点 √</th>
<th>缺点 ×</th>
</tr>
</thead>
<tbody><tr>
<td>你可以在不破坏对象封装情况的前提下创建对象状态快照。<br />你可以通过让负责人维护原发器状态历史记录来简化原发器代码。</td>
<td>如果客户端过于频繁地创建备忘录， 程序将消耗大量内存。<br />负责人必须完整跟踪原发器的生命周期， 这样才能销毁弃用的备忘录。<br />绝大部分动态编程语言 （例如 PHP、 Python 和 JavaScript） 不能确保备忘录中的状态不被修改。</td>
</tr>
</tbody></table>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 备忘录-数据恢复</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Memento</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 状态数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">DataState</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> String action;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAction</span><span class="params">(String action)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.action = action;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getAction</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> action;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 备忘录</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span>  <span class="title class_">MementoDe</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> DataState state;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">MementoDe</span><span class="params">(Originator o)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.state = o.getState();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> DataState <span class="title function_">getState</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> state;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setState</span><span class="params">(DataState state)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.state = state;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 发起者对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Originator</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> DataState state;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Originator</span><span class="params">()</span> &#123;&#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Originator</span><span class="params">(DataState state)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.state = state;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 创建一个Memento，将自身作为参数传入</span></span><br><span class="line">        <span class="keyword">public</span> MementoDe <span class="title function_">getMemento</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MementoDe</span>(<span class="built_in">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 从Memento中取出保存的数据，恢复为原始状态</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMemento</span><span class="params">(MementoDe m)</span> &#123;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             * getMemento() 创建的对象，保存在某个容器里，</span></span><br><span class="line"><span class="comment">             * 当需要恢复时，将其传入当前方法, 再使用getState(),得出</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            <span class="built_in">this</span>.state = m.getState();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> DataState <span class="title function_">getState</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> state;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setState</span><span class="params">(DataState state)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.state = state;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">DataState</span> <span class="variable">state</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DataState</span>();</span><br><span class="line">        state.setAction(<span class="string">&quot;copy a character&quot;</span>);</span><br><span class="line">        <span class="type">Originator</span> <span class="variable">originator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Originator</span>();</span><br><span class="line">        System.out.println(<span class="string">&quot;创建原始数据&quot;</span>);</span><br><span class="line">        originator.setState(state);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;创建备忘录对象, 保存原始数据状态&quot;</span>);</span><br><span class="line">        <span class="type">MementoDe</span> <span class="variable">memento</span> <span class="operator">=</span> originator.getMemento();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;创建了一个新数据&quot;</span>);</span><br><span class="line">        originator.setState(<span class="keyword">new</span> <span class="title class_">DataState</span>());</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;创建新数据后：&quot;</span> + originator.getState().getAction());</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * memento 需要保存在某地，需要时取出，以恢复它内部所保存的数据</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        System.out.println(<span class="string">&quot;创建新数据后，恢复原数据&quot;</span>);</span><br><span class="line">        originator.setMemento(memento);</span><br><span class="line">        System.out.println(originator.getState().getAction());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>**注：**所有对于Serializable的实现都是备忘录</p>
<h3 id="观察者-★★☆"><a href="#观察者-★★☆" class="headerlink" title="观察者 ★★☆"></a>观察者 ★★☆</h3><blockquote>
<p>允许你定义一种订阅机制，可在对象事件发生时通知多个“观察”该对象的其他对象。</p>
</blockquote>
<p>杂志和报纸订阅</p>
<table>
<thead>
<tr>
<th>优点 √</th>
<th>缺点 ×</th>
</tr>
</thead>
<tbody><tr>
<td><em>开闭原则</em>。 你无需修改发布者代码就能引入新的订阅者类 （如果是发布者接口则可轻松引入发布者类）。<br />你可以在运行时建立对象之间的联系。</td>
<td>订阅者的通知顺序是随机的。</td>
</tr>
</tbody></table>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 观察者-邮件通知</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Observe</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 发布订阅管理器</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">EventManager</span> &#123;</span><br><span class="line">        Map&lt;String, List&lt;EventListener&gt;&gt; listeners = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">EventManager</span><span class="params">(String... operations)</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (String operation : operations) &#123;</span><br><span class="line">                <span class="built_in">this</span>.listeners.put(operation, <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">subscribe</span><span class="params">(String eventType, EventListener listener)</span> &#123;</span><br><span class="line">            List&lt;EventListener&gt; users = listeners.get(eventType);</span><br><span class="line">            users.add(listener);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">unsubscribe</span><span class="params">(String eventType, EventListener listener)</span> &#123;</span><br><span class="line">            List&lt;EventListener&gt; users = listeners.get(eventType);</span><br><span class="line">            users.remove(listener);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">notify</span><span class="params">(String eventType, String template)</span> &#123;</span><br><span class="line">            List&lt;EventListener&gt; users = listeners.get(eventType);</span><br><span class="line">            <span class="keyword">for</span> (EventListener listener : users) &#123;</span><br><span class="line">                listener.daily(eventType, template);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 事件监听接口-日报事件</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">EventListener</span> &#123;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">daily</span><span class="params">(String eventType, String template)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 邮件发布者</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Email</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> EventManager events;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Email</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="comment">// 游戏板块 与 世界板块新闻</span></span><br><span class="line">            <span class="built_in">this</span>.events = <span class="keyword">new</span> <span class="title class_">EventManager</span>(<span class="string">&quot;games&quot;</span>, <span class="string">&quot;worlds&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendGameNews</span><span class="params">(String template)</span> &#123;</span><br><span class="line">            events.notify(<span class="string">&quot;games&quot;</span>, template);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendWorldNews</span><span class="params">(String template)</span> &#123;</span><br><span class="line">            events.notify(<span class="string">&quot;worlds&quot;</span>, template);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 男孩订阅</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">BoyListener</span> <span class="keyword">implements</span> <span class="title class_">EventListener</span> &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">daily</span><span class="params">(String eventType, String template)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;男孩子们订阅的：&quot;</span>+eventType+<span class="string">&quot;板块新闻发布了。内容：&quot;</span>+template);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 男人订阅</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ManListener</span> <span class="keyword">implements</span> <span class="title class_">EventListener</span> &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">daily</span><span class="params">(String eventType, String template)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;男人们订阅的：&quot;</span>+eventType+<span class="string">&quot;板块新闻发布了。内容：&quot;</span>+template);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Email</span> <span class="variable">email</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Email</span>();</span><br><span class="line">        email.events.subscribe(<span class="string">&quot;games&quot;</span>, <span class="keyword">new</span> <span class="title class_">BoyListener</span>());</span><br><span class="line">        email.events.subscribe(<span class="string">&quot;worlds&quot;</span>, <span class="keyword">new</span> <span class="title class_">ManListener</span>());</span><br><span class="line">        email.sendWorldNews(<span class="string">&quot;乌克兰战争&quot;</span>);</span><br><span class="line">        email.sendGameNews(<span class="string">&quot;暴雪撤出中国市场&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>**注：**在经典的ORM模型中观察者模式存在高频应用，多用于订阅实体对象变更</p>
<h3 id="状态-★☆☆"><a href="#状态-★☆☆" class="headerlink" title="状态 ★☆☆"></a>状态 ★☆☆</h3><blockquote>
<p>让你能在一个对象的内部状态变化时改变其行为，使其看上去就像改变了自身所属的类一样。</p>
</blockquote>
<p>智能手机的按键和开关会根据设备当前状态完成不同行为：</p>
<ul>
<li>当手机处于解锁状态时， 按下按键将执行各种功能。</li>
<li>当手机处于锁定状态时， 按下任何按键都将解锁屏幕。</li>
<li>当手机电量不足时， 按下任何按键都将显示充电页面。</li>
</ul>
<table>
<thead>
<tr>
<th>优点 √</th>
<th>缺点 ×</th>
</tr>
</thead>
<tbody><tr>
<td><em>单一职责原则</em>。 将与特定状态相关的代码放在单独的类中。<br /><em>开闭原则</em>。 无需修改已有状态类和上下文就能引入新状态。<br />通过消除臃肿的状态机条件语句简化上下文代码。</td>
<td>如果状态机只有很少的几个状态， 或者很少发生改变， 那么应用该模式可能会显得小题大作。</td>
</tr>
</tbody></table>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 状态-简单播放器：准备-播放-停止</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">State</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Player</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Player</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.state = <span class="keyword">new</span> <span class="title class_">ReadyState</span>(<span class="built_in">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">private</span> PlayerState state;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">playing</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">changeState</span><span class="params">(PlayerState state)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.state = state;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> PlayerState <span class="title function_">getState</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> state;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPlaying</span><span class="params">(<span class="type">boolean</span> playing)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.playing = playing;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isPlaying</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> playing;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">start</span><span class="params">()</span> &#123;</span><br><span class="line">            state.onStart();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">stop</span><span class="params">()</span> &#123;</span><br><span class="line">            state.onStop();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 播放器状态</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">PlayerState</span> &#123;</span><br><span class="line">        Player player;</span><br><span class="line"></span><br><span class="line">        PlayerState(Player player) &#123;</span><br><span class="line">            <span class="built_in">this</span>.player = player;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">onStop</span><span class="params">()</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">onStart</span><span class="params">()</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 就绪状态</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ReadyState</span> <span class="keyword">extends</span> <span class="title class_">PlayerState</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">ReadyState</span><span class="params">(Player player)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(player);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onStop</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;未开始播放&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onStart</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;开始播放&quot;</span>);</span><br><span class="line">            player.changeState(<span class="keyword">new</span> <span class="title class_">PlayingState</span>(player));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 播放状态</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">PlayingState</span> <span class="keyword">extends</span> <span class="title class_">PlayerState</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">PlayingState</span><span class="params">(Player player)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(player);</span><br><span class="line">            player.setPlaying(<span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onStop</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;成功停止&quot;</span>);</span><br><span class="line">            player.changeState(<span class="keyword">new</span> <span class="title class_">StopState</span>(player));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onStart</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;已经播放，无需重复&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 停止状态</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">StopState</span> <span class="keyword">extends</span> <span class="title class_">PlayerState</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">StopState</span><span class="params">(Player player)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(player);</span><br><span class="line">            player.setPlaying(<span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onStop</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;已经停止，无需重复&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onStart</span><span class="params">()</span> &#123;</span><br><span class="line">            player.changeState(<span class="keyword">new</span> <span class="title class_">PlayingState</span>(player));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Player</span> <span class="variable">player</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Player</span>();</span><br><span class="line">        player.stop();</span><br><span class="line">        player.start();</span><br><span class="line">        player.start();</span><br><span class="line">        player.stop();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="策略-★☆☆"><a href="#策略-★☆☆" class="headerlink" title="策略 ★☆☆"></a>策略 ★☆☆</h3><blockquote>
<p>能让你定义一系列算法，并将每种算法分别放入独立的类中，以使算法的对象能够相互替换</p>
</blockquote>
<p>假如你需要前往机场。 你可以选择乘坐公共汽车、 预约出租车或骑自行车。 这些就是你的出行策略。 你可以根据预算或时间等因素来选择其中一种策略。</p>
<table>
<thead>
<tr>
<th>优点 √</th>
<th>缺点 ×</th>
</tr>
</thead>
<tbody><tr>
<td>你可以在运行时切换对象内的算法。<br /> 你可以将算法的实现和使用算法的代码隔离开来。<br />  你可以使用组合来代替继承。 <br /> <em>开闭原则</em>。 你无需对上下文进行修改就能够引入新的策略。</td>
<td>如果你的算法极少发生改变， 那么没有任何理由引入新的类和接口。 使用该模式只会让程序过于复杂。  <br />客户端必须知晓策略间的不同——它需要选择合适的策略。  <br />许多现代编程语言支持函数类型功能， 允许你在一组匿名函数中实现不同版本的算法。 这样， 你使用这些函数的方式就和使用策略对象时完全相同， 无需借助额外的类和接口来保持代码简洁。</td>
</tr>
</tbody></table>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 策略-导游路线</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Strategy</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 策略接口</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">RouteStrategy</span> &#123;</span><br><span class="line">        List&lt;String&gt; <span class="title function_">buildRoutes</span><span class="params">(String origination)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 导航</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Navigator</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> RouteStrategy strategy;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">walking</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.strategy = <span class="keyword">new</span> <span class="title class_">WalkingStrategy</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">flight</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.strategy = <span class="keyword">new</span> <span class="title class_">FlightStrategy</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getRoutes</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (strategy == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;未选择出行路线&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> strategy.buildRoutes(<span class="string">&quot;北京&quot;</span>).toString();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 步行策略</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">WalkingStrategy</span> <span class="keyword">implements</span> <span class="title class_">RouteStrategy</span>&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">buildRoutes</span><span class="params">(String origination)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;()&#123;&#123;add(origination);add(<span class="string">&quot;罗马&quot;</span>);&#125;&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 飞行策略</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">FlightStrategy</span> <span class="keyword">implements</span> <span class="title class_">RouteStrategy</span> &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">buildRoutes</span><span class="params">(String origination)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;()&#123;&#123;add(origination);add(<span class="string">&quot;上海&quot;</span>);add(<span class="string">&quot;罗马&quot;</span>);&#125;&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Navigator</span> <span class="variable">navigator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Navigator</span>();</span><br><span class="line">        navigator.flight();</span><br><span class="line">        System.out.println(navigator.getRoutes());</span><br><span class="line">        navigator.walking();</span><br><span class="line">        System.out.println(navigator.getRoutes());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="模板方法-★☆☆"><a href="#模板方法-★☆☆" class="headerlink" title="模板方法 ★☆☆"></a>模板方法 ★☆☆</h3><blockquote>
<p>在超类中定义一个算法的框架，允许子类在不修改结构的情况下重写算法的特定步骤。</p>
</blockquote>
<p>模板方法可用于建造大量房屋。 标准房屋建造方案中可提供几个扩展点， 允许潜在房屋业主调整成品房屋的部分细节。</p>
<p>每个建造步骤 （例如打地基、 建造框架、 建造墙壁和安装水电管线等） 都能进行微调， 这使得成品房屋会略有不同。</p>
<table>
<thead>
<tr>
<th>优点 √</th>
<th>缺点 ×</th>
</tr>
</thead>
<tbody><tr>
<td>你可仅允许客户端重写一个大型算法中的特定部分， 使得算法其他部分修改对其所造成的影响减小。  <br />你可将重复代码提取到一个超类中。</td>
<td>部分客户端可能会受到算法框架的限制。  <br />通过子类抑制默认步骤实现可能会导致违反<em>里氏替换原则</em>。  <br />模板方法中的步骤越多， 其维护工作就可能会越困难。</td>
</tr>
</tbody></table>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 模板方法-社交网络通信</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TemplateMethod</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Network</span> &#123;</span><br><span class="line">        String userName;</span><br><span class="line">        String password;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">post</span><span class="params">(String message)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (logIn(<span class="built_in">this</span>.userName, <span class="built_in">this</span>.password)) &#123;</span><br><span class="line">                <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> sendData(message.getBytes());</span><br><span class="line">                logOut();</span><br><span class="line">                <span class="keyword">return</span> result;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">abstract</span> <span class="type">boolean</span> <span class="title function_">logIn</span><span class="params">(String userName, String password)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">abstract</span> <span class="type">boolean</span> <span class="title function_">sendData</span><span class="params">(<span class="type">byte</span>[] data)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">logOut</span><span class="params">()</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 脸书</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Facebook</span> <span class="keyword">extends</span> <span class="title class_">Network</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Facebook</span><span class="params">(String userName, String password)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.userName = userName;</span><br><span class="line">            <span class="built_in">this</span>.password = password;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">logIn</span><span class="params">(String userName, String password)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Name: &quot;</span> + <span class="built_in">this</span>.userName);</span><br><span class="line">            System.out.print(<span class="string">&quot;Password: &quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="built_in">this</span>.password.length(); i++) &#123;</span><br><span class="line">                System.out.print(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;登录成功&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">sendData</span><span class="params">(<span class="type">byte</span>[] data)</span> &#123;</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">messagePosted</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (messagePosted) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;消息: &#x27;&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(data) + <span class="string">&quot;发布在facebook&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logOut</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;用户: &#x27;&quot;</span> + userName + <span class="string">&quot;&#x27; 注销&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 推特</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Twitter</span> <span class="keyword">extends</span> <span class="title class_">Network</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Twitter</span><span class="params">(String userName, String password)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.userName = userName;</span><br><span class="line">            <span class="built_in">this</span>.password = password;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">logIn</span><span class="params">(String userName, String password)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Name: &quot;</span> + <span class="built_in">this</span>.userName);</span><br><span class="line">            System.out.print(<span class="string">&quot;Password: &quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="built_in">this</span>.password.length(); i++) &#123;</span><br><span class="line">                System.out.print(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;登录成功&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">sendData</span><span class="params">(<span class="type">byte</span>[] data)</span> &#123;</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">messagePosted</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (messagePosted) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;消息: &#x27;&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(data) + <span class="string">&quot;发布在twitter&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logOut</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;用户: &#x27;&quot;</span> + userName + <span class="string">&quot;&#x27; 注销&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> <span class="string">&quot;admin&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;admin&quot;</span>;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Facebook</span>(username, password).post(<span class="string">&quot;你好，脸书&quot;</span>);</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Twitter</span>(username, password).post(<span class="string">&quot;你好，推特&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="访问者-★★★"><a href="#访问者-★★★" class="headerlink" title="访问者 ★★★"></a>访问者 ★★★</h3><blockquote>
<p>将算法与其所作用的对象隔离开</p>
</blockquote>
<p>假如有这样一位非常希望赢得新客户的资深保险代理人。 他可以拜访街区中的每栋楼， 尝试向每个路人推销保险。 所以， 根据大楼内组织类型的不同， 他可以提供专门的保单：</p>
<ul>
<li>如果建筑是居民楼， 他会推销医疗保险。</li>
<li>如果建筑是银行， 他会推销失窃保险。</li>
<li>如果建筑是咖啡厅， 他会推销火灾和洪水保险。</li>
</ul>
<table>
<thead>
<tr>
<th>优点 √</th>
<th>缺点 ×</th>
</tr>
</thead>
<tbody><tr>
<td><em>开闭原则</em>。 你可以引入在不同类对象上执行的新行为， 且无需对这些类做出修改。  <br /><em>单一职责原则</em>。 可将同一行为的不同版本移到同一个类中。  <br />访问者对象可以在与各种对象交互时收集一些有用的信息。 当你想要遍历一些复杂的对象结构 （例如对象树）， 并在结构中的每个对象上应用访问者时， 这些信息可能会有所帮助。</td>
<td>每次在元素层次结构中添加或移除一个类时， 你都要更新所有的访问者。  <br />在访问者同某个元素进行交互时， 它们可能没有访问元素私有成员变量和方法的必要权限。</td>
</tr>
</tbody></table>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 访问者-形状导出为 XML 文件</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Visitor</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Shape</span> &#123;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">move</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span>;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">draw</span><span class="params">()</span>;</span><br><span class="line">        String <span class="title function_">accept</span><span class="params">(ShapeVisitor visitor)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Dot</span> <span class="keyword">implements</span> <span class="title class_">Shape</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> id;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> x;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> y;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Dot</span><span class="params">(<span class="type">int</span> id, <span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.id = id;</span><br><span class="line">            <span class="built_in">this</span>.x = x;</span><br><span class="line">            <span class="built_in">this</span>.y = y;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">move</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">draw</span><span class="params">()</span> &#123;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">accept</span><span class="params">(ShapeVisitor visitor)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> visitor.visitDot(<span class="built_in">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Rectangle</span> <span class="keyword">implements</span> <span class="title class_">Shape</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> id;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> x;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> y;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> width;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> height;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Rectangle</span><span class="params">(<span class="type">int</span> id, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> width, <span class="type">int</span> height)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.id = id;</span><br><span class="line">            <span class="built_in">this</span>.x = x;</span><br><span class="line">            <span class="built_in">this</span>.y = y;</span><br><span class="line">            <span class="built_in">this</span>.width = width;</span><br><span class="line">            <span class="built_in">this</span>.height = height;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">accept</span><span class="params">(ShapeVisitor visitor)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> visitor.visitRectangle(<span class="built_in">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">move</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">draw</span><span class="params">()</span> &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ShapeVisitor</span> &#123;</span><br><span class="line">        String <span class="title function_">visitDot</span><span class="params">(Dot dot)</span>;</span><br><span class="line">        String <span class="title function_">visitRectangle</span><span class="params">(Rectangle rectangle)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">XMLExportVisitor</span> <span class="keyword">implements</span> <span class="title class_">ShapeVisitor</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">export</span><span class="params">(Shape... args)</span> &#123;</span><br><span class="line">            <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">            sb.append(<span class="string">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;utf-8\&quot;?&gt;&quot;</span> + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (Shape shape : args) &#123;</span><br><span class="line">                sb.append(shape.accept(<span class="built_in">this</span>)).append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> sb.toString();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">visitDot</span><span class="params">(Dot d)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&lt;dot&gt;&quot;</span> + <span class="string">&quot;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;    &lt;id&gt;&quot;</span> + d.id + <span class="string">&quot;&lt;/id&gt;&quot;</span> + <span class="string">&quot;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;    &lt;x&gt;&quot;</span> + d.x + <span class="string">&quot;&lt;/x&gt;&quot;</span> + <span class="string">&quot;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;    &lt;y&gt;&quot;</span> + d.y + <span class="string">&quot;&lt;/y&gt;&quot;</span> + <span class="string">&quot;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;&lt;/dot&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">visitRectangle</span><span class="params">(Rectangle r)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&lt;rectangle&gt;&quot;</span> + <span class="string">&quot;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;    &lt;id&gt;&quot;</span> + r.id + <span class="string">&quot;&lt;/id&gt;&quot;</span> + <span class="string">&quot;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;    &lt;x&gt;&quot;</span> + r.x + <span class="string">&quot;&lt;/x&gt;&quot;</span> + <span class="string">&quot;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;    &lt;y&gt;&quot;</span> + r.y + <span class="string">&quot;&lt;/y&gt;&quot;</span> + <span class="string">&quot;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;    &lt;width&gt;&quot;</span> + r.width + <span class="string">&quot;&lt;/width&gt;&quot;</span> + <span class="string">&quot;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;    &lt;height&gt;&quot;</span> + r.height + <span class="string">&quot;&lt;/height&gt;&quot;</span> + <span class="string">&quot;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;&lt;/rectangle&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Dot</span> <span class="variable">dot</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Dot</span>(<span class="number">1</span>, <span class="number">10</span>, <span class="number">55</span>);</span><br><span class="line">        <span class="type">Rectangle</span> <span class="variable">rectangle</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Rectangle</span>(<span class="number">3</span>, <span class="number">10</span>, <span class="number">17</span>, <span class="number">20</span>, <span class="number">30</span>);</span><br><span class="line">        <span class="type">XMLExportVisitor</span> <span class="variable">exportVisitor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XMLExportVisitor</span>();</span><br><span class="line">        System.out.println(exportVisitor.export(dot, rectangle));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>**注：**访问者的实现依赖于“双分派”。双分派是指：接受者和参数都能在运行时决定它的类型。(从而若有同名函数的话,依参数选定目标函数)</p>
<h3 id="解释器-★☆☆"><a href="#解释器-★☆☆" class="headerlink" title="解释器 ★☆☆"></a>解释器 ★☆☆</h3><blockquote>
<p>给定一个语言，定义它的文法表示，并定义一个解释器，这个解释器使用该标识来解释语言中的句子。<br>对于一些固定文法构建一个解释句子的解释器。</p>
</blockquote>
<p>各种编译器，运算表达式本身就是解释器</p>
<p> 1、可以将一个需要解释执行的语言中的句子表示为一个抽象语法树。 2、一些重复出现的问题可以用一种简单的语言来进行表达。 3、一个简单语法需要解释的场景。</p>
<table>
<thead>
<tr>
<th>优点 √</th>
<th>缺点 ×</th>
</tr>
</thead>
<tbody><tr>
<td>可扩展性比较好，灵活<br />增加了新的解释表达式的方式。<br />易于实现简单文法。</td>
<td>可利用场景比较少。<br />对于复杂的文法比较难维护。<br />解释器模式会引起类膨胀。<br />解释器模式采用递归调用方法。</td>
</tr>
</tbody></table>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> design;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 解释器-性别解释判断</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Zhendong Zhou</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InterpreterPattern</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Expression</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="title function_">interpret</span><span class="params">(String context)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">TerminalExpression</span> <span class="keyword">implements</span> <span class="title class_">Expression</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> String data;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">TerminalExpression</span><span class="params">(String data)</span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.data = data;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">interpret</span><span class="params">(String context)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(context.contains(data))&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">OrExpression</span> <span class="keyword">implements</span> <span class="title class_">Expression</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">Expression</span> <span class="variable">expr1</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">Expression</span> <span class="variable">expr2</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">OrExpression</span><span class="params">(Expression expr1, Expression expr2)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.expr1 = expr1;</span><br><span class="line">            <span class="built_in">this</span>.expr2 = expr2;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">interpret</span><span class="params">(String context)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> expr1.interpret(context) || expr2.interpret(context);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">AndExpression</span> <span class="keyword">implements</span> <span class="title class_">Expression</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">Expression</span> <span class="variable">expr1</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">Expression</span> <span class="variable">expr2</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">AndExpression</span><span class="params">(Expression expr1, Expression expr2)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.expr1 = expr1;</span><br><span class="line">            <span class="built_in">this</span>.expr2 = expr2;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">interpret</span><span class="params">(String context)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> expr1.interpret(context) &amp;&amp; expr2.interpret(context);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Expression</span> <span class="variable">robert</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TerminalExpression</span>(<span class="string">&quot;Robert&quot;</span>);</span><br><span class="line">        <span class="type">Expression</span> <span class="variable">john</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TerminalExpression</span>(<span class="string">&quot;John&quot;</span>);</span><br><span class="line">        <span class="type">OrExpression</span> <span class="variable">isMale</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OrExpression</span>(robert, john);</span><br><span class="line"></span><br><span class="line">        <span class="type">Expression</span> <span class="variable">julie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TerminalExpression</span>(<span class="string">&quot;Julie&quot;</span>);</span><br><span class="line">        <span class="type">Expression</span> <span class="variable">married</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TerminalExpression</span>(<span class="string">&quot;Married&quot;</span>);</span><br><span class="line">        <span class="type">Expression</span> <span class="variable">isMarriedWoman</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AndExpression</span>(julie, married);</span><br><span class="line"></span><br><span class="line">        System.out.println(isMale.interpret(<span class="string">&quot;John&quot;</span>));</span><br><span class="line">        System.out.println(isMarriedWoman.interpret(<span class="string">&quot;John&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>**注：**可利用场景比较少，JAVA 中如果碰到可以用 expression4J 代替。</p>

		</div>

		
		<div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8">
			<div class="article-copyright-info-container">
    <ul>
        <li><strong>标题:</strong> 设计模式-Java示例</li>
        <li><strong>作者:</strong> 不易</li>
        <li><strong>创建于
                :</strong> 2025-03-12 22:07:05</li>
        
            <li>
                <strong>更新于
                    :</strong> 2025-03-27 16:21:30
            </li>
        
        <li>
            <strong>链接:</strong> https://github.com/ourdreams0722/2025/03/12/设计模式/
        </li>
        <li>
            <strong>
                版权声明:
            </strong>
            

            
                本文章采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a> 进行许可。
            
        </li>
    </ul>
</div>

		</div>
		

		
		<ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden">
			
			<li class="tag-item mx-0.5">
				<a href="/tags/%E8%AE%BE%E8%AE%A1%E6%9E%B6%E6%9E%84/">#设计架构</a>&nbsp;
			</li>
			
		</ul>
		

		

		
		<div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
			
			<div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="prev" rel="prev" href="/2025/03/12/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">
					<span class="left arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-left"></i>
					</span>
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item">通用数据结构</span>
						<span class="post-nav-item">上一篇</span>
					</span>
				</a>
			</div>
			
			
			<div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="next" rel="next" href="/2022/10/02/AmisLowCode/">
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item">AMIS低代码</span>
						<span class="post-nav-item">下一篇</span>
					</span>
					<span class="right arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-right"></i>
					</span>
				</a>
			</div>
			
		</div>
		


		
		<div class="comment-container px-2 sm:px-6 md:px-8 pb-8">
			<div class="comments-container mt-10 w-full ">
    <div id="comment-anchor" class="w-full h-2.5"></div>
    <div class="comment-area-title w-full my-1.5 md:my-2.5 text-xl md:text-3xl font-bold">
        评论
    </div>
    

        
            
    <div id="waline"></div>
    <script type="module" data-swup-reload-script>
      import { init } from '/js/libs/waline.mjs';

      function loadWaline() {
        init({
          el: '#waline',
          serverURL: 'https://example.example.com',
          lang: 'zh-CN',
          dark: 'body[class~="dark-mode"]',
          reaction: false,
          requiredMeta: ['nick', 'mail'],
          emoji: [],
          
          
        });
      }

      if (typeof swup !== 'undefined') {
        loadWaline();
      } else {
        window.addEventListener('DOMContentLoaded', loadWaline);
      }
    </script>



        
    
</div>

		</div>
		
	</div>

	
	<div class="toc-content-container">
		<div class="post-toc-wrap">
	<div class="post-toc">
		<div class="toc-title">目录</div>
		<div class="page-title">设计模式-Java示例</div>
		<ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F"><span class="nav-text">设计模式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F"><span class="nav-text">创建型模式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B7%A5%E5%8E%82-%E2%98%85%E2%98%86%E2%98%86"><span class="nav-text">工厂 ★☆☆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82-%E2%98%85%E2%98%85%E2%98%86"><span class="nav-text">抽象工厂 ★★☆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E5%99%A8-%E5%BB%BA%E9%80%A0%E8%80%85-%E2%98%85%E2%98%85%E2%98%86"><span class="nav-text">生成器(建造者) ★★☆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%9F%E5%9E%8B-%E2%98%85%E2%98%86%E2%98%86"><span class="nav-text">原型 ★☆☆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E4%BE%8B-%E2%98%85%E2%98%86%E2%98%86"><span class="nav-text">单例 ★☆☆</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%93%E6%9E%84%E5%9E%8B%E6%A8%A1%E5%BC%8F"><span class="nav-text">结构型模式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%82%E9%85%8D%E5%99%A8-%E2%98%85%E2%98%86%E2%98%86"><span class="nav-text">适配器 ★☆☆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A1%A5%E6%8E%A5-%E2%98%85%E2%98%85%E2%98%85"><span class="nav-text">桥接 ★★★</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%84%E5%90%88-%E2%98%85%E2%98%85%E2%98%86"><span class="nav-text">组合 ★★☆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A3%85%E9%A5%B0-%E2%98%85%E2%98%85%E2%98%86"><span class="nav-text">装饰 ★★☆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%96%E8%A7%82-%E2%98%85%E2%98%85%E2%98%86"><span class="nav-text">外观 ★★☆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%AB%E5%85%83-%E2%98%85%E2%98%85%E2%98%85"><span class="nav-text">享元 ★★★</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%90%86-%E2%98%85%E2%98%85%E2%98%86"><span class="nav-text">代理 ★★☆</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%BC%8F"><span class="nav-text">行为模式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B4%A3%E4%BB%BB%E9%93%BE-%E2%98%85%E2%98%85%E2%98%86"><span class="nav-text">责任链 ★★☆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4-%E2%98%85%E2%98%86%E2%98%86"><span class="nav-text">命令 ★☆☆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%AD%E4%BB%A3%E5%99%A8-%E2%98%85%E2%98%85%E2%98%86"><span class="nav-text">迭代器 ★★☆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%AD%E4%BB%8B%E8%80%85-%E2%98%85%E2%98%85%E2%98%86"><span class="nav-text">中介者 ★★☆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%87%E5%BF%98%E5%BD%95-%E2%98%85%E2%98%85%E2%98%85"><span class="nav-text">备忘录 ★★★</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%82%E5%AF%9F%E8%80%85-%E2%98%85%E2%98%85%E2%98%86"><span class="nav-text">观察者 ★★☆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%8A%B6%E6%80%81-%E2%98%85%E2%98%86%E2%98%86"><span class="nav-text">状态 ★☆☆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AD%96%E7%95%A5-%E2%98%85%E2%98%86%E2%98%86"><span class="nav-text">策略 ★☆☆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95-%E2%98%85%E2%98%86%E2%98%86"><span class="nav-text">模板方法 ★☆☆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BF%E9%97%AE%E8%80%85-%E2%98%85%E2%98%85%E2%98%85"><span class="nav-text">访问者 ★★★</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E9%87%8A%E5%99%A8-%E2%98%85%E2%98%86%E2%98%86"><span class="nav-text">解释器 ★☆☆</span></a></li></ol></li></ol></li></ol>

	</div>
</div>
	</div>
	
</div>
			</div>

			
		</div>

		<div class="main-content-footer">
			<footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2025</span>
              -
            
            2025<!--&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">不易</a>-->
            
        </div>
        
        <!--<div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">由 <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a> 驱动</span>
            <span class="text-sm lg:block">主题&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.8.2</a></span>
        </div>-->
        
        
            <div>
                博客已运行 <span class="odometer" id="runtime_days" ></span> 天 <span class="odometer" id="runtime_hours"></span> 小时 <span class="odometer" id="runtime_minutes"></span> 分钟 <span class="odometer" id="runtime_seconds"></span> 秒
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
		</div>
	</div>

	
	<div class="post-tools">
		<div class="post-tools-container">
	<ul class="article-tools-list">
		<!-- TOC aside toggle -->
		
		<li class="right-bottom-tools page-aside-toggle">
			<i class="fa-regular fa-outdent"></i>
		</li>
		

		<!-- go comment -->
		
		<li class="go-comment">
			<i class="fa-regular fa-comments"></i>
		</li>
		
	</ul>
</div>
	</div>
	

	<div class="right-side-tools-container">
		<div class="side-tools-container">
	<ul class="hidden-tools-list">
		<li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-plus"></i>
		</li>

		<li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-minus"></i>
		</li>

		<li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
			<i class="fa-regular fa-moon"></i>
		</li>

		<!-- rss -->
		

		

		<li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
			<i class="fa-regular fa-arrow-down"></i>
		</li>
	</ul>

	<ul class="visible-tools-list">
		<li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
			<i class="fa-regular fa-cog fa-spin"></i>
		</li>
		
		<li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
			<i class="arrow-up fas fa-arrow-up"></i>
			<span class="percent"></span>
		</li>
		
		
	</ul>
</div>
	</div>

	<div class="image-viewer-container">
	<img src="">
</div>

	
	<div class="search-pop-overlay">
	<div class="popup search-popup">
		<div class="search-header">
			<span class="search-input-field-pre">
				<i class="fa-solid fa-keyboard"></i>
			</span>
			<div class="search-input-container">
				<input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="站内搜索您需要的内容..." spellcheck="false" type="search" class="search-input">
			</div>
			<span class="popup-btn-close">
				<i class="fa-solid fa-times"></i>
			</span>
		</div>
		<div id="search-result">
			<div id="no-result">
				<i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
			</div>
		</div>
	</div>
</div>
	

</main>


<script  src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/libs/Swup.min.js" ></script><script  src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/libs/SwupSlideTheme.min.js" ></script><script  src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/libs/SwupScriptsPlugin.min.js" ></script><script  src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/libs/SwupProgressPlugin.min.js" ></script><script  src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/libs/SwupScrollPlugin.min.js" ></script><script  src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/libs/SwupPreloadPlugin.min.js" ></script>
<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>




	<script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/tools/imageViewer.js" ></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/utils.js" ></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/main.js" ></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/layouts/navbarShrink.js" ></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/tools/scrollTopBottom.js" ></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/tools/lightDarkSwitch.js" ></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/layouts/categoryList.js" ></script>


    <script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/tools/localSearch.js" ></script>



    <script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/tools/codeBlock.js" ></script>



    <script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/layouts/lazyload.js" ></script>



    <script  src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/tools/runtime.js" ></script>
    <script  src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/libs/odometer.min.js" ></script>
    <link rel="stylesheet" href="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/assets/odometer-theme-minimal.css">



  <script  src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/libs/Typed.min.js" ></script>
  <script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/plugins/typed.js" ></script>







    <script  src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/libs/anime.min.js" ></script>




    <script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/tools/tocToggle.js" data-swup-reload-script></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/layouts/toc.js" data-swup-reload-script></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/plugins/tabs.js" data-swup-reload-script></script>


<script  src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/libs/moment-with-locales.min.js" data-swup-reload-script></script>
<script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.2/source/js/build/layouts/essays.js" data-swup-reload-script></script>




	
</body>

</html>